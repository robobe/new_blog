{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Home","text":"<p>ROS</p> <p>Simulation</p> <p>Robotics</p> <p>Programming</p> <p>Embedded</p> <p>DevOps</p>"},{"location":"todo/","title":"Todo","text":"<p>[ ] Quaternion math [ ] Gimbal using Quaternion only [ ] Geometry control</p>"},{"location":"DevOps/","title":"Devops","text":"<p>Docker</p> <p>Linux</p> <p>Networking</p> <p>VSCode</p> <p>GIT</p> <p>Tools</p>"},{"location":"DevOps/docker/","title":"Docker","text":"<p>Tips / Settings</p> <p>Docker Compose</p> <p>Images</p> <p>Dockerfile snippets and templates</p> <p>docker nvidia</p> <p>Issues</p>"},{"location":"DevOps/docker/#install-dockerce","title":"Install docker.ce","text":"<p>How to Install Docker on Ubuntu \u2013 Step-by-Step Guide</p> <pre><code>sudo apt update\nsudo apt install apt-transport-https ca-certificates curl software-properties-common\n# install key\ncurl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg\n# update sources.list\necho \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable\" | sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null\n\nsudo apt update\nsudo apt install docker-ce\n</code></pre> <pre><code>sudo systemctl status docker\n</code></pre> Run docker without sudo<pre><code>sudo usermod -aG docker ${USER}\n#\nreboot or logout/login\n</code></pre> <p>Note</p> <p>Install nvidia toolkit</p> <pre><code>docker run -it --rm --gpus all nvidia/cuda:13.0.0-runtime-ubuntu24.04 nvidia-smi\n</code></pre>"},{"location":"DevOps/docker/#posts","title":"Posts","text":"<ul> <li>Running and Building ARM Docker Containers on x86</li> <li>Access Host Devices in Docker: how to connect hardware peripheral and share with docker</li> </ul>"},{"location":"DevOps/docker/#to-read","title":"To Read","text":"<ul> <li>Shared Memory &amp; Docker</li> </ul>"},{"location":"DevOps/docker/docker_build_arm/","title":"Running and Building ARM Docker Containers on x86","text":"","tags":["docker","arm","qemu"]},{"location":"DevOps/docker/docker_build_arm/#install","title":"Install","text":"<pre><code>sudo apt-get install qemu binfmt-support qemu-user-static\n</code></pre> <p>binfmt</p> <p>binfmt (Binary Format) is a Linux kernel feature that allows execution of non-native binary formats (executables compiled for different architectures). This enables cross-architecture execution, such as running ARM64 binaries on an x86_64 machine.</p> <p>binfmt works with interpreters like QEMU to translate and execute foreign binaries transparently.</p>","tags":["docker","arm","qemu"]},{"location":"DevOps/docker/docker_build_arm/#registration-with-docker","title":"Registration With docker","text":"<pre><code>docker run --rm --privileged multiarch/qemu-user-static --reset -p yes\n</code></pre> <p>-p yes</p> <p>This register qemu persistent and available for future docker to run</p> <p>multiarch/qemu-user-static</p> <ul> <li>The multiarch/qemu-user-static image is pulled and run temporarily to register QEMU with your system.</li> <li>It doesn't leave behind an actual image that appears in docker images.</li> <li></li> </ul> <p>The purpose of this command is to enable the host system to run binaries compiled for different architectures (such as ARM) using QEMU. This is particularly useful for building and running ARM Docker containers on an x86 host.</p>","tags":["docker","arm","qemu"]},{"location":"DevOps/docker/docker_build_arm/#usage","title":"Usage","text":"Dockerfile<pre><code>FROM ubuntu:22.04\nRUN apt-get update &amp;&amp; apt-get install -y --no-install-recommends \\\n    &amp;&amp; rm -rf /var/lib/apt/lists/*\nCMD [\"/bin/bash\"]\n</code></pre>","tags":["docker","arm","qemu"]},{"location":"DevOps/docker/docker_build_arm/#build-and-run","title":"Build and Run","text":"Build<pre><code>docker build --platform linux/arm64 -t ubuntu/22.04:arm64 .\ndocker build --platform linux/amd64 -t ubuntu/22.04:amd64 .\n</code></pre> Run<pre><code>docker run --rm -it --platform linux/arm64 ubuntu/22.04:arm64 uname -m\ndocker run --rm -it --platform linux/amd64 ubuntu/22.04:amd64 uname -m\n</code></pre> <p>buildX</p> <p>Use buildX to build multi-arch images with the same TAG work only if we push to a registry (Manifest)</p>","tags":["docker","arm","qemu"]},{"location":"DevOps/docker/docker_build_arm/#references","title":"References","text":"<ul> <li>Running and Building ARM Docker Containers on x86</li> </ul>","tags":["docker","arm","qemu"]},{"location":"DevOps/docker/docker_host_devices/","title":"Access Host device in docker","text":"<p>Connect and share hardware device with docker container Connect joystick, camera and serial device and share with docker container</p>","tags":["docker","devices","hardware","usb","joystick"]},{"location":"DevOps/docker/docker_host_devices/#joystick","title":"joystick","text":"","tags":["docker","devices","hardware","usb","joystick"]},{"location":"DevOps/docker/docker_host_devices/#host","title":"host","text":"<pre><code># check dmesg\n\n# check device\nll /dev/input/js0\n\ncrw-rw-r--+ 1 root input 13, 0 Apr 25 07:44 /dev/input/js0\n</code></pre> test joy functionality<pre><code>sudo apt install joystick\n\n## test\njstest /dev/input/js0\n</code></pre>","tags":["docker","devices","hardware","usb","joystick"]},{"location":"DevOps/docker/docker_host_devices/#docker","title":"docker","text":"share device with container<pre><code>docker run -it --rm \\\n--name test \\\n--hostname test \\\n--device /dev/input/js0 \\\nubuntu:22.04 \\\n/bin/bash\n</code></pre>","tags":["docker","devices","hardware","usb","joystick"]},{"location":"DevOps/docker/docker_host_devices/#device-cgroup-rule","title":"device-cgroup-rule","text":"<p>Docker option used to grant fine-grained access to devices from the Linux cgroup (control group) level.</p> <p>cgroup rules</p> <p>Linux cgroups (control groups) are a powerful kernel feature that allows you to limit, isolate, and prioritize resources (like CPU, memory, devices, I/O, etc.) for groups of processes. more</p> <pre><code>--device-cgroup-rule=\"type major:minor permissions\"\n</code></pre> <p>permission</p> <ul> <li>r(read)</li> <li>w(write)</li> <li>m(mknod- permission to create spacial device file)</li> </ul> joystick check type and major, minor<pre><code>ll /dev/input/js0\n\ncrw-rw-r--+ 1 root input 13, 0 Apr 25 07:44 /dev/input/js0\n</code></pre> <ul> <li>type: <code>c</code></li> <li>major: 13</li> <li>minor: 0</li> </ul> run docker with device cgroup rule<pre><code>docker run -it --rm \\\n--name test \\\n--hostname test \\\n-v /dev/input:/dev/input \\\n--device-cgroup-rule='c 13:* rwm' \\\nubuntu:22.04 \\\n/bin/bash\n</code></pre> <p>privileged</p> <p>No <code>--privileged</code> mode need to run the container and share the device</p>","tags":["docker","devices","hardware","usb","joystick"]},{"location":"DevOps/docker/docker_host_devices/#demo","title":"Demo","text":"<ul> <li>Run docker with none root permission</li> <li>Share joystick</li> <li>Connect the joystick after the container run</li> <li>Disconnect and connect again</li> </ul> Dockerfile.joytest<pre><code>FROM ubuntu:22.04\nRUN apt-get update &amp;&amp; apt-get install -y --no-install-recommends \\\n        joystick \\\n    &amp;&amp; rm -rf /var/lib/apt/lists/*\n\n\n\nRUN groupadd -g 107 input\n\nARG USERNAME=user\nARG UID=1000\nARG GID=1000\n\n\n# add new sudo user\nRUN useradd -m $USERNAME &amp;&amp; \\\n    echo \"$USERNAME:$USERNAME\" | chpasswd &amp;&amp; \\\n    usermod --shell /bin/bash $USERNAME &amp;&amp; \\\n    usermod -aG sudo $USERNAME &amp;&amp; \\\n    usermod -aG input $USERNAME &amp;&amp; \\\n    usermod -aG dialout $USERNAME &amp;&amp; \\\n    mkdir /etc/sudoers.d &amp;&amp; \\\n    echo \"$USERNAME ALL=(ALL) NOPASSWD:ALL\" &gt;&gt; /etc/sudoers.d/$USERNAME &amp;&amp; \\\n    chmod 0440 /etc/sudoers.d/$USERNAME &amp;&amp; \\\n    usermod  --uid $UID $USERNAME &amp;&amp; \\\n    groupmod --gid $GID $USERNAME\n\nCMD [\"/bin/bash\"]\n</code></pre> <p>input group</p> <p>Create <code>input</code> group on docker </p> <pre><code>RUN groupadd -g 107 input\n</code></pre> <p>Add user (none root) to <code>input group</code></p> <pre><code>usermod -aG input $USERNAME &amp;&amp; \\\n</code></pre> build<pre><code>docker build -f Dockerfile.joytest -t joystick:test .\n</code></pre> run and test<pre><code>docker run -it --rm \\\n--user user \\\n--name test \\\n--hostname test \\\n-v /dev/input:/dev/input \\\n--device-cgroup-rule='c 13:* rwm' \\\njoystick:test \\\n/bin/bash\n</code></pre> test - joystick<pre><code>ll /dev/input/js0\njstest /dev/input/js0\n</code></pre>","tags":["docker","devices","hardware","usb","joystick"]},{"location":"DevOps/docker/docker_host_devices/#run-all-the-scenarios","title":"run all the Scenarios","text":"<ul> <li>Run container with joy connect. disconnect and connect again</li> <li>Run container when joy disconnect, connect and check</li> </ul>","tags":["docker","devices","hardware","usb","joystick"]},{"location":"DevOps/docker/docker_compose/","title":"Docker Compose","text":"<p>Docker Compose is a tool for defining and managing multi-container Docker applications using a YAML configuration file. Instead of manually running multiple docker run commands</p> <p><code>docker-compose</code> vs <code>docker compose</code></p> <p><code>docker-compose</code> is the original command, <code>docker compose</code> is the new command.  The new command is available in Docker 1.29 and later.</p>","tags":["docker","compose"]},{"location":"DevOps/docker/docker_compose/#usage","title":"Usage","text":"<pre><code>docker compose -f docker-compose.yml up\ndocker compose -f docker-compose.yml run &lt;service_name&gt; &lt;command&gt;\n</code></pre> <p>gui</p> <p>TBD</p>","tags":["docker","compose"]},{"location":"DevOps/docker/docker_compose/#compose-override","title":"compose override","text":"<p>Docker Compose override is a feature that lets you customize or extend a base docker-compose.yml file using additional YAML files like docker-compose.override.yml </p> <p>For example run nvidia support on pc and nvidia jetson</p> docker-compose.yaml<pre><code>services:\n  dev:\n    image: your-gpu-app:latest\n    deploy:\n      resources:\n        reservations:\n          devices:\n            - capabilities: [gpu]\n</code></pre> docker-compose.jetson.yaml<pre><code>services:\n  dev:\n    runtime: nvidia\n    environment:\n      - NVIDIA_VISIBLE_DEVICES=all\n      - NVIDIA_DRIVER_CAPABILITIES=compute,utility\n</code></pre> <pre><code>docker compose -f docker-compose.yml -f docker-compose.jetson.yml up\n</code></pre>","tags":["docker","compose"]},{"location":"DevOps/docker/docker_compose/#references","title":"References","text":"<ul> <li>Ultimate Docker Compose Tutorial</li> </ul>","tags":["docker","compose"]},{"location":"DevOps/docker/docker_compose/compose_tips_and_templates/","title":"Docker compose tips and templates","text":"","tags":["docker","compose","tips","templates"]},{"location":"DevOps/docker/docker_compose/compose_tips_and_templates/#add-hostname-to-etchosts","title":"Add hostname to /etc/hosts","text":"<p>Used to manually define hostname-to-IP address mappings, similar to adding lines to the /etc/hosts file inside the container.</p> <pre><code>hostname: dev\nextra_hosts:\n    - \"dev:127.0.0.1\"\n</code></pre>","tags":["docker","compose","tips","templates"]},{"location":"DevOps/docker/docker_images/","title":"Index","text":"<p>gui</p> <p>TBD</p>","tags":["docker","images"]},{"location":"DevOps/docker/docker_images/#docker-images","title":"Docker Images","text":"<ul> <li>x11</li> </ul>","tags":["docker","images"]},{"location":"DevOps/docker/docker_images/x11/","title":"X11 Docker Images","text":"<p>Create docker images for X11 GUI applications. base on ubunu:22.04 </p> Dockerfile dockerfile<pre><code># Use Ubuntu 22.04 as the base image\nFROM ubuntu:22.04\n\n# Set non-interactive mode for apt-get to avoid prompts\nENV DEBIAN_FRONTEND=noninteractive\n\n# Update package list and install X11 and OpenGL dependencies\nRUN apt-get update &amp;&amp; apt-get install -y \\\n    # Core X11 libraries\n    libx11-6 \\\n    libxext6 \\\n    libxrender1 \\\n    libxinerama1 \\\n    libxcursor1 \\\n    libxrandr2 \\\n    libxi6 \\\n    # OpenGL/Mesa for rendering\n    libgl1-mesa-glx \\\n    libgl1-mesa-dri \\\n    libglu1-mesa \\\n    # Utilities for X11 auth and testing\n    xauth \\\n    mesa-utils \\\n    # apps\n    cheese \\\n    gstreamer1.0-alsa \\\n    gstreamer1.0-libav \\\n    gstreamer1.0-plugins-bad \\\n    gstreamer1.0-plugins-base \\\n    gstreamer1.0-plugins-good \\\n    gstreamer1.0-plugins-ugly \\\n    gstreamer1.0-tools \\\n    # Clean up\n    &amp;&amp; rm -rf /var/lib/apt/lists/*\n\n# Set up environment variables for X11\nENV DISPLAY=:0\n# Optional: Define a default runtime directory (can be overridden at runtime)\nENV XDG_RUNTIME_DIR=/tmp/runtime-root\n\n# Create a non-root user (optional, for better security and matching host permissions)\nARG USERNAME=user\nARG UID=1000\nARG GID=1000\n\n# add new sudo user\nRUN useradd -m $USERNAME &amp;&amp; \\\n        echo \"$USERNAME:$USERNAME\" | chpasswd &amp;&amp; \\\n        usermod --shell /bin/bash $USERNAME &amp;&amp; \\\n        usermod -aG sudo $USERNAME &amp;&amp; \\\n        usermod -aG video $USERNAME &amp;&amp; \\\n        usermod -aG dialout $USERNAME &amp;&amp; \\\n        mkdir /etc/sudoers.d &amp;&amp; \\\n        echo \"$USERNAME ALL=(ALL) NOPASSWD:ALL\" &gt;&gt; /etc/sudoers.d/$USERNAME &amp;&amp; \\\n        chmod 0440 /etc/sudoers.d/$USERNAME &amp;&amp; \\\n        usermod  --uid $UID $USERNAME &amp;&amp; \\\n        groupmod --gid $GID $USERNAME\n\n# Switch to the non-root user\n# USER $USERNAME\n\n# Set working directory\nWORKDIR /home/$USERNAME\n\n# Default command (can be overridden)\nCMD [\"bash\"]\n</code></pre> build<pre><code>docker build -t ubuntu/22.04:gui -f Dockerfile .\n</code></pre> <p>The command xhost +local:docker is used on Linux systems to manage access control for the X11 display server. Allows any process running locally as part of the \"docker\" context (Docker containers) to connect to your X server.</p> <pre><code>xhost +local:docker\n</code></pre> <p>check x11 app</p> <p>glxgears is a simple OpenGL application that draws a rotating set of gears. It is often used to test the performance of OpenGL on a system.</p> run<pre><code>docker run -it --rm \\\n    -e DISPLAY=$DISPLAY \\\n    -v /tmp/.X11-unix:/tmp/.X11-unix \\\n    ubuntu/22.04:gui \\\n    glxgears\n</code></pre>","tags":["docker","x11","gui","devices"]},{"location":"DevOps/docker/docker_images/x11/#share-camera-with-docker","title":"Share camera with docker","text":"","tags":["docker","x11","gui","devices"]},{"location":"DevOps/docker/docker_images/x11/#simple","title":"Simple","text":"<p>Device must be connected before running the container.</p> run<pre><code>docker run -it --rm \\\n    --user user \\\n    --hostname gui \\\n    --device /dev/video0:/dev/video0 \\\n    -e DISPLAY=$DISPLAY \\\n    --user user \\\n    -v /tmp/.X11-unix:/tmp/.X11-unix \\\n    -v /run/user/1000:/run/user/1000 \\\n    ubuntu/22.04:gui \\\n    /bin/bash\n</code></pre> <pre><code># Test\ngst-launch-1.0 videotestsrc ! videoconvert ! autovideosink\n\n# v4l\ngst-launch-1.0 v4l2src device=/dev/video0 ! videoconvert ! autovideosink\n</code></pre>","tags":["docker","x11","gui","devices"]},{"location":"DevOps/docker/docker_images/x11/#advanced","title":"Advanced","text":"<pre><code>ls -l /dev/video*\n#\ncrw-rw----+ 1 root video 81, 0 Apr  5 16:57 /dev/video0\n</code></pre> run<pre><code>docker run -it --rm \\\n    --user user \\\n    --hostname gui \\\n    -e DISPLAY=$DISPLAY \\\n    -v /tmp/.X11-unix:/tmp/.X11-unix \\\n    -v /dev/dri:/dev/dri \\\n    --device-cgroup-rule='c 81:* rwm' \\\n    -v /dev:/dev \\\n    ubuntu/22.04:gui \\\n    /bin/bash\n</code></pre> <p>Advanced</p> <ul> <li>--device-cgroup-rule: allows the container to interact with any video device (major number 81) created after startup.</li> <li>-v /dev:/dev: ensures the container sees the host\u2019s /dev directory in real-time.host.</li> </ul>","tags":["docker","x11","gui","devices"]},{"location":"DevOps/docker/docker_issues/","title":"Docker issues","text":"<p>DevOps / docker</p>","tags":["docker","issue"]},{"location":"DevOps/docker/docker_issues/#network","title":"Network","text":"<p>failed to start daemon: Error initializing network controller: error obtaining controller instance: failed to register \"bridge\" driver: failed to add</p>","tags":["docker","issue"]},{"location":"DevOps/docker/docker_issues/#resolve","title":"Resolve","text":"<p>TODO: understand more <pre><code>{\n    \"bridge\": \"none\",\n    \"iptables\": false,\n    \"default-address-pools\": [\n        {\"base\": \"172.30.0.0/16\", \"size\": 24}\n  ]\n}\n</code></pre></p> downgrade docker<pre><code>sudo apt-get install -y docker-ce=5:27.5* docker-ce-cli=5:27.5* --allow-downgrades\n</code></pre>","tags":["docker","issue"]},{"location":"DevOps/docker/docker_nvidia/","title":"NVIDIA docker","text":"<p>NVidia container toolkit enables GPU acceleration in docker container</p> <ul> <li>Install Toolkit</li> <li>Configure Docker</li> <li>Run with GPU</li> </ul>","tags":["docker","nvidia","nvidia-container-toolkit"]},{"location":"DevOps/docker/docker_nvidia/#install","title":"Install","text":"add nvidia toolkit repository<pre><code>curl -fsSL https://nvidia.github.io/libnvidia-container/gpgkey | sudo gpg --dearmor -o /usr/share/keyrings/nvidia-container-toolkit-keyring.gpg \\\n  &amp;&amp; curl -s -L https://nvidia.github.io/libnvidia-container/stable/deb/nvidia-container-toolkit.list | \\\n    sed 's#deb https://#deb [signed-by=/usr/share/keyrings/nvidia-container-toolkit-keyring.gpg] https://#g' | \\\n    sudo tee /etc/apt/sources.list.d/nvidia-container-toolkit.list\n</code></pre> install<pre><code>sudo apt update\nsudo apt-get install -y nvidia-container-toolkit\n</code></pre>","tags":["docker","nvidia","nvidia-container-toolkit"]},{"location":"DevOps/docker/docker_nvidia/#configure-docker","title":"Configure Docker","text":"<pre><code>sudo nvidia-ctk runtime configure --runtime=docker\n</code></pre> <pre><code>systemctl --user restart docker\n</code></pre>","tags":["docker","nvidia","nvidia-container-toolkit"]},{"location":"DevOps/docker/docker_nvidia/#usage","title":"Usage","text":"<p>run image form docker hub with cuda </p> <pre><code>docker pull nvidia/cuda:12.2.2-devel-ubuntu22.04\n</code></pre> <p>Run container with <code>--gps all</code> to enable nvidia gpu in container</p>","tags":["docker","nvidia","nvidia-container-toolkit"]},{"location":"DevOps/docker/docker_nvidia/#run","title":"Run","text":"<pre><code>docker run --gpus all -it nvidia/cuda:12.2.2-devel-ubuntu22.04\n</code></pre>","tags":["docker","nvidia","nvidia-container-toolkit"]},{"location":"DevOps/docker/docker_nvidia/#check","title":"check","text":"<pre><code>nvidia-smi\nnvcc --version\n</code></pre>","tags":["docker","nvidia","nvidia-container-toolkit"]},{"location":"DevOps/docker/docker_nvidia/#reference","title":"Reference","text":"<ul> <li>NVIDIA Container Toolkit</li> </ul>","tags":["docker","nvidia","nvidia-container-toolkit"]},{"location":"DevOps/docker/dockerfile_templates/","title":"Dockerfile template and snippets","text":"<p>Dockerfile templates and snippets for various applications and services.</p> <p>Non root user</p> <p>GStreamer snippet</p> <p>Architecture condition</p>","tags":["docker","dockerfile","templates","user","pip"]},{"location":"DevOps/docker/dockerfile_templates/#user","title":"User","text":"<p>Add user and install sudo support</p> Dockerfile<pre><code>ARG USERNAME=user\nARG USER_UID=1000\nARG USER_GID=$USER_UID\n\n# Check if \"ubuntu\" user exists, delete it if it does, then create the desired user\nRUN if getent passwd ubuntu &gt; /dev/null 2&gt;&amp;1; then \\\n        userdel -r ubuntu &amp;&amp; \\\n        echo \"Deleted existing ubuntu user\"; \\\n    fi &amp;&amp; \\\n    groupadd --gid $USER_GID $USERNAME &amp;&amp; \\\n    useradd -s /bin/bash --uid $USER_UID --gid $USER_GID -m $USERNAME &amp;&amp; \\\n    echo \"Created new user $USERNAME\"\n\n# Add sudo support for the non-root user\nRUN apt-get update &amp;&amp; apt-get install -y sudo \\\n  &amp;&amp; echo $USERNAME ALL=\\(root\\) NOPASSWD:ALL &gt; /etc/sudoers.d/$USERNAME\\\n  &amp;&amp; chmod 0440 /etc/sudoers.d/$USERNAME \\\n  &amp;&amp; rm -rf /var/lib/apt/lists/*\n</code></pre>","tags":["docker","dockerfile","templates","user","pip"]},{"location":"DevOps/docker/dockerfile_templates/#usage","title":"usage","text":"Terminal<pre><code>docker run --rm -it --user user my_ubuntu:22.04 id\n#\nuid=1000(user) gid=1000(user) groups=1000(user)\n</code></pre>","tags":["docker","dockerfile","templates","user","pip"]},{"location":"DevOps/docker/dockerfile_templates/#user-with-device-access","title":"User with device access","text":"","tags":["docker","dockerfile","templates","user","pip"]},{"location":"DevOps/docker/dockerfile_templates/#todo-move-to-embedded-section","title":"TODO: move to embedded section","text":"","tags":["docker","dockerfile","templates","user","pip"]},{"location":"DevOps/docker/dockerfile_templates/#usage_1","title":"usage","text":"<pre><code>docker run --rm -it \\\n--user user \\\n--group-add=dialout \\\n--device /dev/ttyACM0 \\\nmy_ubuntu:22.04 \\\nll /dev/ttyACM0\n</code></pre>","tags":["docker","dockerfile","templates","user","pip"]},{"location":"DevOps/docker/dockerfile_templates/#architecture-condition","title":"Architecture condition","text":"<pre><code>RUN ARCH=$(uname -m) &amp;&amp; \\\n    apt update &amp;&amp; \\\n    if [ \"$ARCH\" = \"aarch64\" ]; then \\\n        apt install -y ./OpenCV-unknown-aarch64-*.deb; \\\n    elif [ \"$ARCH\" = \"x86_64\" ]; then \\\n        apt install -y ./OpenCV-unknown-x86_64-*.deb; \\\n    else \\\n        echo \"Unsupported architecture: $ARCH\"; exit 1; \\\n    fi &amp;&amp; \\\n</code></pre>","tags":["docker","dockerfile","templates","user","pip"]},{"location":"DevOps/docker/dockerfile_templates/#gstreamer","title":"GStreamer","text":"<pre><code>RUN apt-get update \\\n    &amp;&amp; apt-get -y install --no-install-recommends \\\n        libgstreamer1.0-0 \\\n        gstreamer1.0-plugins-base \\\n        gstreamer1.0-plugins-good \\\n        gstreamer1.0-plugins-bad \\\n        gstreamer1.0-plugins-ugly \\\n        gstreamer1.0-tools \\\n        python3-gi \\\n        gir1.2-gstreamer-1.0 \\\n        libgstreamer-plugins-base1.0-dev \\\n        gstreamer1.0-libav \\\n        gstreamer-1.0 \\\n    &amp;&amp; apt-get clean -y \\\n    &amp;&amp; rm -rf /var/lib/apt/lists/*\n</code></pre>","tags":["docker","dockerfile","templates","user","pip"]},{"location":"DevOps/docker/tips_settings/","title":"Docker tips","text":"","tags":["docker","tips"]},{"location":"DevOps/docker/tips_settings/#images","title":"images","text":"","tags":["docker","tips"]},{"location":"DevOps/docker/tips_settings/#remove-all-dangling-images","title":"Remove all dangling images","text":"<pre><code>docker image prune\n</code></pre>","tags":["docker","tips"]},{"location":"DevOps/docker/tips_settings/#prompt","title":"Prompt","text":"<pre><code>PS1='\ud83d\udc33  \\[\\033[1;36m\\]\\h \\[\\033[1;34m\\]\\W\\[\\033[0;35m\\] \\[\\033[1;36m\\]# \\[\\033[0m\\]'\n</code></pre>","tags":["docker","tips"]},{"location":"DevOps/docker/tips_settings/#mount-tmpfs","title":"Mount tmpfs","text":"<pre><code>docker run -it --rm  \\\n--mount type=tmpfs,destination=/mnt/ramdisk,tmpfs-size=64m,tmpfs-mode=1777 \\\nubuntu:22.04 \\\n/bin/bash\n</code></pre> check mount<pre><code>df -h /mnt/ramdisk\nFilesystem      Size  Used Avail Use% Mounted on\ntmpfs            64M     0   64M   0% /mnt/ramdisk\n</code></pre>","tags":["docker","tips"]},{"location":"DevOps/docker/tips_settings/#using-compose","title":"using compose","text":"<pre><code>services:\n  app:\n    image: ubuntu:22.04\n    command: bash\n    tmpfs:\n      - /mnt/ramdisk:size=64m,mode=1777\n    stdin_open: true\n    tty: true\n</code></pre> run<pre><code>docker compose -f tmpfs.yaml up -d\n</code></pre> shell<pre><code>docker exec -it code-app-1 /bin/bash\n</code></pre> check mount<pre><code>df -h /mnt/ramdisk\nFilesystem      Size  Used Avail Use% Mounted on\ntmpfs            64M     0   64M   0% /mnt/ramdisk\n</code></pre>","tags":["docker","tips"]},{"location":"DevOps/docker/tips_settings/#devices","title":"Devices","text":"","tags":["docker","tips"]},{"location":"DevOps/docker/tips_settings/#demo-share-pixhawk-device-with-docker","title":"Demo: share pixhawk device with docker","text":"host<pre><code>dmesg\n\nusb 3-4.1.5.4: Product: CubeOrange\nusb 3-4.1.5.4: Manufacturer: Hex/ProfiCNC\nusb 3-4.1.5.4: SerialNumber: 1F0048001451303039333335\ncdc_acm 3-4.1.5.4:1.0: ttyACM0: USB ACM device\n</code></pre> host<pre><code>ll /dev/ttyACM0\ncrw-rw---- 1 root dialout 166, 0 Jul 11 07:19 /dev/ttyACM0\n</code></pre> add to compose<pre><code>    devices:\n      - /dev/ttyACM0:/dev/ttyACM0\n    group_add:\n      - dialout\n    device_cgroup_rules:\n      - 'c 166:* rmw'\n</code></pre>","tags":["docker","tips"]},{"location":"DevOps/docker/tips_settings/#demo-share-by-name","title":"Demo: share by name","text":"<pre><code>ll /dev/serial/by-id/\n#\nlrwxrwxrwx 1 root root 13 Jul 12 12:12 usb-ArduPilot_fmuv2_430032000551353532333634-if00 -&gt; ../../ttyACM0\n</code></pre> compose<pre><code>devices:\n    - /dev/serial/by-id/usb-ArduPilot_fmuv2_430032000551353532333634-if00:/dev/ttyPIXHawk\n  group_add:\n    - dialout\n  device_cgroup_rules:\n    - 'c 166:* rmw'\n  restart:\n</code></pre>","tags":["docker","tips"]},{"location":"DevOps/git/","title":"Git","text":"<p>Tips / Settings</p> <p>Git branching</p> <p>Github</p>","tags":["git"]},{"location":"DevOps/git/#cheat-sheet","title":"Cheat sheet","text":"<ul> <li>git diff</li> <li>git rebase</li> <li>git cherrypick</li> <li>Git stash</li> <li>Git submodule</li> <li>Git hooks</li> </ul>","tags":["git"]},{"location":"DevOps/git/#git-tools","title":"Git tools","text":"<p>GitKraken</p>","tags":["git"]},{"location":"DevOps/git/#reference","title":"Reference","text":"<ul> <li>10 Git Commands Every Developer Should Master</li> </ul>","tags":["git"]},{"location":"DevOps/git/git_cherrypick/","title":"Git Cherrypick","text":"<p>Git cherry-pick command allows you to apply a specific commit from one branch onto another</p> <pre><code># list commit from other branch\ngit log &lt;branch name&gt; --oneline\n\n# cherry\n# from current branch cheery  commit from another branch\ngit cherry-pick &lt;commit hash&gt;\n</code></pre>","tags":["git","cherrypick"]},{"location":"DevOps/git/git_cherrypick/#cherry-pick-multiple-commits","title":"cherry pick multiple commits","text":"<pre><code>git cheery-pick &lt;hash1&gt; &lt;hash2&gt;\n</code></pre> <p>apply order</p> <p>cherry pick apply changes by the hash order</p>","tags":["git","cherrypick"]},{"location":"DevOps/git/git_diff/","title":"Git diff","text":"git command git diff shows the changes that you have made in your working directory but not yet staged for commit    It compares the files you have modified in your working directory with the last committed version of those files. git diff --stage shows the differences between the staging area (index) and the last commit git diff ref1..ref2 compare the changes between two different references (e.g., commits, branches, tags)","tags":["git","git-diff"]},{"location":"DevOps/git/git_diff/#other-tips","title":"other tips","text":"","tags":["git","git-diff"]},{"location":"DevOps/git/git_diff/#compare-specific-file","title":"compare specific file","text":"<pre><code>git diff &lt;ref1&gt;..&lt;ref2&gt; -- &lt;file-path&gt;\n</code></pre>","tags":["git","git-diff"]},{"location":"DevOps/git/git_hooks/","title":"git pre-commit","text":"<p>All Git hooks are ordinary scripts that Git executes when certain events occur in the repository like: - pre-commit - post-commit - update - post-merge - pre-push - full list and more</p> <p>git hooks locate in <code>.git/hooks</code> folder</p>","tags":["git","hooks","pre-commit"]},{"location":"DevOps/git/git_hooks/#pre-commit","title":"pre-commit","text":"<p><code>pre-commit</code> A framework for managing and maintaining multi-language pre-commit hooks.</p>","tags":["git","hooks","pre-commit"]},{"location":"DevOps/git/git_hooks/#install","title":"Install","text":"<pre><code>python -m pip install pre-commit\n#or from pyz\n# Download from release\npython pre-commit-#.#.#.pyz\n</code></pre>","tags":["git","hooks","pre-commit"]},{"location":"DevOps/git/git_hooks/#usage","title":"usage","text":"<ul> <li>Create config file at project root folder</li> <li>Add hooks</li> <li>Install hooks</li> <li>Test / Run hooks</li> </ul>","tags":["git","hooks","pre-commit"]},{"location":"DevOps/git/git_hooks/#config-hooks","title":"config hooks","text":"<pre><code>touch .pre-commit-config.yaml\n</code></pre> <pre><code>repos:\n-   repo: https://github.com/psf/black\n    rev: 23.3.0\n    hooks:\n    -   id: black\n</code></pre> <p>supported hooks</p> <p><code>rev</code> can take from github project releases page</p> <p>supported hooks</p> <p>Get hooks list from pre-commit</p>","tags":["git","hooks","pre-commit"]},{"location":"DevOps/git/git_hooks/#install-hook","title":"install hook","text":"<pre><code>pre-commit install\n</code></pre>","tags":["git","hooks","pre-commit"]},{"location":"DevOps/git/git_hooks/#test-run","title":"Test/ run","text":"<pre><code>#-a all-files\npre-commit run -a\n</code></pre>","tags":["git","hooks","pre-commit"]},{"location":"DevOps/git/git_hooks/#custom-script-demo","title":"Custom script demo","text":"<p>run shell script</p> <pre><code>repos:\n- repo: local\n  hooks:\n    - id: shell_script\n      name: shell_script\n      entry: path_to_shell_script.sh\n      language: script\n</code></pre>","tags":["git","hooks","pre-commit"]},{"location":"DevOps/git/git_hooks/#references","title":"References","text":"<ul> <li>pre-commit</li> <li>4 Tools to Format &amp; Check your Code with Pre-Commit</li> </ul>","tags":["git","hooks","pre-commit"]},{"location":"DevOps/git/git_rebase/","title":"GIT Rebase","text":"<p><pre><code>#switch to feature branch\ngit checkout feature/cool\n</code></pre> </p> <pre><code># from feature/cool\ngit checkout feature/cool\ngit rebase master\n</code></pre> <p></p> <pre><code># from master\ngit checkout master\ngit rebase feature/cool\n</code></pre> <p></p>","tags":["git","rebase"]},{"location":"DevOps/git/git_rebase/#reference","title":"Reference","text":"<ul> <li>A better Git workflow with rebase</li> </ul>","tags":["git","rebase"]},{"location":"DevOps/git/git_stash/","title":"Git Stash","text":"<p>Git stash temporarily saves your local changes without committing them, allowing you to work on something else and then reapply those changes later.</p> Command Description git stash Add track uncommit file to the stash git stash pop Apply and remove from stash git stash apply Apply without remove git stash apply@{1} Apply specific stash git stash list List all stash entries git stash clear clear entries git stash push -m \"stash message\" push with message git stash push -m \"stash message\" -- filename push specific file with message","tags":["git","stash"]},{"location":"DevOps/git/git_stash/#reference","title":"Reference","text":"<ul> <li> Git Stash In 5 Minutes </li> </ul>","tags":["git","stash"]},{"location":"DevOps/git/git_submodule/","title":"Git Submodule","text":"<p>Submodules are repositories inside other Git repositories.</p> <pre><code># Add a submodule to current repository at specified path\ngit submodule add -b master [URL to Git repo] [path]\n</code></pre> <pre><code># update all project submodules\ngit submodule update --init --recursive\n</code></pre>","tags":["git","submodule"]},{"location":"DevOps/git/git_submodule/#remove-a-submodule","title":"Remove a submodule","text":"<p>bash Script to remove a submodule from a git repository</p> <pre><code>submodule_path=$1\n\n[ -d \"$submodule_path\" ] || (echo 'Specify valid submodule path as first parameter' &amp;&amp; exit 1)\n\n# Remove the submodule entry from .git/config\necho \"Deinitializing submodule $submodule_path\"\ngit submodule deinit -f $submodule_path\n\n# Remove the submodule directory from the superproject's .git/modules directory\necho \"Removing .git/modules for $submodule_path\"\nrm -rf .git/modules/$submodule_path\n\n# Remove the entry in .gitmodules and remove the submodule directory located at path/to/submodule\necho \"Removing files for $submodule_path\"\ngit rm -rf $submodule_path\n</code></pre>","tags":["git","submodule"]},{"location":"DevOps/git/branching/","title":"Git branching strategy","text":"","tags":["git","branching"]},{"location":"DevOps/git/branching/#gitflow","title":"Gitflow","text":"Branch main/master stores the currently released version of code and should match the code that is in production. develop stores a copy of the main branch with all additional changes that have been added since the last release feature is the branch where a new feature is developed. release is the branch where the code is prepared for the next release. its merge from develop and ready for test when it done it merge to main and back into develop if any change done, in main it's tag as release (with version) hotfix is the branch where the code is fixed for a bug in the main branch. it's merge to main and back into develop if any change done, in main it's tag as release (with version)","tags":["git","branching"]},{"location":"DevOps/git/branching/#github-flow","title":"Github flow","text":"<p>Github flow is a lightweight, branch-based workflow. It revolves around branching from main and pull requests. </p> <p>A Pull Request (PR) is a request to merge a branch into another branch. It is a way to discuss changes before they are merged into the main branch.</p> <p></p> Branch main stores the last working codebase change/feature Temporary branch for the new feature or bug fix , the branch well be base for pull request and well delete after merging into main branch <p>nameing</p> <p>Name change/feature branch with prefix like:</p> <ul> <li>feature/</li> <li>bugfix/</li> <li>hotfix/</li> </ul>","tags":["git","branching"]},{"location":"DevOps/git/branching/#pull-request","title":"Pull Request","text":"<ul> <li>Unit/Integration test</li> <li>Code review</li> <li>Reference to issue</li> <li>Has a comprehensive description</li> <li>Squashed into single commit</li> </ul> <p>more</p>","tags":["git","branching"]},{"location":"DevOps/git/github/","title":"Github","text":"<p>Tips / Settings</p> <p>Git CLI</p> <p>Github Actions</p> <p></p>","tags":["github"]},{"location":"DevOps/git/github/github_actions/","title":"Github Actions","text":"<p>GitHub Actions is a powerful feature of GitHub that allows you to automate, customize, and execute software development workflows directly in your GitHub repository. With GitHub Actions, you can build, test, and deploy your code right from GitHub.</p> <ul> <li>Custom action</li> <li>Controlling and job execution</li> </ul>","tags":["git","github","action"]},{"location":"DevOps/git/github/github_actions/#act","title":"Act","text":"<p>Run github action locally</p> <ul> <li>Run github action locally using act</li> <li>ACT - pass inputs to workflow</li> </ul>","tags":["git","github","action"]},{"location":"DevOps/git/github/github_actions/github_action_controlling_workflow_and_job_execution/","title":"Macro Rendering Error","text":"<p>File: <code>DevOps/git/github/github_actions/github_action_controlling_workflow_and_job_execution.md</code></p> <p>UndefinedError: 'matrix' is undefined</p> <pre><code>Traceback (most recent call last):\n  File \"/home/user/projects/new_blog/venv/lib/python3.12/site-packages/mkdocs_macros/plugin.py\", line 703, in render\n    return md_template.render(**page_variables)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/user/projects/new_blog/venv/lib/python3.12/site-packages/jinja2/environment.py\", line 1295, in render\n    self.environment.handle_exception()\n  File \"/home/user/projects/new_blog/venv/lib/python3.12/site-packages/jinja2/environment.py\", line 942, in handle_exception\n    raise rewrite_traceback_stack(source=source)\n  File \"&lt;template&gt;\", line 22, in top-level template code\n  File \"/home/user/projects/new_blog/venv/lib/python3.12/site-packages/jinja2/environment.py\", line 490, in getattr\n    return getattr(obj, attribute)\n           ^^^^^^^^^^^^^^^^^^^^^^^\njinja2.exceptions.UndefinedError: 'matrix' is undefined\n</code></pre>","tags":["github actions","workflow","controlling","condition","strategy","matrix"]},{"location":"DevOps/git/github/github_actions/github_action_run_local/","title":"Run github action locally","text":"<p>GitHub Actions help automate tasks like building, testing, and deploying in your GitHub repository. With <code>act</code> CLI tool we can write and test the GitHub action locally.</p> <pre><code>curl https://raw.githubusercontent.com/nektos/act/master/install.sh | sudo bash\n</code></pre>","tags":["github","actions","act","git","devops"]},{"location":"DevOps/git/github/github_actions/github_action_run_local/#config-github-action","title":"config github action","text":"<ul> <li>Add <code>.github/workflows</code> folder to project root</li> <li>Add yaml file and declare jobs</li> </ul>","tags":["github","actions","act","git","devops"]},{"location":"DevOps/git/github/github_actions/github_action_run_local/#view","title":"view","text":"<p>from project root</p> <pre><code>act -l\n</code></pre>","tags":["github","actions","act","git","devops"]},{"location":"DevOps/git/github/github_actions/github_action_run_local/#example","title":"example","text":"<p>Run job on local docker</p> <pre><code>act -j build_demo -P name=docker_image --pull=false\n</code></pre> arg desc -j job to run for workflow -P custom image to --pull pull image from hub or find it locally","tags":["github","actions","act","git","devops"]},{"location":"DevOps/git/github/github_actions/github_action_run_local/#workflow","title":"Workflow","text":"<pre><code>name: My Action\non: [workflow_dispatch]\njobs:\n  build_demo:\n    runs-on: rome_arm\n    steps:\n      - name: Hello, World!\n        run: echo \"build job hello world\"\n</code></pre> arg desc name workflow name on running trigger event [push, pull_request, workflow_dispatch] jobs workflow jobs runs-on platform to run on (image name declare in act command ) <p>multiple lines</p> <p>use <code>|</code> to mark multiple lines</p> <pre><code>steps:\n  - name: colcon\n    run: | \n        line 1\n        line 2\n</code></pre>","tags":["github","actions","act","git","devops"]},{"location":"DevOps/git/github/github_actions/github_action_run_local/#reference","title":"Reference","text":"<ul> <li>How to Run GitHub Actions Locally Using the act CLI Tool</li> </ul>","tags":["github","actions","act","git","devops"]},{"location":"DevOps/git/github/github_actions/github_action_using_custom_actions/","title":"Macro Rendering Error","text":"<p>File: <code>DevOps/git/github/github_actions/github_action_using_custom_actions.md</code></p> <p>UndefinedError: 'inputs' is undefined</p> <pre><code>Traceback (most recent call last):\n  File \"/home/user/projects/new_blog/venv/lib/python3.12/site-packages/mkdocs_macros/plugin.py\", line 703, in render\n    return md_template.render(**page_variables)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/user/projects/new_blog/venv/lib/python3.12/site-packages/jinja2/environment.py\", line 1295, in render\n    self.environment.handle_exception()\n  File \"/home/user/projects/new_blog/venv/lib/python3.12/site-packages/jinja2/environment.py\", line 942, in handle_exception\n    raise rewrite_traceback_stack(source=source)\n  File \"&lt;template&gt;\", line 113, in top-level template code\n  File \"/home/user/projects/new_blog/venv/lib/python3.12/site-packages/jinja2/environment.py\", line 490, in getattr\n    return getattr(obj, attribute)\n           ^^^^^^^^^^^^^^^^^^^^^^^\njinja2.exceptions.UndefinedError: 'inputs' is undefined\n</code></pre>","tags":["github","action","custom","composite"]},{"location":"DevOps/git/github/github_actions/act/act_inputs/","title":"Macro Rendering Error","text":"<p>File: <code>DevOps/git/github/github_actions/act/act_inputs.md</code></p> <p>UndefinedError: 'github' is undefined</p> <pre><code>Traceback (most recent call last):\n  File \"/home/user/projects/new_blog/venv/lib/python3.12/site-packages/mkdocs_macros/plugin.py\", line 703, in render\n    return md_template.render(**page_variables)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/user/projects/new_blog/venv/lib/python3.12/site-packages/jinja2/environment.py\", line 1295, in render\n    self.environment.handle_exception()\n  File \"/home/user/projects/new_blog/venv/lib/python3.12/site-packages/jinja2/environment.py\", line 942, in handle_exception\n    raise rewrite_traceback_stack(source=source)\n  File \"&lt;template&gt;\", line 45, in top-level template code\n  File \"/home/user/projects/new_blog/venv/lib/python3.12/site-packages/jinja2/environment.py\", line 490, in getattr\n    return getattr(obj, attribute)\n           ^^^^^^^^^^^^^^^^^^^^^^^\njinja2.exceptions.UndefinedError: 'github' is undefined\n</code></pre>","tags":["act","github actions","input"]},{"location":"DevOps/git/github/github_cli/","title":"Github cli","text":"<p>DevOps / git / github</p> <p>Git CLI is GitHub\u2019s official command line tool. It brings pull requests, issues, and other GitHub concepts to the terminal next to where you are already working with git and your code.</p> install<pre><code>sudo apt install gh\n</code></pre>","tags":["github","cli"]},{"location":"DevOps/git/github/timps_settings/","title":"Github Tips and settings","text":"","tags":["github","tips"]},{"location":"DevOps/git/tips_settings/","title":"Git Tips and Settings","text":"<ul> <li>Copy and list from another branch</li> </ul>","tags":["git","tips"]},{"location":"DevOps/git/tips_settings/#list-and-copy-file-from-another-branch","title":"list and copy file from another branch","text":"list file from another branch<pre><code>git ls-tree -r dev --name-only\n\n# list specific folder\ngit ls-tree -r dev --name-only path/to/dir\n</code></pre> copy file from another branch<pre><code>git restore --source dev file1 file2 dir/file3\n</code></pre>","tags":["git","tips"]},{"location":"DevOps/git/tips_settings/#prompt","title":"prompt","text":"<p>Effective prompt with git branch name</p> <pre><code>function git-branch-name { \n    git symbolic-ref HEAD 2&gt;/dev/null | cut -d\"/\" -f 3- \n} \n\nfunction git-branch-prompt { \n    local branch=`git-branch-name` \n    if [ $branch ]; then printf \" [%s]\" $branch; fi \n} \n\n\n\nfunction re-prompt { \n    PS1=\"\\u@\\h \\[\\033[0;36m\\]\\W\\[\\033[0m\\]\\[\\033[0;32m\\]\\$(git-branch-prompt)\\[\\033[0m\\] \\$ \" \n} \n\nPROMPT_COMMAND=re-prompt \n\ntrap 're-prompt' DEBUG \n</code></pre>","tags":["git","tips"]},{"location":"DevOps/git/tips_settings/#git-branching","title":"Git branching","text":"","tags":["git","tips"]},{"location":"DevOps/git/tips_settings/#sync-remote-branch-with-local-branch","title":"Sync remote branch with local branch","text":"<p>Remove all remote branches that no longer exist on the remote repository. <pre><code>git fetch --prune\n</code></pre></p>","tags":["git","tips"]},{"location":"DevOps/git/tips_settings/#git-sparse-checkout","title":"git sparse-checkout","text":"<p>is a Git feature that allows you to partially clone a repository, downloading only specific folders or files instead of the entire project.</p> <pre><code>git clone --depth 1 --filter=blob:none --sparse &lt;url&gt;\ngit sparse-checkout set &lt;folders to download separate by space&gt;\n</code></pre>","tags":["git","tips"]},{"location":"DevOps/linux/","title":"Linux","text":"<p>Deb package</p> <p>Udev</p> <p>Networking</p> <p>Encryption</p>","tags":["linux"]},{"location":"DevOps/linux/#tmux","title":"TMUX","text":"<ul> <li>tmux / tmuxp config and usage</li> </ul>","tags":["linux"]},{"location":"DevOps/linux/#cheat-sheet","title":"Cheat sheet","text":"<ul> <li>apt</li> <li>ip</li> </ul>","tags":["linux"]},{"location":"DevOps/linux/linux_apt_cheat_sheet/","title":"APT Cheat sheet","text":"apt depends foo Show all packages foo depends on (use --installed for only those already installed)","tags":["linux","apt"]},{"location":"DevOps/linux/linux_ip_cheat_sheet/","title":"IP command cheat sheet","text":"set interface ip ip addr add 192.168.1.1/24 dev eth0 set MTU ip link set eth0 mtu 1400 up / down ip link set eth0 up, ip link set eth0 down","tags":["linux","ip","cheat sheet"]},{"location":"DevOps/linux/linux_ip_cheat_sheet/#route","title":"Route","text":"Adding a default gateway ip route add default via 192.168.1.254","tags":["linux","ip","cheat sheet"]},{"location":"DevOps/linux/linux_tmux_tmuxp/","title":"tmuxp","text":"<p>Tmuxp is a session manager for tmux, allowing you to define tmux sessions using a YAML configuration</p>","tags":["linux","tmux","tmuxp"]},{"location":"DevOps/linux/linux_tmux_tmuxp/#install","title":"install","text":"<pre><code>sudo apt install tmux\npip install tmuxp\n</code></pre>","tags":["linux","tmux","tmuxp"]},{"location":"DevOps/linux/linux_tmux_tmuxp/#config","title":"config","text":"my_session.yaml<pre><code>session_name: my_session\nwindows:\n  - window_name: my_window\n    layout: tiled\n    suppress_history: false\n    shell_command_before:\n      - echo \"before\"\n    panes:\n      - shell_command: \n          - printf '\\033]2;%s\\033\\\\' 'pane1'\n          - ./script1.sh  # Runs script1 in the first pane\n        focus: true\n      - shell_command:\n          - printf '\\033]2;%s\\033\\\\' 'pane2'\n          - ./script2.sh  # Runs script2 in the second pane\n</code></pre>","tags":["linux","tmux","tmuxp"]},{"location":"DevOps/linux/linux_tmux_tmuxp/#usage","title":"usage","text":"<pre><code>tmuxp load my_session.yaml\n</code></pre>","tags":["linux","tmux","tmuxp"]},{"location":"DevOps/linux/linux_tmux_tmuxp/#tmux","title":"tmux","text":"","tags":["linux","tmux","tmuxp"]},{"location":"DevOps/linux/linux_tmux_tmuxp/#script","title":"script","text":"<p>Open screen with 4 panes</p> <pre><code>#!/bin/bash\n\nSESSION=\"mysession\"\n\n# Start a new session\ntmux new-session -d -s $SESSION\n\n# Split the window into four equal parts\ntmux split-window -h  # Split vertically\ntmux split-window -v  # Split bottom-left horizontally\ntmux select-pane -R   # Move to the right pane\ntmux split-window -v  # Split bottom-right horizontally\n\n# Attach to session\ntmux attach-session -t $SESSION\n</code></pre> <p>don't forget to chmod +x</p>","tags":["linux","tmux","tmuxp"]},{"location":"DevOps/linux/linux_tmux_tmuxp/#config_1","title":"Config","text":"tmux.conf <pre><code># unbind\nunbind C-b\nunbind '\"'\nunbind %\n\n# base1 numbering\nset -g base-index 1\nsetw -g pane-base-index 1\n\n#bind ctrl-a as a prefix\nset-option -g prefix C-a\nbind-key C-a send-prefix\n# kill session\nbind C-c kill-session\n\nbind C-a run \"tmux save-buffer - | xclip -i -sel clipboard\"\n\n# mouse\nset -g mouse on\n\n\n # do like terminator\nbind -n C-E split-window -h\nbind -n C-S-Left resize-pane -L 3\nbind -n C-S-Right resize-pane -R 3\nbind -n C-S-Up resize-pane -U 3\nbind -n C-S-Down resize-pane -D 3\nbind -n C-O split-window -v\n\n# switch panes using Alt-arrow without prefix (not working)\nbind -n M-Left select-pane -L\nbind -n M-Right select-pane -R\nbind -n M-Up select-pane -U\nbind -n M-Down select-pane -D\n\n# Shift arrow to switch windows\n\nbind n next-window\nbind p previous-window\n\nbind c new-window -c \"#{pane_current_path}\"\n\nbind r source-file ~/.tmux.conf\n\n# settings\n</code></pre>","tags":["linux","tmux","tmuxp"]},{"location":"DevOps/linux/deb_package/","title":"Index","text":"<p>Create debian package for shell script, python project and other using debian tools Create custom install wizard using debconf and postinst scripts</p> <p>debconf</p> <p>pack shell script</p> <p>TBD</p> <p></p>","tags":["debian","package","linux","ubuntu"]},{"location":"DevOps/linux/deb_package/#debian-package","title":"Debian package","text":"<p>dpkg-deb</p> <p>Basic tool to create debian package</p> <p>dpkg-buildpackage</p> <p>Debian has some pretty detailed rules on what a \"proper\" Debian package looks like, dpkg-buildpackage is a tool that enforces said workflow and structure, it's use <code>dpkg-deb</code> to create debian package (deb file)</p> <p>Version</p> <p>The \"Version\" field is gone. As explained above, dpkg-buildpackage infers the version number from the changelog file.</p>","tags":["debian","package","linux","ubuntu"]},{"location":"DevOps/linux/deb_package/#debhelper","title":"Debhelper","text":"<p>Debhelper is a tool that automates various common aspects of package building</p>","tags":["debian","package","linux","ubuntu"]},{"location":"DevOps/linux/deb_package/#commandmethod","title":"command/method","text":"","tags":["debian","package","linux","ubuntu"]},{"location":"DevOps/linux/deb_package/#dh_auto_configure","title":"dh_auto_configure","text":"<p>automatically run <code>./configure</code> or the cmake equivalent. - Applies architecture-specific flags.( CFLAGS, CXXFLAGS, LDFLAGS) |</p>","tags":["debian","package","linux","ubuntu"]},{"location":"DevOps/linux/deb_package/#dh_builddeb","title":"dh_builddeb","text":"<p>dh_builddeb is a Debhelper tool that creates a Debian (.deb) package from the files staged in debian/tmp or debian// option desc <code>--destdir=&lt;dir&gt;</code> Change the output directory for .deb files. <pre><code>override_dh_builddeb:\n    dh_builddeb --destdir=output_folder\n</code></pre>","tags":["debian","package","linux","ubuntu"]},{"location":"DevOps/linux/deb_package/#resource","title":"Resource","text":"<ul> <li>Debian Packaging For The Modern Developer (DPMD)</li> </ul>","tags":["debian","package","linux","ubuntu"]},{"location":"DevOps/linux/deb_package/debconf/","title":"Using Debconf","text":"<p>Debconf is Debian\u2019s configuration management system. It stores user inputs and configuration options for packages during installation, upgrade, and removal.</p>","tags":["debconf","debian","linux","package"]},{"location":"DevOps/linux/deb_package/debconf/#structure-of-the-templates-file","title":"Structure of the templates File","text":"<p>A <code>templates</code> file consists of multiple template entries, each defining a specific question. Each entry follows this format:</p> debian/templates<pre><code>Template: mypackage/question_name\nType: string\nDefault: default_value\nDescription: A brief explanation of what the user should enter.\n</code></pre> Field Description Template Unique identifier for the question (mypackage/question_name). Type The type of input expected (see below for options). Default The default answer if the user does not provide one. Description The message displayed to the user.","tags":["debconf","debian","linux","package"]},{"location":"DevOps/linux/deb_package/debconf/#types","title":"Types","text":"<ul> <li>string:   User enters a free-text string.</li> <li>boolean:  Yes/No question.</li> <li>select:   User selects from predefined options.</li> <li>multiselect:  User selects multiple options.</li> <li>note: Displays a message but does not ask a question.</li> <li>password: Hides user input for security.</li> </ul> Boolean (Yes/No)<pre><code>Template: mypackage/enable_feature\nType: boolean\nDefault: true\nDescription: Do you want to enable this feature?\n</code></pre> Select (Multiple Choices)<pre><code>Template: mypackage/choose_option\nType: select\nChoices: Option1, Option2, Option3\nDefault: Option1\nDescription: Please choose an option.\n</code></pre> Multiselect (Multiple Selections)<pre><code>Template: mypackage/multiple_choices\nType: multiselect\nChoices: Red, Green, Blue\nDefault: Red, Blue\nDescription: Select colors (use spacebar to select multiple).\n</code></pre> Note (Just a Message, No Input)<pre><code>Template: mypackage/info_message\nType: note\nDescription: This package will install additional dependencies.\n</code></pre>","tags":["debconf","debian","linux","package"]},{"location":"DevOps/linux/deb_package/debconf/#read-the-users-input-in-postinst","title":"Read the User's Input in postinst","text":"<p>Once the user enters values during installation, you can retrieve them in debian/postinst:</p> postinst<pre><code>#!/bin/bash\nset -e\n. /usr/share/debconf/confmodule\n\ndb_input high mypackage/config_value || true\ndb_go\n\ndb_get mypackage/config_value\necho \"User entered: $RET\" &gt; /etc/mypackage/config.txt\n</code></pre> <p>Tells Debconf to show a prompt for mypackage/config_value. high is the priority (other options: low, medium, critical). || true ensures the script does not fail if db_input encounters an issue.</p> <p>Displays all pending Debconf questions in one go. Must be called after db_input to show the prompt to the user.</p> <p>Retrieves the user's input from Debconf. Stores the value in the $RET variable.</p>","tags":["debconf","debian","linux","package"]},{"location":"DevOps/linux/deb_package/debconf/#postrm","title":"postrm","text":"postrm<pre><code>#!/bin/sh\nset -e  # Exit on any error\n\n# Example: Remove the config directory on purge\nif [ \"$1\" = \"purge\" ]; then\n    echo \"Configuration directory removed.\"\n    echo \"PURGE\" | debconf-communicate my-python-app || true\nfi\n\n\nexit 0\n</code></pre>","tags":["debconf","debian","linux","package"]},{"location":"DevOps/linux/deb_package/debconf/#other-debconf-commands","title":"other debconf commands","text":"<ol> <li>Debugging and Testing</li> </ol> <p>To check stored values:</p> <pre><code>sudo debconf-show mypackage\n</code></pre> <p>To manually set a value: <pre><code>echo \"mypackage/config_value mypackage/config_value string new_value\" | sudo debconf-set-selections\n</code></pre></p> <p>To reset and ask the questions again: <pre><code>sudo dpkg-reconfigure mypackage\n</code></pre></p> <p>package script file location</p> <pre><code>ls -l /var/lib/dpkg/info/mypackage.*\n#\nThis will show various control files for the package, including:\n\n/var/lib/dpkg/info/mypackage.postrm \u2192 The post-remove script\n/var/lib/dpkg/info/mypackage.postinst \u2192 The post-install script\n/var/lib/dpkg/info/mypackage.prerm \u2192 The pre-remove script\n/var/lib/dpkg/info/mypackage.list \u2192 The list of installed files\n</code></pre>","tags":["debconf","debian","linux","package"]},{"location":"DevOps/linux/deb_package/shell_script/","title":"Create Debian package for shell script","text":"<ul> <li>Pack minimal shell script to <code>debian</code> package using <code>fakeroot</code> </li> <li>Add <code>postinst</code> and other debian scripts to control the installation</li> <li>Run the script as systemd service</li> </ul>","tags":["debian","fakeroot","rules","package"]},{"location":"DevOps/linux/deb_package/shell_script/#install-helper-packages","title":"install helper packages","text":"<pre><code>sudo apt install fakeroot devscripts debhelper\n</code></pre>","tags":["debian","fakeroot","rules","package"]},{"location":"DevOps/linux/deb_package/shell_script/#tutorial-minimal","title":"Tutorial: Minimal","text":"<p>Check github <code>simple_script</code> tag source code</p>","tags":["debian","fakeroot","rules","package"]},{"location":"DevOps/linux/deb_package/shell_script/#project","title":"project","text":"<pre><code>.\n\u251c\u2500\u2500 .vscode\n\u2502   \u251c\u2500\u2500 settings.json\n\u2502   \u2514\u2500\u2500 tasks.json\n\u251c\u2500\u2500 debian\n\u2502   \u251c\u2500\u2500 changelog\n\u2502   \u251c\u2500\u2500 compat\n\u2502   \u251c\u2500\u2500 control\n\u2502   \u251c\u2500\u2500 my-tool.install\n\u2502   \u2514\u2500\u2500 rules\n\u251c\u2500\u2500 debs\n\u251c\u2500\u2500 readme.md\n\u251c\u2500\u2500 .gitignore\n\u2514\u2500\u2500 scripts\n    \u2514\u2500\u2500 my-tool.sh\n</code></pre> scripts/my-tool.sh<pre><code>#!/bin/sh\n\necho \"hello my-tool\"\n</code></pre>","tags":["debian","fakeroot","rules","package"]},{"location":"DevOps/linux/deb_package/shell_script/#debian-folder","title":"debian folder","text":"<p>Using <code>fakeroot</code> debian folder must contain this files:</p> <ul> <li>compat</li> <li>rules</li> <li>changelog</li> <li>control</li> <li>my-tool.install</li> </ul>","tags":["debian","fakeroot","rules","package"]},{"location":"DevOps/linux/deb_package/shell_script/#my-toolsinstall","title":"my-tools.install","text":"<p>Map a file from your project directory to its destination path in the installed system. For example, install the script into <code>/usr/bin</code> on the target filesystem.</p> debian/my-tools.install<pre><code>scripts/my-tool.sh /usr/bin\n</code></pre> <p>Tip</p> <p>The file name must match the Debian package name.</p>","tags":["debian","fakeroot","rules","package"]},{"location":"DevOps/linux/deb_package/shell_script/#changelog","title":"changelog","text":"<p><code>dch</code> command create and update changelog file <pre><code># create change log file\ndch --create -v 0.0.1 --package my-tool \"v 0.0.1\"\n\n# add entries\ndch -v 0.0.1 \"simple script\"\n</code></pre></p>","tags":["debian","fakeroot","rules","package"]},{"location":"DevOps/linux/deb_package/shell_script/#control","title":"control","text":"<pre><code>Source: my-tools\nSection: misc\nPriority: optional\nMaintainer: Your Name &lt;youremail@example.com&gt;\nStandards-Version: 4.6.2\n\nPackage: my-tools\nArchitecture: all\nDescription: Minimal Debian package\n A short description of the minimal Debian package.\n</code></pre> <p>Note</p> <p>The  <code>source</code> section in mandatory by <code>fakeroot</code></p>","tags":["debian","fakeroot","rules","package"]},{"location":"DevOps/linux/deb_package/shell_script/#rules","title":"rules","text":"<pre><code>#!/usr/bin/make -f\n\n%:\n    dh $@\n\noverride_dh_builddeb:\n    dh_builddeb --destdir=$(CURDIR)/debs\n</code></pre>","tags":["debian","fakeroot","rules","package"]},{"location":"DevOps/linux/deb_package/shell_script/#change-deb-output-path-debs-folder-must-be-exists","title":"change deb output path (debs folder must be exists)","text":"<pre><code>override_dh_builddeb:\n    dh_builddeb --destdir=$(CURDIR)/debs\n</code></pre> <p>Tip</p> <p>The file must use TAB indentation</p> <p>Check vscode settings to config rule file as shellscript with TAB indentation</p>","tags":["debian","fakeroot","rules","package"]},{"location":"DevOps/linux/deb_package/shell_script/#compat","title":"compat","text":"<pre><code>13\n</code></pre>","tags":["debian","fakeroot","rules","package"]},{"location":"DevOps/linux/deb_package/shell_script/#build","title":"build","text":"<pre><code>fakeroot debian/rules binary\n</code></pre>","tags":["debian","fakeroot","rules","package"]},{"location":"DevOps/linux/deb_package/shell_script/#clean","title":"clean","text":"<pre><code>fakeroot debian/rules clean\n</code></pre>","tags":["debian","fakeroot","rules","package"]},{"location":"DevOps/linux/deb_package/shell_script/#vscode","title":"VSCode","text":"","tags":["debian","fakeroot","rules","package"]},{"location":"DevOps/linux/deb_package/shell_script/#tasksjson","title":"tasks.json","text":"<ul> <li>build using <code>fakeroot debian/rules binary</code></li> <li>clean <code>fakeroot debian/rules clean</code></li> <li>change log using <code>dch</code></li> </ul> tasks.json <pre><code>{\n    // See https://code.visualstudio.com/docs/editor/tasks for more information\n    \"version\": \"2.0.0\",\n    \"tasks\": [\n        {\n            \"label\": \"debian content\",\n            \"type\": \"shell\",\n            \"detail\": \"List the contents of the built debian package\",\n            \"command\": \"dpkg -c ${input:myVersions}\",\n            \"options\": {\n                \"cwd\": \"${workspaceFolder}/debs\"\n            },\n            \"problemMatcher\": []\n        },\n        {\n            \"label\": \"debian control\",\n            \"type\": \"shell\",\n            \"detail\": \"view debian control\",\n            \"command\": \"dpkg -I ${input:myVersions}\",\n            \"options\": {\n                \"cwd\": \"${workspaceFolder}/debs\"\n            },\n            \"problemMatcher\": []\n        },\n        {\n            \"label\": \"Build Debian Package\",\n            \"type\": \"shell\",\n            \"detail\": \"Build debian package\",\n            \"command\": \"fakeroot debian/rules binary\",\n            \"options\": {\n                \"cwd\": \"${workspaceFolder}\"\n            },\n            \"group\": {\n                \"kind\": \"build\",\n                \"isDefault\": true\n            },\n            \"problemMatcher\": []\n        },\n        {\n            \"label\": \"Clean\",\n            \"type\": \"shell\",\n            \"detail\": \"Clean fakeroot output\",\n            \"command\": \"fakeroot debian/rules clean\",\n            \"options\": {\n                \"cwd\": \"${workspaceFolder}\"\n            },\n            \"problemMatcher\": []\n        },\n        {\n            \"label\": \"Update Changelog with dch\",\n            \"type\": \"shell\",\n            \"command\": \"dch --newversion ${input:changelogVersion} $(git log -1 --pretty=format:'* %s')\",\n            \"options\": {\n                \"cwd\": \"${workspaceFolder}\",\n                \"env\": {\n                    \"DEBEMAIL\": \"dev@example.com\",\n                    \"DEBFULLNAME\": \"dev com\"\n                }\n            },\n            \"problemMatcher\": []\n        }\n    ],\n    \"inputs\": [\n        {\n            \"id\": \"changelogVersion\",\n            \"type\": \"promptString\",\n            \"description\": \"Enter the new version for dch\"\n        },\n        {\n            \"id\": \"myVersions\",\n            \"type\": \"pickString\",\n            \"description\": \"Pick a version\",\n            \"options\": [\n                \"my-tools_0.0.1_all.deb\",\n                \"my-tools_0.0.2_all.deb\",\n                \"Option C\"\n            ]\n        }\n    ]\n}\n</code></pre>","tags":["debian","fakeroot","rules","package"]},{"location":"DevOps/linux/deb_package/shell_script/#settingjson","title":"setting.json","text":"<p>Replace indentation from space to tab when using sheelscript</p> settings.json<pre><code>    \"files.associations\": {\n        \"rules\": \"shellscript\"\n    }\n</code></pre> settings.json <pre><code>{\n    \"[shellscript]\": {\n        \"editor.insertSpaces\": false,\n        \"editor.tabSize\": 4,\n        \"editor.detectIndentation\": false\n    },\n    \"files.associations\": {\n        \"rules\": \"shellscript\"\n    }\n}\n</code></pre> <p>using cat to check TAB indentation</p> <pre><code>cat -T &lt;file&gt;\n</code></pre>","tags":["debian","fakeroot","rules","package"]},{"location":"DevOps/linux/deb_package/shell_script/#git","title":"Git","text":"","tags":["debian","fakeroot","rules","package"]},{"location":"DevOps/linux/deb_package/shell_script/#gitignore","title":".gitignore","text":"<pre><code>debs/\ndebian/*\n!debian/changelog\n!debian/rules\n!debian/control\n!debian/compat\n!debian/my-tool.install\n</code></pre> <p>exclude file from ignore folder, for it to work we need to ignore files in folder and not the folder it self <code>debian/*</code> </p>","tags":["debian","fakeroot","rules","package"]},{"location":"DevOps/linux/deb_package/shell_script/#dpkg","title":"dpkg","text":"<ul> <li><code>dpkg -c</code> : List contents of a deb package.</li> <li><code>dpkg -I</code> : Show information about a package. </li> </ul>","tags":["debian","fakeroot","rules","package"]},{"location":"DevOps/linux/deb_package/shell_script/#debian-scripts","title":"Debian scripts","text":"<p>Debian packages can include executable scripts that run automatically at different stages of installation, upgrade, and removal. These scripts live in the package\u2019s <code>debian/</code> directory. </p> <p>Note</p> <p>Don't forget to set executable permission</p> <ul> <li>preinst</li> <li>postinst</li> <li>prerm</li> <li>postrm</li> </ul>","tags":["debian","fakeroot","rules","package"]},{"location":"DevOps/linux/deb_package/shell_script/#scripts-order","title":"Scripts order","text":"<p>Install 1. preinst (install) 1. unpack files 1. postinst (configure)</p> <p>Upgrade 1. preinst (upgrade) 1. unpack new files 1. postinst (configure)</p> <p>Remove 1. prerm (remove) 1. remove files 1. postrm (remove)</p> <p>Purge 1. postrm (purge)</p>","tags":["debian","fakeroot","rules","package"]},{"location":"DevOps/linux/deb_package/shell_script/#check-for-script-existing","title":"Check for script existing","text":"<pre><code>dpkg -I &lt;package name&gt;\n\n#\n new Debian package, version 2.0.\n size 1100 bytes: control archive=472 bytes.\n     237 bytes,     9 lines      control\n     123 bytes,     2 lines      md5sums\n      54 bytes,     7 lines   *  postinst             #!/bin/sh\n      52 bytes,     7 lines   *  postrm               #!/bin/sh\n</code></pre>","tags":["debian","fakeroot","rules","package"]},{"location":"DevOps/linux/deb_package/shell_script/#pack-as-systemd-service","title":"Pack as systemd service","text":"<p>check source code github <code>systemd_service</code> tag</p> services/my-service.service<pre><code>[Unit]\nDescription=mytool background service\nAfter=network.target\n\n[Service]\nType=simple\nExecStart=/usr/bin/my-tool.sh\nRestart=on-failure\nUser=user\nGroup=user\n\n[Install]\nWantedBy=multi-user.target\n</code></pre> debian/my-tools.install<pre><code>scripts/my-tool.sh /usr/bin\nservices/my-service.service lib/systemd/system/\n</code></pre> debian/postinst<pre><code>#!/bin/sh\nset -e\n\nsystemctl daemon-reload\nsystemctl enable my-service.service\nsystemctl start my-service.service\n\nexit 0\n</code></pre> debian/postrm<pre><code>#!/bin/sh\nset -e\n\nif [ \"$1\" = \"remove\" ]; then\n    systemctl stop my-service.service || true\nfi\n\nif [ \"$1\" = \"purge\" ]; then\n    echo purge\nfi\n\nsystemctl daemon-reload || true\n\n\n\nexit 0\n</code></pre>","tags":["debian","fakeroot","rules","package"]},{"location":"DevOps/linux/deb_package/shell_script/#install-and-check","title":"Install and check","text":"journalctl<pre><code>journalctl -u my-service.service \n#\nDec 01 08:42:07 omen systemd[1]: Started my-service.service - mytool background service.\nDec 01 08:42:07 omen my-tool.sh[650610]: hello my-tool\nDec 01 08:42:07 omen systemd[1]: my-service.service: Deactivated successfully.\nDec 01 10:07:11 omen systemd[1]: Started my-service.service - mytool background service.\nDec 01 10:07:11 omen my-tool.sh[705043]: hello my-tool\nDec 01 10:07:11 omen systemd[1]: my-service.service: Deactivated successfully.\n</code></pre> systemctl status<pre><code>sudo systemctl status my-service.service\n# \n\u25cb my-service.service - mytool background service\n     Loaded: loaded (/usr/lib/systemd/system/my-service.service; enabled; preset: enabled)\n     Active: inactive (dead) since Mon 2025-12-01 10:07:11 IST; 1min 15s ago\n   Duration: 1ms\n    Process: 705043 ExecStart=/usr/bin/my-tool.sh (code=exited, status=0/SUCCESS)\n   Main PID: 705043 (code=exited, status=0/SUCCESS)\n        CPU: 1ms\n\nDec 01 10:07:11 omen systemd[1]: Started my-service.service - mytool background service.\nDec 01 10:07:11 omen my-tool.sh[705043]: hello my-tool\nDec 01 10:07:11 omen systemd[1]: my-service.service: Deactivated successfully.\n</code></pre> <p>Tip</p> <p>Check Remove using <code>apt remove &lt;package name&gt;</code></p> <p>for <code>postrm</code> script functionality</p>","tags":["debian","fakeroot","rules","package"]},{"location":"DevOps/linux/deb_package/shell_script/#todo","title":"todo","text":"<ul> <li>How to check systemd using docker or podman</li> <li>check this post</li> </ul>","tags":["debian","fakeroot","rules","package"]},{"location":"DevOps/linux/encryption/","title":"Linux encryption utils","text":"<p>LUKS on loopdevice</p>","tags":["linux","encryption"]},{"location":"DevOps/linux/encryption/luks_on_loopdevice/","title":"LUKS on loop device","text":"<p>LUKS stands for Linux Unified Key Setup. It\u2019s the standard disk-encryption system on Linux, used to protect data at rest by encrypting entire disks or partitions.</p> <p>A loop device is a virtual block device in Linux that lets you treat a regular file as if it were a disk or partition.</p> <p>The idea is using blockfile as disk and use LUKS to protect the disk content</p> <pre><code>sudo apt install cryptsetup\n</code></pre>","tags":["luks","encryption"]},{"location":"DevOps/linux/encryption/luks_on_loopdevice/#demo","title":"Demo","text":"<p>Create file that use as LUKS encrypt disk Open the encrypted disk for usage and close it</p> <p>The process has two main steps - one time create the disk     - open mount / umount close     - create the encrypt disk     - open it     - format     - mount     - add files      - umount     - add key - Usage     - Open and Mount     - Umount and close</p>","tags":["luks","encryption"]},{"location":"DevOps/linux/encryption/luks_on_loopdevice/#step1","title":"Step1","text":"<p>One time step that contain the following steps - create block file using <code>dd</code> - run as a disk using loop device</p> <p>1\ufe0f\u20e3 Create blockfile using <code>dd</code></p> blockfile<pre><code># create 100M blockfile\ndd if=/dev/zero of=secure.img bs=1M count=100\n</code></pre> <p>2\ufe0f\u20e3 Loop device</p> run as a disk device<pre><code>sudo losetup --find --show ~/secure.img\n# the command return the device loop to use\n# /dev/loop3\n</code></pre> <p>3\ufe0f\u20e3 Create the encrypt disk - Initializes the device as a LUKS encrypted container - Writes a LUKS header to the device - Erases any existing filesystem or data references</p> init<pre><code>sudo cryptsetup luksFormat /dev/loop3\n\n# WARNING!\n# ========\n# This will overwrite data on /dev/loop3 irrevocably.\n# \n# Are you sure? (Type 'yes' in capital letters): YES\n# Enter passphrase for /home/user/secure.img: \n# Verify passphrase: \n</code></pre> <p>4\ufe0f\u20e3 Open the encrypted device <pre><code>#Unlock a LUKS-encrypted block device and expose it as a new decrypted virtual device named secure_container.\n# before /dev/loop3 are encrypted\nsudo cryptsetup open /dev/loop3 secure_container\n#\n# the decrypt file open into /dev/mapper/secure_container\n</code></pre></p> <p>5\ufe0f\u20e3 format format<pre><code>sudo mkfs.ext4 /dev/mapper/secure_container\n</code></pre></p> <p>6\ufe0f\u20e3 Mount and add files mount<pre><code>sudo mount /dev/mapper/secure_container /mnt\n</code></pre></p> <pre><code>echo \"text\" | sudo tee file\n</code></pre> <p>7\ufe0f\u20e3 Umount and release resource</p> <pre><code>sudo umount /mnt\nsudo cryptsetup close secure_container\nsudo losetup -d /dev/loop3\n</code></pre> <p>7\ufe0f\u20e3 Add key</p> <pre><code>dd if=/dev/urandom of=keyfile.bin bs=4096  count=1\nsudo cryptsetup luksAddKey secure.img keyfile.bin\n\n# Type the passphrase\n</code></pre>","tags":["luks","encryption"]},{"location":"DevOps/linux/encryption/luks_on_loopdevice/#encrypt-disk-usage","title":"Encrypt disk usage","text":"","tags":["luks","encryption"]},{"location":"DevOps/linux/encryption/luks_on_loopdevice/#mount-with-key","title":"Mount with key","text":"open and mount<pre><code>sudo cryptsetup open --type luks \\\nsecure.img secure_container \\\n--key-file keyfile.bin\n\n# open the encrypt to /dev/mapper/secure_container\n\n# mount \nsudo mount /dev/mapper/secure_container /mnt\n</code></pre> close and umount<pre><code>sudo umount /mnt\nsudo cryptsetup close secure_container\n</code></pre>","tags":["luks","encryption"]},{"location":"DevOps/linux/networking/","title":"Linux Networking","text":"<p>socat</p> <p>ser2net</p> <ul> <li>Linux as router</li> </ul>","tags":["linux","networking","devops"]},{"location":"DevOps/linux/networking/linux_net_config_as_router/","title":"Linux as router","text":"<ul> <li>eth0: WAN</li> <li>eth1: LAN</li> </ul>","tags":["linux","networking","router","iptables","routing"]},{"location":"DevOps/linux/networking/linux_net_config_as_router/#enable-ip-forwarding","title":"Enable IP Forwarding","text":"<p>sysctl<pre><code>sudo sysctl -w net.ipv4.ip_forward=1\n</code></pre> - To make it permanent, add the following line to <code>/etc/sysctl.conf</code>: sysctl.conf<pre><code>net.ipv4.ip_forward = 1\n</code></pre> - To apply the changes, run: sysctl<pre><code>sudo sysctl -p \n</code></pre></p>","tags":["linux","networking","router","iptables","routing"]},{"location":"DevOps/linux/networking/linux_net_config_as_router/#iptables-configuration","title":"IPTables Configuration","text":"","tags":["linux","networking","router","iptables","routing"]},{"location":"DevOps/linux/networking/linux_net_config_as_router/#rules","title":"rules","text":"iptables<pre><code>sudo iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE\nsudo iptables -A FORWARD -i eth0 -o eth1 -j ACCEPT\nsudo iptables -A FORWARD -i eth1 -o eth0 -m state --state ESTABLISHED,RELATED -j ACCEPT\n</code></pre>","tags":["linux","networking","router","iptables","routing"]},{"location":"DevOps/linux/networking/linux_net_config_as_router/#savepersist-iptables-rules","title":"Save/Persist iptables rules","text":"<ul> <li>To save the iptables rules, you can use the following command: iptables<pre><code>sudo iptables-save &gt; /etc/iptables/rules.v4\n</code></pre></li> <li>To restore the iptables rules on boot, you can use the following command: iptables<pre><code>sudo iptables-restore &lt; /etc/iptables/rules.v4\n</code></pre></li> <li>To make the iptables rules persistent across reboots, you can install the <code>iptables-persistent</code> package: apt<pre><code>sudo apt-get install iptables-persistent\n</code></pre></li> <li>During the installation, you will be prompted to save the current iptables rules. Choose \"Yes\" to save them.</li> <li>After installation, the iptables rules will be automatically restored on boot.</li> </ul>","tags":["linux","networking","router","iptables","routing"]},{"location":"DevOps/linux/networking/ser2net/","title":"ser2net","text":"<p>ser2net is a daemon that exposes serial ports over the network (TCP/UDP), turning /dev/tty* devices into network-accessible endpoints.</p> <pre><code>sudo ser2net -d -c config.yaml\n</code></pre> config <pre><code>connection: &amp;uart0\n  accepter: udp,14550\n  enable: on\n  connector: serialdev,/dev/ttyUSB0,115200n81,local\n</code></pre>","tags":["ser2net","tools","networking"]},{"location":"DevOps/linux/networking/socat/","title":"SOCAT","text":"<p>socat = SOcket CAT A general-purpose tool for connecting two data streams (network, serial, files, pipes, PTYs, etc.).</p>","tags":["tools","socat","network"]},{"location":"DevOps/linux/networking/socat/#demo","title":"Demo","text":"keyboard-&gt;udp<pre><code>socat STDIO,raw,echo=0 UDP:127.0.0.1:7000\n</code></pre> udp-&gt;screen<pre><code>socat UDP4-LISTEN:7000,reuseaddr STDOUT\n</code></pre>","tags":["tools","socat","network"]},{"location":"DevOps/linux/networking/socat/#udp-2-serial","title":"udp 2 serial","text":"<ul> <li>UDP-LISTEN = convenience wrapper</li> <li>UDP-RECVFROM = raw UDP socket with source tracking</li> </ul>","tags":["tools","socat","network"]},{"location":"DevOps/linux/networking/socat/#udp-listener","title":"Udp listener","text":"<p>Any UDP packet sent to host IP will be forwarded to the serial device. The sender\u2019s address is remembered so responses can be sent back.</p> <pre><code>socat -d -d \\\n  UDP4-LISTEN:14550,reuseaddr \\\n  FILE:/dev/ttyUSB0,b115200,raw,echo=0\n</code></pre> <ul> <li>reuseaddr Allows rebinding to the same port Useful if:</li> <li>the program crashed</li> <li> <p>you restart quickly</p> </li> <li> <p>raw Disables all terminal processing:</p> </li> <li> <p>No newline translation</p> </li> <li>No character filtering</li> <li>No flow control</li> <li> <p>Binary-safe</p> </li> <li> <p>echo=0 Disable echo, Prevents characters sent to the serial port from being echoed back</p> </li> </ul>","tags":["tools","socat","network"]},{"location":"DevOps/linux/networking/socat/#multiple-clients","title":"multiple clients","text":"<ul> <li>One serial port multiple udp clients</li> </ul> <p>fork</p> <p>fork open multiple process that write and read against the serial process</p> <p>echo server</p> <p>I use usb2uart and connect the TX with RX</p> <pre><code>socat -d -d   UDP4-RECVFROM:14550,fork   FILE:/dev/ttyUSB0,b115200,raw,echo=0\n</code></pre> test<pre><code># using nc as client\n# can open multiple nc client\n\nnc -u 127.0.0.1 14550\n</code></pre> <ul> <li>UDP4-RECVFROM:14550<ul> <li>Create a UDP IPv4 socket</li> <li>Bind to local port 14550</li> <li>Receive datagrams from any remote host/port</li> <li>Reply packets go back to the source of the last received datagram</li> </ul> </li> <li>fork  For each new incoming peer, socat: fork()s a child process The child handles data forwarding The parent keeps listening For UDP, it works per sender address (IP:port), not per connection.</li> </ul>","tags":["tools","socat","network"]},{"location":"DevOps/linux/networking/socat/#tcp-2-serial","title":"TCP 2 serial","text":"<p>Not working for multiple connection</p> <pre><code>socat -d -d \\\n  TCP4-LISTEN:14550,reuseaddr,fork \\\n  FILE:/dev/ttyUSB0,b115200,raw,echo=0\n</code></pre>","tags":["tools","socat","network"]},{"location":"DevOps/linux/udev/","title":"Custom udev rules","text":"<p>udev (the device manager for the Linux kernel) uses rules to manage device events (e.g., when a USB is plugged in). Rules are typically stored in <code>/etc/udev/rules.d/</code> or <code>/lib/udev/rules.d/</code> as files with a <code>.rules</code> extension (e.g., 10-my-rule.rules). Lower-numbered files are processed first.</p>","tags":["udev","linux","custom","rules"]},{"location":"DevOps/linux/udev/#udev-rule","title":"udev Rule","text":"<p>A rule consists of match keys (conditions) and assignment keys (actions), written in the format:</p> <pre><code>KEY==\"value\", ACTION=\"value\"\n</code></pre> <ul> <li>Match keys: Conditions to identify a device (e.g., SUBSYSTEM, ATTR).</li> <li>Assignment keys: Actions to take (e.g., NAME, RUN, SYMLINK).</li> </ul>","tags":["udev","linux","custom","rules"]},{"location":"DevOps/linux/udev/#demos","title":"demos","text":"","tags":["udev","linux","custom","rules"]},{"location":"DevOps/linux/udev/#set-symbolic-name","title":"Set symbolic name","text":"<p>Set symbolic name every time my arduino mega connected</p> <pre><code>udevadm info -a -p /sys/class/tty/ttyACM0\n</code></pre> <ul> <li>udevadm: A utility for managing and querying udev, the Linux device manager.</li> <li>info: A subcommand that provides information about a device.</li> <li>-a : Walks up the device tree (from the specified device to its parents) and shows all attributes available for matching in udev rules.</li> <li>-p : Specifies the sysfs path of the device to query <code>/sys/class/tty/ttyACM0</code>.</li> </ul> result: Show only the part i use for the rule <pre><code>looking at parent device '/devices/pci0000:00/0000:00:14.0/usb3/3-4/3-4.1/3-4.1.5/3-4.1.5.3':\n    KERNELS==\"3-4.1.5.3\"\n    SUBSYSTEMS==\"usb\"\n    DRIVERS==\"usb\"\n    ATTRS{authorized}==\"1\"\n    ...\n    ATTRS{configuration}==\"\"\n    ATTRS{devnum}==\"24\"\n    ATTRS{devpath}==\"4.1.5.3\"\n    ATTRS{idProduct}==\"0010\"\n    ATTRS{idVendor}==\"2341\"\n    ATTRS{ltm_capable}==\"no\"\n    ATTRS{manufacturer}==\"Arduino (www.arduino.cc)\"\n    ...\n    ATTRS{product}==\"Arduino Mega 2560\"\n    ATTRS{quirks}==\"0x0\"\n</code></pre> /etc/udev/rules.d/91-arduino.rules<pre><code>ACTION==\"add\",SUBSYSTEMS==\"usb\",ATTRS{idVendor}==\"2341\",ATTRS{product}==\"Arduino Mega 2560\", SYMLINK+=\"arduino_mega\"\n</code></pre> <p>debug and monitor</p> <p>monitor service using</p> <pre><code>sudo journalctl -f -u systemd-udev.service\n</code></pre>","tags":["udev","linux","custom","rules"]},{"location":"DevOps/linux/udev/#check","title":"check","text":"<pre><code>sudo udevadm control --reload-rules &amp;&amp; sudo udevadm trigger\n</code></pre> <ul> <li>Disconnect / Connect the device for <code>add</code> event <pre><code>ll /dev/arduino_mega \n#\nlrwxrwxrwx 1 root root 7 Apr  2 06:56 /dev/arduino_mega -&gt; ttyACM0\n</code></pre></li> </ul>","tags":["udev","linux","custom","rules"]},{"location":"DevOps/linux/udev/#todo","title":"TODO","text":"<ul> <li>explain monitor</li> <li>explain device tree</li> <li>explain ATTR ATTRS ENV</li> <li>explain SUBSYSTEMS</li> </ul>","tags":["udev","linux","custom","rules"]},{"location":"DevOps/linux/udev/#set-permission","title":"Set permission","text":"<p>Set permission to usb device</p> <pre><code>SUBSYSTEMS==\"i2c-dev\", ATTRS{name}==\"CP2112 SMBus Bridge on hidraw5\", MODE=\"0666\"\n</code></pre>","tags":["udev","linux","custom","rules"]},{"location":"DevOps/networking/","title":"Networking","text":"<p>Tips / Settings</p> <p>tools</p> <p>TBD</p>","tags":["networking"]},{"location":"DevOps/networking/#posts","title":"Posts","text":"<ul> <li>configure netplan and netowokd</li> </ul>","tags":["networking"]},{"location":"DevOps/networking/network_netplan/","title":"Config network using Netplan","text":"","tags":["network","netplan"]},{"location":"DevOps/networking/network_netplan/#systemd-networkd","title":"systemd-networkd","text":"<pre><code>#check if networkd manager the network\n\nnetworkctl\n\nIDX LINK    TYPE     OPERATIONAL SETUP    \n  1 lo      loopback carrier     unmanaged\n  2 l4tbr0  bridge   off         unmanaged\n  3 usb0    gadget   no-carrier  unmanaged\n  5 can0    can      off         unmanaged\n  6 eth0    ether    routable    unmanaged\n</code></pre> systemd-networkd<pre><code># start and enabled\nsudo systemctl unmask systemd-networkd\nsudo systemctl enable systemd-networkd\nsudo systemctl start systemd-networkd\n</code></pre> NetworkManager<pre><code># stop and disabled\nsudo systemctl stop NetworkManager\nsudo systemctl disable NetworkManager\nsudo systemctl mask NetworkManager\n</code></pre>","tags":["network","netplan"]},{"location":"DevOps/networking/network_netplan/#netplan","title":"netplan","text":"<pre><code>sudo apt install netplan.io\n</code></pre> netplan config example<pre><code>network:\n    version: 2\n    renderer: networkd\n    ethernets:\n        enp3s0:\n            dhcp4: true\n            dhcp6: true\n    wifis:\n        wlp2s0b1:\n            dhcp4: yes\n            dhcp6: yes\n            access-points:\n                \"network_ssid_name\":\n                    password: \"**********\"\n</code></pre> <p>edit <code>/etc/netplan/config.yaml</code> file</p> static<pre><code>network: \n  version: 2\n  renderer: networkd\n  ethernets:\n    eth0:\n      dhcp4: false\n      dhcp6: false\n      addresses:\n      - 10.0.0.4/24\n      routes:\n      - to: default\n        via: 10.0.0.1\n      nameservers:\n       addresses: [8.8.8.8,8.8.4.4]\n</code></pre>","tags":["network","netplan"]},{"location":"DevOps/networking/network_netplan/#check-and-apply","title":"check and apply","text":"<p>apply configuration<pre><code># set permission\nsudo chmod 600 /etc/netplan/config.yaml\n# apply\nsudo netplan apply\n</code></pre> <pre><code>networkctl \nIDX LINK    TYPE     OPERATIONAL SETUP     \n  1 lo      loopback carrier     unmanaged\n  2 l4tbr0  bridge   off         unmanaged\n  3 usb0    gadget   no-carrier  unmanaged\n  4 usb1    gadget   no-carrier  unmanaged\n  5 can0    can      off         unmanaged\n  6 eth0    ether    routable    configured\n  7 docker0 bridge   no-carrier  unmanaged\n</code></pre></p>","tags":["network","netplan"]},{"location":"DevOps/networking/tips_settings/","title":"Networking Tips and Settings","text":"","tags":["networking","tips"]},{"location":"DevOps/networking/tips_settings/#config-machine-as-router","title":"config machine as router","text":"<pre><code>#!/bin/sh\n\nsudo iptables -P FORWARD ACCEPT\nsudo iptables -t nat -s 10.0.0.0/24 -A POSTROUTING -j MASQUERADE\necho 1 &gt; sudo tee /proc/sys/net/ipv4/ip_forward\n</code></pre>","tags":["networking","tips"]},{"location":"DevOps/networking/tips_settings/#allow-multicast-on-locakhost","title":"Allow multicast on Locakhost","text":"<pre><code>sudo ifconfig lo multicast\n</code></pre>","tags":["networking","tips"]},{"location":"DevOps/networking/tips_settings/#posts","title":"Posts","text":"<ul> <li>checking mtu</li> </ul>","tags":["networking","tips"]},{"location":"DevOps/networking/tips_settings/checking_mtu/","title":"Checking MTU","text":"<p>Check the MTU (Maximum Transmission Unit) of a network interface using the ping command with the Don't Fragment (DF) flag.</p> <pre><code>ping -M do -s 1472 &lt;destination&gt;\n</code></pre> <ul> <li><code>-M do</code> \u2192 Enables the Don't Fragment (DF) flag, preventing packet fragmentation.</li> <li><code>-s 1472</code> \u2192 Specifies the payload size (1472 bytes is used for standard Ethernet with an MTU of 1500).</li> </ul> <p>1472</p> <p>The payload size of 1472 is used because the ICMP header is 8 bytes, and IP header 20 which makes the total packet size 1500 bytes.</p> <p></p>","tags":["networking","tips","mtu"]},{"location":"DevOps/networking/tips_settings/checking_mtu/#usage","title":"usage","text":"<p>To find the actual MTU, decrease the -s value in steps until you get a successful response.</p>","tags":["networking","tips","mtu"]},{"location":"DevOps/networking/tips_settings/tcpdump_tips/","title":"Tcpdump tips and cheat sheet","text":"","tags":["tcpdump","tips"]},{"location":"DevOps/networking/tips_settings/tcpdump_tips/#sniffer-ethernet-frame","title":"sniffer ethernet frame","text":"<pre><code>tcpdump -e\n</code></pre>","tags":["tcpdump","tips"]},{"location":"DevOps/networking/tools/","title":"Tools","text":"","tags":["networking","tools"]},{"location":"DevOps/networking/tools/#bmon","title":"bmon","text":"<p>bmon is a monitoring and debugging tool to capture networking related statistics and prepare them visually in a human friendly way</p> <pre><code>sudo apt-get install bmon\n</code></pre>","tags":["networking","tools"]},{"location":"DevOps/networking/tools/#iftop","title":"iftop","text":"<p>iftop is a network monitoring tool that shows a list of network connections in real-time</p> <pre><code>sudo apt-get install iftop\n</code></pre>","tags":["networking","tools"]},{"location":"DevOps/networking/tools/#example","title":"example","text":"<pre><code>sudo iftop -f \"udp port &lt;port_number&gt;\"\n</code></pre>","tags":["networking","tools"]},{"location":"DevOps/tools/","title":"DevOps Tools","text":"<p>Aptly</p>","tags":["devops","tools"]},{"location":"DevOps/tools/#posts","title":"Posts","text":"<ul> <li>debootstrap - create custom rootfs</li> <li>gpg</li> </ul>","tags":["devops","tools"]},{"location":"DevOps/tools/devops_debootstrap/","title":"Debootstrap","text":"<ul> <li>First Stage: Downloads the basic packages and sets up the environment.</li> <li>Second Stage: Completes the system setup, installs additional packages, and configures the environment to be fully usable.</li> </ul>","tags":["devops","tools"]},{"location":"DevOps/tools/devops_debootstrap/#first-stage","title":"First stage","text":"<pre><code>sudo debootstrap --arch=arm64 --foreign jammy /home/user/rootfs/ubuntuRootFS http://us.ports.ubuntu.com/ubuntu-ports\n</code></pre>","tags":["devops","tools"]},{"location":"DevOps/tools/devops_debootstrap/#second-stage","title":"Second stage","text":"<pre><code># Copy qemu binary to emulate ARM architecture on x86 machine\nsudo cp /usr/bin/qemu-aarch64-static /path/to/rootfs/usr/bin/\n\n# Chroot into the new rootfs\nsudo chroot /path/to/rootfs\n\n# Run the second-stage installation\n/debootstrap/debootstrap --second-stage\n</code></pre> <pre><code>deb http://us.ports.ubuntu.com/ubuntu-ports jammy main restricted\ndeb http://us.ports.ubuntu.com/ubuntu-ports jammy-updates main restricted\n# deb-src http://tw.ports.ubuntu.com/ubuntu-ports jammy main restricted universe multiverse\n# deb-src http://tw.ports.ubuntu.com/ubuntu-ports jammy-updates main restricted universe multiverse\ndeb http://us.ports.ubuntu.com/ubuntu-ports jammy universe\ndeb http://us.ports.ubuntu.com/ubuntu-ports jammy-updates universe\ndeb http://us.ports.ubuntu.com/ubuntu-ports jammy multiverse\ndeb http://us.ports.ubuntu.com/ubuntu-ports jammy-updates multiverse\n</code></pre> <pre><code>sudo mount -o bind /dev /home/user/rootfs/ubuntuRootFS/dev\nsudo mount -t devpts devpts /home/user/rootfs/ubuntuRootFS/dev/pts\nsudo mount -o bind /proc /home/user/rootfs/ubuntuRootFS/proc\nsudo mount -o bind /sys /home/user/rootfs/ubuntuRootFS/sys\nsudo mount -o bind /run /home/user/rootfs/ubuntuRootFS/run\n</code></pre> <pre><code>sudo chroot /path/to/rootfs /bin/bash\n</code></pre>","tags":["devops","tools"]},{"location":"DevOps/tools/devops_debootstrap/#install-ros-on-the-rootfs","title":"install ROS on the rootfs","text":"<pre><code>$ sudo apt update &amp;&amp; sudo apt install locales\n$ sudo locale-gen en_US en_US.UTF-8\n$ sudo update-locale LC_ALL=en_US.UTF-8 LANG=en_US.UTF-8\n$ export LANG=en_US.UTF-8\n</code></pre> <pre><code>$ sudo apt install software-properties-common\n$ sudo add-apt-repository universe\n</code></pre> <pre><code>$ sudo apt update &amp;&amp; sudo apt install curl -y\n$ sudo curl -sSL https://raw.githubusercontent.com/ros/rosdistro/master/ros.key -o /usr/share/keyrings/ros-archive-keyring.gpg\n$ echo \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/ros-archive-keyring.gpg] http://packages.ros.org/ros2/ubuntu $(. /etc/os-release &amp;&amp; echo $UBUNTU_CODENAME) main\" | sudo tee /etc/apt/sources.list.d/ros2.list &gt; /dev/null\n</code></pre> <pre><code>apt update\n</code></pre> <pre><code>sudo apt install ros-humble-ros-base\n</code></pre> toolchain.cmake<pre><code>set(CMAKE_SYSTEM_NAME Linux)\nset(CMAKE_SYSTEM_PROCESSOR aarch64)  # Change to match your target architecture\n\n# Set cross-compiler paths\nset(CMAKE_C_COMPILER /path/to/cross-compiler/bin/aarch64-linux-gnu-gcc)\nset(CMAKE_CXX_COMPILER /path/to/cross-compiler/bin/aarch64-linux-gnu-g++)\nset(CMAKE_SYSROOT /path/to/rootfs)  # Set to your root filesystem\n\n# Set where CMake should look for libraries and headers\nset(CMAKE_FIND_ROOT_PATH /path/to/rootfs /path/to/rootfs/usr /path/to/rootfs/usr/local)\n\n# Only search inside the target rootfs\nset(CMAKE_FIND_ROOT_PATH_MODE_PROGRAM NEVER)\nset(CMAKE_FIND_ROOT_PATH_MODE_LIBRARY ONLY)\nset(CMAKE_FIND_ROOT_PATH_MODE_INCLUDE ONLY)\n\n# ROS 2 paths\nset(AMENT_PREFIX_PATH /path/to/rootfs/opt/ros/humble)\nset(CMAKE_PREFIX_PATH ${AMENT_PREFIX_PATH})\n</code></pre> <pre><code>colcon build --cmake-args -DCMAKE_TOOLCHAIN_FILE=/path/to/toolchain.cmake\n</code></pre> <p>pyconfig.h</p> <p>Fix include path in pyconfig.h    <pre><code>//#  include &lt;aarch64-linux-gnu/python3.10/pyconfig.h&gt;\n# include \"/home/user/rootfs/ubuntuRootFS/usr/include/aarch64-linux-gnu/python3.10/pyconfig.h\"\n</code></pre></p>","tags":["devops","tools"]},{"location":"DevOps/tools/aptly/","title":"Aptly","text":"<p>Aptly is a swiss army knife for Debian repository management. </p> <p>install new version</p> <p>install new version 1.6.1</p> <p>Create custom repository</p> <p>Using Aptly with REST api</p> <p>Using Aptly to create mirror for selected packages</p>","tags":["aptly","debian"]},{"location":"DevOps/tools/aptly/#_1","title":"Aptly","text":"","tags":["aptly","debian"]},{"location":"DevOps/tools/aptly/#gpg-keys","title":"gpg keys","text":"","tags":["aptly","debian"]},{"location":"DevOps/tools/aptly/#todo-how-to-create-and-assign-key","title":"TODO: how to create and assign key","text":"","tags":["aptly","debian"]},{"location":"DevOps/tools/aptly/#aptly-repository","title":"Aptly Repository","text":"<p>An Aptly repository is a collection of .deb packages that you create and manage locally using Aptly. Think of it like a staging area \u2014 it's where you add, update, or remove packages.</p> <p>Repositories type</p> <ul> <li>local: custom repos.</li> <li>mirror: mirror official repos</li> </ul>","tags":["aptly","debian"]},{"location":"DevOps/tools/aptly/#aptly-snapshot","title":"Aptly Snapshot","text":"<p>A snapshot is a frozen, read-only version of a repository (local or mirror) at a specific point in time. It\u2019s like taking a picture of the repository.</p>","tags":["aptly","debian"]},{"location":"DevOps/tools/aptly/#serve","title":"Serve","text":"<pre><code>aptly serve\n</code></pre>","tags":["aptly","debian"]},{"location":"DevOps/tools/aptly/#using-nginx","title":"Using nginx","text":"<p>Nginx (pronounced \"engine-x\") is a high-performance web server</p> <pre><code>server {\n    listen 80;\n    server_name myrepo.example.com;\n\n    root /home/user/.aptly/public;\n\n    location / {\n        autoindex on;\n    }\n}\n</code></pre>","tags":["aptly","debian"]},{"location":"DevOps/tools/aptly/#add-to-sourceslist","title":"Add to sources.list","text":"<pre><code>deb http://myrepo.example.com/ jammy main\n# Without sign key\ndeb [trusted=yes] http://myrepo.example.com/ jammy main\n</code></pre>","tags":["aptly","debian"]},{"location":"DevOps/tools/aptly/aptly_custom_repository/","title":"TO REVIEW AND TEST","text":"","tags":["aptly","repo","local"]},{"location":"DevOps/tools/aptly/aptly_custom_repository/#aptly-repo","title":"aptly repo","text":"<p>Local repository is a collection of packages (most usually custom packages created internally).  Multiple versions of the same package could be added to the repository. In order to capture current repository state we use snapshot</p>","tags":["aptly","repo","local"]},{"location":"DevOps/tools/aptly/aptly_custom_repository/#repo","title":"repo","text":"","tags":["aptly","repo","local"]},{"location":"DevOps/tools/aptly/aptly_custom_repository/#create","title":"Create","text":"<p>Create local package repository. Repository would be empty when created, packages could be added to the repository from local files, copied or moved from another local repository or imported from the mirror. more</p> <pre><code>REPO_NAME=\"my-repo\"\n\naptly -distribution=\"jammy\" -architectures=\"amd64\" -comment=\"my repo desc\" \\\nrepo \\\ncreate \\\n${REPO_NAME}\n</code></pre>","tags":["aptly","repo","local"]},{"location":"DevOps/tools/aptly/aptly_custom_repository/#list","title":"List","text":"<p>Commands list displays list of all local package repositories. more</p> <pre><code>aptly repo list\n</code></pre>","tags":["aptly","repo","local"]},{"location":"DevOps/tools/aptly/aptly_custom_repository/#add","title":"Add","text":"<p>Command adds packages to local repository from .deb more</p> <p>From <code>deb</code> folder location</p> <pre><code>aptly repo add my_repo *deb\n</code></pre>","tags":["aptly","repo","local"]},{"location":"DevOps/tools/aptly/aptly_custom_repository/#snapshot","title":"Snapshot","text":"<p>Snapshot is a fixed state of remote repository mirror or local repository. Internally snapshot is list of references to packages. </p> <p>more</p> <p>Creates snapshot from current state of local package repository. </p> <p><pre><code>aptly snapshot create &lt;name&gt; from repo &lt;repo-name&gt;\n</code></pre> - name: snapshot name - repo-name: local repository name</p> <pre><code>aptly snapshot create \\\nsnap_my_repo \\\nfrom repo my_repo\n</code></pre>","tags":["aptly","repo","local"]},{"location":"DevOps/tools/aptly/aptly_custom_repository/#publish","title":"Publish","text":"<p>Publishes snapshot as repository to be consumed by apt.  more</p> <pre><code>aptly publish snapshot &lt;name&gt; [&lt;prefix&gt;]\n</code></pre> <ul> <li>prefix: Add prefix to repo url</li> <li>architectures: publish only selected arc from snapshot</li> <li>distribution: distribution name to publish</li> <li>skip-signing: don\u2019t sign Release files with GPG</li> </ul> publish with prefix<pre><code>aptly -architectures=\"amd64\" -skip-signing=true \\\npublish snapshot -architectures=\"amd64\" \\\nsnap_my_repo local\n</code></pre>","tags":["aptly","repo","local"]},{"location":"DevOps/tools/aptly/aptly_custom_repository/#serve","title":"Serve","text":"<p>aptly can serve published repositories using its own embedded webserver. more</p> <pre><code>aptly server\n</code></pre>","tags":["aptly","repo","local"]},{"location":"DevOps/tools/aptly/aptly_custom_repository/#sourcelist","title":"source.list","text":"<ul> <li>Add this line to use by apt</li> </ul> line in source.list<pre><code>deb http://lap2:8080/local/ jammy main\n</code></pre>","tags":["aptly","repo","local"]},{"location":"DevOps/tools/aptly/aptly_custom_repository/#reference","title":"Reference","text":"<ul> <li>Introducing \u2018Aptly\u2019, A Debian Repository Management Tool</li> </ul>","tags":["aptly","repo","local"]},{"location":"DevOps/tools/aptly/aptly_mirror/","title":"Aptly create mirror for selected packages","text":"<p>aptly allows to create mirrors of remote Debian repositories, it can mirror selected packages using filter</p>","tags":["aptly","mirror"]},{"location":"DevOps/tools/aptly/aptly_mirror/#install","title":"install","text":"/etc/apt/sources.list.d/aptly.list<pre><code>echo \"deb [signed-by=/etc/apt/keyrings/aptly.asc] http://repo.aptly.info/release jammy main\" \\\n  | sudo tee /etc/apt/sources.list.d/aptly.list &gt; /dev/null\n</code></pre> download key<pre><code>sudo wget -O /etc/apt/keyrings/aptly.asc https://www.aptly.info/pubkey.txt\n</code></pre> <pre><code>sudo apt update\nsudo apt install aptly\n</code></pre>","tags":["aptly","mirror"]},{"location":"DevOps/tools/aptly/aptly_mirror/#demo","title":"Demo","text":"<p>Create mirror for `` packages use docker to check the install</p> <ul> <li>Create</li> <li>Update</li> <li>Snapshot</li> <li>Publish</li> <li>Server</li> </ul>","tags":["aptly","mirror"]},{"location":"DevOps/tools/aptly/aptly_mirror/#create","title":"Create","text":"<p>create</p> create mirror<pre><code>#aptly mirror create &lt;name&gt; &lt;archive url&gt; &lt;distribution&gt; \n\naptly mirror create \\\n  -architectures=\"arm64\" \\\n  -filter=\"tcpdump|iputils-ping\" \\\n  -filter-with-deps \\\n  mirror-demo \\\n  http://ports.ubuntu.com/ubuntu-ports \\\n  jammy \\\n  main\n</code></pre> <pre><code>gpg --no-default-keyring \\\n    --keyring trustedkeys.gpg \\\n    --keyserver keyserver.ubuntu.com \\\n    --recv-keys 871920D1991BC93C\n</code></pre> <p>Note</p> ignore-signatures<pre><code># not recommended use -ignore-signatures flag\naptly mirror create -ignore-signatures\n</code></pre>","tags":["aptly","mirror"]},{"location":"DevOps/tools/aptly/aptly_mirror/#update","title":"update","text":"<pre><code># aptly mirror update &lt;mirror name&gt;\naptly mirror update mirror-demo\n</code></pre>","tags":["aptly","mirror"]},{"location":"DevOps/tools/aptly/aptly_mirror/#snapshot","title":"Snapshot","text":"<pre><code>#aptly snapshot create &lt;name&gt; from mirror &lt;mirror name&gt;\naptly snapshot create mirror-demo-v1 from mirror mirror-demo\n</code></pre>","tags":["aptly","mirror"]},{"location":"DevOps/tools/aptly/aptly_mirror/#create-key","title":"Create key","text":"<pre><code>gpg --full-generate-key\n#\npublic and secret key created and signed.\n\npub   rsa4096 2025-12-09 [SC]\n      4C4B6FD1CFF42336F74470225127A6636EB51D12\nuid                      dev &lt;dev@dev.com&gt;\nsub   rsa4096 2025-12-09 [E]\n</code></pre> <ul> <li>Key type \u2192 RSA and RSA</li> <li>Key size \u2192 4096 bits</li> <li>Expiration \u2192 0 = no expiration</li> <li>passphrase \u2192 dev</li> </ul> <pre><code>gpg --list-secret-keys --keyid-format LONG\n</code></pre> export key to use by apt<pre><code>gpg --export -a \"4C4B6FD1CFF42336F74470225127A6636EB51D12\" &gt; aptly.asc\n</code></pre> use the key<pre><code>deb [signed-by=aptly.asc] http://your-server/apt jammy main\n</code></pre>","tags":["aptly","mirror"]},{"location":"DevOps/tools/aptly/aptly_mirror/#publish","title":"Publish","text":"<pre><code>aptly publish snapshot -gpg-key=\"4C4B6FD1CFF42336F74470225127A6636EB51D12\" \\\nmirror-demo-v1\n</code></pre>","tags":["aptly","mirror"]},{"location":"DevOps/tools/aptly/aptly_mirror/#demo_1","title":"Demo","text":"<p>Update the mirror with another package</p> <pre><code>aptly mirror edit \\\n  -architectures=\"arm64\" \\\n  -filter=\"tcpdump|iputils-ping | net-tools\" \\\n  -filter-with-deps \\\n  mirror-demo \n</code></pre>","tags":["aptly","mirror"]},{"location":"DevOps/tools/aptly/aptly_mirror/#update_1","title":"update","text":"<pre><code># aptly mirror update &lt;mirror name&gt;\naptly mirror update mirror-demo\n</code></pre>","tags":["aptly","mirror"]},{"location":"DevOps/tools/aptly/aptly_mirror/#snapshot_1","title":"snapshot","text":"<pre><code>#aptly snapshot create &lt;name&gt; from mirror &lt;mirror name&gt;\naptly snapshot create mirror-demo-v2 from mirror mirror-demo\n</code></pre>","tags":["aptly","mirror"]},{"location":"DevOps/tools/aptly/aptly_mirror/#publish-switch","title":"publish (switch)","text":"<p>Command switches in-place published repository with new snapshot contents more</p> publish list<pre><code>aptly publish list\n#\nPublished repositories:\n  * ./jammy (origin: Ubuntu) [arm64] publishes {main: [mirror-demo-v1]: Snapshot from mirror [mirror-demo]: http://ports.ubuntu.com/ubuntu-ports/ jammy}\n</code></pre> <pre><code>aptly publish switch -gpg-key=\"4C4B6FD1CFF42336F74470225127A6636EB51D12\" jammy mirror-demo-v2\n#\nPublished snapshot repository ./jammy (origin: Ubuntu) [arm64] publishes {main: [mirror-demo-v2]: Snapshot from mirror [mirror-demo]: http://ports.ubuntu.com/ubuntu-ports/ jammy} has been successfully switched to new source.\n</code></pre> serve<pre><code>aptly serve\nServing published repositories, recommended apt sources list:\n\n# ./jammy (origin: Ubuntu) [arm64] publishes {main: [mirror-demo-v2]: Snapshot from mirror [mirror-demo]: http://ports.ubuntu.com/ubuntu-ports/ jammy}\ndeb http://127.0.0.1:8080/ jammy main\n</code></pre>","tags":["aptly","mirror"]},{"location":"DevOps/tools/aptly/aptly_mirror/#usage","title":"usage","text":"<p>Run minimal ubuntu 24.04 arm docker , edit the source list and try to install one of the package from the custom mirror</p> <ul> <li>Copy exported key</li> <li>Remove sources.list.d and update sources.list</li> </ul>","tags":["aptly","mirror"]},{"location":"DevOps/tools/aptly/aptly_mirror/#files","title":"files","text":"<ul> <li>aptly.asc</li> <li>Dockerfile</li> <li>sources.list</li> </ul> <pre><code>FROM ubuntu:24.04\n\nCOPY aptly.asc /etc/apt/keyrings/aptly.asc\nCOPY sources.list /etc/apt/sources.list\nRUN chmod 644 /etc/apt/keyrings/aptly.asc \\\n    &amp;&amp; rm -rf /etc/apt/sources.list.d\n\nCMD [\"/bin/bash\"]\n</code></pre> /etc/apt/sources.list<pre><code>deb [signed-by=/etc/apt/keyrings/aptly.asc] http://127.0.0.1:8080 jammy main\n</code></pre> <pre><code>docker build --platform linux/arm64 -t ubuntu/24.04:arm64 .\n</code></pre> <pre><code>docker run --rm -it --net host --hostname test --platform linux/arm64 ubuntu/24.04:arm64 \n</code></pre>","tags":["aptly","mirror"]},{"location":"DevOps/tools/aptly/aptly_mirror/#test","title":"Test","text":"<pre><code>apt update\napt install tcpdump\n</code></pre> <p>Note</p> <pre><code>deb [trusted=yes] http://example.com/debian stable main\n</code></pre>","tags":["aptly","mirror"]},{"location":"DevOps/tools/aptly/aptly_mirror/#use-file-as-filter-list","title":"use file as filter list","text":"<pre><code>aptly mirror edit \\\n  -architectures=\"arm64\" \\\n  -filter=\"@filter.txt\" \\\n  -filter-with-deps \\\n  mirror-demo \n</code></pre> filter.txt<pre><code>(\ncurl |\nvim |\ntcpdump |\nlibpcap* |\nnet-tools\n)\n</code></pre>","tags":["aptly","mirror"]},{"location":"DevOps/tools/aptly/aptly_rest_api/","title":"Aptly REST Api","text":"<p>Aptly operations are also available via REST API served with <code>aptly api serve</code>. The example and API reference refer to version 1.6.1</p> <p>version 1.6.1</p> <p>list and reference Aptly REST API</p>","tags":["aptly","rest"]},{"location":"DevOps/tools/aptly/aptly_rest_api/#run-and-test","title":"Run and Test","text":"run aptly REST api server<pre><code>aptly api serve\n</code></pre>","tags":["aptly","rest"]},{"location":"DevOps/tools/aptly/aptly_rest_api/#test-rest-api","title":"Test REST Api","text":"get server version<pre><code>curl http://localhost:8080/api/version | jq .\n\n#\n{\n    \"Version\":\"1.6.1\"\n}\n</code></pre>","tags":["aptly","rest"]},{"location":"DevOps/tools/aptly/aptly_rest_api/#files","title":"Files","text":"<p>Upload debs file to aptly location from this location aptly update it's repositories After adding to a repository, the files are removed by default.</p> upload file<pre><code># POST /api/files/{dir}\n# curl -X POST -F file=@{deb file} http://localhost:8080/api/files/uploads\ncurl -X POST -F file=@my-tool_0.0.1_amd64.deb http://localhost:8080/api/files/uploads\n</code></pre> list files in directory<pre><code>#GET /api/files/{dir}\ncurl http://localhost:8080/api/files/uploads\n</code></pre>","tags":["aptly","rest"]},{"location":"DevOps/tools/aptly/aptly_rest_api/#repository","title":"Repository","text":"<p>A local repository is a collection of versionned packages (usually custom packages created internally).</p> <p>Packages can be added, removed, moved or copied between repos.</p> <p>Local repositories can be published (either directly or via snapshot) to be used a APT source on a debian based system.</p> list repos<pre><code># GET /api/repos\ncurl http://localhost:8080/api/repos | jq .\n</code></pre> create repo<pre><code>POST /api/repos\n\ncurl -X POST http://localhost:8080/api/repos \\\n-H 'Content-Type: application/json' \\\n--data '{\n    \"Name\": \"my-repo\"\n    \"Comment\":\"my application repo\",\n    \"DefaultDistribution\":\"jammy\",\n    \"DefaultComponent\":\"main\"\n    }' \n</code></pre> add uploaded folder<pre><code># POST /api/repos/{name}/file/{dir}\ncurl -X POST http://localhost:8080/api/repos/my-repo/file/uploads\n</code></pre>","tags":["aptly","rest"]},{"location":"DevOps/tools/aptly/aptly_rest_api/#publish","title":"Publish","text":"<p>Publish snapshot or local repo as Debian repository to be used as APT source on Debian based systems.</p> list published repositories<pre><code># GET /api/publish\ncurl http://localhost:8080/api/publish | jq .\n</code></pre>","tags":["aptly","rest"]},{"location":"DevOps/tools/aptly/aptly_rest_api/#create-published-repository","title":"create published repository","text":"<p>Publish a local repository or snapshot</p> <p>The prefix may contain a storage specifier, e.g. s3:packages/, or it may also be empty to publish to the root directory.</p> create<pre><code># /api/publish/{prefix}\ncurl -X POST http://localhost:8080/api/publish/ \\\n-H 'Content-Type: application/json' \\\n--data '\n{\n    \"Distribution\": \"jammy\",\n    \"Sources\": [{\"Name\": \"my-repo\"}],\n    \"SourceKind\": \"local\",\n    \"Signing\": {\n        \"Skip\": true\n    }\n}' \n</code></pre> update<pre><code># PUT /api/publish/{prefix}/{distribution}\n# Empty prefix\n\ncurl -X PUT http://localhost:8080/api/publish//jammy\n-H 'Content-Type: application/json' \\\n--data '\n{\n    \"ForceOverwrite\": true,\n    \"Architectures\": [\n        \"amd64\"\n    ],\n    \"SourceKind\": \"local\",\n    \"Sources\": [\n    {\n      \"Component\": \"main\",\n      \"Name\": \"my-repo\"\n    },\n    \"Signing\": {\n        \"Skip\": true\n  },\n}'\n</code></pre> show published repository<pre><code>curl http://localhost:8080/api/publish/repos/jammy | jq .\n</code></pre>","tags":["aptly","rest"]},{"location":"DevOps/tools/aptly/aptly_rest_api/#demo-upload-deb-package-to-exists-repository","title":"Demo: upload deb package to exists repository","text":"<p>The demo base and how to create simple shell debian package</p> <p>The demo assume that the repository exists and we all ready publish it. no snapshot </p> <p>Demo steps:</p> <ul> <li>Upload deb file</li> <li>Add file to repository</li> <li>Update publisher</li> <li>Serve</li> <li>Update local apt</li> </ul>","tags":["aptly","rest"]},{"location":"DevOps/tools/aptly/aptly_rest_api/#pre","title":"Pre","text":"run aptly<pre><code>aptly serve\n</code></pre> create repository using aptly cli<pre><code>REPO_NAME=\"my-repo\"\n\naptly -distribution=\"jammy\" -architectures=\"amd64\" -comment=\"my repo desc\" \\\nrepo \\\ncreate \\\n${REPO_NAME}\n</code></pre> publish repo using aptly cli<pre><code>REPO_NAME=\"my-repo\"\n\naptly -distribution=\"jammy\" -architectures=\"amd64\" -skip-signing=\"true\" \\\npublish \\\nrepo \\\n${REPO_NAME}\n\n##\n#Now you can add following line to apt sources:\n#  deb http://your-server/ jammy main\n</code></pre>","tags":["aptly","rest"]},{"location":"DevOps/tools/aptly/aptly_rest_api/#rest-api","title":"rest api","text":"<pre><code>aptly api serve\n</code></pre>","tags":["aptly","rest"]},{"location":"DevOps/tools/aptly/aptly_rest_api/#upload","title":"Upload","text":"<pre><code>FILE=my-tool_0.0.1_amd64.deb\ncurl -X POST -F file=@${FILE} http://localhost:8080/api/files/uploads\n</code></pre>","tags":["aptly","rest"]},{"location":"DevOps/tools/aptly/aptly_rest_api/#update-repository","title":"Update repository","text":"<pre><code>REPO_NAME=\"my-repo\"\ncurl -X POST http://localhost:8080/api/repos/${REPO_NAME}/file/uploads\n</code></pre>","tags":["aptly","rest"]},{"location":"DevOps/tools/aptly/aptly_rest_api/#update-publisher","title":"Update publisher","text":"<pre><code>REPO_NAME=\"my-repo\"\n\ncurl -X PUT http://localhost:8080/api/publish//jammy \\\n-H 'Content-Type: application/json' \\\n--data '\n{\n    \"ForceOverwrite\": true,\n    \"Architectures\": [\n        \"amd64\"\n    ],\n    \"SourceKind\": \"local\",\n    \"Sources\": [\n        {\n        \"Component\": \"main\",\n        \"Name\": \"${REPO_NAME}\"\n        }\n    ],\n    \"Signing\": {\n        \"Skip\": true\n  }\n}'\n</code></pre>","tags":["aptly","rest"]},{"location":"DevOps/tools/aptly/aptly_rest_api/#serve","title":"Serve","text":"<ul> <li>Serve</li> <li>Add to <code>sources.list</code> or <code>sources.list.d</code></li> <li>Run <code>apt update</code></li> <li>Install package</li> </ul> <pre><code># serve with aptly or use nginx\naptly serve\n# ./jammy [amd64] publishes {main: [my-repo]: my repo desc}\ndeb http://127.0.0.1:8080/ jammy main\n</code></pre> <p>repositories URL</p> <p>When run <code>aptly server</code> it print all the publish repositories and the deb line add to the sources.list</p> <pre><code># repos/jammy [amd64] publishes {main: [my-repo]}\ndeb http://lap:8080/repos/ jammy main\n</code></pre> <pre><code>sudo vim /etc/apt/sources.list.d/my_repo.list\n</code></pre> <pre><code>deb [trusted=yes] http://127.0.0.1:8080/ jammy main\n</code></pre> <pre><code>sudo apt update\n</code></pre> <pre><code>apt search my-tool\n#\nSorting... Done\nFull Text Search... Done\nmy-tool/jammy 0.0.1 amd64\n  My Tool \u2013 brief description\n</code></pre>","tags":["aptly","rest"]},{"location":"DevOps/tools/aptly/aptly_rest_api/#vscode","title":"VSCode","text":"<p>Using vscode task to automate the above rest api calls</p> <ul> <li>Upload deb file</li> <li>Add files to repository</li> <li>Update publisher</li> </ul> <p>aptly api</p> <p>Run server</p> <pre><code>aptly api serve\n</code></pre>","tags":["aptly","rest"]},{"location":"DevOps/tools/aptly/aptly_rest_api/#upload-task","title":"Upload task","text":"<p>VSCode command variable</p> <p>Using command variable extension to pick deb file for upload</p> task section: upload file<pre><code>{\n\"label\": \"upload deb to aptly\",\n\"type\": \"shell\",\n\"command\": \"curl\",\n\"args\": [\n    \"-X\",\n    \"POST\",\n    \"-F\",\n    \"file=@${input:file_path}\",\n    \"http://localhost:8080/api/files/uploads\"\n],\n\"problemMatcher\": []\n}\n</code></pre> input add pickFile<pre><code>{\n    \"id\": \"file_path\",\n    \"type\": \"command\",\n    \"command\": \"extension.commandvariable.file.pickFile\",\n    \"args\":{\n        \"include\": \"**/*.deb\"\n    }\n}\n</code></pre>","tags":["aptly","rest"]},{"location":"DevOps/tools/aptly/aptly_rest_api/#update-repo","title":"Update repo","text":"task: update repository<pre><code>{\n    \"label\": \"add/update files to repository\",\n    \"type\": \"shell\",\n    \"command\": \"curl\",\n    \"args\": [\n        \"-X\",\n        \"POST\",\n        \"http://localhost:8080/api/repos/${input:repo_name}/file/uploads\"\n    ],\n    \"problemMatcher\": []\n}\n</code></pre> input: repo name<pre><code>{\n    \"id\": \"repo_name\",\n    \"default\": \"my-repo\",\n    \"type\": \"promptString\",\n    \"description\": \"my repository name\"\n}\n</code></pre>","tags":["aptly","rest"]},{"location":"DevOps/tools/aptly/aptly_rest_api/#update-publish","title":"Update publish","text":"<p>no prefix</p> <p>The double <code>//</code> is because no prefix define</p> task: update publish finish json part<pre><code>{\n    \"label\": \"update publish\",\n    \"type\": \"shell\",\n    \"command\": \"curl\",\n    \"args\": [\n        \"-X\",\n        \"PUT\",\n        \"http://localhost:8080/api/publish//jammy\",\n        \"-H\",\n        \"Content-Type: application/json\",\n        \"--data\",\n        \"{\\\"ForceOverwrite\\\": true, \\\"Architectures\\\": [\\\"amd64\\\"],\\\"SourceKind\\\": \\\"local\\\",\\\"Sources\\\": [{\\\"Component\\\": \\\"main\\\",\\\"Name\\\": \\\"${REPO_NAME}\\\"}],\\\"Signing\\\": {\\\"Skip\\\": true}}\"\n\n    ],\n    \"problemMatcher\": []\n}\n</code></pre> <p>download vscode full tasks.json file</p>","tags":["aptly","rest"]},{"location":"DevOps/tools/aptly/aptly_rest_api/#check","title":"Check","text":"<ul> <li>update sources.list</li> <li>run aptly</li> </ul> <pre><code>apt update\n</code></pre> <pre><code>apt search my-tool\n#\nSorting... Done\nFull Text Search... Done\nmy-tool/jammy 0.0.2 amd64\n  My Tool \u2013 brief description\n</code></pre> <pre><code>apt list -a my-tool\n#\nListing... Done\nmy-tool/jammy 0.0.2 amd64\nmy-tool/jammy 0.0.1 amd64\n</code></pre>","tags":["aptly","rest"]},{"location":"DevOps/tools/gpg/","title":"GPG","text":"<ul> <li>GPG (GNU Privacy Guard) is an open-source implementation of the OpenPGP standard used for encryption, signing, and verifying data</li> <li>GPG2 (GNU Privacy Guard 2) is an updated version of GPG (GnuPG) that provides improved cryptographic features, better security, and supports modern encryption algorithms.</li> </ul> encrypt<pre><code>gpg --symmetric --cipher-algo AES256 --passphrase-file password.txt --batch secret.txt\n</code></pre> decrypt<pre><code>gpg --decrypt --passphrase-file password.txt --batch secret.txt.gpg &gt; secret.txt\n</code></pre> <ul> <li>--batch: Prevent GPG from prompting for interactive input.</li> </ul>","tags":["gpg","encrypt"]},{"location":"DevOps/tools/terminator/","title":"Terminator","text":"<p>Custom layout</p> <p>check</p> <p>All layout save in config file at <code>.config/terminator</code> folder</p>","tags":["terminator"]},{"location":"DevOps/vscode/","title":"VSCode","text":"<p>Settings</p> <p>DevContainer</p> <p>Remote ssh</p> <p>Extensions</p> <p>Copilot</p> <p>MCP</p>","tags":["vscode"]},{"location":"DevOps/vscode/#video-and-posts","title":"Video and posts","text":"<ul> <li>Code Customization 101: Supercharge VS Code with Profiles</li> </ul>","tags":["vscode"]},{"location":"DevOps/vscode/#todo-read","title":"ToDO: read","text":"<ul> <li>vscode profile</li> </ul>","tags":["vscode"]},{"location":"DevOps/vscode/#extensions","title":"Extensions","text":"<p>Open VSX Registry</p>","tags":["vscode"]},{"location":"DevOps/vscode/copilot/","title":"VSCode copilot","text":"<p>Copilot tips setting and resource </p>","tags":["vscode","copilot"]},{"location":"DevOps/vscode/copilot/#control-completion","title":"Control completion","text":"<pre><code>\"github.copilot.enable\": {\n        \"*\": true,\n        \"plaintext\": false,\n        \"markdown\": false,\n        \"scminput\": false\n    }\n</code></pre>","tags":["vscode","copilot"]},{"location":"DevOps/vscode/copilot/#participants","title":"Participants","text":"<pre><code>@workspace: ask about files in your workspace\n</code></pre>","tags":["vscode","copilot"]},{"location":"DevOps/vscode/copilot/#slash","title":"Slash","text":"<p>highlight the code</p> <p>/doc</p> <p>/fix</p> <p>/test</p> <p>GitHub Copilot's @Workspace - Deep Dive</p>","tags":["vscode","copilot"]},{"location":"DevOps/vscode/copilot/#copilot","title":"copilot","text":"<ul> <li> Get to know GitHub Copilot in VS Code and be productive IMMEDIATELY </li> <li>VS Code Agent Mode Just Changed Everything</li> <li>Get Started with GitHub Copilot in VS Code (2025)</li> </ul>","tags":["vscode","copilot"]},{"location":"DevOps/vscode/dev_container/","title":"VSCode Dev Container","text":"<p>features</p> <p>TBD</p> <p>TBD</p> <pre><code>{\n    \"name\": \"&lt;name&gt;\",\n    \"dockerFile\": \"Dockerfile\",\n    \"context\": \"..\",\n    \"workspaceFolder\": \"/workspaces/&lt;host folder name&gt;\",\n    \"remoteUser\": \"user\",\n    \"runArgs\": [\n        \"--net=host\",\n        \"--hostname=&lt;name&gt;\",\n        \"--add-host=&lt;name&gt;:127.0.0.1\"\n    ],\n    \"remoteEnv\": {\n        \"DISPLAY\": \"${localEnv:DISPLAY}\",\n        \"QT_X11_NO_MITSHM\": \"1\"\n    },\n    \"mounts\": [\n        \"source=/tmp/.X11-unix,target=/tmp/.X11-unix,type=bind\",\n        \"source=/dev/dri,target=/dev/dri,type=bind\"\n    ],\n    \"postCreateCommand\": \"/home/user/.venv/bin/pip install -r /workspaces/${containerWorkspaceFolderBasename}/requirements.txt\",\n    \"customizations\": {\n        \"vscode\": {\n            \"extensions\": [\n                \"ms-python.python\",\n                \"ms-python.flake8\",\n                \"ms-python.black-formatter\",\n                \"ms-toolsai.jupyter\"\n            ],\n            \"settings\": {}\n        }\n    }\n}\n</code></pre> <p>Tip</p> <p>Mounting /dev/dri between the host and the container is needed only when you want hardware-accelerated rendering</p>","tags":["vscode","devcontainer","docker"]},{"location":"DevOps/vscode/dev_container/#resource","title":"Resource","text":"<ul> <li>Development Containers : An open specification for enriching containers with development specific content and settings. </li> <li>Run DevContainer on remote host</li> <li>VScode docker volume</li> </ul>","tags":["vscode","devcontainer","docker"]},{"location":"DevOps/vscode/dev_container/vscode_devcontainer_remote_host/","title":"Run dev container on remote host","text":"","tags":["vscode","devcontainer","remote","context"]},{"location":"DevOps/vscode/dev_container/vscode_devcontainer_remote_host/#prepared-host","title":"Prepared host","text":"","tags":["vscode","devcontainer","remote","context"]},{"location":"DevOps/vscode/dev_container/vscode_devcontainer_remote_host/#ssh-key","title":"SSH key","text":"<pre><code>ssh-keygen -t ed25519 -C \"dev@gmail.com\"\n</code></pre> <pre><code>ssh-copy-id &lt;user&gt;r@&lt;host&gt;\n</code></pre>","tags":["vscode","devcontainer","remote","context"]},{"location":"DevOps/vscode/dev_container/vscode_devcontainer_remote_host/#prepared-vscode","title":"Prepared VSCode","text":"<ul> <li>install <code>Remote - SSH</code> (ms-vscode-remote.remote-ssh) extension</li> <li>install <code>Dev Containers</code> (ms-vscode-remote.remote-containers) extension</li> </ul>","tags":["vscode","devcontainer","remote","context"]},{"location":"DevOps/vscode/dev_container/vscode_devcontainer_remote_host/#config-docker-context","title":"Config docker context","text":"<p>Docker context defines the endpoint (i.e., the target Docker Engine) that the Docker CLI talks to. This allows you to easily switch between local Docker engines, remote Docker hosts</p>","tags":["vscode","devcontainer","remote","context"]},{"location":"DevOps/vscode/dev_container/vscode_devcontainer_remote_host/#create-docker-context-for-the-remote-host","title":"Create docker context for the remote host","text":"<pre><code>docker context create &lt;remote_name&gt;&lt;/remote_bane&gt; --docker \"host=ssh://user@remote-host\"\n\ndocker context create orin --docker \"host=ssh://user@10.0.0.4\"\n\ndocker context ls\n</code></pre>","tags":["vscode","devcontainer","remote","context"]},{"location":"DevOps/vscode/dev_container/vscode_devcontainer_remote_host/#vscode-working-with-devcontainer-on-remote-machine","title":"VSCode working with Devcontainer on Remote machine","text":"<ul> <li>Create folder on host and remote machine with the same path</li> <li>Change to remote context from docker/containers extension</li> </ul>","tags":["vscode","devcontainer","remote","context"]},{"location":"DevOps/vscode/dev_container/vscode_devcontainer_remote_host/#change-docker-context","title":"Change docker context","text":"","tags":["vscode","devcontainer","remote","context"]},{"location":"DevOps/vscode/dev_container/vscode_devcontainer_remote_host/#create-folders","title":"Create folders","text":"<p>Create project folder on the remote machine in the same location like the local machine</p>","tags":["vscode","devcontainer","remote","context"]},{"location":"DevOps/vscode/dev_container/vscode_devcontainer_remote_host/#demo","title":"Demo","text":"devcontainer.json<pre><code>{\n  \"name\": \"Remote DevContainer\",\n  \"workspaceFolder\": \"/workspaces/vscode_remote_devcontainer\",\n  \"build\": {\n    \"dockerfile\": \"Dockerfile\"\n  },\n  \"remoteUser\": \"user\",\n  \"runArgs\": [\"--network=host\"],\n  \"postCreateCommand\": \"echo 'DevContainer is ready!'\"\n}\n</code></pre>","tags":["vscode","devcontainer","remote","context"]},{"location":"DevOps/vscode/dev_container/vscode_devcontainer_remote_host/#dockerfile","title":"Dockerfile","text":"<p>Base on ubuntu 22.04 add none root user and install and config <code>sudo</code></p> <pre><code>FROM ubuntu:22.04\n\nARG DEBIAN_FRONTEND=noninteractive\n\nARG USERNAME=user\nARG USER_UID=1000\nARG USER_GID=$USER_UID\n\n# Check if \"ubuntu\" user exists, delete it if it does, then create the desired user\nRUN if getent passwd ubuntu &gt; /dev/null 2&gt;&amp;1; then \\\n        userdel -r ubuntu &amp;&amp; \\\n        echo \"Deleted existing ubuntu user\"; \\\n    fi &amp;&amp; \\\n    groupadd --gid $USER_GID $USERNAME &amp;&amp; \\\n    useradd -s /bin/bash --uid $USER_UID --gid $USER_GID -m $USERNAME &amp;&amp; \\\n    echo \"Created new user $USERNAME\"\n\n# Add sudo support for the non-root user\nRUN apt-get update &amp;&amp; apt-get install -y sudo \\\n  &amp;&amp; echo $USERNAME ALL=\\(root\\) NOPASSWD:ALL &gt; /etc/sudoers.d/$USERNAME\\\n  &amp;&amp; chmod 0440 /etc/sudoers.d/$USERNAME \\\n  &amp;&amp; rm -rf /var/lib/apt/lists/*\n\n\n  ARG DEBIAN_FRONTEND=\n</code></pre>","tags":["vscode","devcontainer","remote","context"]},{"location":"DevOps/vscode/dev_container/vscode_devcontainer_remote_host/#run","title":"Run","text":"<p>Warning</p> <p>How to sync files from remote to local machine</p>","tags":["vscode","devcontainer","remote","context"]},{"location":"DevOps/vscode/dev_container/vscode_docker_volume/","title":"VSCode docker volume","text":"<p>Using devcontainer vscode save <code>vscode-server</code> on docker volume to share between different containers</p> <p>It save the <code>vscode-server</code> binary in <code>/vscode/vscode-server/bin/linux-x64/&lt;commit id&gt;</code>, each time we upgrade the vscode it add new <code>&lt;commit id&gt;</code> folder</p> list servers<pre><code>docker run -it --rm -v vscode:/vscode busybox ls /vscode/vscode-server/bin/linux-x64\n</code></pre> <p>vscode version and commit id</p> <pre><code>code -v\n</code></pre> <pre><code>code -v | head -n 2 | tail -n 1\n</code></pre>","tags":["vscode","devcontainer","volume","docker"]},{"location":"DevOps/vscode/dev_container/vscode_docker_volume/#backup","title":"backup","text":"<pre><code>ver=$(code -v | head -n 1)\ndocker run --rm \\\n  -v vscode:/vscode \\\n  -v $(pwd):/backup \\\n  busybox \\\n  sh -c \"tar czf /backup/vscode_volume_${ver}.tar.gz -C /vscode .\"\n</code></pre>","tags":["vscode","devcontainer","volume","docker"]},{"location":"DevOps/vscode/dev_container/vscode_docker_volume/#restore","title":"Restore","text":"<pre><code>ver=$(code -v | head -n 1)\ndocker run --rm \\\n  -v vscode:/vscode \\\n  -v $(pwd):/backup \\\n  busybox \\\n  sh -c \"tar xzf /backup/vscode_volume_${ver}.tar.gz -C /vscode\"\n</code></pre>","tags":["vscode","devcontainer","volume","docker"]},{"location":"DevOps/vscode/dev_container/vscode_docker_volume/#clean-volume","title":"Clean volume","text":"remove all vscode-server old folder<pre><code>commit_id=$(code -v | head -n 2 | tail -n 1)\ndocker run -it --rm \\\n-v vscode:/vscode busybox \\\nbusybox \\\nsh -c \"cd /vscode/vscode-server/bin/linux-x64 &amp;&amp; for d in *; do [ \\\"\\$d\\\" != \\\"${commit_id}\\\" ] &amp;&amp; [ -d \\\"\\$d\\\" ] &amp;&amp; rm -rf \\\"\\$d\\\"; done\"\n</code></pre>","tags":["vscode","devcontainer","volume","docker"]},{"location":"DevOps/vscode/dev_container/features/","title":"Dev container features","text":"<p>Dev container features are modular, pre-built scripts and configurations that automatically install tools, libraries, or settings inside your dev container, without needing to write a full Dockerfile.</p> <p>They are reusable building blocks to build and config containers.</p> <p>Note</p> <p>The feature run after The docker finish it build stage</p> <p>Check feature templates more</p>","tags":["vscode","devcontainers","features"]},{"location":"DevOps/vscode/dev_container/features/#demo-add-none-root-user-using-feature","title":"Demo: Add none root user using feature","text":"<pre><code>\u251c\u2500\u2500 .devcontainer\n\u2502   \u251c\u2500\u2500 devcontainer.json\n\u2502   \u251c\u2500\u2500 Dockerfile\n\u2502   \u2514\u2500\u2500 features\n\u2502       \u2514\u2500\u2500 none_root_user\n\u2502           \u251c\u2500\u2500 devcontainer-feature.json\n\u2502           \u2514\u2500\u2500 install.sh\n\u251c\u2500\u2500 docker-compose.yaml\n</code></pre> .devcontainer.json<pre><code>{\n    \"name\": \"demo\",\n    \"dockerComposeFile\": [\n      \"../docker-compose.yaml\",\n    ],\n    \"features\": {\n      \"./features/none_root_user\": {\n        \"user\": \"ros\"\n      }\n    },\n    \"service\": \"dev\",\n    \"shutdownAction\": \"stopCompose\",\n    \"workspaceFolder\": \"/workspace\",\n    \"customizations\": {\n      \"vscode\": {\n        \"extensions\": [\n        ],\n        \"settings\": {}\n      }\n    }\n  }\n</code></pre> .devcontainer/features/none_root_user/devcontainer-feature.json<pre><code>{\n    \"name\": \"add none root user\",\n    \"id\": \"hello\",\n    \"version\": \"1.0.0\",\n    \"description\": \"add a non-root user with sudo\",\n    \"options\": {\n        \"user\": {\n            \"type\": \"string\",\n            \"proposals\": [\n                \"user\"\n            ],\n            \"default\": \"user\",\n            \"description\": \"The name of the user to create.\"\n        }\n    }\n}\n</code></pre> .devcontainer/features/none_root_user/install.sh<pre><code>#!/bin/bash\nset -e\n\n\nUSERNAME=${USER}\nUSER_UID=1000\nUSER_GID=$USER_UID\n# Check if \"ubuntu\" user exists, delete it if it does, then create the desired user\nif getent passwd ubuntu &gt; /dev/null 2&gt;&amp;1; then \\\n        userdel -r ubuntu &amp;&amp; \\\n        echo \"Deleted existing ubuntu user\"; \\\n    fi &amp;&amp; \\\n    groupadd --gid $USER_GID $USERNAME &amp;&amp; \\\n    useradd -s /bin/bash --uid $USER_UID --gid $USER_GID -m $USERNAME &amp;&amp; \\\n    echo \"Created new user $USERNAME\"\n# Add sudo support for the non-root user\napt-get update &amp;&amp; apt-get install -y sudo \\\n  &amp;&amp; echo $USERNAME ALL=\\(root\\) NOPASSWD:ALL &gt; /etc/sudoers.d/$USERNAME\\\n  &amp;&amp; chmod 0440 /etc/sudoers.d/$USERNAME \\\n  &amp;&amp; rm -rf /var/lib/apt/lists/*\n</code></pre> <p>variable</p> <p>To use variable declare in <code>devcontainer-feature.json</code> in the install.sh use the name uppercase <code>${USER}</code></p>","tags":["vscode","devcontainers","features"]},{"location":"DevOps/vscode/extensions/","title":"VSCode Extensions","text":"<p>Command Variable</p> <p>TBD</p> <p>TBD</p>","tags":["vscode","extensions"]},{"location":"DevOps/vscode/extensions/#download-vsix-link","title":"Download vsix link","text":"<pre><code> https://marketplace.visualstudio.com/_apis/public/gallery/publishers/${publisher}/vsextensions/${extension}/${version}/vspackage\n</code></pre>","tags":["vscode","extensions"]},{"location":"DevOps/vscode/extensions/#demo","title":"Demo","text":"<p>Download ROS2 Topic Viewer and install offline</p> <ul> <li>publisher: AlessandroSofia</li> <li>extension: ros2-topic-viewer</li> <li>Version: 0.1.3</li> </ul> <pre><code>wget https://marketplace.visualstudio.com/_apis/public/gallery/publishers/AlessandroSofia/vsextensions/ros2-topic-viewer/0.1.3/vspackage\n</code></pre> <pre><code>code --install-extension AlessandroSofia.ros2-topic-viewer-0.1.3.vsix\n</code></pre>","tags":["vscode","extensions"]},{"location":"DevOps/vscode/extensions/command_variable/","title":"command_variable","text":"<p>Extend vscode command variables to use in <code>tasks.json</code> and <code>launch.json</code> marketplace</p>","tags":["vscode","extensions","command_variable"]},{"location":"DevOps/vscode/extensions/command_variable/#file-pick-demo","title":"file pick demo","text":"<p>Open file select Can filter the file list to show using include and exclude arguments more</p> tasks.json<pre><code>{\n    \"version\": \"2.0.0\",\n    \"tasks\": [\n      {\n        \"label\": \"echo select file\",\n        \"type\": \"shell\",\n        \"command\": \"echo\",\n        \"args\": [\n          \"${input:file_path}\"\n        ],\n        \"problemMatcher\": []\n      }\n    ],\n    \"inputs\": [\n      {\n        \"id\": \"file_path\",\n        \"type\": \"command\",\n        \"command\": \"extension.commandvariable.file.pickFile\",\n        \"args\":{\n            \"include\": \"**/control\"\n        }\n\n      }\n    ]\n}\n</code></pre>","tags":["vscode","extensions","command_variable"]},{"location":"DevOps/vscode/mcp/","title":"VSCode MCP Server","text":"<p>DevOps / vscode</p> <p>MCP (Model Context Protocol) is an open-source standard for connecting AI applications to external systems.</p>","tags":["mcp","vscode"]},{"location":"DevOps/vscode/mcp/#mcp-concept","title":"MCP Concept","text":"<ul> <li>Resources: File-like data that can be read by clients (like API responses or file contents)</li> <li>Tools: Functions that can be called by the LLM (with user approval)</li> <li>Prompts: Pre-written templates that help users accomplish specific tasks</li> </ul>","tags":["mcp","vscode"]},{"location":"DevOps/vscode/mcp/#simple-mcp-server-demo","title":"Simple MCP Server demo","text":"<p>using python mcp library</p> <p>uv</p> <p>Must of the example use <code>uv</code> the new package installer and runner I still use pip and the old virtual environment</p> <p>using logging</p> <p>Using logging and not print</p> <pre><code>import logging\n\n\nlogging.basicConfig(level=logging.INFO,\n    format=\"%(asctime)s [%(levelname)s] %(message)s\"\n)\n\nlog = logging.getLogger(__name__)\n</code></pre>","tags":["mcp","vscode"]},{"location":"DevOps/vscode/mcp/#logging","title":"Logging","text":"<p>The logging from the mcp server mark is <code>warning</code> and from [server stderr] as source , is ok and not an error the mcp output to stderr we can show from the image below that the rest of the logging line describe to output from our mcp server</p> <p></p>","tags":["mcp","vscode"]},{"location":"DevOps/vscode/mcp/#install","title":"Install","text":"<pre><code>pip install mcp[cli]\npip install trio #  friendly Python library for async concurrency and I/O\n</code></pre>","tags":["mcp","vscode"]},{"location":"DevOps/vscode/mcp/#very-simple-server","title":"Very simple server","text":"<pre><code>from mcp.server.fastmcp import FastMCP\nimport logging\n\n\nlogging.basicConfig(level=logging.INFO,\n    format=\"%(asctime)s [%(levelname)s] %(message)s\"\n    )\n\nlog = logging.getLogger(__name__)\n\n\n# Create an MCP server\nmcp = FastMCP(\"Demo\")\nlog.info(\"------- Starting MCP server -------\")\n\n\n@mcp.tool()\ndef add(a: int, b: int) -&gt; int:\n    \"\"\"Add two numbers together.\"\"\"\n    return a + b\n\n# Prompt: greeting\n@mcp.prompt()\ndef greet(name: str) -&gt; str:\n    \"\"\"Generate a greeting prompt.\"\"\"\n    return f\"Please write a short greeting for {name}.\"\n\n# Resource: static greeting\n@mcp.resource(\"hello://{name}\")\ndef hello(name: str) -&gt; str:\n    \"\"\"Return a static greeting resource.\"\"\"\n    return f\"Hello, {name}!\"\n\n# Entrypoint\nif __name__ == \"__main__\":\n    mcp.run()\n</code></pre>","tags":["mcp","vscode"]},{"location":"DevOps/vscode/mcp/#register-the-server-in-vscode","title":"Register the server in vscode","text":"<p>From <code>mcp.json</code> file we can manage the server: start, stop, show output(log) and more mcp.json<pre><code>{\n    \"servers\": {\n        \"demo-mcp\": {\n            \"command\": \".venv/bin/python\",\n            \"args\": [\n                \"mcp_demo.py\",\n                \"stdio\"\n            ],\n            \"type\": \"stdio\"\n        }\n    }\n}\n</code></pre></p> <p>The <code>tools</code> relevant only from agent mode and can config using the tool icon</p> <p></p>","tags":["mcp","vscode"]},{"location":"DevOps/vscode/mcp/#manage","title":"Manage","text":"<p>From vscode extensions tab</p> <p></p>","tags":["mcp","vscode"]},{"location":"DevOps/vscode/mcp/#usage-from-copilot","title":"Usage from copilot","text":"","tags":["mcp","vscode"]},{"location":"DevOps/vscode/mcp/#mcptool","title":"@mcp.tool()","text":"<ul> <li>Purpose: Expose a Python function as a structured action the client (Copilot Chat, Cursor, Windsurf, etc.) can call.</li> <li>Input/Output: JSON-serializable arguments and return values.</li> <li>Use case: Do something deterministic (math, file ops, API calls).</li> </ul> <p>permission</p> agent mode<pre><code>Use the add tool with a=2 and b=3\n</code></pre> <p></p>","tags":["mcp","vscode"]},{"location":"DevOps/vscode/mcp/#mcpprompt","title":"@mcp.prompt()","text":"<ul> <li>Purpose: Expose a prompt template (reusable instruction).</li> <li>Input: Arguments you want to inject into the prompt string.</li> <li>Output: A text template that will be fed to the AI.</li> <li>Use case: Style instructions, boilerplate phrasing, workflows.</li> </ul> <pre><code>Use the greet prompt with name=\"Amir\"\n</code></pre>","tags":["mcp","vscode"]},{"location":"DevOps/vscode/mcp/#mcpresource","title":"@mcp.resource()","text":"<ul> <li>Purpose: Expose structured data sources the client can browse/fetch.</li> <li>Input: Usually a URI-like parameter (you define the pattern).</li> <li>Output: String or JSON content.</li> <li>Use case: Provide documents, snippets, templates, or data.</li> </ul> <pre><code>Fetch hello://Alice\n</code></pre>","tags":["mcp","vscode"]},{"location":"DevOps/vscode/mcp/#more-demos","title":"More Demos","text":"<p>Generate files from templates</p> <p></p> <p></p>","tags":["mcp","vscode"]},{"location":"DevOps/vscode/mcp/#resources","title":"Resources","text":"<ul> <li>MCP Servers for VS Code (Crash Course)</li> <li>Visual Studio code + CMP server getting started guid what why how</li> <li>Create MCP Servers from Python Code in 10.5 Minutes</li> <li>MCP Server in Python \u2014 Everything I Wish I\u2019d Known on Day One</li> </ul>","tags":["mcp","vscode"]},{"location":"DevOps/vscode/mcp/generate_files/","title":"Generate files from template","text":"<p>DevOps / vscode / mcp</p> <p>The demo combine prompt and tool the generate file it use <code>rules</code> file to guide copilot to use the prompt from our mcp server</p> <pre><code>\u251c\u2500\u2500 mcp_demo.py\n\u251c\u2500\u2500 .copilot\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 rules.json\n\u251c\u2500\u2500 .vscode\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 settings.json\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 mcp.json\n\u2514\u2500\u2500 templates\n    \u251c\u2500\u2500 bridge.launch.py\n    \u251c\u2500\u2500 gazebo.launch.py\n    \u2514\u2500\u2500 rviz.launch.py\n</code></pre> .vscode/mcp.json <pre><code>{\n    \"servers\": {\n        \"demo-mcp\": {\n            \"command\": \".venv/bin/python\",\n            \"args\": [\n                \"mcp_demo.py\",\n                \"stdio\"\n            ],\n            \"type\": \"stdio\"\n        }\n    }\n}\n</code></pre> .copilot/rules.json <pre><code>{\n  \"rules\": [\n    {\n      \"when\": \"user asks to create a launch file\",\n      \"then\": \"always use the choose_template prompt\"\n    },\n    {\n      \"when\": \"user mentions gazebo, bridge, or rviz\",\n      \"then\": \"map to the generate_file tool with the corresponding template\"\n    }\n  ]\n}\n</code></pre> mcp_demo.py <pre><code>import logging\nfrom pathlib import Path\nfrom mcp.server.fastmcp import FastMCP\n\n# --- Setup ---\nlogging.basicConfig(\n    level=logging.INFO,\n    format=\"%(asctime)s [%(levelname)s] %(message)s\"\n)\nlog = logging.getLogger(\"template-mcp\")\n\nmcp = FastMCP(\"TemplateBuilder\")\nlog.info(\"MCP server initialized. -----------\")\nTEMPLATES_DIR = Path(\"templates\")\n\n# -------------------------------------------------\n# TOOL \u2192 Generate file from a template\n# -------------------------------------------------\n@mcp.tool()\ndef generate_file(template: str, output_name: str, **kwargs) -&gt; dict:\n    \"\"\"\n    Generate a new file from a given template.\n\n    Args:\n        template: filename in templates/ (e.g. gazebo.launch.py)\n        output_name: new file name (e.g. my_gazebo.launch.py)\n        kwargs: placeholder values to substitute\n    \"\"\"\n    template_path = TEMPLATES_DIR / template\n    if not template_path.exists():\n        raise ValueError(f\"Template '{template}' not found in {TEMPLATES_DIR}\")\n\n    content = template_path.read_text()\n\n    # Replace placeholders like {{robot_name}} with values from kwargs\n    for key, value in kwargs.items():\n        content = content.replace(f\"{{{{{key}}}}}\", str(value))\n\n    log.info(f\"Generated {output_name} from {template}\")\n    return {\"filename\": output_name, \"content\": content}\n\n# -------------------------------------------------\n# PROMPT \u2192 Choose the right template\n# -------------------------------------------------\n@mcp.prompt()\ndef choose_template(subject: str) -&gt; str:\n    \"\"\"\n    Guide the AI to pick the right template based on the subject.\n    \"\"\"\n    available = [f.name for f in TEMPLATES_DIR.glob(\"*.launch.py\")]\n    prompt = f\"\"\"\n    The user wants: \"{subject}\"\n\n    Available templates:\n    {available}\n\n    Select the best template file name and call generate_file with:\n      - template: &lt;chosen template&gt;\n      - output_name: a descriptive filename for the project\n      - kwargs: any substitutions needed (e.g. world=\"my_world.sdf\")\n    \"\"\"\n    log.info(f\"Prompting AI with subject: {subject}\")\n    log.info(available)\n    return prompt\n\n# -------------------------------------------------\n# Entrypoint\n# -------------------------------------------------\nif __name__ == \"__main__\":\n    log.info(\"Starting TemplateBuilder MCP server...\")\n    mcp.run()\n</code></pre>","tags":["mcp","vscode","generate","tool","prompt"]},{"location":"DevOps/vscode/mcp/generate_files/#usage","title":"Usage","text":"","tags":["mcp","vscode","generate","tool","prompt"]},{"location":"DevOps/vscode/remote_ssh/","title":"Index","text":"<p>The Remote - SSH extension lets you use any remote machine with a SSH server as your development environment.</p> <p>Check vscode remote and raspberry pi</p>","tags":["vscode","remote","ssh","vscode-server"]},{"location":"DevOps/vscode/remote_ssh/#tips","title":"Tips","text":"","tags":["vscode","remote","ssh","vscode-server"]},{"location":"DevOps/vscode/remote_ssh/#add-x11-support","title":"Add x11 support","text":"<p>Add ForwardX11 and ForwardX11Trusted to user <code>.ssh/config</code> file</p> <pre><code>Host 10.0.0.4\n  HostName 10.0.0.4\n  User user\n  ForwardX11 yes\n  ForwardX11Trusted yes\n</code></pre>","tags":["vscode","remote","ssh","vscode-server"]},{"location":"DevOps/vscode/tips_settings/","title":"VSCode tips and settings","text":"<p>Tasks</p> <p>Launch</p> <p>Snippets</p> <ul> <li>Keyboard shortcuts</li> <li>Editor</li> <li>Workbanch</li> <li>Terminal</li> </ul>","tags":["vscode","tips","settings"]},{"location":"DevOps/vscode/tips_settings/#keyboard-shortcuts","title":"keyboard shortcuts","text":"","tags":["vscode","tips","settings"]},{"location":"DevOps/vscode/tips_settings/#vscode-explorer","title":"VSCode explorer","text":"<p>Add <code>new file</code> and <code>new folder</code> keyboard shortcut in file explorer</p> <p>Add <code>key</code> to <code>keybindings.json</code> file <pre><code>{\n    \"key\": \"ctrl+n\",\n    \"command\": \"explorer.newFile\",\n    \"when\": \"explorerViewletFocus\"\n},\n{\n    \"key\": \"ctrl+shift+n\",\n    \"command\": \"explorer.newFolder\",\n    \"when\": \"explorerViewletFocus\"\n},\n</code></pre></p>","tags":["vscode","tips","settings"]},{"location":"DevOps/vscode/tips_settings/#terminal","title":"Terminal","text":"","tags":["vscode","tips","settings"]},{"location":"DevOps/vscode/tips_settings/#run-script-when-terminal-open","title":"run script when terminal open","text":"<pre><code>\"terminal.integrated.profiles.linux\": {\n      \"bash\": {\n          \"path\": \"bash\",\n          \"icon\": \"terminal-bash\",\n          \"args\": [\"--rcfile\", \"&lt;project&gt;/env.sh\"]\n      }\n  }\n</code></pre> <ul> <li>rcfile: specify an alternative initialization file (RC file) to source when starting a new bash session</li> </ul>","tags":["vscode","tips","settings"]},{"location":"DevOps/vscode/tips_settings/#disabled-auto-suggest","title":"Disabled auto suggest","text":"<pre><code>\"terminal.integrated.suggest.enabled\": false\n</code></pre>","tags":["vscode","tips","settings"]},{"location":"DevOps/vscode/tips_settings/#editor","title":"Editor","text":"","tags":["vscode","tips","settings"]},{"location":"DevOps/vscode/tips_settings/#use-tab-instead-of-space","title":"Use tab instead of space","text":"<p>Config <code>tab</code> and not <code>space</code> for shell script <pre><code> \"[shellscript]\": {\n            \"editor.insertSpaces\": false,\n            \"editor.tabSize\": 4,\n            \"editor.detectIndentation\": false\n        },\n</code></pre></p> <p>When <code>editor.detectIndentation</code> false, VS Code ignores the file\u2019s existing indentation and uses the user-defined settings (e.g., editor.tabSize, editor.insertSpaces).</p>","tags":["vscode","tips","settings"]},{"location":"DevOps/vscode/tips_settings/#workbench","title":"Workbench","text":"<ul> <li>Mark active tab</li> <li>Tab focus mode</li> <li>Preview mode</li> </ul>","tags":["vscode","tips","settings"]},{"location":"DevOps/vscode/tips_settings/#tab-key-function","title":"Tab key function","text":"<p>I accidentally pressed some key combonition and the \"Tab\" switch the focus mode between pans' using command pallette to change tab function</p> <p></p>","tags":["vscode","tips","settings"]},{"location":"DevOps/vscode/tips_settings/#add-custom-color-to-active-tab","title":"Add custom color to active tab","text":"<pre><code>\"workbench.colorCustomizations\": {\n        \"tab.activeBorder\": \"#ff0000\",\n        \"tab.activeBackground\": \"#373737\"\n    },\n</code></pre>","tags":["vscode","tips","settings"]},{"location":"DevOps/vscode/tips_settings/#preview-mode","title":"Preview mode","text":"<p>preview or not</p>","tags":["vscode","tips","settings"]},{"location":"DevOps/vscode/tips_settings/#preview-mode_1","title":"Preview mode","text":"<p>VSCode default</p> <p>Preview Mode tabs are not kept open. As soon as you go to open another file from the sidebar, the existing Preview Mode tab (if one exists) is used. You can determine if a tab is in Preview Mode, by looking at its title in the tab bar. If the title is italic, the tab is in preview mode.</p> <p>To open a file for editing (i.e. don't open in Preview Mode), double-click on the file in the sidebar, or single-click it in the sidebar then double click the title of its Preview Mode tab.</p> <ul> <li>Clicking on a file in the explorer opens it in the editor in preview (the file name well be italic).</li> <li>Dbl-clicking on a file in the explorer opens it in the editor in a new tab.</li> <li>To switch file from preview to tab, dbl-click on the file title bar. (or start to edit)</li> </ul>","tags":["vscode","tips","settings"]},{"location":"DevOps/vscode/tips_settings/#disabled-preview-mode","title":"Disabled preview mode","text":"<pre><code>\"workbench.editor.enablePreview\": false,\n</code></pre>","tags":["vscode","tips","settings"]},{"location":"DevOps/vscode/tips_settings/launch/","title":"VSCode launch","text":"<p>VSCode launch.json is used to configure debugging settings for different programming languages and environments. It allows you to define how VS Code should start, attach to, or debug an application.</p>","tags":["vscode","launch"]},{"location":"DevOps/vscode/tips_settings/snippets/","title":"VSCode snippets","text":"<ul> <li>Markdown snippet</li> </ul>","tags":["vscode","snippets"]},{"location":"DevOps/vscode/tips_settings/tasks/","title":"VSCode Tasks","text":"","tags":["vscode","tips","tasks"]},{"location":"DevOps/vscode/tips_settings/tasks/#inputs","title":"Inputs","text":"<p>Inputs provide a way to get user-defined values before running a task.</p> <ul> <li>promptString</li> <li>pickString</li> </ul>","tags":["vscode","tips","tasks"]},{"location":"DevOps/vscode/tips_settings/tasks/#promptstring","title":"promptString","text":"<pre><code>{\n  \"version\": \"2.0.0\",\n  \"tasks\": [\n    {\n      \"label\": \"Run script with input\",\n      \"type\": \"shell\",\n      \"command\": \"echo User entered: ${input:myInput}\",\n      \"problemMatcher\": [],\n      \"group\": \"build\"\n    }\n  ],\n  \"inputs\": [\n    {\n      \"id\": \"myInput\",\n      \"type\": \"promptString\",\n      \"description\": \"Enter a value\"\n    }\n  ]\n}\n</code></pre>","tags":["vscode","tips","tasks"]},{"location":"DevOps/vscode/tips_settings/tasks/#pickstring","title":"pickString","text":"<pre><code>{\n  \"version\": \"2.0.0\",\n  \"tasks\": [\n    {\n      \"label\": \"Run script with input\",\n      \"type\": \"shell\",\n      \"command\": \"echo User entered: ${input:myInput}\",\n      \"problemMatcher\": [],\n      \"group\": \"build\"\n    }\n  ],\n  \"inputs\": [\n    {\n      \"id\": \"myInput\",\n      \"type\": \"pickString\",\n      \"description\": \"Enter a value\",\n      \"options\": [\"Option A\", \"Option B\", \"Option C\"]\n    }\n  ]\n}\n</code></pre> VSCode pickString","tags":["vscode","tips","tasks"]},{"location":"Embedded/","title":"Embedded","text":"<p>Arduino</p> <p>ESP32</p> <p>Jetson</p> <p>RPi</p> <p>micro python</p> <p>Hardware</p>"},{"location":"Embedded/ESP32/","title":"ESP32","text":"<ul> <li>simple FOC</li> </ul>","tags":["esp32"]},{"location":"Embedded/ESP32/esp32_mqtt/","title":"ESP32 MQTT","text":"<p>Connect esp32 running arduino framework to ubuntu machine using MQTT protocol</p> <p>Connect ESP32 to PlotJuggler to visualize data</p>","tags":["arduino","esp32","mqtt","tutorial"]},{"location":"Embedded/ESP32/esp32_mqtt/#prerequisites","title":"Prerequisites","text":"<p>Install mqtt broker on ubuntu machine</p> <pre><code>sudo apt install mosquitto mosquitto-clients\n</code></pre> <pre><code>sudo systemctl status mosquitto\n</code></pre>","tags":["arduino","esp32","mqtt","tutorial"]},{"location":"Embedded/ESP32/esp32_mqtt/#test-mqtt-broker","title":"Test mqtt broker","text":"<ul> <li>Without authentication</li> </ul> terminal 1, subscriber<pre><code>mosquitto_sub -t \"hello/topic\"\n</code></pre> terminal 2, publisher<pre><code>mosquitto_pub -t 'hello/topic' -m 'hello MQTT'\n</code></pre>","tags":["arduino","esp32","mqtt","tutorial"]},{"location":"Embedded/ESP32/esp32_mqtt/#under-construction","title":"UNDER CONSTRUCTION","text":"","tags":["arduino","esp32","mqtt","tutorial"]},{"location":"Embedded/ESP32/esp32_simple_foc/","title":"Esp32 simple foc","text":"","tags":["esp32","simpleFOC","bldc","encoder"]},{"location":"Embedded/ESP32/esp32_simple_foc/#bom","title":"BOM","text":"","tags":["esp32","simpleFOC","bldc","encoder"]},{"location":"Embedded/Jetson/","title":"Nvidia Jetson","text":"<p>Jetpack </p> <p>Docker </p> <p>vpi </p> <ul> <li>using gpio using python</li> <li>build opencv with cuda support</li> <li>tensorrt</li> <li>nvidia jetson minimalist images</li> <li>nvidia flash bootloader only</li> </ul>","tags":["embedded","nvidia","jetson","orin"]},{"location":"Embedded/Jetson/build_opencv_with_cuda_support/","title":"OpenCV with cuda support on jetson","text":"<p>Build OpenCV with CUDA support on Jetson  Pack it using DEB for future use.</p> <p>Build scripts from  Qengineering/Install-OpenCV-Jetson-Nano </p> <pre><code>&gt;&gt;&gt; import cv2\n&gt;&gt;&gt; cv2.__version__\n'4.10.0'\n&gt;&gt;&gt; cv2.cuda.getCudaEnabledDeviceCount()\n1\n</code></pre> <pre><code>cmake -D CMAKE_BUILD_TYPE=RELEASE \\\n-D CMAKE_INSTALL_PREFIX=/usr \\\n-D OPENCV_EXTRA_MODULES_PATH=~/opencv_contrib/modules \\\n-D EIGEN_INCLUDE_PATH=/usr/include/eigen3 \\\n-D WITH_OPENCL=OFF \\\n-D CUDA_ARCH_BIN=${ARCH} \\\n-D CUDA_ARCH_PTX=${PTX} \\\n-D WITH_CUDA=ON \\\n-D WITH_CUDNN=ON \\\n-D WITH_CUBLAS=ON \\\n-D ENABLE_FAST_MATH=ON \\\n-D CUDA_FAST_MATH=ON \\\n-D OPENCV_DNN_CUDA=ON \\\n-D ENABLE_NEON=ON \\\n-D WITH_QT=OFF \\\n-D WITH_OPENMP=ON \\\n-D BUILD_TIFF=ON \\\n-D WITH_FFMPEG=ON \\\n-D WITH_GSTREAMER=ON \\\n-D WITH_TBB=ON \\\n-D BUILD_TBB=ON \\\n-D BUILD_TESTS=OFF \\\n-D WITH_EIGEN=ON \\\n-D WITH_V4L=ON \\\n-D WITH_LIBV4L=ON \\\n-D WITH_PROTOBUF=ON \\\n-D OPENCV_ENABLE_NONFREE=ON \\\n-D INSTALL_C_EXAMPLES=OFF \\\n-D INSTALL_PYTHON_EXAMPLES=OFF \\\n-D PYTHON3_PACKAGES_PATH=/usr/lib/python3/dist-packages \\\n-D OPENCV_GENERATE_PKGCONFIG=ON \\\n-D BUILD_EXAMPLES=OFF \\\n-D CMAKE_CXX_FLAGS=\"-march=native -mtune=native\" \\\n-D CMAKE_C_FLAGS=\"-march=native -mtune=native\" \\\n-D CPACK_BINARY_DEB=ON \\\n-D CPACK_PACKAGE_VERSION=4.10.0 \\\n-D CPACK_DEBIAN_PACKAGE_VERSION=4.10.0-1 \\\n..\n</code></pre> <p>CUDA_ARCH_BIN, CUDA_ARCH_PTX</p> <p>DEB</p> <p>The CPACK_BINARY_DEB option in OpenCV\u2019s CMake configuration enables packaging OpenCV as a Debian (.deb) package using CPack.</p> <pre><code>-D CPACK_BINARY_DEB=ON\n-D CPACK_PACKAGE_VERSION=4.10.0 \n-D CPACK_DEBIAN_PACKAGE_VERSION=4.10.0-1\n</code></pre> <pre><code>make package ..\n</code></pre>","tags":["nvidia","jetson","opencv","cuda"]},{"location":"Embedded/Jetson/build_opencv_with_cuda_support/#check-installation","title":"Check installation","text":"pull cuda runtime image<pre><code>docker pull nvidia/cuda:12.6.0-runtime-ubuntu22.04\n</code></pre> run and share cv build folder<pre><code># from build folder\ndocker run  --gpus all --runtime=nvidia \\\n    -it --rm --hostname test \\\n    -v `pwd`:/tmp/cv \\\n    nvidia/cuda:12.6.0-cudnn-runtime-ubuntu22.04  \\\n    /bin/bash\n</code></pre> <p>docker image</p> <p>We can start with docker that the cudnn is preinstall</p> <pre><code>docker pull nvidia/cuda:12.6.0-cudnn-runtime-ubuntu22.04\n</code></pre> <pre><code>docker pull  nvidia/cuda:12.6.0-runtime-ubuntu22.04 /bin/bash\n</code></pre> install dependencies<pre><code>apt update\napt install cudnn9 # skip if use the preinstall cudnn\napt install python3\napt install python3-numpy\n#\n#install all opencv debs\ncd /tmp/cv\napt install ./*.deb\n</code></pre> check cuda installation<pre><code>&gt;&gt;&gt; import cv2\n&gt;&gt;&gt; cv2.__version__\n'4.10.0'\n&gt;&gt;&gt; cv2.cuda.getCudaEnabledDeviceCount()\n1\n</code></pre>","tags":["nvidia","jetson","opencv","cuda"]},{"location":"Embedded/Jetson/flash_bootloader_only/","title":"Bootloader","text":"flash bootloader qspi<pre><code>l4t_initrd_flash.sh --qspi-only =p \"-c bootloader/generic/cfg/flash_t234_qpsi.xml\" cti/orin-nx/hadron/base internal\n</code></pre>","tags":["nvidia","bootloader","flash"]},{"location":"Embedded/Jetson/nvidia_gpio_using_python/","title":"GPIO on Nvidia jetson using python","text":"","tags":["nvidia","jetson","gpio","python"]},{"location":"Embedded/Jetson/nvidia_gpio_using_python/#todo-gpiod","title":"TODO: gpiod","text":"","tags":["nvidia","jetson","gpio","python"]},{"location":"Embedded/Jetson/nvidia_jetson_minimalist_images/","title":"Nvidia Jetson Minimalist Images","text":"<p>The need for the minimalist images came from the official jetson images being large in size and containing pre-installed packages that are not necessary, resulting in the consumption of valuable disk space and memory. github</p> <p>Tip</p> <p>user: jetson pass: jetson</p>","tags":["jetson","rootfs","image"]},{"location":"Embedded/Jetson/dockers/","title":"Docker nvidia","text":"<p>Nvidia NGC Catalog</p>","tags":["nvidia","jetson","docker","docker-compose"]},{"location":"Embedded/Jetson/dockers/#jetpack","title":"Jetpack","text":"<pre><code>docker pull nvcr.io/nvidia/l4t-jetpack:r36.4.0\n</code></pre>","tags":["nvidia","jetson","docker","docker-compose"]},{"location":"Embedded/Jetson/dockers/#nvidia-container-runtime","title":"Nvidia container runtime","text":"<pre><code>sudo apt install nvidia-container-toolkit\n</code></pre> usage<pre><code>sudo docker run --gpus all --runtime=nvidia -it --rm nvcr.io/nvidia/l4t-jetpack:r36.4.0 nvidia-smi\n</code></pre>","tags":["nvidia","jetson","docker","docker-compose"]},{"location":"Embedded/Jetson/dockers/#using-compose","title":"Using compose","text":"<p>Using compose override to run nvidia docker on pc and jetson</p> <p>nvidia runtime on jetson</p> <ul> <li>jetPack includes NVIDIA Container Runtime for Jetson, which is based on nvidia-docker2, but it does not auto-assign <code>runtime: nvidia</code>.</li> <li>You must explicitly request the nvidia runtime in your Docker Compose file to enable GPU access.</li> </ul>","tags":["nvidia","jetson","docker","docker-compose"]},{"location":"Embedded/Jetson/dockers/#what-does-runtime-nvidia-do","title":"What Does runtime: nvidia Do?:","text":"<ul> <li>Enables GPU passthrough into the container.</li> <li>Loads required GPU drivers and libraries into container's environment.</li> <li>Makes nvidia-smi, CUDA, cuDNN, TensorRT available in the container.</li> </ul>","tags":["nvidia","jetson","docker","docker-compose"]},{"location":"Embedded/Jetson/dockers/#demo-using-vscode-devcontainer-with-docker-compose","title":"Demo: using vscode devcontainer with docker compose","text":"<ul> <li>use <code>nvidia/cuda:12.6.0-cudnn-runtime-ubuntu22.04</code> as a base image</li> <li>use compose override to support pc and jetson running</li> <li>check running using <code>nvidia-smi</code></li> </ul> <pre><code>FROM nvidia/cuda:12.6.0-cudnn-runtime-ubuntu22.04\n</code></pre> docker-compose.yaml<pre><code>services:\n  dev:\n    build:\n      context: .\n      dockerfile: .devcontainer/Dockerfile\n    deploy:\n      resources:\n        reservations:\n          devices:\n            - capabilities: [gpu]\n    volumes:\n      - .:/workspace:cached\n    hostname: dev\n    network_mode: host\n    stdin_open: true\n    tty: true\n</code></pre> docker-compose.jetson.yaml<pre><code>services:\n  dev:\n    runtime: nvidia\n    environment:\n      - NVIDIA_VISIBLE_DEVICES=all\n      - NVIDIA_DRIVER_CAPABILITIES=compute,utility\n</code></pre>","tags":["nvidia","jetson","docker","docker-compose"]},{"location":"Embedded/Jetson/dockers/#vscode-devcontainer","title":"VScode devcontainer","text":"<pre><code>{\n    \"name\": \"opencv_cuda\",\n    \"dockerComposeFile\": [\n      \"../docker-compose.yaml\",\n      \"../docker-compose.jetson.yaml\"\n    ],\n    \"service\": \"dev\",\n    \"shutdownAction\": \"stopCompose\",\n    \"workspaceFolder\": \"/workspace\",\n    \"customizations\": {\n      \"vscode\": {\n        \"extensions\": [],\n        \"settings\": {}\n      }\n    }\n  }\n</code></pre>","tags":["nvidia","jetson","docker","docker-compose"]},{"location":"Embedded/Jetson/jetpack/","title":"Nvidia jetson Jetpack","text":"","tags":["nvidia","jetson","jetpack"]},{"location":"Embedded/Jetson/jetpack/#sdk-manager","title":"SDK Manager","text":"","tags":["nvidia","jetson","jetpack"]},{"location":"Embedded/Jetson/jetpack/#tips","title":"Tips","text":"install from cli<pre><code>#from nvidia/nvidia_sdk/JetPack_6.2.1_Linux_JETSON_ORIN_NX_TARGETS/Linux_for_Tegra\nsudo ./nvsdkmanager_flash.sh --storage nvme0n1p1\n</code></pre> <pre><code># TODO: check when and way to command relevant\n# I install from sdk and missing opencv and nvcc, the command fix it\nsudo apt install nvidia-jetpack\n</code></pre>","tags":["nvidia","jetson","jetpack"]},{"location":"Embedded/Jetson/jetpack/#mapping","title":"Mapping","text":"<p>Mapping between Jetpack version and Jetson Linux</p> <pre><code>cat /etc/nv_tegra_release\n#\n# R36 (release), REVISION: 4.3,\n</code></pre> <p>it's map to Jetson linux 36.4.3</p> <p>Jetson linux Downloads</p> <p>The version map to link for download roosfs and toolchain</p> <pre><code>https://developer.nvidia.com/embedded/jetson-linux-r3643\n</code></pre>","tags":["nvidia","jetson","jetpack"]},{"location":"Embedded/Jetson/jetpack/#build-custom-rootfs","title":"Build custom rootfs","text":"<p>Root file System</p> <p>The minimal root file system is the basic root file system that is used for NVIDIA Jetson develop kits. This file system does not provide the GUI mode, and all manipulations can be completed only by using the SSH or UART console. The file system does not also provide an OEM configuration, so we recommend that you create a default user before you flash the device. Refer to l4t_create_default_user.sh in Skipping oem-config for more information.</p> <pre><code>sudo ./nv_build_samplefs.sh --abi aarch64 --distro ubuntu --flavor minimal --version jammy\n</code></pre> <p>fix l4t_create_default_user.sh</p> <p>function <code>show_eula()</code> replace if order</p> <pre><code>if [ \"${accept_license}\" = true ]; then\n    return\nfi\n\nif [ ! -f \"${license_file}\" ] &amp;&amp; [ ! -f \"${license_gz_file}\" ]; then\n    echo \"ERROR: Cannot find the Tegra software license agreement\"\n    exit 1\nfi\n</code></pre> <pre><code>sudo ./apply_binaries.sh\n</code></pre> <pre><code>sudo ./tools/l4t_create_default_user.sh -u user -p user -n prod --accept-license\n</code></pre> <pre><code>cp -a desktop_rootfs/boot/ minimum_rootfs/\n</code></pre>","tags":["nvidia","jetson","jetpack"]},{"location":"Embedded/Jetson/vpi/","title":"Jetson VPI","text":"<p>Vision Programming Interface is software library from NVIDIA for implementing algorithms on computing engines. more</p> <p>NVIDIA Optical Flow SDK</p> <p>The vpi and optical-flow-sdk are different library  the sdk not working with jetson more  opencv cuda_NvidiaOpticalFlow_1_0 class use the sdk to run.</p>","tags":["vpi","jetson","nvidia"]},{"location":"Embedded/Jetson/vpi/#resource","title":"Resource","text":"<ul> <li>VPI - Vision Programming Interface Documentation</li> <li> Introduction to NVIDIA VPI </li> </ul>","tags":["vpi","jetson","nvidia"]},{"location":"Embedded/RPI/","title":"Raspberry Pi","text":"<p>VSCode Remote</p> <p>GPIO</p>","tags":["rpi","raspberry"]},{"location":"Embedded/RPI/lora_hat/","title":"RPi zero with lora HAT","text":"<p>SX1268 433M LoRa HAT</p> <p></p>","tags":["zero","rpi","lora"]},{"location":"Embedded/RPI/lora_hat/#enable-serial-port","title":"Enable Serial port","text":"<ul> <li>Run <code>sudo raspi-config</code></li> <li>From Inerfacing Option select serial</li> </ul>","tags":["zero","rpi","lora"]},{"location":"Embedded/RPI/lora_hat/#install-python-dependencies","title":"Install python dependencies","text":"<pre><code>sudo apt install python3-pip\npip3 install --break-system-packages pyserial\n</code></pre>","tags":["zero","rpi","lora"]},{"location":"Embedded/RPI/lora_hat/#add-user-to-dialout","title":"Add user to dialout","text":"<pre><code>sudo usermod -aG dialout $USER\n</code></pre>","tags":["zero","rpi","lora"]},{"location":"Embedded/RPI/lora_hat/#run-demo","title":"Run demo","text":"<pre><code>cd ~/SX126X_LoRa_HAT_Code/raspberrypi/python/\npython3 main.py\n</code></pre>","tags":["zero","rpi","lora"]},{"location":"Embedded/RPI/lora_hat/#pinout","title":"PinOut","text":"","tags":["zero","rpi","lora"]},{"location":"Embedded/RPI/lora_hat/#gpio","title":"GPIO","text":"","tags":["zero","rpi","lora"]},{"location":"Embedded/RPI/dev/","title":"Index","text":"<p>Embedded / RPI</p>","tags":["vscode","cross compiler"]},{"location":"Embedded/RPI/dev/#using-vscode-with-cross-compiler","title":"Using vscode with cross compiler","text":"","tags":["vscode","cross compiler"]},{"location":"Embedded/RPI/dev/#install","title":"Install","text":"<pre><code>sudo apt install gcc-aarch64-linux-gnu\n</code></pre>","tags":["vscode","cross compiler"]},{"location":"Embedded/RPI/dev/#build","title":"Build","text":"","tags":["vscode","cross compiler"]},{"location":"Embedded/RPI/dev/#current-file","title":"current file","text":"tasks.json<pre><code>{\n    \"label\": \"build-arm\",\n    \"type\": \"shell\",\n    \"command\": \"aarch64-linux-gnu-g++\",\n    \"args\": [\n        \"-g\",\n        \"-o\",\n        \"${workspaceFolder}/build/${fileBasenameNoExtension}_arm\",\n        \"${file}\"\n    ],\n    \"group\": {\n        \"kind\": \"build\",\n        \"isDefault\": true\n    },\n    \"presentation\": {\n        \"echo\": true,\n        \"reveal\": \"always\",\n        \"focus\": false,\n        \"panel\": \"shared\"\n    },\n    \"problemMatcher\": [\"$gcc\"]\n}\n</code></pre>","tags":["vscode","cross compiler"]},{"location":"Embedded/RPI/dev/#c_cpp_properties","title":"c_cpp_properties","text":"c_cpp_properties.json<pre><code>{\n    \"configurations\": [\n        {\n            \"name\": \"ARM Cross Compile\",\n            \"includePath\": [\n                \"${workspaceFolder}/**\",\n                \"/usr/aarch64-linux-gnu//include/**\"\n            ],\n            \"compilerPath\": \"/usr/bin/aarch64-linux-gnu-gcc\",\n            \"cStandard\": \"c17\",\n            \"cppStandard\": \"c++17\",\n            \"intelliSenseMode\": \"linux-gcc-arm\"\n        }\n    ],\n    \"version\": 4\n}\n</code></pre>","tags":["vscode","cross compiler"]},{"location":"Embedded/RPI/gpio/","title":"Raspberry Pi GPIO using gpiod","text":"<p>gpiod (libgpiod) is a modern, fast, and safe way to control GPIOs on Linux-based systems the gpiod library work with <code>/dev/gpiochip*</code></p> <p>Note</p> <p>gpiod replaces the deprecated <code>/sys/class/gpio</code> interface.</p>","tags":["raspberry pi","rpi","gpio","gpiod"]},{"location":"Embedded/RPI/gpio/#install","title":"Install","text":"<pre><code>sudo apt install gpiod\n</code></pre>","tags":["raspberry pi","rpi","gpio","gpiod"]},{"location":"Embedded/RPI/gpio/#usage","title":"usage","text":"<p>gpiod installed 6 utils</p> <ul> <li>gpiodetect: List all GPIO chips on the system</li> <li>gpiofind: Find a GPIO by label</li> <li>gpioget: Turn GPIOs ON/OFF</li> <li>gpioset: Read digital input state</li> <li>gpioinfo: Show info about all lines on a chip</li> <li>gpiomon: Monitor GPIOs for edge events</li> </ul>","tags":["raspberry pi","rpi","gpio","gpiod"]},{"location":"Embedded/RPI/gpio/#demo-using-gpiod-utilities-with-rpi5","title":"Demo: using gpiod utilities with rpi5","text":"gpiodetect<pre><code>gpiodetect\n#\ngpiochip0 [gpio-brcmstb@107d508500] (32 lines)\ngpiochip1 [gpio-brcmstb@107d508520] (4 lines)\ngpiochip2 [gpio-brcmstb@107d517c00] (15 lines)\ngpiochip3 [gpio-brcmstb@107d517c20] (6 lines)\ngpiochip4 [pinctrl-rp1] (54 lines)\n</code></pre> <p>Note</p> <p>Control the j8 header</p> gpioset<pre><code>gpioset gpiochip4 17=1\ngpioset gpiochip4 17=0\n</code></pre>","tags":["raspberry pi","rpi","gpio","gpiod"]},{"location":"Embedded/RPI/gpio/#python-and-cpp","title":"Python and CPP","text":"","tags":["raspberry pi","rpi","gpio","gpiod"]},{"location":"Embedded/RPI/gpio/#cpp","title":"cpp","text":"install<pre><code>sudo apt install -y libgpiod-dev \n</code></pre> blink cpp code <pre><code>#include &lt;gpiod.h&gt;\n#include &lt;iostream&gt;\n#include &lt;chrono&gt;\n#include &lt;thread&gt;\n\nint main() {\n    const char* chipname = \"gpiochip4\";  // Raspberry Pi 5 J8 header GPIOs\n    unsigned int line_num = 17;          // GPIO17 (BCM)\n\n    gpiod_chip* chip = gpiod_chip_open_by_name(chipname);\n    if (!chip) {\n        std::cerr &lt;&lt; \"Failed to open GPIO chip\\n\";\n        return 1;\n    }\n\n    gpiod_line* line = gpiod_chip_get_line(chip, line_num);\n    if (!line) {\n        std::cerr &lt;&lt; \"Failed to get line\\n\";\n        gpiod_chip_close(chip);\n        return 1;\n    }\n\n    if (gpiod_line_request_output(line, \"gpio_toggle\", 0) &lt; 0) {\n        std::cerr &lt;&lt; \"Failed to request line as output\\n\";\n        gpiod_chip_close(chip);\n        return 1;\n    }\n\n    for (int i = 0; i &lt; 10; ++i) {\n        gpiod_line_set_value(line, 1);\n        std::this_thread::sleep_for(std::chrono::milliseconds(500));\n        gpiod_line_set_value(line, 0);\n        std::this_thread::sleep_for(std::chrono::milliseconds(500));\n    }\n\n    gpiod_line_release(line);\n    gpiod_chip_close(chip);\n    return 0;\n}\n</code></pre> build<pre><code>g++ -o gpio_toggle gpio_blink.cpp -lgpiod\n</code></pre>","tags":["raspberry pi","rpi","gpio","gpiod"]},{"location":"Embedded/RPI/gpio/#python","title":"python","text":"<pre><code>sudo apt install python3-libgpiod\n</code></pre> blink cpp code <pre><code>import gpiod\nimport time\n\nCHIP_NAME = \"gpiochip4\"  # On Raspberry Pi 5\nLINE_OFFSET = 17         # BCM GPIO number\n\n# Open the GPIO chip and get the line\nchip = gpiod.Chip(CHIP_NAME)\nline = chip.get_line(LINE_OFFSET)\n\n# Request the line as output (v2.x API)\nline.request(consumer=\"python-gpiod\", type=gpiod.LINE_REQ_DIR_OUT)\n\n# Blink loop\nfor _ in range(10):\n    line.set_value(1)\n    time.sleep(0.5)\n    line.set_value(0)\n    time.sleep(0.5)\n\nline.release()\n</code></pre>","tags":["raspberry pi","rpi","gpio","gpiod"]},{"location":"Embedded/RPI/ssh_vscode_remote/","title":"Using vscode remote on RPI","text":"<p>The Remote - SSH extension lets you use any remote machine with a SSH server as your development environment.</p>","tags":["rpi","raspberry","ssh","vscode","remote"]},{"location":"Embedded/RPI/ssh_vscode_remote/#login-using-ssh-key","title":"Login using SSH key","text":"","tags":["rpi","raspberry","ssh","vscode","remote"]},{"location":"Embedded/RPI/ssh_vscode_remote/#create-key","title":"Create key","text":"<p>Create ssh key (private/public) <pre><code># ssh-keygen -t ed25519 -C \"your_email@example.com\"\n\nssh-keygen -t ed25519 -C \"dev@dev.com\"\n# Type enter for empty passphrase\n</code></pre></p> <p>Tip</p> <p>For simplicity (less secure) create key without passphrase</p>","tags":["rpi","raspberry","ssh","vscode","remote"]},{"location":"Embedded/RPI/ssh_vscode_remote/#copy-key-to-remote","title":"Copy key to remote","text":"<p>Copy the public key to remote machine</p> <pre><code># ssh-copy-id user@remote\nssh-copy-id user@pi\n</code></pre> <p>ssh-agent</p> <p>If the private key has passphrase we need to type it every time we start ssh session. ssh-agent keep the private key after we type the passphrase once</p>","tags":["rpi","raspberry","ssh","vscode","remote"]},{"location":"Embedded/RPI/ssh_vscode_remote/#vscode-remote-ssh","title":"VSCode Remote-SSH","text":"<p>The Remote - SSH extension lets you use any remote machine with a SSH server as your development environment. install and more</p>","tags":["rpi","raspberry","ssh","vscode","remote"]},{"location":"Embedded/RPI/ssh_vscode_remote/#remote-ssh-usage","title":"Remote-ssh usage","text":"","tags":["rpi","raspberry","ssh","vscode","remote"]},{"location":"Embedded/RPI/ssh_vscode_remote/#add-new-remote","title":"Add new remote","text":"","tags":["rpi","raspberry","ssh","vscode","remote"]},{"location":"Embedded/RPI/ssh_vscode_remote/#connect","title":"Connect","text":"","tags":["rpi","raspberry","ssh","vscode","remote"]},{"location":"Embedded/RPI/ssh_vscode_remote/#edit-ssh-config","title":"Edit ssh config","text":"<p>Edit remote name and other settings</p> <p></p> <ul> <li>Change remote name</li> <li>Add x11 settings</li> </ul> <pre><code>Host pi\n    HostName 192.168.1.50\n    User pi\n    ForwardX11 yes\n    ForwardX11Trusted yes\n    # Port 2222\n</code></pre>","tags":["rpi","raspberry","ssh","vscode","remote"]},{"location":"Embedded/RPI/ssh_vscode_remote/#tip-change-prompt","title":"Tip: Change prompt","text":"Add to .bashrc<pre><code>if [ -n \"$SSH_CONNECTION\" ]; then\n    if [ \"$EUID\" -eq 0 ]; then\n        PS1='\ud83c\udf53\\[\\e[1;41m\\][ROOT SSH \\u@\\h]\\[\\e[0m\\] \\w # '\n    else\n        PS1='\ud83c\udf53\\[\\e[1;31m\\][SSH \\u@\\h]\\[\\e[0m\\] \\w \\$ '\n    fi\nfi\n</code></pre>","tags":["rpi","raspberry","ssh","vscode","remote"]},{"location":"Embedded/RPI/ssh_vscode_remote/#vscode-project","title":"VSCode project","text":"<p>All the file exists on the remote machine</p> <p>use <code>extensions.json</code> file to control with extension will installed on the remote</p> <pre><code>{\n  \"recommendations\": [\n    \"ms-python.python\",\n    \"ms-vscode.cpptools\",\n    \"ms-vscode.cmake-tools\",\n  ]\n}\n</code></pre> <p></p>","tags":["rpi","raspberry","ssh","vscode","remote"]},{"location":"Embedded/arduino/","title":"Arduino","text":"<p>Dev environment</p> <p>platformio</p> <p>Libraries</p>","tags":["arduino","vscode","pio"]},{"location":"Embedded/arduino/#posts","title":"Posts","text":"<ul> <li>Arduino i2c</li> <li>Simple FOC with arduino</li> <li>Arduino REST Server</li> </ul>","tags":["arduino","vscode","pio"]},{"location":"Embedded/arduino/arduino_foc/","title":"Using SimpleFOC library with arduino","text":"","tags":["arduino","foc","bldc"]},{"location":"Embedded/arduino/arduino_foc/#bom","title":"BOM","text":"Item GM3506 Gimbal Motor Datasheet SimpleFOCMini V1.0","tags":["arduino","foc","bldc"]},{"location":"Embedded/arduino/arduino_foc/#wiring","title":"Wiring","text":"mini pin EN IN3 IN2 IN1 GND Uno pin 4 5 6 9 GND","tags":["arduino","foc","bldc"]},{"location":"Embedded/arduino/arduino_foc/#code","title":"Code","text":"src/main.cpp<pre><code>#include &lt;Arduino.h&gt;\n#include &lt;SimpleFOC.h&gt;\n\n// Define motor driver pins\n#define PWM_A 9\n#define PWM_B 6\n#define PWM_C 5\n#define ENABLE_PIN 4\n\n// Create the BLDC driver object\nBLDCDriver3PWM driver(PWM_A, PWM_B, PWM_C, ENABLE_PIN);\n\n// Create the BLDC motor object\nBLDCMotor motor = BLDCMotor(11); // 7 pole pairs (estimate for GM3506)\n\n// Create an open-loop velocity control\nvoid setup()\n{\n  Serial.begin(9600);\n\n  // Initialize driver\n  driver.voltage_power_supply = 12; // Set to your supply voltage\n  driver.init();\n\n  // Link driver to motor\n  motor.linkDriver(&amp;driver);\n\n  // Open-loop velocity mode\n  motor.voltage_limit = 6; // Limit voltage to half supply\n  motor.controller = MotionControlType::velocity_openloop;\n\n  // Initialize motor\n  motor.init();\n  Serial.println(\"Motor Ready!\");\n}\n\nvoid loop()\n{\n  motor.move(1);\n  motor.loopFOC();\n}\n</code></pre> <p>Note</p> <p>In <code>velocity_openloop</code> mode the speed depends on supply voltage and motor parameters. </p> platformio.ini<pre><code>[env:uno]\nplatform = atmelavr\nboard = uno\nframework = arduino\nlib_deps = askuric/Simple FOC@^2.2\n</code></pre>","tags":["arduino","foc","bldc"]},{"location":"Embedded/arduino/arduino_foc/#add-encoder","title":"Add encoder","text":"","tags":["arduino","foc","bldc"]},{"location":"Embedded/arduino/arduino_foc/#wiring_1","title":"Wiring","text":"color desc uno pin black CSN  (chip select) D10 (any gpio) purple CLK D13 (SCK) yellow MOSI (master out slave in) D11 (COPI) green MISO (master in slave out) D12 (CIPO) red 5/3.3 white GND","tags":["arduino","foc","bldc"]},{"location":"Embedded/arduino/arduino_foc/#code_1","title":"Code","text":"<p>Using FOC library with encoder</p> src/main.cpp<pre><code>#include &lt;Arduino.h&gt;\n#include &lt;SimpleFOC.h&gt;\n\n// Define motor driver pins\n#define PWM_A 9\n#define PWM_B 6\n#define PWM_C 5\n#define ENABLE_PIN 4\n\n// Create the BLDC driver object\nBLDCDriver3PWM driver(PWM_A, PWM_B, PWM_C, ENABLE_PIN);\n\n// Create the BLDC motor object\nBLDCMotor motor = BLDCMotor(11); // 7 pole pairs (estimate for GM3506)\nMagneticSensorSPI as5047u = MagneticSensorSPI(10, 14, 0x3FFF);\n// Create an open-loop velocity control\nvoid setup()\n{\n  Serial.begin(115200);\n  as5047u.init();\n  Serial.println(\"as5047u ready\");\n  // Initialize driver\n  driver.voltage_power_supply = 12; // Set to your supply voltage\n  driver.init();\n\n  // Link driver to motor\n  motor.linkDriver(&amp;driver);\n\n  // Open-loop velocity mode\n  motor.voltage_limit = 6; // Limit voltage to half supply\n  motor.controller = MotionControlType::velocity_openloop;\n\n  // Initialize motor\n  motor.init();\n  Serial.println(\"Motor Ready!\");\n}\n\nvoid loop()\n{\n  motor.move(1);\n  motor.loopFOC();\n  as5047u.update();\n  // display the angle and the angular velocity to the terminal\n  Serial.print(as5047u.getAngle());\n  Serial.print(\"\\t\");\n  Serial.println(as5047u.getVelocity());\n}\n</code></pre>","tags":["arduino","foc","bldc"]},{"location":"Embedded/arduino/arduino_i2c/","title":"Arduino i2c","text":"","tags":["arduino","i2c","scanner"]},{"location":"Embedded/arduino/arduino_i2c/#i2c-scanner","title":"i2c scanner","text":"i2c scanner<pre><code>#include &lt;Arduino.h&gt;\n\n#include &lt;Wire.h&gt;\n\nvoid setup()\n{\n  Wire.begin();\n\n  Serial.begin(9600);\n  while (!Serial)\n  Serial.println(\"\\nI2C Scanner\");\n}\n\nvoid loop()\n{\n  byte error, address;\n  int nDevices;\n\n  Serial.println(\"Scanning...\");\n\n  nDevices = 0;\n  for (address = 1; address &lt; 127; address++)\n  {\n    // The i2c_scanner uses the return value of\n    // the Write.endTransmisstion to see if\n    // a device did acknowledge to the address.\n    Wire.beginTransmission(address);\n    error = Wire.endTransmission();\n\n    if (error == 0)\n    {\n      Serial.print(\"I2C device found at address 0x\");\n      if (address &lt; 16)\n        Serial.print(\"0\");\n      Serial.print(address, HEX);\n      Serial.println(\"  !\");\n\n      nDevices++;\n    }\n    else if (error == 4)\n    {\n      Serial.print(\"Unknown error at address 0x\");\n      if (address &lt; 16)\n        Serial.print(\"0\");\n      Serial.println(address, HEX);\n    }\n  }\n  if (nDevices == 0)\n    Serial.println(\"No I2C devices found\\n\");\n  else\n    Serial.println(\"done\\n\");\n\n  delay(5000); // wait 5 seconds for next scan\n}\n</code></pre>","tags":["arduino","i2c","scanner"]},{"location":"Embedded/arduino/arduino_i2c_gpio_extension/","title":"Arduino i2c gpio extension","text":"","tags":["mcp23017","i2c","arduino"]},{"location":"Embedded/arduino/arduino_i2c_gpio_extension/#boom","title":"Boom","text":"<ul> <li>MCP23017 I2C Interface 16bit I/O Extension</li> </ul>","tags":["mcp23017","i2c","arduino"]},{"location":"Embedded/arduino/arduino_mqtt/","title":"Connect Arduino with PC using MQTT","text":"<p>Publish data from arduino that run on ESP32 device to pc that run <code>mosquito</code> MQTT broker via wifi</p>","tags":["arduino","mqtt","PubSubClient","Mosquito"]},{"location":"Embedded/arduino/arduino_mqtt/#pc","title":"PC","text":"<ul> <li>Install </li> <li>Config</li> </ul>","tags":["arduino","mqtt","PubSubClient","Mosquito"]},{"location":"Embedded/arduino/arduino_mqtt/#config","title":"Config","text":"<p>Add this line allow broker to listen to all port and allow connection without user and password</p> /etc/mosquitto/mosquitto.conf<pre><code>listener 1883 0.0.0.0\nallow_anonymous true\n</code></pre> restart service<pre><code>systemctl restart mosquitto\n</code></pre> <pre><code>[env:esp32dev]\nplatform = espressif32\nplatform_packages=\n  framework-arduinoespressif32 @ https://github.com/espressif/arduino-esp32.git#3.0.3\n  framework-arduinoespressif32-libs @ https://github.com/espressif/arduino-esp32/releases/download/3.0.3/esp32-arduino-libs-3.0.3.zip\nboard = esp32dev\nframework = arduino\nserial_speed = 115200\nmonitor_speed = 115200\nlib_deps = \n    PubSubClient\n</code></pre>","tags":["arduino","mqtt","PubSubClient","Mosquito"]},{"location":"Embedded/arduino/arduino_mqtt/#arduino-code","title":"Arduino code","text":"<pre><code>#include &lt;WiFi.h&gt;\n#include &lt;PubSubClient.h&gt;\n\n// WiFi\nconst char *ssid = \"&lt;&gt;\"; // Enter your Wi-Fi name\nconst char *password = \"&lt;&gt;\";  // Enter Wi-Fi password\n\n// MQTT Broker\nconst char *mqtt_broker = \"&lt;&gt;\";\nconst char *topic = \"mqtt/esp32\";\nconst int mqtt_port = 1883;\n\nWiFiClient espClient;\nPubSubClient client(espClient);\n\nvoid callback(char *topic, byte *payload, unsigned int length) {\n  Serial.print(\"Message arrived in topic: \");\n  Serial.println(topic);\n  Serial.print(\"Message:\");\n  for (int i = 0; i &lt; length; i++) {\n      Serial.print((char) payload[i]);\n  }\n  Serial.println();\n  Serial.println(\"-----------------------\");\n}\n\nvoid setup() {\n    // Set software serial baud to 115200;\n    Serial.begin(115200);\n    // Connecting to a WiFi network\n    WiFi.begin(ssid, password);\n    while (WiFi.status() != WL_CONNECTED) {\n        delay(500);\n        Serial.println(\"Connecting to WiFi..\");\n    }\n    Serial.println(\"Connected to the Wi-Fi network\");\n    //connecting to a mqtt broker\n    client.setServer(mqtt_broker, mqtt_port);\n    client.setCallback(callback);\n    while (!client.connected()) {\n        String client_id = \"esp32-client-\";\n        client_id += String(WiFi.macAddress());\n        Serial.printf(\"The client %s connects to the public MQTT broker\\n\", client_id.c_str());\n        if (client.connect(client_id.c_str())) {\n            Serial.println(\"Public EMQX MQTT broker connected\");\n        } else {\n            Serial.print(\"failed with state \");\n            Serial.print(client.state());\n            delay(2000);\n        }\n    }\n    // Publish and subscribe\n    client.publish(topic, \"Hi, I'm ESP32 ^^\");\n    client.subscribe(topic);\n}\n\n\n\nvoid loop() {\n    client.loop();\n}\n</code></pre>","tags":["arduino","mqtt","PubSubClient","Mosquito"]},{"location":"Embedded/arduino/arduino_mqtt/#usage","title":"usage","text":"<pre><code>mosquitto_sub -t \"mqtt/esp32\"\n</code></pre>","tags":["arduino","mqtt","PubSubClient","Mosquito"]},{"location":"Embedded/arduino/arduino_mqtt/#reference","title":"Reference","text":"<ul> <li>MQTT on ESP32: A Beginner's Guide</li> <li>PubSibClient API</li> </ul>","tags":["arduino","mqtt","PubSubClient","Mosquito"]},{"location":"Embedded/arduino/arduino_web_rest_server/","title":"Implement RESET Server using Arduino on ESP32 board","text":"<p>Using esp32 board with arduino platform to create REST server</p> <p>BOM</p> esp32 seeed_xiao_esp32s3","tags":["arduino","esp32","web","REST"]},{"location":"Embedded/arduino/arduino_web_rest_server/#init-project","title":"init project","text":"<pre><code>[env:seeed_xiao_esp32]\nplatform = espressif32\nboard = seeed_xiao_esp32s3\nframework = arduino\nlib_deps = bblanchon/ArduinoJson@^7.3.0\n</code></pre>","tags":["arduino","esp32","web","REST"]},{"location":"Embedded/arduino/arduino_web_rest_server/#init-vscode-project","title":"init vscode project","text":"<p>Create vscode <code>c_cpp_properties.json</code> for declared board in the platformio.ini files</p> <pre><code>pio init --ide vscode\n</code></pre>","tags":["arduino","esp32","web","REST"]},{"location":"Embedded/arduino/arduino_web_rest_server/#install-libraries","title":"Install libraries","text":"<pre><code>pio lib install bblanchon/ArduinoJson@^7.3.0\n</code></pre>","tags":["arduino","esp32","web","REST"]},{"location":"Embedded/arduino/arduino_web_rest_server/#rest-app","title":"REST App","text":"<ul> <li>Simple code that init the wifi and create GET REST api <code>getValues</code> that return json</li> </ul> code <pre><code>#include &lt;Arduino.h&gt;\n#include &lt;WiFi.h&gt;\n#include &lt;WebServer.h&gt;\n#include &lt;ArduinoJson.h&gt;\n\n#pragma region consts\nconst char* ssid = \"xxx\";\nconst char* password = \"xxxx\";\n#pragma endregion\n\n#pragma region globals\nWebServer server(80);\nStaticJsonDocument&lt;1024&gt; jsonDocument;\nchar buffer[1024];\n#pragma endregion\n\n#pragma region REST API\nvoid getValues(){\n  Serial.println(\"get all values\");\n  jsonDocument.clear();\n    jsonDocument[\"name\"] = \"hello\";\n  serializeJson(jsonDocument, buffer);\n    server.send(200, \"application/json\", buffer);\n}\nvoid setupApi() {\n  server.on(\"/getValues\", getValues);\n  // server.on(\"/setStatus\", HTTP_POST, handlePost);\n\n  // start server\n  server.begin();\n}\n\n#pragma endregion REST API\n\n#pragma region init\nvoid initWiFi() {\n  WiFi.mode(WIFI_STA);\n  WiFi.begin(ssid, password);\n  Serial.print(\"Connecting to WiFi ..\");\n  while (WiFi.status() != WL_CONNECTED) {\n    Serial.println(\".!\");\n    delay(1000);\n  }\n  Serial.println(WiFi.localIP());\n\n}\n#pragma endregion\n\nvoid setup() {\n  Serial.begin(115200);\n  initWiFi();\n  Serial.print(\"RRSI: \");\n  Serial.println(WiFi.RSSI());\n  setupApi();\n}\n\nvoid loop() {\n  server.handleClient();\n}\n</code></pre>","tags":["arduino","esp32","web","REST"]},{"location":"Embedded/arduino/arduino_web_rest_server/#build-and-upload","title":"build and upload","text":"<pre><code># build\npio run\n\n# upload\npio run --target upload\n</code></pre>","tags":["arduino","esp32","web","REST"]},{"location":"Embedded/arduino/arduino_web_rest_server/#usage","title":"usage","text":"<pre><code>http://10.100.102.24/getValues\n</code></pre>","tags":["arduino","esp32","web","REST"]},{"location":"Embedded/arduino/arduino_web_rest_server/#add-post","title":"Add POST","text":"Post <pre><code>void handlePost() {\n  if (server.hasArg(\"plain\")) {  // Check if there is a body\n      String message = server.arg(\"plain\");  // Get POST body\n      deserializeJson(jsonDocument, message);\n      Serial.println(\"Received POST Data: \" + message);\n      Serial.println(\"Received json Data: \" + String((const char*)jsonDocument[\"cmd\"]));\n      server.send(HTTP_OK, CONTENT_TYPE, \"{\\\"status\\\":\\\"success\\\"}\");\n  } else {\n      server.send(HTTP_ERROR, \"text/plain\", \"Bad Request\");\n  }\n}\n\nvoid setupApi() {\n    server.on(\"/getValues\", getValues);\n    server.on(\"/setStatus\", HTTP_POST, handlePost);\n\n    server.begin();\n}\n</code></pre>","tags":["arduino","esp32","web","REST"]},{"location":"Embedded/arduino/arduino_web_rest_server/#usage_1","title":"usage","text":"<pre><code>curl -X POST http://10.100.102.24/setStatus \\\n     -H \"Content-Type: application/json\" \\\n     -d '{\"cmd\": \"value\"}'\n\n# result\n{\"status\":\"success\"}(venv)\n</code></pre>","tags":["arduino","esp32","web","REST"]},{"location":"Embedded/arduino/arduino_web_rest_server/#reference","title":"Reference","text":"<ul> <li>ESP32 Useful Wi-Fi Library Functions </li> <li>How to build a REST API server with ESP32user</li> </ul>","tags":["arduino","esp32","web","REST"]},{"location":"Embedded/arduino/libraries/","title":"Arduino libraries","text":"<ul> <li>Arduino Json</li> </ul>","tags":["arduino","libraries"]},{"location":"Embedded/arduino/libraries/arduino_jeson/","title":"ArduinoJson","text":"<p>Read and more</p>","tags":["arduino","json","library"]},{"location":"Embedded/arduino/libraries/arduino_jeson/#demos","title":"Demos","text":"","tags":["arduino","json","library"]},{"location":"Embedded/arduino/libraries/arduino_jeson/#deserialization","title":"Deserialization","text":"platformio ini     Using ESP32 hardware   <pre><code>[env:seeed_xiao]\nplatform = espressif32\nplatform_packages=\n  framework-arduinoespressif32 @ https://github.com/espressif/arduino-esp32.git#3.0.3\n  framework-arduinoespressif32-libs @ https://github.com/espressif/arduino-esp32/releases/download/3.0.3/esp32-arduino-libs-3.0.3.zip\n\nboard = seeed_xiao_esp32s3\nframework = arduino\nupload_port = /dev/ttyACM0\nmonitor_speed = 115200\n\nlib_deps =\n    bblanchon/ArduinoJson\n</code></pre> <ul> <li>Parser json demo</li> </ul>","tags":["arduino","json","library"]},{"location":"Embedded/arduino/platformio/","title":"Platformio","text":"","tags":["platformio","arduino"]},{"location":"Embedded/arduino/platformio/#arduino","title":"Arduino","text":"","tags":["platformio","arduino"]},{"location":"Embedded/arduino/platformio/#esp32","title":"ESP32","text":"<p>The Arduino framework for ESP32 is actually a wrapper around the Espressif ESP-IDF. This means that while you write Arduino-style code (setup() and loop() functions), under the hood, ESP-IDF components handle tasks like Wi-Fi, Bluetooth, and RTOS scheduling. Arduino ESP32</p>","tags":["platformio","arduino"]},{"location":"Embedded/arduino/platformio/#config","title":"Config","text":"<pre><code>[env:esp32dev]\nplatform = espressif32\nboard = esp32dev\nframework = arduino\nmonitor_speed = 115200\nupload_speed = 921600\n</code></pre> <p>Upgrade Arduino ESP32 version</p> <ul> <li>framework-arduinoespressif32: core Arduino-ESP32 framework package</li> <li>framework-arduinoespressif32-libs: additional precompiled libraries that can speed up compilation.</li> </ul> <pre><code>[env:esp32dev]\nplatform = espressif32\nplatform_packages=\nframework-arduinoespressif32 @ https://github.com/espressif/arduino-esp32.git#3.0.3\nframework-arduinoespressif32-libs @ https://github.com/espressif/arduino-esp32/releases/download/3.0.3/esp32-arduino-libs-3.0.3.zip\nboard = esp32dev\nframework = arduino\n</code></pre>","tags":["platformio","arduino"]},{"location":"Embedded/arduino/vscode_dev/","title":"Using VSCode with platformio cli as Arduino dev environment","text":"<p>Using Platformio CLI to develop, build, and upload firmware for embedded systems</p> <p>Platformio VSCode extension</p> <p>Graphical interface that integrates with VS Code for an easier development experience.</p>","tags":["arduino","dev","vscode","pio","platformio"]},{"location":"Embedded/arduino/vscode_dev/#install","title":"Install","text":"<pre><code>pip install platformio\n</code></pre>","tags":["arduino","dev","vscode","pio","platformio"]},{"location":"Embedded/arduino/vscode_dev/#basic-command-cheat","title":"Basic command cheat","text":"Command Description pio project init --board  Create a new project pio lib install  Install libraries pio run Build firmware pio run --target upload Upload code to the board pio device monitor Open Serial Monitor pio run --target clean   Clean compiled files","tags":["arduino","dev","vscode","pio","platformio"]},{"location":"Embedded/arduino/vscode_dev/#init-project","title":"Init project","text":"<pre><code>pio project init --board &lt;board name&gt;\n</code></pre> <pre><code># search for arduino mega 2560 atmelmegaavr bord\npio boards | grep -i mega | grep 2560\n\n# select megaatmega2560 from the list\n\npio project init --board megaatmega2560\n</code></pre>","tags":["arduino","dev","vscode","pio","platformio"]},{"location":"Embedded/arduino/vscode_dev/#project-struct","title":"Project struct","text":"<pre><code>\u251c\u2500\u2500 .vscode\n|        \u2514\u2500\u2500 c_cpp_properties.json\n\u251c\u2500\u2500 include\n|        \u2514\u2500\u2500 helper.hpp\n\u251c\u2500\u2500 lib                                # External libraries (if manually added)\n\u251c\u2500\u2500 platformio.ini                     # PlatformIO configuration file\n\u251c\u2500\u2500 README.md\n\u251c\u2500\u2500 src\n|    \u251c\u2500\u2500 helper.cpp\n|    \u2514\u2500\u2500 main.cpp\n\u2514\u2500\u2500 test\n</code></pre> <p>create c_cpp_properties.json</p> <pre><code>pio init --ide vscode\n</code></pre> <p>code organize</p> <ul> <li>include libraries</li> <li>defines and constants</li> <li>global variables</li> <li>user defined function or function signatures</li> <li>setup</li> <li>loop</li> </ul>","tags":["arduino","dev","vscode","pio","platformio"]},{"location":"Embedded/arduino/vscode_dev/#demo","title":"Demo","text":"<p>Use blink LED demo to learn how to split project to</p> <ul> <li>Multiple file</li> <li>Create Library</li> <li>Arduino OOP</li> </ul>","tags":["arduino","dev","vscode","pio","platformio"]},{"location":"Embedded/arduino/vscode_dev/#multiple-files","title":"Multiple files","text":"<p>Split utils function to header and code good reference</p>","tags":["arduino","dev","vscode","pio","platformio"]},{"location":"Embedded/arduino/vscode_dev/#project","title":"Project","text":"<pre><code>\u251c\u2500\u2500 include\n\u2502   \u2514\u2500\u2500 led_function.hpp\n\u251c\u2500\u2500 platformio.ini\n\u2514\u2500\u2500 src\n    \u251c\u2500\u2500 led_function.cpp\n    \u2514\u2500\u2500 main.cpp\n</code></pre> lef_function.hpp<pre><code>#ifndef LED_FUNCTUIN_H\n#define LED_FUNCTUIN_H\n\n#include &lt;Arduino.h&gt;\n\nvoid powerOnLed(byte pin);\nvoid powerOffLed(byte pin);\n\n#endif\n</code></pre> lef_function.cpp<pre><code>#include \"led_function.hpp\"\n\nvoid powerOnLed(byte pin){\n    digitalWrite(pin, HIGH);   // Turn the LED on\n  }\n\n  void powerOffLed(byte pin){\n    digitalWrite(pin, LOW);   // Turn the LED on\n  }\n</code></pre> main.cpp<pre><code>#include &lt;Arduino.h&gt;\n#include \"led_function.hpp\"\n\n# define LED_PIN 13\n\nvoid setup() {\n  Serial.begin(115200);\n  // Print log\n  Serial.println(\"setup\");\n  pinMode(LED_PIN, OUTPUT);\n}\n\nvoid loop() {\n\n  powerOnLed(LED_PIN);\n  delay(1000);                   // Wait for a second\n  powerOffLed(LED_PIN);\n  delay(1000);                   // Wait for a second\n}\n</code></pre>","tags":["arduino","dev","vscode","pio","platformio"]},{"location":"Embedded/arduino/vscode_dev/#create-custom-library","title":"Create custom Library","text":"<p>Create an Arduino library</p>","tags":["arduino","dev","vscode","pio","platformio"]},{"location":"Embedded/arduino/vscode_dev/#todo-arduino-custom-library","title":"TODO: Arduino custom library","text":"","tags":["arduino","dev","vscode","pio","platformio"]},{"location":"Embedded/arduino/vscode_dev/#arduino-oop","title":"Arduino OOP","text":"<p>Arduino OOP [40-Minute Crash Course]</p>","tags":["arduino","dev","vscode","pio","platformio"]},{"location":"Embedded/arduino/vscode_dev/#todo-arduino-oop","title":"TODO: arduino OOP","text":"","tags":["arduino","dev","vscode","pio","platformio"]},{"location":"Embedded/hardware/","title":"Hardware io bards sensors and more","text":"<p>I2C MCP23017</p>","tags":["hardware","gpio","i2c"]},{"location":"Embedded/hardware/i2c_mcp23017/","title":"MCP23017 IO Expansion Board","text":"<p>MCP23017 IO Expansion Board, I2C Interface, Expands 16 I/O Pins</p> <ul> <li>16 GPIOs split into Port A (GPA0\u2013GPA7) and Port B (GPB0\u2013GPB7)</li> <li>Per-pin direction control (input or output)</li> <li>Internal pull-ups for inputs (ideal for buttons/switches)</li> <li>Interrupt support via INTA/INTB pins (or mirrored)</li> <li>Up to 8 devices on one I\u00b2C bus (addresses via A0\u2013A2)</li> <li>Operates at 3.3V or 5V (logic follows VDD)</li> </ul> <p></p>","tags":["i2c","hardware","smbus"]},{"location":"Embedded/hardware/i2c_mcp23017/#address","title":"Address","text":"","tags":["i2c","hardware","smbus"]},{"location":"Embedded/hardware/i2c_mcp23017/#connector","title":"Connector","text":"# name Color (PH2.0 20cm 6Pin x1) 1 vcc red 2 gnd black 3 SDA blue 4 SCL yellow 5 INTA orange 6 INTB green","tags":["i2c","hardware","smbus"]},{"location":"Embedded/hardware/i2c_mcp23017/#cp2112","title":"CP2112","text":"<p>The CP2112 USB-to-I2C Bridge is a communication device between a USB host (like a PC) and I2C devices</p> <p></p>","tags":["i2c","hardware","smbus"]},{"location":"Embedded/hardware/i2c_mcp23017/#install","title":"install","text":"<pre><code>sudo apt install i2c-tools\n</code></pre>","tags":["i2c","hardware","smbus"]},{"location":"Embedded/hardware/i2c_mcp23017/#usage","title":"usage","text":"<pre><code>i2cdetect -l\n#\ni2c-0   unknown     Synopsys DesignWare I2C adapter     N/A\ni2c-1   unknown     Synopsys DesignWare I2C adapter     N/A\n..\ni2c-21  unknown     CP2112 SMBus Bridge on hidraw6      N/A\n</code></pre> <pre><code>sudo i2cdetect -y -r 21\n#\n     0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f\n00:                         -- -- -- -- -- -- -- -- \n10: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- \n20: -- -- -- -- -- -- -- 27 -- -- -- -- -- -- -- -- \n30: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- \n40: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- \n50: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- \n60: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- \n</code></pre>","tags":["i2c","hardware","smbus"]},{"location":"Embedded/hardware/i2c_mcp23017/#output","title":"Output","text":"Register Use for Read gives <code>IODIRA</code> Direction 1=input, 0=output <code>GPPUA</code> Pull-ups Enabled bits <code>OLATA</code> Output latch Last written output values <code>GPIOA</code> Pin state Actual pin logic level <code>INTCAPA</code> Interrupt snapshot Pin state at interrupt <p>OLATA vs GPIOA</p> <ul> <li>To CONTROL pins \u2192 OLATA</li> <li>To OBSERVE pins \u2192 GPIOA</li> </ul>","tags":["i2c","hardware","smbus"]},{"location":"Embedded/hardware/i2c_mcp23017/#i2c-tools","title":"i2c-tools","text":"<pre><code>sudo apt install i2c-tools\n</code></pre> i2cset cli<pre><code>i2cset [OPTIONS] BUS SLAVE_ADDR REGISTER VALUE [MODE]\n</code></pre> <p>1\ufe0f\u20e3 IODIRA(0x00) \u2014 I/O Direction Register (Port A) IODIRA controls whether each Port A pin is an input or output.</p> <ul> <li>Address: 0x00</li> <li>Reset value: 0xFF (all inputs)</li> </ul> <pre><code>Bit = 1 \u2192 INPUT  (output driver OFF, Hi-Z)\nBit = 0 \u2192 OUTPUT (output driver ON)\n</code></pre>","tags":["i2c","hardware","smbus"]},{"location":"Embedded/hardware/i2c_mcp23017/#demo","title":"Demo","text":"<ul> <li>Config GPA0 as output 0xFE using IODIRA register</li> <li>Set/ Unset output value using register OLATA register</li> </ul> <pre><code># i2cset [OPTIONS] BUS SLAVE_ADDR REGISTER VALUE [MODE]\nsudo i2cset -y 21 0x27 0x00 0xFE b\nsudo i2cset -y 21 0x27 0x14 0x01 b\nsudo i2cset -y 21 0x27 0x14 0x00 b\n</code></pre>","tags":["i2c","hardware","smbus"]},{"location":"Embedded/hardware/i2c_mcp23017/#input","title":"Input","text":"","tags":["i2c","hardware","smbus"]},{"location":"Embedded/hardware/i2c_mcp23017/#demo_1","title":"Demo:","text":"<ul> <li>Config GPA1 as input</li> <li>Config it as pull-up: <code>GPA1 ----[ button ]---- GND</code></li> <li>Create poll loop </li> </ul> init<pre><code># config GPA1 as input\n#bus: 21 address:0x27 IODIRA: 0x00 GPIA1: bit (1) 0x02\ni2cset -y 21 0x27 0x00 0x02 b\n\n# config GPA1 as pull up\n# GPPUA register: 0x0c\ni2cset -y 21 0x27 0x0C 0x02 b\n</code></pre> poll_loop.sh<pre><code>#/bin/bash\ni2cset -y 21 0x27 0x00 0x02\ni2cset -y 21 0x27 0x0C 0x02\n\nlast=\"\"\n\nwhile true; do\n  v=$(i2cget -y 21 0x27 0x12)\n  # convert hex string (0x..) to number\n  n=$((v))\n\n  if [ $((n &amp; 0x02)) -eq 0 ]; then\n    s=\"pressed\"\n  else\n    s=\"released\"\n  fi\n\n  if [ \"$s\" != \"$last\" ]; then\n    echo \"$s ($v)\"\n    last=\"$s\"\n  fi\n\n  sleep 0.05\ndone\n</code></pre>","tags":["i2c","hardware","smbus"]},{"location":"Embedded/hardware/i2c_mcp23017/#todo-implement-int-on-rpi-and-jetson-board","title":"TODO: implement INT on rpi and jetson board","text":"","tags":["i2c","hardware","smbus"]},{"location":"Embedded/hardware/i2c_mcp23017/#python","title":"Python","text":"blink LED<pre><code>from smbus2 import SMBus\nimport time\n\n\nADDRESS = 0x27\nBUS = 21\nREG_IODIRA = 0x00\nREG_OLATA = 0x14\nGPA0 = 0x01\n\n# Initialize SMBus\nbus = SMBus(BUS)\n# Set GPA0 as output\niodir = bus.read_byte_data(ADDRESS, REG_IODIRA)\niodir &amp;= ~GPA0\nbus.write_byte_data(ADDRESS, REG_IODIRA, iodir)\n\nwhile True:\n    # Read current OLATA value\n    olata = bus.read_byte_data(ADDRESS, REG_IODIRA)\n    # Set GPA0 high\n    olata |= GPA0\n    # Write OLATA with GPA0 high\n    bus.write_byte_data(ADDRESS, REG_OLATA, olata)  # OLATA\n    time.sleep(1)\n    olata = bus.read_byte_data(ADDRESS, REG_IODIRA)\n    # Set GPA0 low\n    olata &amp;= ~GPA0\n    # Write OLATA with GPA0 low\n    bus.write_byte_data(ADDRESS, REG_OLATA, olata)  # OLATA\n    time.sleep(1)\n</code></pre>","tags":["i2c","hardware","smbus"]},{"location":"Embedded/hardware/i2c_mcp23017/#todo","title":"TODO","text":"<ul> <li>implement interrupt using rpi</li> <li>implement python simple pool</li> </ul>","tags":["i2c","hardware","smbus"]},{"location":"Embedded/hardware/i2c_mcp23017/#reference","title":"Reference","text":"<ul> <li>mcp23017 datasheet</li> <li>MCP23017 IO Expansion Board</li> </ul>","tags":["i2c","hardware","smbus"]},{"location":"Embedded/micro_python/","title":"Micro Python","text":"<p>MicroPython is a lean and efficient implementation of the Python 3 programming language that includes a small subset of the Python standard library and is optimised to run on microcontrollers and in constrained environments. more</p> <p>RPI Pico</p> <p></p> <p></p>","tags":["micro python","esp32","thonny"]},{"location":"Embedded/micro_python/pico/","title":"Raspberry PI pico with MicroPython","text":"","tags":["pico","micropython"]},{"location":"Embedded/micro_python/pico/#install","title":"Install","text":"<p>Download , boot with bootsel press and drag it to mass storage</p>","tags":["pico","micropython"]},{"location":"Embedded/micro_python/pico/#pinout","title":"Pinout","text":"","tags":["pico","micropython"]},{"location":"Embedded/micro_python/pico/#thonny","title":"Thonny","text":"","tags":["pico","micropython"]},{"location":"Embedded/micro_python/pico/#demo-blink-led","title":"Demo: blink led","text":"blink<pre><code>from machine import Pin\nfrom time import sleep\n\nled = Pin(\"LED\", Pin.OUT)\n\nwhile True:\n    led.toggle()\n    sleep(1)        # Wait 1 second\n</code></pre>","tags":["pico","micropython"]},{"location":"Embedded/micro_python/pico/#demo-web-server","title":"Demo: Web Server","text":"<ul> <li>install micodot library</li> <li>set wlan using network library</li> </ul> <pre><code># default port 5000\nimport network\nimport time\nimport asyncio\nfrom microdot import Microdot\n\n# === Connect to Wi-Fi ===\nssid = '&lt;ssid&gt;'\npassword = '&lt;pass&gt;'\n\nwlan = network.WLAN(network.STA_IF)\nwlan.active(True)\nwlan.connect(ssid, password)\n\nprint('Connecting to WiFi...', end='')\nwhile not wlan.isconnected():\n    print('.', end='')\n    time.sleep(1)\n\nprint('\\nConnected. IP:', wlan.ifconfig()[0])\n\napp = Microdot()\n\n@app.route('/')\nasync def index(request):\n    return 'Hello, world!'\n\nasync def main():\n    # start the server in a background task\n    server = asyncio.create_task(app.start_server())\n\n    # ... do other asynchronous work here ...\n\n    # cleanup before ending the application\n    await server\n\nasyncio.run(main())\n</code></pre>","tags":["pico","micropython"]},{"location":"Embedded/other_boards/","title":"Index","text":"<p>Odroid</p> <p>TBD</p> <p>TBD</p>","tags":["embedded","boards"]},{"location":"Embedded/other_boards/odroid/","title":"Odroid","text":"<p>An affordable, power-efficient, high-performance Single Board Computer that supports Android and Linux platforms. more</p>","tags":["odroid","gpio","gpiod"]},{"location":"Embedded/other_boards/odroid/#install","title":"Install","text":"<ul> <li>docs</li> <li>Download os</li> </ul> <p>1.8 v</p> <p>All GPIO use 1.8 vdc for signaling Don't connect 3.3VDC or 5VDC</p> <p></p> <p></p>","tags":["odroid","gpio","gpiod"]},{"location":"Embedded/other_boards/odroid/#demo","title":"Demo","text":"<p>Mapping gpio name to gpiod command</p> <p>from the pinout table we locate ping 13 as GPX1.5 using <code>/sys/kernel/debug/gpio</code> we look for gpx1 pins</p> <pre><code>sudo cat /sys/kernel/debug/gpio | grep gpx\n#\ngpiochip1: GPIOs 8-15, parent: platform/13400000.pinctrl, gpx0:\ngpiochip2: GPIOs 16-23, parent: platform/13400000.pinctrl, gpx1:\ngpiochip3: GPIOs 24-31, parent: platform/13400000.pinctrl, gpx2:\ngpiochip4: GPIOs 32-39, parent: platform/13400000.pinctrl, gpx3:\n</code></pre> gpioinfo on gpiochip2<pre><code>sudo gpioinfo gpiochip2\n\ngpiochip2 - 8 lines:\n        line   0:      unnamed       unused   input  active-high \n        line   1:      unnamed       unused   input  active-high \n        line   2:      unnamed       unused   input  active-high \n        line   3:      unnamed       unused   input  active-high \n        line   4:      unnamed       unused   input  active-high \n        line   5:      unnamed       unused   input  active-high \n        line   6:      unnamed       unused   input  active-high \n        line   7:      unnamed       unused   input  active-high \n</code></pre> <p>1.8 v</p> <p>All GPIO use 1.8 vdc for signaling Don't connect 3.3VDC or 5VDC</p> gpioset<pre><code># toggle line5 to high (1.8v)\nsudo gpioset gpiochip2 5=1\n# toggle line5 to low\nsudo gpioset gpiochip2 5=0\n</code></pre> gpioinfo on gpiochip2 after the set command<pre><code>sudo gpioinfo gpiochip2\ngpiochip2 - 8 lines:\n        line   0:      unnamed       unused  output  active-high \n        line   1:      unnamed       unused   input  active-high \n        line   2:      unnamed       unused   input  active-high \n        line   3:      unnamed       unused   input  active-high \n        line   4:      unnamed       unused   input  active-high \n        line   5:      unnamed       unused  output  active-high \n        line   6:      unnamed       unused   input  active-high \n        line   7:      unnamed       unused   input  active-high \n</code></pre>","tags":["odroid","gpio","gpiod"]},{"location":"Embedded/other_boards/odroid/#demo-do-it-again","title":"Demo: do it again","text":"<pre><code>sudo cat /sys/kernel/debug/gpio | grep gpx\n#\ngpiochip1: GPIOs 8-15, parent: platform/13400000.pinctrl, gpx0:\ngpiochip2: GPIOs 16-23, parent: platform/13400000.pinctrl, gpx1:\ngpiochip3: GPIOs 24-31, parent: platform/13400000.pinctrl, gpx2:\ngpiochip4: GPIOs 32-39, parent: platform/13400000.pinctrl, gpx3:\n</code></pre> <p>from the pinout table we locate ping 19 as GPX2.6</p> gpioset<pre><code># toggle line5 to high (1.8v)\nsudo gpioset gpiochip3 6=1\n# toggle line5 to low\nsudo gpioset gpiochip3 6=0\n</code></pre>","tags":["odroid","gpio","gpiod"]},{"location":"Embedded/tiny_ml/","title":"TinyML","text":"","tags":["tinyml"]},{"location":"Embedded/tiny_ml/#tensorflow-light","title":"Tensorflow light","text":"<pre><code>pip3 install tensorflow\npip3 install tflite-runtime\n</code></pre>","tags":["tinyml"]},{"location":"Embedded/tiny_ml/#resources","title":"Resources","text":"<ul> <li> Building with TensorFlow Lite for microcontrollers | Workshop </li> <li>IoT and Tiny Machine Learning (Spring 2024)</li> </ul>","tags":["tinyml"]},{"location":"Embedded/tiny_ml/xiao/","title":"TinyML","text":"","tags":["tiny_ml","xiao","tf-lite"]},{"location":"Embedded/tiny_ml/xiao/#hardware","title":"Hardware","text":"<p>Seeed Studio XIAO ESP32S3</p> <p></p> <p></p> blink code simple blink<pre><code>#include &lt;Arduino.h&gt;\n\nconst int ledPin = 21; // Change this to the pin your LED is connected to\n\nvoid setup() {\n    pinMode(ledPin, OUTPUT);\n}\n\nvoid loop() {\n    digitalWrite(ledPin, HIGH); // Turn the LED on\n    delay(1000);                // Wait for a second\n    digitalWrite(ledPin, LOW);  // Turn the LED off\n    delay(1000);                // Wait for a second\n}\n</code></pre> platformio.ini<pre><code>[env:seeed_xiao_esp32s3]\nplatform = espressif32\nplatform_packages=\n  framework-arduinoespressif32 @ https://github.com/espressif/arduino-esp32.git#3.0.3\n  framework-arduinoespressif32-libs @ https://github.com/espressif/arduino-esp32/releases/download/3.0.3/esp32-arduino-libs-3.0.3.zip\n\nboard = seeed_xiao_esp32s3\nframework = arduino\n</code></pre>","tags":["tiny_ml","xiao","tf-lite"]},{"location":"Other/","title":"Other","text":"<p>GStreamer</p> <p>markdown </p> <p>Block 3 Description</p> <p>TODO</p> <p>courses and books</p> <p>Presentation</p>"},{"location":"Other/Gstreamer/","title":"GStreamer","text":"<p>Element and Pipes</p> <p>mpegts</p> <p>python_bindings</p>"},{"location":"Other/Gstreamer/#more-examples","title":"More examples","text":"<ul> <li>rtsp server exemple</li> <li>Video stream pipes</li> <li>pipes examples</li> </ul>"},{"location":"Other/Gstreamer/gst_stream_pipes/","title":"GStreamer video stream pipe","text":"<p>Using gstreamer to stream h264/h265 over network</p>","tags":["gstreamer","streaming","h265","h264"]},{"location":"Other/Gstreamer/gst_stream_pipes/#h265-cpu-encoder","title":"H265 cpu encoder","text":"<pre><code>gst-launch-1.0 videotestsrc \\\n! video/x-raw, width=640, height=480, framerate=30/1, format=I420 \\\n! videoconvert \\\n! x265enc tune=zerolatency speed-preset=ultrafast key-int-max=30 bitrate=500 \\\n! rtph265pay config-interval=1 mtu=1400 \\\n! udpsink host=127.0.0.1 port=5000 sync=true\n</code></pre> property description more ... config-interval Send VPS, SPS and PPS Insertion Interval in seconds (default 0) help decoder to interpret video stream key-int-max defines the maximum interval between keyframes, keyframes: is a full image <pre><code>## receive\ngst-launch-1.0 udpsrc port=5000 \\\n! application/x-rtp, encoding-name=H265, payload=96 \\\n! rtpjitterbuffer latency=10 \\\n! rtph265depay \\\n! decodebin \\\n! fpsdisplaysink sync=true\n</code></pre>","tags":["gstreamer","streaming","h265","h264"]},{"location":"Other/Gstreamer/gst_stream_pipes/#h265-nvidia-jetson","title":"H265 nvidia jetson","text":"<pre><code>gst-launch-1.0 videotestsrc ! video/x-raw, width=640, height=480, framerate=30/1, format=I420 \\\n! nvvidconv ! 'video/x-raw(memory:NVMM)' \\\n! nvv4l2h265enc preset-level=UltraFastPreset \\\nbitrate=500000 vbv-size=500000 control-rate=GST_V4L2_VIDENC_CONSTANT_BITRATE \\\n! rtph265pay config-interval=1 \\\n! udpsink host=10.0.0.1 port=5000 sync=true\n</code></pre> property description more ... vbv-size Control the encoder buffer size, affecting bitrate variability Smaller values = Stable bitrate (good for live streaming) <pre><code>## receive\ngst-launch-1.0 udpsrc port=5000 \\\n! application/x-rtp, encoding-name=H265, payload=96 \\\n! rtpjitterbuffer latency=10 \\\n! rtph265depay \\\n! decodebin \\\n! fpsdisplaysink sync=true\n</code></pre>","tags":["gstreamer","streaming","h265","h264"]},{"location":"Other/Gstreamer/gst_stream_pipes/#multicast","title":"Multicast","text":"<p>IPv4 multicast address define from <code>222.0.0.0</code> to <code>239.255.255.255</code></p> <p>To Stream over multicast just change the ip to multicast range udpsink support multicast by default</p> <p>lo multicast</p> <p>By default multicast disabled on LO</p> <pre><code>#check \nifconfig lo | grep -i multicast\n\n# enable\nsudo ifconfig lo multicast\n#or\nsudo ip list set lo multicast on\n</code></pre> <pre><code>gst-launch-1.0 videotestsrc \\\n! video/x-raw, width=640, height=480, framerate=30/1, format=I420 \\\n! videoconvert \\\n! x265enc tune=zerolatency speed-preset=ultrafast key-int-max=30 bitrate=500 \\\n! rtph265pay config-interval=1 mtu=1400 \\\n! udpsink host=224.0.0.1 port=5000 sync=true\n</code></pre>","tags":["gstreamer","streaming","h265","h264"]},{"location":"Other/Gstreamer/gst_stream_pipes/#h264","title":"H264","text":"sender<pre><code>gst-launch-1.0 videotestsrc is-live=true \\\n! video/x-raw,width=640,height=480,framerate=20/1 \\\n! videoconvert \\\n! x264enc tune=zerolatency speed-preset=ultrafast bitrate=500 key-int-max=20 \\\n! rtph264pay config-interval=1 pt=96 \\\n! udpsink host=127.0.0.1 port=5000 sync=true\n</code></pre> receiver<pre><code>gst-launch-1.0 udpsrc port=5000 caps=\"application/x-rtp, media=video, encoding-name=H264, payload=96\" \\\n! rtph264depay \\\n! avdec_h264 \\\n! videoconvert \\\n! autovideosink sync=true\n</code></pre> <p>Fast sync between sender and receiver</p> <p>The idea H264/H265 is to send full frame in intervals and between the send partial changes</p> <ul> <li>I-frames: (keyframe) full image</li> <li>P-frames:</li> <li>B-frames:</li> </ul> <p>x264 uses adaptive keyframe intervals, which can go very long without IDRs (especially for static syne) The receiver wait for i-frame to sync and it can take 6-8 sec when we are in static sync use key-int-max=20 force the encoder to send i-frame each 30 frames, in 20 fps rate it send full image every 1 sec.</p>","tags":["gstreamer","streaming","h265","h264"]},{"location":"Other/Gstreamer/pipes_examples/","title":"Gstreamer pipes example","text":"","tags":["gstreamer","pipes","demos"]},{"location":"Other/Gstreamer/pipes_examples/#control-framerate","title":"Control framerate","text":"<p>Control 60hz source and reduce stream to 10 hz Queue save only the newest frames</p> <pre><code>gst-launch-1.0 v4l2src device=/dev/video4 \\\n! video/x-raw,width=640,height=480,framerate=60/1 \\\n! videoconvert \\\n! queue max-size-buffers=1 leaky=downstream \\\n! videorate \\\n! video/x-raw,framerate=10/1 \\\n! fpsdisplaysink\n</code></pre>","tags":["gstreamer","pipes","demos"]},{"location":"Other/Gstreamer/pipes_examples/#capture-one-image-from-camera","title":"Capture one image from camera","text":"<pre><code>gst-launch-1.0 v4l2src device=/dev/video0 num-buffers=1 \\\n! video/x-raw \\\n! jpegenc \\\n! filesink location=frame.jpg\n</code></pre>","tags":["gstreamer","pipes","demos"]},{"location":"Other/Gstreamer/c_bindings/","title":"Gstreamer c/cpp bindings","text":"<p>```bash titlle=\"install dependencies\" sudo apt install -y \\     libgstreamer1.0-dev \\     libgstreamer-plugins-base1.0-dev <pre><code>```c\n#include &lt;gst/gst.h&gt;\n#include &lt;glib.h&gt;\n#include &lt;iostream&gt;\n\nstatic void on_error(\n    GstBus *bus,\n    GstMessage *msg,\n    gpointer user_data)\n{\n    GMainLoop *loop = static_cast&lt;GMainLoop *&gt;(user_data);\n\n    GError *err = nullptr;\n    gchar *debug = nullptr;\n    gst_message_parse_error(msg, &amp;err, &amp;debug);\n\n    std::cerr &lt;&lt; \"ERROR: \" &lt;&lt; err-&gt;message &lt;&lt; std::endl;\n    if (debug)\n        std::cerr &lt;&lt; \"Debug info: \" &lt;&lt; debug &lt;&lt; std::endl;\n\n    g_error_free(err);\n    g_free(debug);\n\n    g_main_loop_quit(loop);\n}\n\nstatic void on_eos(\n    GstBus *bus,\n    GstMessage *msg,\n    gpointer user_data)\n{\n    GMainLoop *loop = static_cast&lt;GMainLoop *&gt;(user_data);\n    std::cout &lt;&lt; \"EOS\" &lt;&lt; std::endl;\n    g_main_loop_quit(loop);\n}\n\nint main(int argc, char *argv[])\n{\n    gst_init(&amp;argc, &amp;argv);\n\n    GMainLoop *loop = g_main_loop_new(nullptr, FALSE);\n\n    GstElement *pipeline =\n        gst_parse_launch(\"videotestsrc ! autovideosink\", nullptr);\n\n    GstBus *bus = gst_element_get_bus(pipeline);\n\n    /* Attach bus to GLib signals (no manual polling) */\n    gst_bus_add_signal_watch(bus);\n\n    g_signal_connect(\n        bus, \"message::error\",\n        G_CALLBACK(on_error), loop);\n\n    g_signal_connect(\n        bus, \"message::eos\",\n        G_CALLBACK(on_eos), loop);\n\n    gst_object_unref(bus);\n\n    gst_element_set_state(pipeline, GST_STATE_PLAYING);\n\n    g_main_loop_run(loop);\n\n    gst_element_set_state(pipeline, GST_STATE_NULL);\n    gst_object_unref(pipeline);\n    g_main_loop_unref(loop);\n\n    return 0;\n}\n</code></pre></p> <pre><code>cmake_minimum_required(VERSION 3.16)\nproject(gstreamer_cpp_example LANGUAGES C CXX)\n\nset(CMAKE_CXX_STANDARD 17)\nset(CMAKE_CXX_STANDARD_REQUIRED ON)\n\n# Find GStreamer\nfind_package(PkgConfig REQUIRED)\npkg_check_modules(GST REQUIRED\n    gstreamer-1.0\n    gstreamer-base-1.0\n)\n\nadd_executable(gst_example main.cpp)\n\ntarget_include_directories(gst_example PRIVATE\n    ${GST_INCLUDE_DIRS}\n)\n\ntarget_link_libraries(gst_example\n    ${GST_LIBRARIES}\n)\n\n# Needed on some systems\ntarget_compile_options(gst_example PRIVATE\n    ${GST_CFLAGS_OTHER}\n)\n</code></pre>","tags":["gstreamer","bindings"]},{"location":"Other/Gstreamer/deepstream/","title":"Deepstream","text":"<pre><code>docker run -it --rm --network=host \\\n  --runtime=nvidia \\\n  --ipc=host \\\n  -e DISPLAY=$DISPLAY \\\n  -e QT_X11_NO_MITSHM=1 \\\n  -e LIBGL_ALWAYS_INDIRECT=1 \\\n  -e NVIDIA_DRIVER_CAPABILITIES=all \\\n  -v /tmp/.X11-unix:/tmp/.X11-unix \\\nnvcr.io/nvidia/deepstream:8.0-samples-multiarch\n</code></pre> <pre><code>gst-launch-1.0 videotestsrc is-live=true ! nvvideoconvert ! nveglglessink sync=false\n</code></pre> <pre><code>version: \"3.9\"\n\nservices:\n  gst:\n    image: nvcr.io/nvidia/deepstream:8.0-samples-multiarch\n    runtime: nvidia\n    network_mode: host\n    ipc: host\n    shm_size: 1gb\n    environment:\n      DISPLAY: ${DISPLAY}\n      NVIDIA_DRIVER_CAPABILITIES: all\n    volumes:\n      - /tmp/.X11-unix:/tmp/.X11-unix\n      - /dev/shm:/dev/shm\n</code></pre>","tags":["Deepstream"]},{"location":"Other/Gstreamer/gstreamer/","title":"Gstreamer","text":"<p>gstreamer debug and trace</p> <p>gstreamer clock</p> <p>h264</p> <p>compositor</p> <p>selector</p> <p>cario</p> <p>text</p>","tags":["gstreamer","compositor"]},{"location":"Other/Gstreamer/gstreamer/#resource","title":"Resource","text":"<ul> <li>intel deep learning streamer</li> </ul>","tags":["gstreamer","compositor"]},{"location":"Other/Gstreamer/gstreamer/clock/","title":"GStreamer clock","text":"<p>The GStreamer clock is the global time reference that the pipeline uses to decide:</p> <p>WHEN each buffer should be processed, rendered, or sent</p> <p>Without a clock: - Buffers would flow as fast as possible - Video would play too fast - Audio/video would drift - Network streams would burst</p> <p>The clock allows: - Real-time playback - Audio \u2194 video sync - Smooth network pacing</p>","tags":["gstreamer","clock","pts","dts"]},{"location":"Other/Gstreamer/gstreamer/clock/#demo-play-mp4-file","title":"Demo: play mp4 file","text":"<p>Change <code>autovideosink</code> sync - True (default) use clock to play the video - False: play the video as fast as possible</p> <pre><code>gst-launch-1.0 filesrc location=video.mp4 \\\n! decodebin \\\n! videoconvert \\\n! autovideosink sync=false\n</code></pre>","tags":["gstreamer","clock","pts","dts"]},{"location":"Other/Gstreamer/gstreamer/clock/#clock-timestamps-critical-pair","title":"Clock + timestamps (critical pair)","text":"<p>Every buffer may carry a timestamp:</p> <ul> <li>PTS \u2013 when to present</li> <li>DTS \u2013 when to decode</li> </ul> <p>The sink compares: buffer PTS  vs  pipeline clock time</p> <p>Decision:</p> <ul> <li>PTS &gt; now \u2192 wait</li> <li>PTS \u2248 now \u2192 render/send</li> <li>PTS &lt; now \u2192 late (drop or rush)</li> </ul> <p>This is why sync=true matters.</p>","tags":["gstreamer","clock","pts","dts"]},{"location":"Other/Gstreamer/gstreamer/clock/#clock-source","title":"Clock source","text":"<p>Only one element provides the clock.</p> <p>Clock provider priority: - Audio sink (most stable) - Live source (camera, mic, RTP) - System clock (fallback)</p>","tags":["gstreamer","clock","pts","dts"]},{"location":"Other/Gstreamer/gstreamer/clock/#clock-in-different-pipeline-types","title":"Clock in different pipeline types","text":"","tags":["gstreamer","clock","pts","dts"]},{"location":"Other/Gstreamer/gstreamer/clock/#file-playback","title":"File playback","text":"<ul> <li>No audio \u2192 system clock</li> <li>With audio \u2192 audio sink clock</li> </ul>","tags":["gstreamer","clock","pts","dts"]},{"location":"Other/Gstreamer/gstreamer/clock/#demo","title":"Demo","text":"the output from the above filesrc pipe<pre><code>Setting pipeline to PAUSED ...\nPipeline is PREROLLING ...\nRedistribute latency...\nGot context from element 'nvh264dec0': gst.cuda.context=context, gst.cuda.context=(GstCudaContext)\"\\(GstCudaContext\\)\\ cudacontext1\", cuda-device-id=(uint)0;\nRedistribute latency...\nRedistribute latency...\nPipeline is PREROLLED ...\nSetting pipeline to PLAYING ...\nRedistribute latency...\nNew clock: GstSystemClock\nRedistribute latency...\nGot EOS from element \"pipeline0\".\nExecution ended after 0:00:00.711912146\nSetting pipeline to NULL ...\nFreeing pipeline ..\n</code></pre>","tags":["gstreamer","clock","pts","dts"]},{"location":"Other/Gstreamer/gstreamer/clock/#camera","title":"Camera","text":"<ul> <li>Camera provides clock</li> <li>No preroll</li> </ul> <pre><code>gst-launch-1.0 v4l2src ! videoconvert ! autovideosink\n</code></pre>","tags":["gstreamer","clock","pts","dts"]},{"location":"Other/Gstreamer/gstreamer/clock/#rtp-udp-streaming","title":"RTP / UDP streaming","text":"","tags":["gstreamer","clock","pts","dts"]},{"location":"Other/Gstreamer/gstreamer/clock/#sender","title":"Sender","text":"<pre><code>appsrc is-live=true do-timestamp=true !\n...\nudpsink sync=true\n</code></pre> <ul> <li>Sender timestamps buffers</li> <li>Sink uses clock to pace packets</li> </ul>","tags":["gstreamer","clock","pts","dts"]},{"location":"Other/Gstreamer/gstreamer/clock/#receiver","title":"Receiver","text":"<pre><code>udpsrc !\nrtpjitterbuffer !\n...\nautovideosink\n</code></pre> <ul> <li>rtpjitterbuffer re-aligns timestamps</li> <li>Sink syncs to clock</li> </ul>","tags":["gstreamer","clock","pts","dts"]},{"location":"Other/Gstreamer/gstreamer/clock/#live-vs-non-live-sources-very-important","title":"Live vs non-live sources (very important)","text":"Source is-live Clock behavior filesrc false preroll, seekable v4l2src true no preroll udpsrc true real-time appsrc (live) true you control time <p>preroll</p> <p>Preroll is the process where a pipeline buffers just enough data so that playback can start smoothly at time 0.</p>","tags":["gstreamer","clock","pts","dts"]},{"location":"Other/Gstreamer/gstreamer/compositor/","title":"Index","text":"<p>Other / Gstreamer / gstreamer</p> simple pipe with compositor<pre><code># Simple GStreamer compositor with two videotestsrc side by side\ngst-launch-1.0 \\\n  compositor name=comp \\\n    sink_0::xpos=0 sink_0::ypos=0 sink_0::width=320 sink_0::height=240 \\\n    sink_1::xpos=320 sink_1::ypos=0 sink_1::width=320 sink_1::height=240 ! \\\n  video/x-raw,width=640,height=240 ! \\\n  videoconvert ! \\\n  autovideosink \\\n  videotestsrc pattern=0 ! \\\n    video/x-raw,width=320,height=240 ! \\\n    comp.sink_0 \\\n  videotestsrc pattern=1 ! \\\n    video/x-raw,width=320,height=240 ! \\\n    comp.sink_1\n</code></pre>","tags":["gstreamer","compositor"]},{"location":"Other/Gstreamer/gstreamer/compositor/#dynamic-control-compositor","title":"Dynamic control compositor","text":"simple pipe with compositor<pre><code>#!/usr/bin/env python3\nimport gi\ngi.require_version(\"Gst\", \"1.0\")\nfrom gi.repository import Gst, GLib\n\nimport threading\nfrom fastapi import FastAPI\nimport uvicorn\n\nGst.init(None)\n\n# --- Pipeline setup ---\npipeline = Gst.Pipeline.new(\"api-comp\")\n\ncomp = Gst.ElementFactory.make(\"compositor\", \"comp\")\ncapsfilter = Gst.ElementFactory.make(\"capsfilter\", \"caps\")\ncaps = Gst.Caps.from_string(\"video/x-raw,width=640,height=480,framerate=30/1\")\ncapsfilter.set_property(\"caps\", caps)\n\nsink = Gst.ElementFactory.make(\"ximagesink\", \"sink\")  # window output\n\npipeline.add(comp)\npipeline.add(capsfilter)\npipeline.add(sink)\n\ncomp.link(capsfilter)\ncapsfilter.link(sink)\n\nsources = {}  # name -&gt; (src, conv, sinkpad)\n\n# --- Safe functions to add/remove sources ---\n# def update_layout(name, xpos, ypos, w, h):\n\ndef safe_add_source(name, pattern, xpos, ypos, w, h):\n    if name in sources:\n        print(f\"{name} already exists\")\n\n        return f\"{name} already exists\"\n    src = Gst.ElementFactory.make(\"videotestsrc\", name)\n    src.set_property(\"is-live\", True)\n    src.set_property(\"pattern\", pattern)\n    conv = Gst.ElementFactory.make(\"videoconvert\", f\"{name}_conv\")\n\n    # Add elements to pipeline\n    pipeline.add(src)\n    pipeline.add(conv)\n    src.link(conv)\n\n    sinkpad = comp.get_request_pad(\"sink_%u\")\n    conv.link(comp)\n\n    # Set layout\n    sinkpad.set_property(\"xpos\", xpos)\n    sinkpad.set_property(\"ypos\", ypos)\n    sinkpad.set_property(\"width\", w)\n    sinkpad.set_property(\"height\", h)\n\n    # Sync state with pipeline\n    src.sync_state_with_parent()\n    conv.sync_state_with_parent()\n\n    sources[name] = (src, conv, sinkpad)\n    print(f\"Added {name}\")\n    return f\"Added {name}\"\n\ndef safe_remove_source(name):\n    if name not in sources:\n        return f\"{name} not found\"\n    src, conv, sinkpad = sources.pop(name)\n    print(f\"Removing {name}\")\n\n    # Pause the elements first\n    src.set_state(Gst.State.NULL)\n    conv.set_state(Gst.State.NULL)\n\n    # Release pad\n    comp.release_request_pad(sinkpad)\n    conv.unlink(comp)\n\n    # Remove from pipeline\n    pipeline.remove(src)\n    pipeline.remove(conv)\n\n    return f\"Removed {name}\"\n\n# --- Layouts ---\ndef layout_side_by_side():\n    \"\"\"Two sources side by side\"\"\"\n    safe_add_source(\"src1\", 0, 0, 0, 320, 480)\n    safe_add_source(\"src2\", 1, 320, 0, 320, 480)\n    safe_remove_source(\"src3\")\n\ndef layout_pip():\n    \"\"\"Fullscreen src1 with small overlay src3\"\"\"\n    safe_add_source(\"src1\", 0, 0, 0, 640, 480)\n    safe_add_source(\"src3\", 2, 440, 340, 200, 140)\n    safe_remove_source(\"src2\")\n\n# --- FastAPI server ---\napp = FastAPI()\n\n@app.get(\"/add/{name}\")\nasync def api_add_source(name: str, pattern: int = 0, xpos: int = 0, ypos: int = 0, w: int = 320, h: int = 240):\n    def do():\n        pipeline.set_state(Gst.State.PAUSED)\n        safe_add_source(name, pattern, xpos, ypos, w, h)\n        pipeline.set_state(Gst.State.PLAYING)\n        return False  # &lt;- important to avoid infinite loop\n    GLib.idle_add(do)\n    return {\"status\": f\"Adding {name}\"}\n\n@app.get(\"/remove/{name}\")\nasync def api_remove_source(name: str):\n    def do():\n        pipeline.set_state(Gst.State.PAUSED)\n        safe_remove_source(name)\n        pipeline.set_state(Gst.State.PLAYING)\n        return False\n    GLib.idle_add(do)\n    return {\"status\": f\"Removing {name}\"}\n\n@app.get(\"/layout/{name}\")\nasync def api_set_layout(name: str):\n    def do():\n        pipeline.set_state(Gst.State.PAUSED)\n        if name == \"side_by_side\":\n            layout_side_by_side()\n        elif name == \"pip\":\n            layout_pip()\n        pipeline.set_state(Gst.State.PLAYING)\n        return False\n    GLib.idle_add(do)\n    return {\"status\": f\"Switching to {name}\"}\n\n# --- Run GStreamer main loop in a background thread ---\ndef gst_loop():\n    pipeline.set_state(Gst.State.PLAYING)\n    layout_side_by_side()\n    loop = GLib.MainLoop()\n    loop.run()\n\ngst_thread = threading.Thread(target=gst_loop, daemon=True)\ngst_thread.start()\n\n# --- Run FastAPI ---\nif __name__ == \"__main__\":\n    uvicorn.run(app, host=\"0.0.0.0\", port=8000)\n</code></pre>","tags":["gstreamer","compositor"]},{"location":"Other/Gstreamer/gstreamer/compositor/#usage","title":"usage","text":"<pre><code># switch to other layout\ncurl -X 'GET' \\\n  'http://localhost:8000/layout/side_by_side' \\\n  -H 'accept: application/json'\n\n# switch to other layout\ncurl -X 'GET' \\\n  'http://localhost:8000/layout/pip' \\\n  -H 'accept: application/json'\n</code></pre>","tags":["gstreamer","compositor"]},{"location":"Other/Gstreamer/gstreamer/debug_and_trace/","title":"GStreamer debug and trace","text":"","tags":["gstreamer","debug","trace","gst-shark","identity"]},{"location":"Other/Gstreamer/gstreamer/debug_and_trace/#debug","title":"Debug","text":"<p>Basic tutorial 11: Debugging tools </p>","tags":["gstreamer","debug","trace","gst-shark","identity"]},{"location":"Other/Gstreamer/gstreamer/debug_and_trace/#trace","title":"Trace","text":"from source to sink<pre><code> GST_TRACERS=latency GST_DEBUG=GST_TRACER:7 \n</code></pre>","tags":["gstreamer","debug","trace","gst-shark","identity"]},{"location":"Other/Gstreamer/gstreamer/debug_and_trace/#todo-explain","title":"TODO: explain","text":"<pre><code>GST_TRACERS=\"latency(flags=element+pipeline+reported)\" GST_DEBUG=GST_TRACER:7\n</code></pre>","tags":["gstreamer","debug","trace","gst-shark","identity"]},{"location":"Other/Gstreamer/gstreamer/debug_and_trace/#todo-gst-shark","title":"TODO: gst-shark","text":"<p>GstShark_</p>","tags":["gstreamer","debug","trace","gst-shark","identity"]},{"location":"Other/Gstreamer/gstreamer/h264/","title":"GStreamer h264 pipes","text":"<p>Gstreamer h264 encoder has few implementation for different hardware support</p> <ul> <li>cpu </li> <li>nvidia</li> <li>intel (iGPU)</li> </ul> Encoder name Hardware / Architecture Platform Plugin package Latency Performance Notes / When to use <code>nvh264enc</code> NVIDIA NVENC (GPU) Desktop NVIDIA (RTX / GTX) <code>gst-plugins-bad</code> \u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50\u2b50 Best choice for RTX. Low latency, very high throughput. <code>nvv4l2h264enc</code> NVIDIA Tegra V4L2 Jetson (Orin / Xavier / Nano) Jetson Multimedia API \u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50\u2b50 Jetson-only. Will NOT work on RTX desktops. <code>vaapih264enc</code> VAAPI (iGPU) Intel / AMD iGPU <code>gstreamer1.0-vaapi</code> \u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50 Uses <code>/dev/dri</code>. Not for NVIDIA systems. <code>x264enc</code> CPU (x264) Any <code>gst-plugins-ugly</code> \u2b50\u2b50 \u2b50\u2b50\u2b50 Software encoder. Good quality, higher CPU usage. <code>avenc_h264</code> CPU (FFmpeg/libav) Any <code>gstreamer1.0-libav</code> \u2b50\u2b50 \u2b50\u2b50 Universal fallback. Simplest, but slowest. <code>v4l2h264enc</code> V4L2 HW encode Embedded SoCs <code>gst-plugins-good</code> \u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50 Generic V4L2; quality varies widely by hardware.","tags":["gstreamer","h264"]},{"location":"Other/Gstreamer/gstreamer/h264/#demo","title":"Demo","text":"<p>Send video data over network using h264 and RTP</p>","tags":["gstreamer","h264"]},{"location":"Other/Gstreamer/gstreamer/h264/#receiver","title":"Receiver","text":"<p>The receiver pipe common for all sender's <pre><code>gst-launch-1.0 \\\n  udpsrc port=5000 caps=\"application/x-rtp, media=video, encoding-name=H264, payload=96\" \\\n  ! rtph264depay \\\n  ! avdec_h264 \\\n  ! videoconvert \\\n  ! autovideosink\n</code></pre></p>","tags":["gstreamer","h264"]},{"location":"Other/Gstreamer/gstreamer/h264/#x264enc","title":"x264enc","text":"","tags":["gstreamer","h264"]},{"location":"Other/Gstreamer/gstreamer/h264/#install","title":"install","text":"<pre><code>sudo apt update\nsudo apt install -y \\\n  gstreamer1.0-plugins-ugly \\\n  gstreamer1.0-plugins-good \\\n  gstreamer1.0-plugins-bad \\\n  gstreamer1.0-libav\n</code></pre>","tags":["gstreamer","h264"]},{"location":"Other/Gstreamer/gstreamer/h264/#sender","title":"Sender","text":"<pre><code>gst-launch-1.0 \\\n  videotestsrc is-live=true pattern=ball \\\n  ! video/x-raw,width=640,height=480,framerate=30/1 \\\n  ! videoconvert \\\n  ! x264enc tune=zerolatency speed-preset=ultrafast bitrate=2000 \\\n  ! rtph264pay pt=96 config-interval=1 \\\n  ! udpsink host=127.0.0.1 port=5000\n</code></pre>","tags":["gstreamer","h264"]},{"location":"Other/Gstreamer/gstreamer/h264/#using-intel-igpu","title":"Using Intel iGPU","text":"","tags":["gstreamer","h264"]},{"location":"Other/Gstreamer/gstreamer/h264/#install_1","title":"Install","text":"install plugins<pre><code>sudo apt install -y \\\n  gstreamer1.0-vaapi \\\n  intel-media-va-driver \\\n  vainfo\n</code></pre>","tags":["gstreamer","h264"]},{"location":"Other/Gstreamer/gstreamer/h264/#sender_1","title":"Sender","text":"intel encoder<pre><code>gst-launch-1.0 \\\n  videotestsrc is-live=true \\\n  ! videoconvert \\\n  ! vaapih264enc \\\n  ! rtph264pay pt=96 \\\n  ! udpsink host=127.0.0.1 port=5000\n</code></pre>","tags":["gstreamer","h264"]},{"location":"Other/Gstreamer/gstreamer/h264/#receiver_1","title":"Receiver","text":"<p>leggy decoding</p> <p>On my machine the cpu decoder <code>avdec_h264</code> work better then <code>vaapih264dec</code></p> <pre><code>gst-launch-1.0 \\\n  udpsrc port=5000 caps=\"application/x-rtp,media=video,encoding-name=H264,payload=96\" \\\n  ! rtph264depay \\\n  ! h264parse \\\n  ! vaapih264dec \\\n  ! videoconvert \\\n  ! autovideosink\n</code></pre> with jitter<pre><code>gst-launch-1.0 \\\n  udpsrc port=5000 caps=\"application/x-rtp,media=video,encoding-name=H264,payload=96\" \\\n  ! rtpjitterbuffer latency=100 drop-on-latency=true \\\n  ! rtph264depay \\\n  ! h264parse \\\n  ! vaapih264dec \\\n  ! videoconvert \\\n  ! autovideosink\n</code></pre>","tags":["gstreamer","h264"]},{"location":"Other/Gstreamer/gstreamer/h264/#using-nvidia-nvdec","title":"Using nvidia (NVDEC)","text":"<ul> <li>nvh264enc</li> <li>nvh264dec</li> </ul> <p>jetson</p> <p>NVIDIA Jetson hardware using <code>nvv4l2h264enc</code> element</p> <p>Check that the PC support NVENC <pre><code>nvidia-smi -q | grep -i encoder\n</code></pre></p> <p>The plugin implement in bad package</p>","tags":["gstreamer","h264"]},{"location":"Other/Gstreamer/gstreamer/h264/#sender_2","title":"Sender","text":"<pre><code>gst-launch-1.0 \\\n  videotestsrc is-live=true \\\n  ! videoconvert \\\n  ! nvh264enc preset=low-latency-hq rc-mode=cbr bitrate=2000 \\\n  ! rtph264pay pt=96 config-interval=1 \\\n  ! udpsink host=127.0.0.1 port=5000\n</code></pre>","tags":["gstreamer","h264"]},{"location":"Other/Gstreamer/gstreamer/h264/#receiver_2","title":"Receiver","text":"<pre><code>gst-launch-1.0 \\\n  udpsrc port=5000 caps=\"application/x-rtp,media=video,encoding-name=H264,payload=96\" \\\n  ! rtph264depay \\\n  ! h264parse \\\n  ! nvh264dec \\\n  ! videoconvert \\\n  ! autovideosink\n</code></pre> <p>TODO: check jetson pipe</p>","tags":["gstreamer","h264"]},{"location":"Other/Gstreamer/gstreamer/h264/#jetson","title":"Jetson","text":"<pre><code>gst-launch-1.0 \\\n  videotestsrc is-live=true do-timestamp=true \\\n  ! video/x-raw,width=1280,height=720,framerate=30/1 \\\n  ! nvvidconv \\\n  ! nvv4l2h264enc insert-sps-pps=true iframeinterval=30 bitrate=2000000 \\\n  ! h264parse \\\n  ! rtph264pay pt=96 config-interval=1 \\\n  ! udpsink host=127.0.0.1 port=5000\n</code></pre> <ul> <li>insert-sps-pps=true    # required for streaming</li> <li>iframeinterval=30     # one keyframe per second @30fps</li> <li>bitrate=2000000       # 2 Mbps (adjust as needed)</li> </ul> <pre><code>gst-launch-1.0 \\\n  udpsrc port=5000 caps=\"application/x-rtp,media=video,encoding-name=H264,payload=96\" \\\n  ! rtpjitterbuffer latency=50 \\\n  ! rtph264depay \\\n  ! h264parse \\\n  ! nvv4l2decoder \\\n  ! nvvidconv \\\n  ! autovideosink\n</code></pre>","tags":["gstreamer","h264"]},{"location":"Other/Gstreamer/gstreamer/h264/#demo_1","title":"Demo","text":"<pre><code>gst-launch-1.0 \\\n  videotestsrc is-live=true do-timestamp=true \\\n  ! video/x-raw,width=640,height=480,framerate=30/1 \\\n  ! timeoverlay font-desc=\"Sans, 24\" halignment=left valignment=top shaded-background=true \\\n  ! videoconvert \\\n  ! nvh264enc preset=low-latency-hq rc-mode=cbr bitrate=2000 \\\n  ! h264parse \\\n  ! rtph264pay pt=96 config-interval=1 \\\n  ! udpsink host=127.0.0.1 port=5000\n</code></pre> <pre><code>gst-launch-1.0 \\\n  udpsrc port=5000 caps=\"application/x-rtp,media=video,encoding-name=H264,payload=96\" \\\n  ! rtpjitterbuffer latency=50 \\\n  ! rtph264depay \\\n  ! h264parse \\\n  ! avdec_h264 \\\n  ! videoconvert \\\n  ! fpsdisplaysink\n</code></pre>","tags":["gstreamer","h264"]},{"location":"Other/Gstreamer/gstreamer/selector/","title":"GStreamer selector","text":"<p>Other / Gstreamer / gstreamer</p> dynamic selector<pre><code>#!/usr/bin/env python3\nimport gi\ngi.require_version('Gst', '1.0')\nfrom gi.repository import Gst, GLib\n\nGst.init(None)\n\n# Define pipeline string using input-selector\npipeline_str = \"\"\"\ninput-selector name=selector !\n    videoconvert ! autovideosink\n    v4l2src device=/dev/video0 ! videoconvert ! selector.sink_0\n    v4l2src device=/dev/video4 ! videoconvert ! selector.sink_1\n\"\"\"\n\nprint(\"Pipeline:\\n\", pipeline_str)\npipeline = Gst.parse_launch(pipeline_str)\n\nselector = pipeline.get_by_name(\"selector\")\npads = selector.sinkpads\n\n# state for switching\ncurrent_index = {\"i\": 0}\n\ndef switch_source():\n    current_index[\"i\"] = (current_index[\"i\"] + 1) % len(pads)\n    pad = pads[current_index[\"i\"]]\n    selector.set_property(\"active-pad\", pad)\n    print(f\"Switched to camera {current_index['i']}\")\n    return True  # keep repeating\n\n# Set up bus to catch errors and EOS\nbus = pipeline.get_bus()\nbus.add_signal_watch()\n\ndef on_message(bus, message):\n    if message.type == Gst.MessageType.ERROR:\n        err, debug = message.parse_error()\n        print(\"Error:\", err, debug)\n        loop.quit()\n    elif message.type == Gst.MessageType.EOS:\n        print(\"End of stream\")\n        loop.quit()\n\nbus.connect(\"message\", on_message)\n\n# Start pipeline\npipeline.set_state(Gst.State.PLAYING)\n\n# Switch every 5 seconds\nGLib.timeout_add_seconds(5, switch_source)\n\nloop = GLib.MainLoop()\ntry:\n    loop.run()\nexcept KeyboardInterrupt:\n    pass\nfinally:\n    pipeline.set_state(Gst.State.NULL)\n</code></pre> dynamic selector and compositor<pre><code>#!/usr/bin/env python3\nimport gi\ngi.require_version('Gst', '1.0')\nfrom gi.repository import Gst, GLib\n\nGst.init(None)\n\npipeline_str = \"\"\"\n    compositor name=final_comp sink_0::xpos=0 sink_0::ypos=0 sink_1::xpos=640 sink_1::ypos=0 !\n        videoconvert ! autovideosink\n\n    v4l2src device=/dev/video0 ! videoconvert ! tee name=tee0\n    tee0. ! queue ! selector.sink_0\n    tee0. ! queue ! videoscale ! video/x-raw,width=320,height=240 ! both_comp.sink_0\n\n    v4l2src device=/dev/video4 ! videoconvert ! tee name=tee1\n    tee1. ! queue ! selector.sink_1\n    tee1. ! queue ! videoscale ! video/x-raw,width=320,height=240 ! both_comp.sink_1\n\n    input-selector name=selector ! videoscale ! video/x-raw,width=640,height=480 ! final_comp.sink_0\n\n    compositor name=both_comp sink_0::xpos=0 sink_0::ypos=0 sink_1::xpos=320 sink_1::ypos=0 !\n        videoscale ! video/x-raw,width=640,height=480 ! final_comp.sink_1\n\"\"\"\n\n\n\nprint(\"Pipeline:\\n\", pipeline_str)\npipeline = Gst.parse_launch(pipeline_str)\n\nselector = pipeline.get_by_name(\"selector\")\npads = selector.sinkpads\n\n# Track which pad is active\ncurrent_index = {\"i\": 0}\n\ndef switch_source():\n    current_index[\"i\"] = (current_index[\"i\"] + 1) % len(pads)\n    pad = pads[current_index[\"i\"]]\n    selector.set_property(\"active-pad\", pad)\n    print(f\"Switched selector to camera {current_index['i']}\")\n    return True  # repeat\n\nbus = pipeline.get_bus()\nbus.add_signal_watch()\n\ndef on_message(bus, message):\n    if message.type == Gst.MessageType.ERROR:\n        err, debug = message.parse_error()\n        print(\"Error:\", err, debug)\n        loop.quit()\n    elif message.type == Gst.MessageType.EOS:\n        print(\"End of stream\")\n        loop.quit()\n\nbus.connect(\"message\", on_message)\n\npipeline.set_state(Gst.State.PLAYING)\n\n# Switch every 5s\nGLib.timeout_add_seconds(5, switch_source)\n\nloop = GLib.MainLoop()\ntry:\n    loop.run()\nexcept KeyboardInterrupt:\n    pass\nfinally:\n    pipeline.set_state(Gst.State.NULL)\n</code></pre>","tags":["gstreamer","selector"]},{"location":"Other/Gstreamer/mpegts/","title":"Gstreamer mpegts","text":"<p>klv</p> <p>TBD</p> <p>TBD</p>","tags":["gstreamer","mpegts"]},{"location":"Other/Gstreamer/mpegts/#demo","title":"Demo","text":"<p>Send video over udp using h264 encoder and mpegts as a transform (no RTP)</p> sender<pre><code>gst-launch-1.0 -v videotestsrc is-live=true \\\n! x264enc tune=zerolatency bitrate=1000 speed-preset=superfast key-int-max=15 \\\n! video/x-h264,profile=main \\\n! mpegtsmux \\\n! udpsink host=127.0.0.1 port=5000\n</code></pre> <ul> <li>key-int-max=15: Forces a keyframe every 15 frames (lower values reduce startup delay).</li> <li>tune=zerolatency: Removes internal buffering.</li> </ul> receiver<pre><code>gst-launch-1.0 -v udpsrc port=5000 \\\n! tsdemux \\\n! h264parse \\\n! avdec_h264 \\\n! autovideosink\n</code></pre> <p>Tip</p> <p>key-int-max=15: Forces a keyframe every 15 frames (lower values reduce startup delay).</p> <p>tmuxp script to run the pipes</p>","tags":["gstreamer","mpegts"]},{"location":"Other/Gstreamer/mpegts/#more-then-one-stream","title":"More then one stream","text":"<ul> <li>Using RTP</li> </ul> sender<pre><code>gst-launch-1.0 -v mpegtsmux name=mux alignment=7 \\\n    ! rtpmp2tpay \\\n    ! udpsink host=127.0.0.1 port=5000 \\\nvideotestsrc pattern=ball is-live=true ! videoconvert ! x264enc tune=zerolatency bitrate=1000 speed-preset=superfast key-int-max=15 ! h264parse ! queue ! mux. \\\nvideotestsrc pattern=smpte is-live=true ! videoconvert ! x264enc tune=zerolatency bitrate=1000 speed-preset=superfast key-int-max=15  ! h264parse ! queue ! mux.\n</code></pre> receiver<pre><code>gst-launch-1.0 -v udpsrc port=5000 buffer-size=2000000 caps=\"application/x-rtp, media=video, encoding-name=MP2T, payload=33\" \\\n! rtpmp2tdepay \\\n! tsdemux name=demux \\\ndemux. ! queue ! h264parse ! avdec_h264 ! videoconvert ! autovideosink \\\ndemux. ! queue ! h264parse ! avdec_h264 ! videoconvert ! autovideosink\n</code></pre> <p>Note</p> <p>TODO: read more about the difference</p> <p>Tip</p> <pre><code>gst-launch-1.0 -v udpsrc port=5000 ! fakesink dump=true\ngst-launch-1.0 -v udpsrc port=5000 caps=\"video/mpegts, systemstream=true\" ! tsdemux ! fakesink\n</code></pre> <p>dump stream data to screen</p>","tags":["gstreamer","mpegts"]},{"location":"Other/Gstreamer/mpegts/#appsrc-demo","title":"AppSrc Demo","text":"<p>Send generated image using opencv to <code>appsrc</code> element</p> Send image using appsrc example <pre><code>\"\"\"simple pipeline and wait for bus message\n\nTags:\n    - add_signal_watch\n    - bus\n    - pipeline\n        - set_state\n        - get_bus\n\"\"\"\nimport gi\nimport numpy as np\nimport cv2\ngi.require_version(\"Gst\", \"1.0\")\nfrom gi.repository import Gst, GLib\n\n# Initialize GStreamer\nGst.init(None)\n\nWIDTH, height, FRAMERATE = 640, 480, 20\nPIPELINE = f\"\"\"appsrc is-live=true name=source is-live=true format=time \\\n! video/x-raw,format=BGR,width={WIDTH},height={height},framerate={FRAMERATE}/1 \\\n! videoconvert \\\n! timeoverlay time-mode=buffer-count \\\n! x264enc tune=zerolatency bitrate=1000 speed-preset=ultrafast key-int-max={FRAMERATE} \\\n! video/x-h264,profile=main \\\n! mpegtsmux \\\n! udpsink host=127.0.0.1 port=5000\"\"\"\n\n\n# change pipe for rtp support\nPIPELINE = f\"\"\"appsrc is-live=true name=source is-live=true format=time \\\n! video/x-raw,format=BGR,width={WIDTH},height={height},framerate={FRAMERATE}/1 \\\n! videoconvert \\\n! timeoverlay time-mode=buffer-count \\\n! queue \\\n! x264enc tune=zerolatency bitrate=1000 speed-preset=ultrafast key-int-max={FRAMERATE} \\\n! video/x-h264,profile=main \\\n! mpegtsmux alignment=7 \\\n! rtpmp2tpay \\\n! udpsink host=127.0.0.1 port=5000\"\"\"\n\ndef gen_frame(id:int) -&gt; bytes:\n    \"\"\"Generate omage\n    Create black image with counter text\n    \"\"\"\n    frame = np.zeros((height, WIDTH, 3), dtype=np.uint8)\n    cv2.putText(frame, f\"Appsrc Video {id}\", (50, height // 2), cv2.FONT_HERSHEY_SIMPLEX, 2, (255, 255, 255), 3)\n    # Convert the frame to a GStreamer buffer\n    data = frame.tobytes()\n    return data\n\ndef push_data():\n    \"\"\"push gen image to gst buffer\n    set pts dts and duration\n    Returns:\n        _type_: _description_\n    \"\"\"\n    data = gen_frame(push_data.counter)\n    buf = Gst.Buffer.new_allocate(None, len(data), None)\n    buf.fill(0, data)\n\n    duration_ns = int(1e9 / FRAMERATE)\n    buf.pts = buf.dts = push_data.counter * duration_ns\n    buf.duration = duration_ns\n    GLib.log_default_handler(\"MyApp\", GLib.LogLevelFlags.LEVEL_MESSAGE, f\"This {push_data.counter}\")\n    # Push the buffer to appsrc\n    retval = appsrc.emit(\"push-buffer\", buf)\n    if retval != Gst.FlowReturn.OK:\n        print(\"Error pushing buffer:\", retval)\n        loop.quit()\n\n    push_data.counter += 1\n    return True\n\ndef bus_callback(bus, message, loop):\n    \"\"\"\n    Handle GStreamer bus messages.\n    \"\"\"\n    if message.type == Gst.MessageType.EOS:\n        print(\"End-of-stream received, exiting.\")\n        loop.quit()\n    elif message.type == Gst.MessageType.ERROR:\n        err, debug = message.parse_error()\n        print(f\"Error: {err}, Debug Info: {debug}\")\n        loop.quit()\n    elif message.type == Gst.MessageType.STATE_CHANGED:\n        old, new, pending = message.parse_state_changed()\n        print(f\"State changed from {old.value_name} to {new.value_name}\")\n    return True\n\npipeline = Gst.parse_launch(PIPELINE)\nappsrc = pipeline.get_by_name(\"source\")\npipeline.set_state(Gst.State.PLAYING)\npush_data.counter = 0\nbus = pipeline.get_bus()\nbus.add_signal_watch()\nloop = GLib.MainLoop()\nbus.connect(\"message\", bus_callback, loop)\n# gst timer\nGLib.timeout_add(1000 // FRAMERATE, push_data)\ntry:\n    loop.run()\nexcept KeyboardInterrupt:\n    print(\"Exiting...\")\nfinally:\n    pipeline.set_state(Gst.State.NULL)\n</code></pre>","tags":["gstreamer","mpegts"]},{"location":"Other/Gstreamer/mpegts/#usage","title":"usage","text":"<p>Run script and receiver pipe</p> receiver<pre><code>gst-launch-1.0 -v udpsrc port=5000 \\\n! tsdemux \\\n! h264parse \\\n! avdec_h264 \\\n! autovideosink\n</code></pre> <p></p>","tags":["gstreamer","mpegts"]},{"location":"Other/Gstreamer/mpegts/#add-rtp","title":"Add RTP","text":"<p>Sending MPEG video over RTP - RTP includes sequence numbers in each packet, allowing the receiver to reorder packets if they arrive out of order. using jitter - RTP packets contain timestamps to help the receiver synchronize playback.</p> <ul> <li>TODO: Add more why, check when direct UDP is batter</li> </ul> <pre><code># change pipe for rtp support\nPIPELINE = f\"\"\"appsrc is-live=true name=source is-live=true format=time \\\n! video/x-raw,format=BGR,width={WIDTH},height={height},framerate={FRAMERATE}/1 \\\n! videoconvert \\\n! timeoverlay time-mode=buffer-count \\\n! x264enc tune=zerolatency bitrate=1000 speed-preset=superfast key-int-max=15 \\\n! video/x-h264,profile=main \\\n! mpegtsmux alignment=7 \\\n! rtpmp2tpay \\\n! udpsink host=127.0.0.1 port=5000\"\"\"\n</code></pre> description mpegtsmux alignment=7 The alignment property in mpegtsmux determines how MPEG-TS packets are arranged inside the output transport stream.  <p>7: Fully aligned \u2013 combines all alignments above for better RTP streaming.</p> rtpmp2tpay Encapsulates MPEG-TS (Transport Stream) data into RTP packets receiver pipe<pre><code>gst-launch-1.0 -v udpsrc port=5000 buffer-size=2000000 caps=\"application/x-rtp, media=video, encoding-name=MP2T, payload=33\" \\\n! rtpmp2tdepay \\\n! tsdemux name=demux \\\n! h264parse \\\n! avdec_h264 \\\n! autovideosink\n</code></pre>","tags":["gstreamer","mpegts"]},{"location":"Other/Gstreamer/mpegts/klv/","title":"KLV","text":"<p>A KLV stream is a sequence of Key-Length-Value encoded messages Using gstreamer we can send and receive klv data in <code>SMPTE 336M</code> standard</p> <p>SMPTE 336M</p> <p>The standard require 16 byte Universal Label (UL) as the key.  more</p>","tags":["klv","gstreamer"]},{"location":"Other/Gstreamer/mpegts/klv/#demo","title":"Demo","text":"<p>Send and Receive klv using gstreamer python binding</p> sender<pre><code>import gi\ngi.require_version('Gst', '1.0')\nfrom gi.repository import Gst, GLib\nimport time\n\nGst.init()\n\npipeline_str = \"appsrc name=klv_source caps=meta/x-klv,parsed=true ! rtpklvpay ! udpsink host=127.0.0.1 port=5002\"\npipeline = Gst.parse_launch(pipeline_str)\n\nappsrc = pipeline.get_by_name(\"klv_source\")\n\ndef push_klv_data():\n    # Create dummy KLV data\n    klv_data = bytes([\n        0x06, 0x0E, 0x2B, 0x34, 0x01, 0x01, 0x01, 0x01, 0x0E, 0x01, 0x03, 0x01, 0x01, 0x00, 0x00, 0x00,  # Key\n        0x02,  # Length\n        0x01, 0x02   # Value\n    ])\n\n    buf = Gst.Buffer.new_allocate(None, len(klv_data), None)\n    buf.fill(0, klv_data)\n    appsrc.emit(\"push-buffer\", buf)\n    return True\n\n# Set up the main loop\nloop = GLib.MainLoop()\n\n# Start the pipeline\npipeline.set_state(Gst.State.PLAYING)\n\n# Push KLV data periodically\nGLib.timeout_add_seconds(1, push_klv_data)\n\ntry:\n    loop.run()\nexcept KeyboardInterrupt:\n    pass\n\n# Clean up\npipeline.set_state(Gst.State.NULL)\n</code></pre> receiver<pre><code># klv_receiver.py\nimport gi\ngi.require_version('Gst', '1.0')\nfrom gi.repository import Gst, GLib\n\nGst.init(None)\n\ndef on_new_sample(sink):\n    sample = sink.emit(\"pull-sample\")\n    buf = sample.get_buffer()\n    success, map_info = buf.map(Gst.MapFlags.READ)\n    if success:\n        data = map_info.data\n        print(\"Received KLV:\", list(data))\n        buf.unmap(map_info)\n    return Gst.FlowReturn.OK\n\npipeline = Gst.parse_launch(\"\"\"\nudpsrc port=5002 caps=\"application/x-rtp, media=application, encoding-name=SMPTE336M, payload=96\" !\nrtpklvdepay ! appsink name=sink emit-signals=true sync=true\n\"\"\")\n\nsink = pipeline.get_by_name(\"sink\")\nsink.connect(\"new-sample\", on_new_sample)\n\npipeline.set_state(Gst.State.PLAYING)\nloop = GLib.MainLoop()\nloop.run()\n</code></pre>","tags":["klv","gstreamer"]},{"location":"Other/Gstreamer/mpegts/klv/gst_demo/","title":"MPEG with KLV","text":"mpeg send image and kvl data sender mpeg receiver parse kvl data receiver","tags":["gstreamer","mpegts","klv","metadata","python"]},{"location":"Other/Gstreamer/mpegts/klv/gst_demo/#reference-to-check-and-read","title":"Reference , To check and read","text":"<ul> <li>GStreamer KVL plugins</li> <li>klv_decoder</li> </ul>","tags":["gstreamer","mpegts","klv","metadata","python"]},{"location":"Other/Gstreamer/mpegts/klv/klv_stanag/","title":"KLV","text":"<p>A KLV stream is a sequence of Key-Length-Value encoded messages</p> <p>MISB/STANAG</p> <p>TBD</p> <p>TBD</p> Description MISB Motion Imagery Standard Board ST 601 MISB Defines UAS Datalink Local Set (core telemetry format) STANAG 4609 NATO Standardization Agreement (include MISB ST 601) UAS metadata Sensor telemetry sent with drone imagery","tags":["klv"]},{"location":"Other/Gstreamer/mpegts/klv/klv_stanag/#unmanned-air-system-uas-metadata","title":"Unmanned Air System (UAS) Metadata","text":"<p>UAS metadata refers to the telemetry and context information transmitted alongside video or sensor feeds from an Unmanned Aerial System (drone/UAV). It includes:</p> <ul> <li>Timestamp</li> <li>Platform orientation</li> <li>Platform position</li> <li>more ..</li> </ul>","tags":["klv"]},{"location":"Other/Gstreamer/mpegts/klv/klv_stanag/#demo-using-klvdata-python-library","title":"Demo: using klvdata python library","text":"<p>klvdata github</p> <pre><code>pip install klvdata\n</code></pre>","tags":["klv"]},{"location":"Other/Gstreamer/mpegts/klv/klv_stanag/#reference","title":"Reference","text":"<ul> <li>MISB ST 0601.8 UAS Datalink Local Set</li> <li>mpg video with klv stream</li> <li>klvdata - python library for MISB 601 </li> </ul>","tags":["klv"]},{"location":"Other/Gstreamer/python_bindings/","title":"GStreamer python bindings","text":"","tags":["gstreamer","python","bindings","gst-bindings"]},{"location":"Other/Gstreamer/python_bindings/#install","title":"Install","text":"<pre><code>sudo apt-get install gstreamer1.0-tools gstreamer1.0-python3 \n</code></pre> <p>app src</p> <p>app sink</p> <p>TBD</p>","tags":["gstreamer","python","bindings","gst-bindings"]},{"location":"Other/Gstreamer/python_bindings/#simple-usage","title":"Simple usage","text":"<pre><code>import gi\ngi.require_version('Gst', '1.0')\nfrom gi.repository import Gst, GLib\n\n# Initialize GStreamer\nGst.init(None)\n\n# Create a GStreamer pipeline\nPIPELINE = \"videotestsrc ! videoconvert ! autovideosink\"\npipeline = Gst.parse_launch()\n\n# Start playing the video\npipeline.set_state(Gst.State.PLAYING)\n\n# Creates a main loop to keep the program running.\nloop = GLib.MainLoop()\ntry:\n    loop.run()\nexcept KeyboardInterrupt:\n    pass\n</code></pre>","tags":["gstreamer","python","bindings","gst-bindings"]},{"location":"Other/Gstreamer/python_bindings/app_sink/","title":"Index","text":"<p>tags:     - gstreamer     - python     - bindings     - gst-bindings     - appsink</p>"},{"location":"Other/Gstreamer/python_bindings/app_src/","title":"Index","text":"<p>tags:     - gstreamer     - python     - bindings     - gst-bindings     - appsrc</p>"},{"location":"Other/Gstreamer/rtsp/","title":"Index","text":"server.py<pre><code>import sys\nimport gi\n\ngi.require_version('Gst', '1.0')\ngi.require_version('GstRtspServer','1.0')\nfrom gi.repository import Gst, GstRtspServer, GLib\n\nloop = GLib.MainLoop()\nGst.init(None)\n\nclass MyFactory(GstRtspServer.RTSPMediaFactory):\n    def __init__(self):\n        GstRtspServer.RTSPMediaFactory.__init__(self)\n\n    def do_create_element(self, url):\n        s_src = \"v4l2src ! video/x-raw,rate=30,width=320,height=240 ! videoconvert ! video/x-raw,format=I420\"\n        s_h264 = \"videoconvert ! vaapiencode_h264 bitrate=1000\"\n        s_src = \"videotestsrc ! video/x-raw,rate=30,width=320,height=240,format=I420\"\n        s_h264 = \"x264enc tune=zerolatency\"\n        pipeline_str = \"( {s_src} ! queue max-size-buffers=1 name=q_enc ! {s_h264} ! rtph264pay name=pay0 pt=96 )\".format(**locals())\n        if len(sys.argv) &gt; 1:\n            pipeline_str = \" \".join(sys.argv[1:])\n        print(pipeline_str)\n        return Gst.parse_launch(pipeline_str)\n\nclass GstServer():\n    def __init__(self):\n        self.server = GstRtspServer.RTSPServer()\n        f = MyFactory()\n        f.set_shared(True)\n        m = self.server.get_mount_points()\n        m.add_factory(\"/test\", f)\n        self.server.attach(None)\n\nif __name__ == '__main__':\n    s = GstServer()\n    loop.run()\n\n# gst-play-1.0 rtsp://127.0.0.1:8554/test\n</code></pre> player<pre><code>gst-launch-1.0 rtspsrc location=rtsp://127.0.0.1:8554/test ! rtph264depay ! avdec_h264 ! autovideosink\n</code></pre>","tags":["gstreamer","rtsp","server","python"]},{"location":"Other/Gstreamer/rtsp/#todo-explain-server","title":"todo: explain server","text":"","tags":["gstreamer","rtsp","server","python"]},{"location":"Other/Presentation/","title":"Presentaions","text":"<p>ROS Application from development to deploy using docker and vscode</p> <p>Robotic Interview for developer</p> <p>Block 3 Description</p>"},{"location":"Other/Presentation/learn_path/","title":"Index","text":"<p>Robotics Software Development</p>"},{"location":"Other/Presentation/learn_path/#skills","title":"Skills","text":"<ul> <li>Programming</li> <li>Robotics</li> <li>ROS</li> <li>DevOps</li> <li>Do not afraid to learn new things</li> </ul>"},{"location":"Other/Presentation/learn_path/#prerequisites","title":"Prerequisites","text":"<ul> <li>Linux</li> <li>Python</li> </ul>"},{"location":"Other/Presentation/learn_path/#novice","title":"Novice","text":"<ul> <li>Git</li> <li>C++ for robotics (cmake)</li> <li>ROS2 basics</li> <li>Docker basics</li> <li>Robot simulation (basic)</li> <li>more linux</li> <li>bash</li> <li>OS</li> </ul>"},{"location":"Other/Presentation/learn_path/#beginner","title":"Beginner","text":"<ul> <li>ROS2 advanced</li> <li>Unit testing</li> <li>GStreamer</li> <li>Mavlink</li> <li>Ardupilot</li> <li>Networking</li> </ul>"},{"location":"Other/Presentation/learn_path/#more","title":"More","text":"<ul> <li>Robot Perception</li> <li>Math for robotics</li> <li>Deployment</li> <li>More programming skills</li> <li>Adv python</li> <li>Adv C++</li> <li>UI</li> </ul>"},{"location":"Other/Presentation/learn_path/#advanced","title":"Advanced","text":"<ul> <li>Embedded</li> <li>AI</li> <li>Filters / Kalman filter</li> <li>SLAM</li> <li>Advanced perception</li> </ul>"},{"location":"Other/Presentation/learn_path/#done","title":"Done","text":""},{"location":"Other/Presentation/learn_path2/","title":"Index","text":"<p>Robotics Engineering</p>"},{"location":"Other/Presentation/learn_path2/#math-physics","title":"Math &amp; Physics","text":"<ul> <li>Linear Algebra Essentials (9h)</li> <li>Calculus Essentials(3h)</li> <li>Probability (13h)</li> <li>more Probability</li> </ul>"},{"location":"Other/Presentation/learn_path2/#programming","title":"Programming","text":"<ul> <li>C++ (62h)</li> </ul>"},{"location":"Other/Presentation/learn_path2/#control-sensor-fusing-and-other-algorithms","title":"Control, Sensor fusing and other algorithms","text":""},{"location":"Other/Presentation/learn_path2/#sensor-fusing","title":"Sensor fusing","text":"<ul> <li>Sensor Fusion</li> </ul>"},{"location":"Other/Presentation/learn_path2/#control","title":"Control","text":"<ul> <li>MPC</li> <li></li> </ul>"},{"location":"Other/Presentation/learn_path2/#robotics-algorithm","title":"robotics algorithm","text":"<ul> <li>SLAM</li> <li>Particle filters </li> <li>Localization</li> <li>Path planning</li> <li>Master the Concepts of Reinforcement Learning. Implement a complete RL solution and understand how to apply AI tools to solve real-world problems.</li> </ul>"},{"location":"Other/Presentation/learn_path2/#ros","title":"ROS","text":"<ul> <li>ROS2 control</li> <li>ROS2 NAvigation Stack</li> </ul>"},{"location":"Other/Presentation/presentation_source/ros2_dev_2_deploy/","title":"ROS2 from dev to deploy","text":""},{"location":"Other/Presentation/presentation_source/ros2_dev_2_deploy/#on-nvidia-jetson","title":"on nvidia jetson","text":""},{"location":"Other/Presentation/presentation_source/ros2_dev_2_deploy/#agenda","title":"Agenda","text":"<ul> <li>Dev</li> <li>Build and test</li> <li>Deploy</li> <li>Source control (??)</li> <li>Version control</li> </ul>"},{"location":"Other/Presentation/presentation_source/ros2_dev_2_deploy/#today","title":"Today","text":"<ul> <li>Dev on linux machine as python project (no ROS)</li> <li>Deploy: copy python files to remote system </li> <li>Deploy as ZIP</li> <li>Deploy: Burn pre cocked jetson image</li> </ul>"},{"location":"Other/Presentation/presentation_source/ros2_dev_2_deploy/#docker-as-a-way-of-life","title":"Docker as a way of life","text":"<ul> <li>Dev: using vscode devcontainer</li> <li>Build: using docker to build for different architecture</li> <li>Test: using docker as test environment (allow clean system)</li> <li>Deploy: Deploy the application as cocked docker image </li> </ul>"},{"location":"Other/Presentation/presentation_source/ros2_dev_2_deploy/#dev","title":"Dev","text":"<ul> <li>Using VSCode devcontainer</li> <li>support remote development (run on jetson)</li> <li>Docker hierarchy</li> <li>OS with Chosen ROS version + simulator + common dev tools</li> <li>Project runtime dependencies (runtime/test)</li> <li>Project dev dependencies (dev)</li> <li>Project cycle (forget package and python pip) </li> </ul>"},{"location":"Other/Presentation/presentation_source/ros2_dev_2_deploy/#build","title":"Build","text":"<ul> <li>Cross Compiler</li> <li>Using docker as cross compiler environment</li> <li>using dev docker that build for the jetson arm architecture</li> </ul>"},{"location":"Other/Presentation/presentation_source/ros2_dev_2_deploy/#test","title":"Test","text":"<ul> <li>Using docker as consistent and repetitive environment for testing</li> <li>Use it to test package install tests</li> </ul>"},{"location":"Other/Presentation/presentation_source/ros2_dev_2_deploy/#deploy-find-your-way","title":"Deploy - Find your way","text":"<ul> <li>deb packages</li> <li>docker image</li> <li>jetson image </li> </ul>"},{"location":"Other/Presentation/presentation_source/ros2_dev_2_deploy/#deploy-debian-package","title":"Deploy - debian package","text":"<ul> <li>Standard</li> <li>The linux/debian way </li> <li>every package are installable has version and metadata</li> <li>easy to deploy from remote</li> </ul>"},{"location":"Other/Presentation/presentation_source/ros2_dev_2_deploy/#deploy-jetson-image","title":"Deploy - jetson image","text":"<ul> <li>pre install jetson image with all project dependencies and code</li> <li>Code install as debian package</li> <li>easy to copy</li> <li></li> </ul>"},{"location":"Other/Presentation/presentation_source/ros2_dev_2_deploy/#deploy-with-docker","title":"Deploy - with docker","text":"<ul> <li>Build application docker with all dependencies</li> <li>Easy deploy</li> </ul>"},{"location":"Other/Presentation/presentation_source/ros2_dev_2_deploy/#deploy-with-docker-when","title":"Deploy - with docker - when","text":"<ul> <li>legacy</li> <li>test's</li> <li>mixing system</li> <li>when is no other way</li> </ul>"},{"location":"Other/Presentation/presentation_source/ros2_dev_2_deploy/#deploy-with-docker-why-not","title":"Deploy - with docker - why not","text":"<ul> <li>Hardware issue</li> <li>Hard to deploy from remote</li> </ul>"},{"location":"Other/Presentation/presentation_source/ros2_dev_2_deploy/#version","title":"Version","text":"<ul> <li>Every thing has a version</li> <li>package</li> <li>OS image</li> <li>docker image</li> <li>Every project / application has version page</li> </ul>"},{"location":"Other/Presentation/presentation_source/ros2_dev_2_deploy/#control-after-release","title":"Control after release","text":"<ul> <li>Dev days: yes, we know ourself</li> <li>From release and on:</li> <li>Source control</li> <li>Ticket and issue</li> <li>Code review and test</li> </ul>"},{"location":"Other/Presentation/presentation_source/ros2_dev_2_deploy/#all-fit-together","title":"All fit together","text":"<ul> <li>Build Debian packages</li> <li>Install Packages on the docker image</li> <li>Backup jetson image with docker include </li> </ul>"},{"location":"Other/Presentation/presentation_source/ros2_dev_2_deploy/#final-thought","title":"Final thought","text":"<p> Docker for dev using devcontainer  Docker for build  Docker for test  Docker for production</p>"},{"location":"Other/Presentation/ros4manager/ros4manager/","title":"ROS2","text":"<p>What, Why and basic verbs and concept</p> <p></p>"},{"location":"Other/Presentation/ros4manager/ros4manager/#what","title":"What","text":"<ul> <li>Open source software development kit for robotics applications.</li> <li>Standard</li> <li>From research and prototyping through to deployment and production</li> </ul>"},{"location":"Other/Presentation/ros4manager/ros4manager/#why","title":"Why","text":"<ul> <li>For me it a STANDARD</li> </ul>"},{"location":"Other/Presentation/ros4manager/ros4manager/#verbs","title":"Verbs","text":"<ul> <li>DDS</li> <li>Node</li> <li>Pub / Sub</li> <li>Service</li> <li>Parameters</li> </ul>"},{"location":"Other/Presentation/ros4manager/ros4manager/#tools","title":"Tools","text":"<ul> <li>Rqt</li> <li>Rviz</li> <li>Gazebo</li> </ul>"},{"location":"Other/Presentation/ros4manager/ros4manager/#what-to-remember","title":"What to remember","text":"<ul> <li>ROS2 is a standard</li> <li>Don't invite the wheel (reuse other works)</li> <li>ROS2 is a way of thinking to solve robotics problems</li> <li>ROS2 is a SDK</li> </ul>"},{"location":"Other/Presentation/ros4manager/ros4manager/#learn-from-others","title":"Learn from others","text":"<ul> <li>Autonomous, GPS-Denied Quadrotor Flight</li> </ul>"},{"location":"Other/Presentation/ros4manager/ros4manager/#darpa","title":"DARPA","text":"<p>link</p>"},{"location":"Other/Presentation/ros4manager/ros4manager/#vrx","title":"VRX","text":""},{"location":"Other/Presentation/ros4manager/ros4manager/#eye-on-the-prize-glance-to-the-future","title":"Eye on the prize. glance to the future","text":"<ul> <li>ROS Version</li> <li>Simulation</li> <li>Gazebo version</li> <li>Flight controller</li> <li>PX4 /ArduPilot</li> </ul> <p>2024 ROS Metrics Report</p>"},{"location":"Other/Presentation/ros4manager/ros4manager/#node-message-and-topic","title":"Node message and topic","text":"<p>Node: A node is an executable that uses ROS to communicate with other nodes. Message: ROS data type Topics: ROS2 topic is a way of communication between ROS2 nodes</p>"},{"location":"Other/Presentation/ros4manager/ros4manager/#pub-sub","title":"Pub / Sub","text":""},{"location":"Other/Presentation/ros4manager/ros4manager/#service","title":"Service","text":""},{"location":"Other/Presentation/ros4manager/ros4manager/#action","title":"Action","text":""},{"location":"Other/Presentation/ros4manager/ros4manager/#rqt","title":"Rqt","text":"<p>RQT is a Qt-based framework for GUI development for ROS</p> <p></p>"},{"location":"Other/Presentation/ros4manager/ros4manager/#rviz","title":"Rviz","text":"<ul> <li>Rviz is a 3D visualization tool for ROS</li> <li>It allows you to visualize sensor data and other information from your robot in real-time</li> </ul>"},{"location":"Other/Presentation/ros4manager/ros4manager/#gazebo","title":"Gazebo","text":""},{"location":"Other/Presentation/ros4manager/ros4manager/#without-words","title":"Without words","text":"<p>video link</p>"},{"location":"Other/Presentation/ros4manager/ros4manager/#final","title":"Final","text":"<ul> <li>ROS is a standard </li> <li>Way of thinking</li> <li>SDK for develop robotics application</li> </ul>"},{"location":"Other/buy_list/","title":"new laptop","text":"<ul> <li>Asus ROG Zephyrus G14 (2025) GA403WR-QS096 <ul> <li>config ubuntu 24.04</li> </ul> </li> <li>bestbuy</li> </ul> <p>If You're About to Buy a Laptop, Watch This Firstdddd</p> AMD Ryzen\u2122 AI 9 HX 370 HX - high performance 32GB LPDDR5X 8000 NVIDIA\u00ae GeForce RTX\u2122 5070 Ti 12GB GDDR7 Laptop GPU 1TB PCIe\u00ae 4.0 NVMe\u2122 M.2 SSD <ul> <li>ASUS Zenbook 14X OLED (UX3404)</li> <li>nvidia 3050</li> </ul> spec Asus ux3404 cpu i9-13900H memory 32GB gpu RTX 3050 <p>Asus Zenbook 14X OLED UX3404VC-M9025W</p> spec Asus UX6404 cpu i9-13900H memory 48GB gpu RTX 4070 HD 2T <p>BuG Asus</p>","tags":["buy list"]},{"location":"Other/buy_list/#alternative","title":"Alternative","text":"<ul> <li>Lenovo Yoga Pro 7-14IMH9 83E2003JIV</li> </ul>","tags":["buy list"]},{"location":"Other/courses_and_books/","title":"Courses","text":"","tags":["course","book"]},{"location":"Other/courses_and_books/#ai","title":"AI","text":"<ul> <li>Neural Networks From Scratch in Python</li> </ul>","tags":["course","book"]},{"location":"Other/courses_and_books/#robotics","title":"Robotics","text":"<ul> <li>The Kalman Filter (1 of 55) What is a Kalman Filter?</li> </ul>","tags":["course","book"]},{"location":"Other/courses_and_books/#vision","title":"Vision","text":"<ul> <li>YT Event base robot vision 2020</li> </ul>","tags":["course","book"]},{"location":"Other/courses_and_books/#books","title":"Books","text":"<ul> <li>TinyML</li> </ul>","tags":["course","book"]},{"location":"Other/interview/","title":"Index","text":"<p>Robotics Software Development Interview</p>"},{"location":"Other/interview/#python","title":"Python","text":"<ul> <li>Differentiate between list and tuple</li> <li>Explain immutable vs mutable</li> <li>Explain yield keyword </li> <li>Explain python context manager and how to implement it.</li> <li>Explain thread safe object</li> </ul>"},{"location":"Other/interview/#python-code-i","title":"Python code I","text":"<p>what the output</p> <pre><code>names = [\"Alice\", \"Bob\", \"Charlie\", \"Dave\"]\nresult = sorted([name.lower() for name in names if len(name) &gt; 3], key=lambda x: x[-1])\nprint(result)\n</code></pre>"},{"location":"Other/interview/#python-code-ii","title":"Python code II","text":"<p>find my bug</p> <pre><code>def remove_even(numbers):\n    for num in numbers:\n        if num % 2 == 0:\n            numbers.remove(num)\n    return numbers\n\nprint(remove_even([1, 2, 3, 4, 5, 6]))\n</code></pre>"},{"location":"Other/interview/#python-code-iii","title":"Python code III","text":"<p>What the output</p> <pre><code>def log_message(*args, **kwargs):\n    level = kwargs.get('level', 'INFO')\n    prefix = kwargs.get('prefix', '')\n    message = \" \".join(str(arg) for arg in args)\n    print(f\"[{level}] {prefix}{message}\")\n\nlog_message(\"System\", \"started\")\nlog_message(\"Temperature:\", 72, level=\"WARNING\")\nlog_message(\"User\", \"login\", prefix=\"&gt;&gt; \", level=\"DEBUG\")\n</code></pre>"},{"location":"Other/interview/#python-code-iv","title":"Python code IV","text":"<p>What the bug and how fix it</p> <pre><code>import threading\n\ncounter = 0\n\ndef increment():\n    global counter\n    for _ in range(100000):\n        counter += 1\n\nthreads = [threading.Thread(target=increment) for _ in range(5)]\n\nfor t in threads: t.start()\nfor t in threads: t.join()\n\nprint(\"Counter:\", counter)\n</code></pre>"},{"location":"Other/interview/#python-code-v","title":"Python code V","text":"<p>What the result</p> <pre><code>def mystery(n):\n    if n == 0:\n        return 0\n    return n + mystery(n - 1)\n\nprint(mystery(4))\n</code></pre>"},{"location":"Other/interview/#python-code-vi","title":"Python code VI","text":"<p>What\u2019s the difference between these two?</p> <pre><code>def build_list(n):\n    result = []\n    for i in range(n):\n        result.append(i * i)\n    return result\n\ndef generate_values(n):\n    for i in range(n):\n        yield i * i\n\nprint(\"Using return:\")\nfor x in build_list(5):\n    print(x)\n\nprint(\"\\nUsing yield:\")\nfor x in generate_values(5):\n    print(x)\n</code></pre>"},{"location":"Other/interview/#control","title":"Control","text":"<ul> <li>Explain filters and why i need them</li> <li>Explain PID system</li> <li>Give me example for system that i must add <code>I</code> control part to close my error</li> </ul>"},{"location":"Other/interview/#filter-i","title":"filter I","text":"<pre><code>def ema_filter(current, previous, alpha=0.1):\n    return alpha * current + (1 - alpha) * previous\n\ndata = [1,2,3,4,5,6]\np  = 0\nfor c in data:\n    p= ema_filter(c, p)\n</code></pre> <ul> <li>What is the functionality this filter implement</li> <li>What are the valid alpha that can be use for this functionally<ul> <li>Choice two alpha values and explain </li> </ul> </li> </ul>"},{"location":"Other/interview/#control-i","title":"Control I","text":"<p>I have a PID-controlled water heating system.  The system has a large overshoot and takes a long time to stabilize. What tuning do you recommend?</p>"},{"location":"Other/interview/#control_1","title":"Control","text":"<p>I design the system only with <code>PD</code> control what the pros and cons</p>"},{"location":"Other/interview/#robotics","title":"Robotics","text":"<p>I have a differential-drive robot that needs to reach a goal position marked by a red dot. ( the robot has no previous data about the obstacle in the room)</p> <p></p> <ul> <li>The robot know it's position on map x,y</li> <li>The Robot know the target position x,y </li> <li>The Robot algorithm need to find the shortest path to the target</li> </ul> <ul> <li>What sensor do I need to add to help the robot to reach the target ?</li> <li>Describe the algorithm to implement in pseudocode.</li> <li>Give me another set of sensors that can help solve the machine</li> </ul>"},{"location":"Other/interview/#robotics-ii","title":"Robotics II","text":"<ul> <li>What sensor do I need to add if the robot has no initialize position and no knowledge about the target location</li> <li>The robot needs to find the red box in the environment and stop near it?</li> </ul> <ul> <li>Describe the algorithm to implement in pseudocode</li> <li>What sensor to add if i want to control robot speed and yaw (no gps)</li> </ul>"},{"location":"Other/interview/more_advance/","title":"More advance","text":"<p>Robotics Software Development Interview II</p>"},{"location":"Other/interview/more_advance/#control-i","title":"Control I","text":"<p>How to tune the PID </p> <p></p>"},{"location":"Other/interview/more_advance/#control-i_1","title":"Control I","text":"<p>How to tune the PID </p> <p></p>"},{"location":"Other/interview/more_advance/#control","title":"Control","text":"<p>Explain and what are the usage - anti-windup - feed forward - output rate limiting - conditional integration</p>"},{"location":"Other/interview/more_advance/#ros","title":"ROS","text":"<ul> <li>Explain ROS2 QoS</li> <li>Explain Intra-process communication in ROS 2, benefits and trade-offs?</li> </ul>"},{"location":"Other/interview/more_advance/#ros_1","title":"ROS","text":"<p>Your system runs multiple nodes that publish TF2 messages at a very high frequency. Frequent calls to lookupTransform() are causing noticeable latency. What techniques or optimizations in ROS 2 can help reduce this latency?</p>"},{"location":"Other/interview/more_advance/#ros_2","title":"ROS","text":"<p>You have two nodes \u2014 a Tracker and an ATR \u2014 that both consume significant system resources. They do not need to run at the same time. What ROS 2 features or mechanisms can you use to manage this situation effectively?</p>"},{"location":"Other/interview/more_advance/#python","title":"Python","text":"<p>What is the output and way it work, suggest two or more way to achieve the same functionality / behavior</p> <pre><code>def func():\n    func.c +=1\n\nfunc.c = 0\nfunc()\nfunc()\n\nprint(func.c)\n</code></pre>"},{"location":"Other/interview/more_advance/#python_1","title":"Python","text":"<p>Explain what Python\u2019s asyncio library is and describe when it is appropriate to use it.</p>"},{"location":"Other/interview/more_advance/#python_2","title":"Python","text":"<p>Explain the code</p> <pre><code>class XXX:\n    _instance = None\n    def __new__(cls, *args, **kwargs):\n        if cls._instance is None:\n            cls._instance = super().__new__(cls)\n        return cls._instance\n</code></pre>"},{"location":"Other/interview/more_advance/#cpp","title":"CPP","text":"<ul> <li>Explain what std::move does.</li> <li>What is the difference between moving and copying an object?</li> <li>Give a case where moving is significantly more efficient.</li> </ul>"},{"location":"Other/interview/more_advance/#cpp_1","title":"CPP","text":"<p>What\u2019s the difference between  - std::unique_ptr  - std::shared_ptr - std::weak_ptr</p> <p>When would you use each?</p>"},{"location":"Other/interview/more_advance/#cpp_2","title":"CPP","text":"<p>What the output?</p> <pre><code>int x = 10;\nauto f = [x]() mutable { return ++x; }; \nstd::cout &lt;&lt; f() &lt;&lt; \" \" &lt;&lt; f() &lt;&lt; std::endl;\n</code></pre> <pre><code>int x = 10;\nauto f = [](int x) { return ++x; }; // no mutable\nstd::cout &lt;&lt; f(x) &lt;&lt; \" \" &lt;&lt; f(x) &lt;&lt; std::endl;\n</code></pre>"},{"location":"Other/markdown/","title":"Markdown Cheatsheet and VSCode Extensions","text":"<p>Github Docs - Basic writing and formatting syntax</p>","tags":["markdown","cheatsheet","vscode"]},{"location":"Other/markdown/#markdown","title":"Markdown","text":"Tag Markdown <code>**bold**</code> bold <code>*italic*</code> italic <code>~~strikethrough~~</code> ~~strikethrough~~ <code>$\\LaTeX$</code> \\(\\LaTeX\\) <code>---</code> ---","tags":["markdown","cheatsheet","vscode"]},{"location":"Other/markdown/#links","title":"Links","text":"new tab <code>[link](https://uri){:target=\"_blank\"}</code>","tags":["markdown","cheatsheet","vscode"]},{"location":"Other/markdown/#images","title":"images","text":"width control <code>![](images/markdown.png){ width=10% }</code> width control <code>![](images/markdown.png){ width=20% }</code>","tags":["markdown","cheatsheet","vscode"]},{"location":"Other/markdown/#headings","title":"headings","text":"","tags":["markdown","cheatsheet","vscode"]},{"location":"Other/markdown/#heading-1","title":"Heading 1","text":"<p><code># Heading 1</code></p>","tags":["markdown","cheatsheet","vscode"]},{"location":"Other/markdown/#heading-2","title":"Heading 2","text":"<p><code>## Heading 2</code></p>","tags":["markdown","cheatsheet","vscode"]},{"location":"Other/markdown/#heading-3","title":"Heading 3","text":"<p><code>### Heading 3</code></p>","tags":["markdown","cheatsheet","vscode"]},{"location":"Other/markdown/#emoji","title":"emoji","text":"<p>Complete list</p> <p>:sunglasses: <code>:sunglasses:</code> :heart: <code>:heart:</code></p>","tags":["markdown","cheatsheet","vscode"]},{"location":"Other/todo/","title":"TODO","text":"<p>Other</p> <p>[ ] https://www.youtube.com/playlist?list=PL5B692fm6--ukF8S7ul5NmceZhXLRv_lR</p>","tags":["todo"]},{"location":"Programming/","title":"Programing","text":"<p>Python</p> <p>C/CPP</p> <p>Rust</p> <p>AI</p> <p>Vision</p> <p>GUI</p> <ul> <li>Configuration files</li> </ul>"},{"location":"Programming/GUI/","title":"GUI Programing","text":"<p>QT</p>"},{"location":"Programming/GUI/QT/","title":"GUI","text":"","tags":["gui","ui"]},{"location":"Programming/GUI/QT/#python","title":"Python","text":"<p>PyQt and PySide are the two primary sets of Python bindings for the Qt framework. </p> <p>QtPy</p> <p>a compatibility layer that allows you to write code once and run it with either PyQt or PySide by simply changing an environment variable.</p> <p>MVP</p>","tags":["gui","ui"]},{"location":"Programming/GUI/QT/MVP/","title":"MVP Model View Presenter","text":"<p>MVP splits your UI code into three roles:</p> <p>1\ufe0f\u20e3 Model \u2014 data &amp; business logic - Holds application state - Knows nothing about Qt or UI - Example: data classes, domain logic, timers, IO, calculations</p> <p>2\ufe0f\u20e3 View \u2014 UI only - Widgets, layouts, rendering - Emits user intent (signals like clicked, textChanged) - Has no business logic - Does not pull data from Model</p> <p>3\ufe0f\u20e3 Presenter \u2014 the glue - Listens to View events - Updates the Model - Listens to Model changes - Pushes updates to the View</p>","tags":["gui","mvp"]},{"location":"Programming/GUI/QT/MVP/#simple-demo","title":"Simple Demo","text":"<pre><code>\"\"\"\nMinimal PyQt6 MVP example\n\n- Model: plain Python (no Qt)\n- View: QWidget + signals (no logic)\n- Presenter: connects View \u2194 Model\n\nRun:\n  pip install PyQt6\n  python minimal_mvp.py\n\"\"\"\n\nfrom __future__ import annotations\nimport sys\nfrom dataclasses import dataclass\n\nfrom PyQt6.QtCore import QObject, pyqtSignal, pyqtSlot\nfrom PyQt6.QtWidgets import (\n    QApplication,\n    QWidget,\n    QVBoxLayout,\n    QLabel,\n    QLineEdit,\n)\n\n\n# -------------------------\n# Model (Qt-free)\n# -------------------------\n\n@dataclass\nclass GreetingModel:\n    name: str = \"\"\n\n    def greeting(self) -&gt; str:\n        n = self.name.strip()\n        return f\"Hello, {n}!\" if n else \"Hello!\"\n\n\n# -------------------------\n# View (UI only)\n# -------------------------\n\nclass GreetingView(QWidget):\n    # User intent exposed as signals\n    nameChanged = pyqtSignal(str)\n\n    def __init__(self) -&gt; None:\n        super().__init__()\n\n        self.edit = QLineEdit()\n        self.label = QLabel(\"Hello!\")\n\n        layout = QVBoxLayout(self)\n        layout.addWidget(QLabel(\"Name:\"))\n        layout.addWidget(self.edit)\n        layout.addWidget(QLabel(\"Greeting:\"))\n        layout.addWidget(self.label)\n\n        # UI \u2192 View signals\n        self.edit.textChanged.connect(self.nameChanged.emit)\n\n    # Presenter \u2192 View API\n    def set_greeting(self, text: str) -&gt; None:\n        self.label.setText(text)\n\n\n# -------------------------\n# Presenter (glue)\n# -------------------------\n\nclass GreetingPresenter(QObject):\n    def __init__(self, model: GreetingModel, view: GreetingView) -&gt; None:\n        super().__init__()\n        self.model = model\n        self.view = view\n\n        # View \u2192 Presenter\n        self.view.nameChanged.connect(self.on_name_changed)\n\n        # Initial render\n        self.view.set_greeting(self.model.greeting())\n\n    @pyqtSlot(str)\n    def on_name_changed(self, text: str) -&gt; None:\n        self.model.name = text\n        self.view.set_greeting(self.model.greeting())\n\n\n# -------------------------\n# Main\n# -------------------------\n\ndef main() -&gt; int:\n    app = QApplication(sys.argv)\n\n    model = GreetingModel()\n    view = GreetingView()\n    presenter = GreetingPresenter(model, view)  # keep reference!\n\n    view.setWindowTitle(\"Minimal PyQt6 MVP\")\n    view.resize(300, 150)\n    view.show()\n\n    return app.exec()\n\n\nif __name__ == \"__main__\":\n    raise SystemExit(main())\n</code></pre>","tags":["gui","mvp"]},{"location":"Programming/GUI/QT/MVP/#model-notify-variant","title":"Model notify variant","text":"","tags":["gui","mvp"]},{"location":"Programming/GUI/QT/MVP/#brief-remainder","title":"Brief remainder","text":"<p>Qt uses signals &amp; slots to implement an event-driven, observer pattern. pyqtSignal declares events; pyqtSlot receives them safely and efficiently.</p> <ul> <li>Signal \u2192 \u201cSomething happened\u201d</li> <li>Slot \u2192 \u201cWhat should run when it happens\u201d</li> </ul>","tags":["gui","mvp"]},{"location":"Programming/GUI/QT/MVP/#pyqtsignal","title":"pyqtSignal","text":"<ul> <li>Declared at class level</li> <li>Signal type is defined by argument list</li> <li>Emits with .emit(...)</li> <li>One signal \u2192 many receivers</li> </ul> declare<pre><code>from PyQt6.QtCore import QObject, pyqtSignal\n\nclass GreetingView(QWidget):\n    # User intent exposed as signals\n    nameChanged = pyqtSignal(str)\n\n    def __init__(self) -&gt; None:\n        super().__init__()\n\n        self.edit = QLineEdit()\n        self.label = QLabel(\"Hello!\")\n\n        #...\n\n        # UI \u2192 View signals\n        self.edit.textChanged.connect(self.nameChanged.emit)\n</code></pre>","tags":["gui","mvp"]},{"location":"Programming/GUI/QT/MVP/#pyqtslot","title":"pyqtSlot","text":"<p>pyqtSlot marks a method as a Qt slot.</p>","tags":["gui","mvp"]},{"location":"Programming/GUI/QT/MVP/#1-2-3-4-5-6-7from-pyqt6qtcore-import-pyqtslot-class-greetingpresenterqobject-pyqtslotstr-def-on_name_changedself-text-str-none-selfmodelname-text-selfviewset_greetingselfmodelgreeting","title":"<pre><code>from PyQt6.QtCore import pyqtSlot\n\nclass GreetingPresenter(QObject):\n    @pyqtSlot(str)\n    def on_name_changed(self, text: str) -&gt; None:\n        self.model.name = text\n        self.view.set_greeting(self.model.greeting())\n</code></pre>","text":"","tags":["gui","mvp"]},{"location":"Programming/GUI/QT/MVP/#reference","title":"Reference","text":"<ul> <li>Everything You NEED to Know About Client Architecture Patterns</li> </ul>","tags":["gui","mvp"]},{"location":"Programming/GUI/QT/Plugins/","title":"QT Plugins - Load widget dynamic","text":"main.py <pre><code>from __future__ import annotations\n\nimport importlib\nimport pkgutil\nimport sys\nfrom typing import List, cast\n\nfrom PyQt6.QtWidgets import (\n    QApplication,\n    QLabel,\n    QMainWindow,\n    QTabWidget,\n    QWidget,\n)\n\nfrom plugin_api import PluginHandle\n\n\ndef load_plugins(parent: QWidget) -&gt; List[PluginHandle]:\n    plugins: List[PluginHandle] = []\n    pkg = importlib.import_module(\"plugins\")\n\n    for mod in pkgutil.iter_modules(pkg.__path__):\n        if mod.ispkg:\n            continue\n        try:\n            module = importlib.import_module(f\"plugins.{mod.name}\")\n            create_plugin = getattr(module, \"create_plugin\", None)\n            if not callable(create_plugin):\n                continue\n            plugin = create_plugin(parent)\n            plugin = cast(PluginHandle, plugin)\n            plugins.append(plugin)\n        except Exception as exc:\n            print(f\"[plugin_app] Failed to load plugins.{mod.name}: {exc}\")\n\n    return plugins\n\n\nclass MainWindow(QMainWindow):\n    def __init__(self) -&gt; None:\n        super().__init__()\n        self.setWindowTitle(\"Qt MVP Plugin Tabs\")\n        self.resize(640, 360)\n\n        # Tab widget to hold plugins\n        self.tabs = QTabWidget()\n        self.setCentralWidget(self.tabs)\n\n        # Load plugins\n        self._plugins = load_plugins(self.tabs)\n        if not self._plugins:\n            self.tabs.addTab(QLabel(\"No plugins found in ./plugins\"), \"Empty\")\n        else:\n            for plugin in self._plugins:\n                self.tabs.addTab(plugin.widget, plugin.name)\n\n    def closeEvent(self, a0) -&gt; None:\n        for plugin in self._plugins:\n            if plugin.dispose:\n                plugin.dispose()\n        super().closeEvent(a0)\n\n\ndef main() -&gt; int:\n    app = QApplication(sys.argv)\n    win = MainWindow()\n    win.show()\n    return app.exec()\n\n\nif __name__ == \"__main__\":\n    raise SystemExit(main())\n</code></pre>","tags":["qt","plugin"]},{"location":"Programming/GUI/QT/Plugins/#dynamic-discovert","title":"Dynamic discovert","text":"<p>Dynamically discover and load plugin modules from a plugins package, call a factory function (create_plugin) in each plugin, and return a list of instantiated plugin objects.</p> <pre><code>def load_plugins(parent: QWidget) -&gt; List[PluginHandle]:\n    plugins: List[PluginHandle] = []\n    pkg = importlib.import_module(\"plugins\")\n\n    for mod in pkgutil.iter_modules(pkg.__path__):\n        if mod.ispkg:\n            continue\n        try:\n            module = importlib.import_module(f\"plugins.{mod.name}\")\n            create_plugin = getattr(module, \"create_plugin\", None)\n            if not callable(create_plugin):\n                continue\n            plugin = create_plugin(parent)\n            plugin = cast(PluginHandle, plugin)\n            plugins.append(plugin)\n        except Exception as exc:\n            print(f\"[plugin_app] Failed to load plugins.{mod.name}: {exc}\")\n\n    return plugins\n</code></pre>","tags":["qt","plugin"]},{"location":"Programming/GUI/QT/Plugins/#import-plugins-package","title":"import plugins package","text":"<ul> <li>Dynamically imports the package, not individual plugins</li> <li>Equivalent to: <code>import packages</code></li> </ul> <pre><code>pkg = importlib.import_module(\"plugins\")\n</code></pre>","tags":["qt","plugin"]},{"location":"Programming/GUI/QT/Plugins/#import-each-plugin-module","title":"import each plugin module","text":"<ul> <li>executes the plugin module</li> <li>registers its symbols in memory</li> </ul> <pre><code>module = importlib.import_module(f\"plugins.{mod.name}\")\n</code></pre>","tags":["qt","plugin"]},{"location":"Programming/GUI/QT/Plugins/#factory-method","title":"factory method","text":"<pre><code># get method\ncreate_plugin = getattr(module, \"create_plugin\", None)\n# run method\nplugin = create_plugin(parent)\n</code></pre> plugin_api.py <pre><code>from __future__ import annotations\n\nfrom dataclasses import dataclass\nfrom typing import Callable, Optional\n\nfrom PyQt6.QtWidgets import QWidget\n\n\n@dataclass\nclass PluginHandle:\n    plugin_id: str\n    name: str\n    widget: QWidget\n    presenter: object\n    dispose: Optional[Callable[[], None]] = None\n</code></pre> plugins/plug_demo.py <pre><code>from __future__ import annotations\n\nimport json\nimport threading\nfrom dataclasses import dataclass\nfrom typing import Optional\nfrom urllib import error as url_error\nfrom urllib import parse as url_parse\nfrom urllib import request as url_request\n\nfrom PyQt6.QtCore import QObject, pyqtSignal, pyqtSlot\nfrom PyQt6.QtWidgets import (\n    QWidget,\n    QVBoxLayout,\n    QHBoxLayout,\n    QLabel,\n    QLineEdit,\n    QPushButton,\n)\n\nfrom plugin_api import PluginHandle\n\nPLUGIN_ID = \"led-off\"\nPLUGIN_NAME = \"LED OFF\"\n\n\n# -------------------------\n# Model (Qt-free)\n# -------------------------\n\n@dataclass\nclass PluginModel:\n    base_url: str = \"http://127.0.0.1:8000\"\n    name: str = \"\"\n    greeting: str = \"\"\n    error: str = \"\"\n    loading: bool = False\n\n    def gpio(self, name: str, value: bool) -&gt; str:\n        # Build query string\n        query = url_parse.urlencode(\n            {\"name\": name, \"value\": \"true\" if value else \"false\"}\n        )\n\n        url = f\"{self.base_url}/gpio?{query}\"\n\n        # POST request with NO body\n        req = url_request.Request(\n            url=url,\n            method=\"POST\",\n            headers={\n                \"Accept\": \"application/json\",\n            },\n        )\n\n        try:\n            with url_request.urlopen(req, timeout=5) as resp:\n                if resp.status != 200:\n                    raise RuntimeError(f\"HTTP {resp.status}\")\n                payload = json.loads(resp.read().decode(\"utf-8\"))\n        except url_error.URLError as exc:\n            raise RuntimeError(f\"Request failed: {exc}\") from exc\n\n        greeting = payload.get(\"greeting\")\n        if not isinstance(greeting, str):\n            raise RuntimeError(\"Invalid response payload\")\n\n        return greeting\n\n\n# -------------------------\n# View (UI only)\n# -------------------------\n\nclass PluginView(QWidget):\n    nameChanged = pyqtSignal(str)\n    baseUrlChanged = pyqtSignal(str)\n    fetchClicked = pyqtSignal()\n\n    def __init__(self, parent: Optional[QWidget] = None) -&gt; None:\n        super().__init__(parent)\n\n        self.edit_base_url = QLineEdit()\n        self.edit_name = QLineEdit()\n        self.btn_fetch = QPushButton(\"LED off\")\n        self.lbl_status = QLabel()\n        self.lbl_greeting = QLabel()\n\n        root = QVBoxLayout(self)\n\n\n\n        root.addWidget(self.btn_fetch)\n\n\n        self.edit_name.textChanged.connect(self.nameChanged.emit)\n        self.edit_base_url.textChanged.connect(self.baseUrlChanged.emit)\n        self.btn_fetch.clicked.connect(self.fetchClicked.emit)\n\n    def set_greeting(self, text: str) -&gt; None:\n        self.lbl_greeting.setText(text)\n\n    def set_status(self, text: str) -&gt; None:\n        self.lbl_status.setText(text)\n\n    def set_loading(self, loading: bool) -&gt; None:\n        self.btn_fetch.setEnabled(not loading)\n\n\n# -------------------------\n# Presenter (glue)\n# -------------------------\n\nclass PluginPresenter(QObject):\n    resultReady = pyqtSignal(str)\n    errorReady = pyqtSignal(str)\n    loadingChanged = pyqtSignal(bool)\n\n    def __init__(self, model: PluginModel, view: PluginView) -&gt; None:\n        super().__init__()\n        self.model = model\n        self.view = view\n        self._worker: Optional[threading.Thread] = None\n\n        self.view.fetchClicked.connect(self.on_fetch_clicked)\n\n        self.resultReady.connect(self.on_result)\n        self.errorReady.connect(self.on_error)\n        self.loadingChanged.connect(self.on_loading_changed)\n\n        self.render()\n\n    def render(self) -&gt; None:\n        self.view.set_greeting(self.model.greeting)\n        if self.model.loading:\n            self.view.set_status(\"Loading...\")\n            self.view.set_loading(True)\n        else:\n            self.view.set_status(self.model.error)\n            self.view.set_loading(False)\n\n\n\n    @pyqtSlot()\n    def on_fetch_clicked(self) -&gt; None:\n        if self.model.loading:\n            return\n        self.model.error = \"\"\n        self.model.greeting = \"\"\n        self.model.loading = True\n        self.render()\n\n        name = \"GPA0\"\n\n        def run() -&gt; None:\n            try:\n                greeting = self.model.gpio(name, False)\n                self.resultReady.emit(greeting)\n            except Exception as exc:\n                self.errorReady.emit(str(exc))\n            finally:\n                self.loadingChanged.emit(False)\n\n        self._worker = threading.Thread(target=run, daemon=True)\n        self._worker.start()\n\n    @pyqtSlot(str)\n    def on_result(self, greeting: str) -&gt; None:\n        self.model.greeting = greeting\n        self.model.error = \"\"\n        self.render()\n\n    @pyqtSlot(str)\n    def on_error(self, message: str) -&gt; None:\n        self.model.error = message\n        self.model.greeting = \"\"\n        self.render()\n\n    @pyqtSlot(bool)\n    def on_loading_changed(self, loading: bool) -&gt; None:\n        self.model.loading = loading\n        self.render()\n\n    def dispose(self) -&gt; None:\n        self.model.loading = False\n\n\n# -------------------------\n# Plugin factory\n# -------------------------\n\ndef create_plugin(parent: Optional[QWidget] = None) -&gt; PluginHandle:\n    model = PluginModel()\n    view = PluginView(parent)\n    presenter = PluginPresenter(model, view)\n    return PluginHandle(\n        plugin_id=PLUGIN_ID,\n        name=PLUGIN_NAME,\n        widget=view,\n        presenter=presenter,\n        dispose=presenter.dispose,\n    )\n</code></pre>","tags":["qt","plugin"]},{"location":"Programming/ai/","title":"AI ML and what inside","text":"<p>Math</p> <p>ONNX</p> <p>Neural Networks From Scratch in Python</p> <p>Reinforcement Learning</p>"},{"location":"Programming/ai/#resources","title":"Resources","text":"<ul> <li>Neural Networks From Scratch</li> <li>Deep Learning with PyTorch Step-by-Step Official repository of my book: \"Deep Learning with PyTorch Step-by-Step: A Beginner's Guide\" </li> </ul>"},{"location":"Programming/ai/math/","title":"AI Math","text":"<ul> <li>Linear Algebra for Machine Learning</li> </ul>"},{"location":"Programming/ai/nnfs/","title":"Neural Networks From Scratch in Python","text":"<p>Programming / ai</p> <p>MNIST</p>","tags":["ai","Neural Networks From Scratch in Python"]},{"location":"Programming/ai/nnfs/#reference","title":"Reference","text":"<ul> <li>Neural Networks From Scratch in Python</li> </ul>","tags":["ai","Neural Networks From Scratch in Python"]},{"location":"Programming/ai/nnfs/mnist/","title":"Index","text":"<p>Programming / ai / nnfs</p> <ul> <li>MNIST: A Beginner\u2019s Guide to Artificial Intelligence with Digit Recognition</li> </ul>","tags":["mnist","ai"]},{"location":"Programming/ai/onnx/","title":"ONNX","text":"<p>ONNX (Open Neural Network Exchange) is an open-source format for representing machine learning models, designed to enable interoperability between different deep learning frameworks</p> <p>C++</p> <p>---</p> <p>---</p>","tags":["onnx","ai"]},{"location":"Programming/ai/onnx/#todo-move-to-its-on-section","title":"#TODO: move to it's on section","text":"","tags":["onnx","ai"]},{"location":"Programming/ai/onnx/#install-on-nvidia-jetson-with-jetpack-62","title":"Install on nvidia jetson with jetpack 6.2","text":"<p>!!! warning \"onnx version\" - The last package from Jetson Zoo is for jetpack 6.0 - I found the last version 1.23 pypi.jetson-ai-lab.io it's installed successfully</p> <p>pypi.jetson-ai-lab.io</p> <p>many sites refer to nvidia url: https://pypi.jetson-ai-lab.dev/jp6/cu126, note to the dev suffix</p> <pre><code>the `dev` part reploace by `io`\nhttps://pypi.jetson-ai-lab.io/jp6/cu126\n</code></pre>","tags":["onnx","ai"]},{"location":"Programming/ai/onnx/#installed-on-docker","title":"Installed on docker","text":"<p>Install onnxruntime-gpu on docker that run on jetson orin using vscode and devcontainer</p> <pre><code>.\n|-- .devcontainer\n|   |-- Dockerfile\n|   `-- devcontainer.json\n|-- .gitignore\n|-- .vscode\n|-- README.md\n|-- docker-compose.yaml\n|-- requirements.txt\n`-- scripts\n    `-- check.py\n</code></pre> <p>At last i update my host with the command <code>sudo apt install nvidia-jetpack</code> And use the docker image nvcr.io/nvidia/l4t-jetpack:r36.4.0 find at NGC Catalog</p> Package version note jetpack R36.4.3 cat /etc/nv_tegra_release cuda 2.6 nvcc --version cudnn 9.3.0 <code>dpkg -l \\| grep cudnn</code> tensorrt 10.3.0.30 <code>dpkg -l \\| grep tensorrt</code> onnxruntime 1.23.0 <code>python3 -c \"import onnxruntime as ort; print('ONNX Runtime version:', ort.__version__)</code>\"","tags":["onnx","ai"]},{"location":"Programming/ai/onnx/#code","title":"Code","text":".devcontainer/devcontainer.json <pre><code>{\n    \"name\": \"onnx\",\n    \"dockerComposeFile\": \"../docker-compose.yaml\",\n    \"service\": \"dev\",\n    \"shutdownAction\": \"stopCompose\",\n    \"workspaceFolder\": \"/workspace\",\n    \"customizations\": {\n      \"vscode\": {\n        \"extensions\": [\n            \"ms-python.python\",\n            \"ms-vscode.cpptools\",\n            \"twxs.cmake\",\n            \"redhat.vscode-xml\",\n            \"redhat.vscode-yaml\",\n            \"albert.tabout\",\n            \"actboy168.tasks\",\n            \"streetsidesoftware.code-spell-checker\",\n            \"mhutchie.git-graph\",\n            \"dlech.chmod\",\n            \"smilerobotics.urdf\"\n        ],\n        \"settings\": {}\n      }\n    }\n  }\n</code></pre> .devcontainer/Dockerfile <pre><code># FROM nvidia/cuda:12.6.0-cudnn-runtime-ubuntu22.04\nFROM nvcr.io/nvidia/l4t-jetpack:r36.4.0\n\nARG USERNAME=user\nARG USER_UID=1000\nARG USER_GID=$USER_UID\n\n# Check if \"ubuntu\" user exists, delete it if it does, then create the desired user\nRUN if getent passwd ubuntu &gt; /dev/null 2&gt;&amp;1; then \\\n        userdel -r ubuntu &amp;&amp; \\\n        echo \"Deleted existing ubuntu user\"; \\\n    fi &amp;&amp; \\\n    groupadd --gid $USER_GID $USERNAME &amp;&amp; \\\n    useradd -s /bin/bash --uid $USER_UID --gid $USER_GID -m $USERNAME &amp;&amp; \\\n    echo \"Created new user $USERNAME\"\n\n# Add sudo support for the non-root user\nRUN apt-get update &amp;&amp; apt-get install -y sudo \\\n  &amp;&amp; echo $USERNAME ALL=\\(root\\) NOPASSWD:ALL &gt; /etc/sudoers.d/$USERNAME\\\n  &amp;&amp; chmod 0440 /etc/sudoers.d/$USERNAME \\\n  &amp;&amp; rm -rf /var/lib/apt/lists/*\n\n# Install Python and pip\nRUN apt-get update \\\n    &amp;&amp; apt-get -y install --no-install-recommends \\\n        python3-pip \\\n        python3-dev \\\n    &amp;&amp; apt-get clean -y \\\n    &amp;&amp; rm -rf /var/lib/apt/lists/*\n\n# Copy and install requirements\nCOPY requirements.txt /tmp/requirements.txt\nRUN pip3 install --no-cache-dir -r /tmp/requirements.txt\n\n# RUN pip3 install https://github.com/ultralytics/assets/releases/download/v0.0.0/onnxruntime_gpu-1.20.0-cp310-cp310-linux_aarch64.whl\nRUN pip3 install https://pypi.jetson-ai-lab.io/jp6/cu126/+f/e1e/9e3dc2f4d5551/onnxruntime_gpu-1.23.0-cp310-cp310-linux_aarch64.whl#sha256=e1e9e3dc2f4d5551c5f0b5554cf490d141cd0d339a5a7f4826ac0e04f20a35fc\n\n# RUN apt-get update \\\n#     &amp;&amp; apt-get -y install --no-install-recommends \\\n#         wget \\\n#         libgl1 \\\n#         libglib2.0-0 \\\n#         libsm6 \\\n#         libxext6 \\\n#         libxrender-dev \\\n#     &amp;&amp; apt-get clean -y \\\n#     &amp;&amp; rm -rf /var/lib/apt/lists/*\n</code></pre> docker-compose.yaml <pre><code>services:\n  dev:\n    build:\n      context: .\n      dockerfile: .devcontainer/Dockerfile\n    deploy:\n      resources:\n        reservations:\n          devices:\n            - capabilities: [gpu]\n    volumes:\n      - .:/workspace:cached\n    hostname: dev\n    network_mode: host\n    stdin_open: true\n    tty: true\n    runtime: nvidia\n    environment:\n      - NVIDIA_VISIBLE_DEVICES=all\n      - NVIDIA_DRIVER_CAPABILITIES=compute,utility\n</code></pre> requirements.txt <pre><code>opencv-python-headless\nnumpy&lt;2\n</code></pre> <p>python package location</p> <p>https://pypi.jetson-ai-lab.io/jp6/cu129</p>","tags":["onnx","ai"]},{"location":"Programming/ai/onnx/#run","title":"Run","text":"<pre><code>import onnxruntime as ort\n\nort.set_default_logger_severity(0)  # 0 = VERBOSE, 1 = INFO, 2 = WARNING, 3 = ERROR, 4 = FATAL\n\n\n# Show all available providers on your machine\nprint(\"Available providers:\", ort.get_available_providers())\nprint(\"ONNX Runtime version:\", ort.__version__)\nprint(\"Build info:\", ort.get_device())\n</code></pre> <pre><code>Available providers: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']\nONNX Runtime version: 1.20.0\nBuild info: GPU\n</code></pre>","tags":["onnx","ai"]},{"location":"Programming/ai/onnx/#demo-mnist","title":"Demo: mnist","text":"<p>MNIST model home page</p> <p>mnist-8.onnx</p> <p>[W:onnxruntime:Default, device_discovery.cc:164 DiscoverDevicesForPlatform] GPU device discovery failed: device_discovery.cc:89 ReadFileContents Failed to open file: \"/sys/class/drm/card1/device/vendor\"</p> <pre><code>for known i don't found and reference that help resolve the issue\n</code></pre> <ul> <li>work with onnxruntime-gpu version 1.23</li> <li>need numpy &lt;2</li> <li>images zero, six</li> <li>model: mnist-8.onnx</li> <li>try with the 3 providers</li> <li>on the docker side success only with the cpu (TODO)</li> <li>on the host all off them work</li> </ul> <pre><code>import onnxruntime as ort\nimport numpy as np\nimport cv2\n\nort.set_default_logger_severity(0)  # 0 = VERBOSE, 1 = INFO, 2 = WARNING, 3 = ERROR, 4 = FATAL\n\n\n# --- Load ONNX model ---\n# \"CPUExecutionProvider\"\n# CUDAExecutionProvider\n# TensorrtExecutionProvider\nsession = ort.InferenceSession(\"model/mnist-8.onnx\", providers=[\"CUDAExecutionProvider\"])\n\n# --- Load and preprocess an image (28\u00d728 grayscale) ---\n# You can replace 'digit.png' with your own file.\nimg = cv2.imread(\"images/six_1.png\", cv2.IMREAD_GRAYSCALE)\n\nif img is None:\n    # fallback: create a synthetic \"3\"-like shape for demo\n    img = np.zeros((28, 28), np.uint8)\n    cv2.putText(img, \"3\", (4, 24), cv2.FONT_HERSHEY_SIMPLEX, 0.9, 255, 2)\n\n# Normalize to [0,1]\nimg = img.astype(np.float32) / 255.0\n\n# Reshape to NCHW = (1,1,28,28)\nimg = img.reshape(1, 1, 28, 28)\n\n# --- Run inference ---\ninput_name = session.get_inputs()[0].name\noutput_name = session.get_outputs()[0].name\n\npred = session.run([output_name], {input_name: img})[0]\ndigit = int(np.argmax(pred))\n\nprint(f\"Predicted digit: {digit}\")\n</code></pre>","tags":["onnx","ai"]},{"location":"Programming/ai/onnx/#tutorials","title":"tutorials","text":"<ul> <li>Unlocking the Power of ONNX: A Beginner\u2019s Guide with Practical Examples by using 80\u201320 rule</li> <li>Unlocking the Power of ONNX: A Beginner\u2019s Guide with Practical Examples by using 80\u201320 rule (Part-2)</li> </ul>","tags":["onnx","ai"]},{"location":"Programming/ai/onnx/#references","title":"References","text":"<ul> <li>onnx tutorial</li> <li>ONNX Explained with Example | Quick ML Tutorial</li> </ul>","tags":["onnx","ai"]},{"location":"Programming/ai/onnx/cpp/","title":"Using onnx inference using C++","text":"<p>Programming / ai / onnx</p>","tags":["onnx","cpp"]},{"location":"Programming/ai/onnx/cpp/#install","title":"Install","text":"<ul> <li>Download from  releases page</li> <li>Extract and copy to include and lib folders</li> </ul> <pre><code># version 1.23\ntar -xzf onnxruntime-linux-x64-gpu-1.23.1.tgz\nsudo cp -r onnxruntime-linux-x64-gpu-1.23.1/include /usr/local/include/onnxruntime\nsudo mkdir /usr/local/lib/onnxruntime/\nsudo cp -r onnxruntime-linux-x64-gpu-1.23.1/lib/* /usr/local/lib/onnxruntime/\nsudo ldconfig\n</code></pre>","tags":["onnx","cpp"]},{"location":"Programming/ai/onnx/cpp/#demo","title":"Demo","text":"<pre><code>#include &lt;iostream&gt;\n#include &lt;onnxruntime_cxx_api.h&gt;\n\nint main() {\n    // Initialize ONNX Runtime environment\n    Ort::Env env(ORT_LOGGING_LEVEL_WARNING, \"providers_info\");\n\n    // Print version info\n    std::cout &lt;&lt; \"ONNX Runtime version: \" &lt;&lt; Ort::GetVersionString() &lt;&lt; std::endl;\n\n    // Get available execution providers\n    auto providers = Ort::GetAvailableProviders();\n\n    std::cout &lt;&lt; \"Available providers:\" &lt;&lt; std::endl;\n    for (const auto&amp; p : providers) {\n        std::cout &lt;&lt; \"  - \" &lt;&lt; p &lt;&lt; std::endl;\n    }\n\n    // Device info \u2014 equivalent to Python's ort.get_device()\n    // (C++ API doesn't expose a global 'get_device', so we check provider priority)\n    if (std::find(providers.begin(), providers.end(), \"CUDAExecutionProvider\") != providers.end()) {\n        std::cout &lt;&lt; \"Default device: GPU (CUDA)\" &lt;&lt; std::endl;\n    } else {\n        std::cout &lt;&lt; \"Default device: CPU\" &lt;&lt; std::endl;\n    }\n\n    return 0;\n}\n</code></pre> <pre><code>cmake_minimum_required(VERSION 3.10)\nproject(onnxruntime_info)\n\nset(CMAKE_CXX_STANDARD 17)\nset(CMAKE_CXX_STANDARD_REQUIRED ON)\n\n\n# Point to ONNXRuntime headers &amp; libs that install from tar\ninclude_directories(/usr/local/include/onnxruntime)\nlink_directories(/usr/local/lib/onnxruntime)\n\nadd_executable(onnx_info src/check.cpp)\ntarget_link_libraries(onnx_info onnxruntime)\n</code></pre> output<pre><code>ONNX Runtime version: 1.23.1\nAvailable providers:\n  - TensorrtExecutionProvider\n  - CUDAExecutionProvider\n  - CPUExecutionProvider\nDefault device: GPU (CUDA)\n</code></pre>","tags":["onnx","cpp"]},{"location":"Programming/ai/onnx/cpp/#reference","title":"Reference","text":"<ul> <li>Number recognition with MNIST in C++ </li> </ul>","tags":["onnx","cpp"]},{"location":"Programming/ai/reinforcement_learning/","title":"Reinforcement Learning","text":"<p>Programming / ai</p> <p>GYM</p>","tags":["reinforcement","q-learning","learning"]},{"location":"Programming/ai/reinforcement_learning/#resources","title":"Resources","text":"<ul> <li>RL Course by David Silver</li> <li>Reinforcement Learning beginner to master - AI in Python</li> <li>Reinforcement Learning in 3 Hours</li> <li>Q-learning</li> <li>Reinforcement learning playground ROS and gazebo</li> </ul>","tags":["reinforcement","q-learning","learning"]},{"location":"Programming/ai/reinforcement_learning/gym/","title":"Using RL with Gymnasium","text":"<p>Programming / ai / reinforcement learning</p> <p>Custom Env</p>","tags":["rl","gym","reinforcement","gymnasium"]},{"location":"Programming/ai/reinforcement_learning/gym/#gymnasium-main-concepts","title":"Gymnasium main concepts","text":"<ul> <li>Observation Space: Set of possible state that agent can observe in the environment</li> <li>Action Space: Set of actions that agent cant take in environment</li> <li>Episode: A complete run through the environment from initial state until terminate state is reach, each episode is composed if a sequence of states, actions and rewards </li> <li>Wrapper: A tool in GYM that allow modify an environment behavior without changing its code, for example and time constrain and action masking</li> <li>Benchmark: Help to compare between different RL algorithm</li> </ul> <pre><code>graph TD\n\n    S[State/Observation\\ns_t] --&gt; A[Agent]\n    A --&gt;|Select Action a_t| ENV[Environment]\n    ENV --&gt;|Reward r_t| A\n    ENV --&gt;|Next Observation s_{t+1}| A\n\n    style S fill:#d9eaff,stroke:#0052a3,stroke-width:1.5px\n    style A fill:#c7ffd9,stroke:#007a3d,stroke-width:1.5px\n    style ENV fill:#ffe2bc,stroke:#cc7a00,stroke-width:1.5px</code></pre>","tags":["rl","gym","reinforcement","gymnasium"]},{"location":"Programming/ai/reinforcement_learning/gym/#observation-space","title":"Observation space","text":"<p>What information the environment gives the agent</p>","tags":["rl","gym","reinforcement","gymnasium"]},{"location":"Programming/ai/reinforcement_learning/gym/#action-space","title":"Action space","text":"<p>What actions the agent is allowed to take</p>","tags":["rl","gym","reinforcement","gymnasium"]},{"location":"Programming/ai/reinforcement_learning/gym/#_1","title":"Using RL with Gymnasium","text":"<ul> <li>next_state: the observation after taking the action</li> <li>reward: the reward after tacking the action</li> <li>terminated: boolean, true if episode ended</li> <li>truncated: boolean , true if the episode end by early truncation (time limit reached)</li> <li>info: a dictionary contain additional environment information (for example in atari game it's hold user lives)</li> </ul>","tags":["rl","gym","reinforcement","gymnasium"]},{"location":"Programming/ai/reinforcement_learning/gym/#reference","title":"Reference","text":"<ul> <li>gym solution</li> <li>Build a Custom Gymnasium Reinforcement Learning Environment &amp; Train w Q-Learning &amp; Stable Baselines3</li> <li>gym turtlebot</li> </ul>","tags":["rl","gym","reinforcement","gymnasium"]},{"location":"Programming/ai/reinforcement_learning/gym/custom_environment/","title":"Make custom Gymnasium environment","text":"","tags":["rl","gym","reinforcement","gymnasium","custom"]},{"location":"Programming/ai/reinforcement_learning/gym/custom_environment/#simple-environment","title":"Simple environment","text":"<p>my code base on johnnycode8</p>","tags":["rl","gym","reinforcement","gymnasium","custom"]},{"location":"Programming/ai/reinforcement_learning/gym/custom_environment/#pybullet-environment","title":"PyBullet environment","text":"","tags":["rl","gym","reinforcement","gymnasium","custom"]},{"location":"Programming/ai/reinforcement_learning/gym/custom_environment/#reference","title":"Reference","text":"<ul> <li>Custom Gym Environment</li> <li>Make your own custom environment</li> <li>OpenAI Gym Environments with PyBullet (Part 1)</li> <li>Gym with pybullet</li> </ul>","tags":["rl","gym","reinforcement","gymnasium","custom"]},{"location":"Programming/configure_files/","title":"Configuration files","text":"<p>json</p> <p>YAML</p> <p>TOML</p>","tags":["toml","yaml","json"]},{"location":"Programming/configure_files/json/","title":"JSON","text":"<p>JSON (JavaScript Object Notation) is a lightweight, text-based data format used to store and exchange structured data in a simple, readable way.</p> <ul> <li>Uses key\u2013value pairs and arrays</li> <li>Easy for humans to read and machines to parse</li> <li>Commonly used in APIs, configuration files, and data exchange</li> </ul> <pre><code>{\n  \"name\": \"robot\",\n  \"enabled\": true,\n  \"count\": 3\n}\n</code></pre> simple.py<pre><code>import json\nimport pprint\n\ntry:\n    with open(\"simple.json\") as f:\n        data = json.load(f)\n        pprint.pprint(data)\nexcept json.JSONDecodeError as e:\n    print(\"Invalid JSON:\", e)\n</code></pre> <p>json5</p> <p>json schema</p>","tags":["python","json"]},{"location":"Programming/configure_files/json/json5/","title":"JSON5","text":"<p>JSON5 is an extension of JSON designed to be more human-friendly while staying close to JSON.</p> <p>What json5 add compare to json - Comments - multi line string - hex - trailing commas </p> <pre><code>pip install json5\n</code></pre> <pre><code>import json5\n\nwith open(\"config.json5\") as f:\n    data = json5.load(f)\n\nprint(data[\"name\"])   # diffbot\n</code></pre>","tags":["python","json5"]},{"location":"Programming/configure_files/json/json_schema/","title":"JSON Schema","text":"<p>json schema  While JSON is probably the most popular format for exchanging data, JSON Schema is the vocabulary that enables JSON data consistency, validity, and interoperability at scale.</p>","tags":["python","json","schema"]},{"location":"Programming/configure_files/yaml/","title":"YAML","text":"<p>YAML stands for \u201cYAML Ain\u2019t Markup Language.\u201d It\u2019s a human-readable data format used to represent configuration and structured data.</p> <p>YAML struct define by indentation Use spaces only not TAB'S Common style : 2 space per level</p> <p>Tip</p> <pre><code>pip install --break-system-packages yamllint\n</code></pre> <p>Tip</p> <pre><code>pip install pyyaml\n</code></pre>","tags":["python","yaml"]},{"location":"Programming/configure_files/yaml/#simple-yaml","title":"simple YAML","text":"","tags":["python","yaml"]},{"location":"Programming/configure_files/yaml/#dictionary-map-key-value","title":"Dictionary (map / key-value)","text":"simple.py<pre><code>---\nkey: value\n</code></pre>","tags":["python","yaml"]},{"location":"Programming/configure_files/yaml/#load-and-print","title":"load and print","text":"<p>Simple python load yaml and print it using <code>pprint</code></p> simple.py<pre><code>from typing import Any\nimport yaml\nimport pathlib\n\ndef load_yaml(path: str) -&gt; Any:\n    \"\"\"Load a single-document YAML file using safe_load.\"\"\"\n    with open(path, \"r\", encoding=\"utf-8\") as f:\n        return yaml.safe_load(f)\n\nif __name__ == \"__main__\":\n    file = pathlib.Path(__file__).parent.joinpath(\"simple.yaml\").as_posix()\n    data = load_yaml(file)\n    print(data)\n</code></pre> usage<pre><code>python simple.py\n#\n&lt;class 'dict'&gt;\n{'key': 'value'}\n</code></pre>","tags":["python","yaml"]},{"location":"Programming/configure_files/yaml/#comments","title":"Comments","text":"<p>Anything on a line after <code>#</code> is ignored by YAML parsers.</p>","tags":["python","yaml"]},{"location":"Programming/configure_files/yaml/#list","title":"List","text":"<p>Each <code>-</code> begins a new element in the sequence.</p> <pre><code>---\nlist:\n  - apple\n  - banana\n  - orange\n\nalternative: [grape, mango, pineapple]\n</code></pre>","tags":["python","yaml"]},{"location":"Programming/configure_files/yaml/#mapping","title":"Mapping","text":"<p>Unordered key-value pairs</p> <pre><code>---\nworker:\n  id: 22222\n  name: me\n  age: 32\n\nalternative: {id:2222, age:30, name: dddd}\n</code></pre>","tags":["python","yaml"]},{"location":"Programming/configure_files/yaml/#string","title":"string","text":"<p>You don\u2019t need quotes unless contain special character or start with <code>{,[,#]</code></p>","tags":["python","yaml"]},{"location":"Programming/configure_files/yaml/#multiline","title":"multiline","text":"just folded<pre><code>msg: &gt;\n  Hello\n  world\n</code></pre> multi line string<pre><code>msg2: |\n  Hello\n  world\n</code></pre>","tags":["python","yaml"]},{"location":"Programming/configure_files/yaml/#1-2-3-4-msg-hello-worldn-msg2-hellonworld","title":"<pre><code>{\n  'msg': 'Hello world\\n', \n  'msg2': 'Hello\\nworld'\n}\n</code></pre>","text":"","tags":["python","yaml"]},{"location":"Programming/configure_files/yaml/#null","title":"null","text":"<pre><code>value1: null\nvalue2: ~\nvalue3:\n</code></pre> <pre><code># simple.py result\n{'value1': None, 'value2': None, 'value3': None}\n</code></pre>","tags":["python","yaml"]},{"location":"Programming/configure_files/yaml/#types","title":"types","text":"<ul> <li>string</li> <li>boolean</li> <li>integer</li> <li>float</li> <li>list</li> <li>dict</li> <li>null</li> </ul> <pre><code>int_val: 10\nfloat_val: 3.14\nbool_true: true\nbool_false: false\nstring1: hello\nstring2: \"hello\"\nlist: [1, 2, 3, 4, 5]\ndict:\n  key1: value1\n  key2: value2\nnull_val: null\n</code></pre>","tags":["python","yaml"]},{"location":"Programming/configure_files/yaml/#linter","title":"linter","text":"<p>github source <pre><code>pip install --break-system-packages yamllint\n</code></pre></p>","tags":["python","yaml"]},{"location":"Programming/configure_files/yaml/#configuration","title":"Configuration","text":"<pre><code>extends: default\n\nrules:\n  # 80 chars should be enough, but don't fail if a line is longer\n  line-length:\n    max: 80\n    level: warning\n</code></pre> <pre><code>yamllint -c /path/myconfig file-to-lint.yaml\n</code></pre>","tags":["python","yaml"]},{"location":"Programming/configure_files/yaml/#schemas","title":"Schemas","text":"<p>YAML Language support uses JSON Schemas to understand the shape of a YAML file, including its value sets, defaults and descriptions. The schema support is shipped with JSON Schema Draft 7.</p> <p>The association of a YAML file to a schema can be done either in the YAML file itself using a modeline or in the User or Workspace settings under the property <code>yaml.schemas.</code> in vscode settings</p>","tags":["python","yaml"]},{"location":"Programming/configure_files/yaml/#associating-a-schema-in-the-yaml-file","title":"Associating a schema in the YAML file","text":"<pre><code># yaml-language-server: $schema=&lt;urlToTheSchema&gt;\n</code></pre>","tags":["python","yaml"]},{"location":"Programming/configure_files/yaml/#vscode","title":"VSCode","text":"","tags":["python","yaml"]},{"location":"Programming/configure_files/yaml/#extension","title":"Extension","text":"","tags":["python","yaml"]},{"location":"Programming/configure_files/yaml/#settings","title":"Settings","text":"","tags":["python","yaml"]},{"location":"Programming/configure_files/yaml/#schema","title":"Schema","text":"<pre><code>yaml.schemas: {\n    \"/home/user/custom_schema.json\": \"someFilePattern.yaml\",\n}\n</code></pre>","tags":["python","yaml"]},{"location":"Programming/cpp/","title":"C++","text":"<p>Programming</p> <p>VSCode dev env.</p> <p>CMake</p> <p>gtest</p> <p>Zero to Hero</p>","tags":["cpp","vscode"]},{"location":"Programming/cpp/#libraries","title":"Libraries","text":"<p>fmt</p> <p>msgpack</p> <p>---</p>","tags":["cpp","vscode"]},{"location":"Programming/cpp/#compilers","title":"Compilers","text":"C++ GCC Clang ubuntu Notes C++17 7 5 C++20 11 14 22.04 C++23 13 18 24.04","tags":["cpp","vscode"]},{"location":"Programming/cpp/#courses","title":"Courses","text":"<ul> <li>Modern C++ Programming</li> </ul>","tags":["cpp","vscode"]},{"location":"Programming/cpp/cmake/","title":"CMake","text":"<p>CMakePresets.json</p> <p>gtest</p> <p></p>","tags":["cmake","cpp"]},{"location":"Programming/cpp/cmake/#reference","title":"Reference","text":"<ul> <li>More Modern CMake</li> </ul>","tags":["cmake","cpp"]},{"location":"Programming/cpp/cmake/cmake_preset/","title":"CMakePreset.json","text":"<p>Programming / cpp / cmake</p> <p>CMake presets by creating a file named <code>CMakePresets.json</code> in your project root directory. The basic format for this file is:</p> <pre><code>{\n  \"version\": 3,\n  \"cmakeMinimumRequired\": {\n    \"major\": 3,\n    \"minor\": 23,\n    \"patch\": 0\n  },\n  \"configurePresets\": [\n    {\n      // ...\n    }\n  ],\n  \"buildPresets\": [\n    {\n      // ...\n    }\n  ],\n  \"testPresets\": [\n    {\n      // ...\n    }\n  ]\n}\n</code></pre>","tags":["cmake","presets"]},{"location":"Programming/cpp/cmake/cmake_preset/#preset-types","title":"Preset types","text":"Section Used by Purpose <code>\"configurePresets\"</code> <code>cmake --preset</code> How to generate build files <code>\"buildPresets\"</code> <code>cmake --build --preset</code> How to compile <code>\"testPresets\"</code> <code>ctest --preset</code> How to run tests <code>\"packagePresets\"</code> (optional) <code>cpack --preset</code> How to create installers (support cmake&gt;3.24) <p>version field</p> <p>version: 2 \u2192 CMake \u2265 3.20 version: 3 \u2192 CMake \u2265 3.21 version: 4 \u2192 CMake \u2265 3.23 version: 5 \u2192 CMake \u2265 3.24 version: 6 \u2192 CMake \u2265 3.25</p> <pre><code>ubuntu 22.04 default cmake : 3.22.1\nubuntu 24.04 default cmake : 3.28.3\n</code></pre>","tags":["cmake","presets"]},{"location":"Programming/cpp/cmake/cmake_preset/#preset-definition","title":"Preset definition","text":"Field Description <code>\"name\"</code> Unique identifier (used in commands) <code>\"displayName\"</code> Friendly label shown in IDE <code>\"generator\"</code> Build tool (\u201cNinja\u201d, \u201cUnix Makefiles\u201d, etc.) <code>\"binaryDir\"</code> Output directory for this preset <code>\"cacheVariables\"</code> Key-value pairs (like <code>-D</code> arguments) <code>\"inherits\"</code> Reuse another preset\u2019s settings <code>\"environment\"</code> Environment variables set for this preset <code>\"hidden\"</code> If true, not shown in IDE list but usable as a base preset <pre><code>\"configurePresets\": [\n        {\n            \"name\": \"default\",\n            \"hidden\": false,\n            \"generator\": \"Ninja\",\n            \"description\": \"Default configure preset\",\n            \"binaryDir\": \"${sourceDir}/build\",\n            \"cacheVariables\": {\n                \"CMAKE_BUILD_TYPE\": \"Release\"\n            }\n        },\n]\n</code></pre>","tags":["cmake","presets"]},{"location":"Programming/cpp/cmake/cmake_preset/#using-inheritance","title":"Using inheritance","text":"<p>Avoid repeating common options using inheritance</p> <pre><code>{\n  \"name\": \"base\",\n  \"hidden\": true,\n  \"generator\": \"Ninja\",\n  \"cacheVariables\": {\n    \"CMAKE_EXPORT_COMPILE_COMMANDS\": \"ON\"\n  }\n},\n{\n  \"name\": \"debug\",\n  \"inherits\": \"base\",\n  \"binaryDir\": \"${sourceDir}/build/debug\",\n  \"cacheVariables\": {\n    \"CMAKE_BUILD_TYPE\": \"Debug\"\n  }\n}\n</code></pre> <p>TODO</p> <p>check if multi inheritance work</p>","tags":["cmake","presets"]},{"location":"Programming/cpp/cmake/cmake_preset/#commands","title":"Commands","text":"<pre><code>cmake --list-presets\n</code></pre> <pre><code>cmake --preset &lt;name&gt;\n</code></pre>","tags":["cmake","presets"]},{"location":"Programming/cpp/cmake/cmake_preset/#demo","title":"Demo","text":"<pre><code>.\n\u251c\u2500\u2500 CMakeLists.txt\n\u251c\u2500\u2500 CMakePresets.json\n\u251c\u2500\u2500 include\n\u2502   \u2514\u2500\u2500 demo\n\u2502       \u2514\u2500\u2500 lib.hpp\n\u251c\u2500\u2500 src\n\u2502   \u251c\u2500\u2500 lib.cpp\n\u2502   \u2514\u2500\u2500 main.cpp\n\u2514\u2500\u2500 test\n   \u2514\u2500\u2500 test_add.cpp\n</code></pre> src/main.cpp<pre><code>#include &lt;iostream&gt;\n#include \"demo/lib.hpp\"\n\nint main(int argc, char** argv) {\n    std::string name = (argc &gt; 1) ? argv[1] : \"\";\n    std::cout &lt;&lt; demo::greet(name) &lt;&lt; \"\\n\";\n    std::cout &lt;&lt; \"2 + 3 = \" &lt;&lt; demo::add(2, 3) &lt;&lt; \"\\n\";\n    return 0;\n}\n</code></pre> src/lib.cpp<pre><code>#include \"demo/lib.hpp\"\n\nnamespace demo {\n\nint add(int a, int b) {\n    return a + b;\n}\n\nstd::string greet(const std::string &amp;name) {\n    if (name.empty()) return \"Hello, World!\";\n    return \"Hello, \" + name + \"!\";\n}\n\n} // namespace demo\n</code></pre> include/demo/lib.hpp<pre><code>#pragma once\n#include &lt;string&gt;\n\nnamespace demo {\n\n// Adds two integers and returns the sum.\nint add(int a, int b);\n\n// Returns a greeting message (\"Hello, &lt;name&gt;!\"). If name empty =&gt; \"Hello, World!\".\nstd::string greet(const std::string &amp;name);\n\n} // namespace demo\n</code></pre> test/test_add.cpp<pre><code>#include &lt;gtest/gtest.h&gt;\n#include \"demo/lib.hpp\"\n\nTEST(AddTests, BasicPositive) {\n    EXPECT_EQ(demo::add(2,3), 5);\n}\n\nTEST(AddTests, NegativeAndPositive) {\n    EXPECT_EQ(demo::add(-1,1), 0);\n}\n\nTEST(GreetTests, EmptyName) {\n    EXPECT_EQ(demo::greet(\"\") , \"Hello, World!\");\n}\n\nTEST(GreetTests, NonEmptyName) {\n    EXPECT_EQ(demo::greet(\"Alice\"), \"Hello, Alice!\");\n}\n\n// main provided by GTest::gtest_main\n</code></pre> CMakePresets.json<pre><code>--8&lt;-- \"docs/Programming/cpp/cmake/cmake_preset/code/CMakePresets.json\"&gt;\n</code></pre> <pre><code>cmake_minimum_required(VERSION 3.22)\n\n# Project setup\nproject(DemoApp VERSION 0.1.0 LANGUAGES CXX)\n\n# Options\noption(DEMO_BUILD_TESTS \"Build tests\" ON)\n\n# Library\nadd_library(demolib src/lib.cpp)\nadd_library(demo::demolib ALIAS demolib)\n\ntarget_include_directories(demolib\n    PUBLIC\n        $&lt;BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/include&gt;\n        $&lt;INSTALL_INTERFACE:include&gt;\n)\n\nset_target_properties(demolib PROPERTIES\n    CXX_STANDARD 17\n    CXX_STANDARD_REQUIRED YES\n    CXX_EXTENSIONS NO\n)\n\n# Executable\nadd_executable(demo_app src/main.cpp)\n\ntarget_link_libraries(demo_app PRIVATE demo::demolib)\nset_target_properties(demo_app PROPERTIES\n    CXX_STANDARD 17\n    CXX_STANDARD_REQUIRED YES\n    CXX_EXTENSIONS NO\n)\n\n# Testing\ninclude(CTest)\nif (DEMO_BUILD_TESTS AND BUILD_TESTING)\n    include(FetchContent)\n    # Avoid overriding parent project's compiler/linker settings in gtest\n    set(BUILD_GMOCK OFF CACHE BOOL \"Disable gmock\" FORCE)\n    set(INSTALL_GTEST OFF CACHE BOOL \"Disable gtest install\" FORCE)\n    FetchContent_Declare(\n        googletest\n        URL https://github.com/google/googletest/archive/refs/tags/v1.14.0.zip\n    )\n    FetchContent_MakeAvailable(googletest)\n    enable_testing()\n    add_executable(test_add test/test_add.cpp)\n    target_link_libraries(test_add PRIVATE demo::demolib GTest::gtest_main)\n    add_test(NAME test_add COMMAND test_add)\nendif()\n</code></pre> <pre><code># configure\ncmake --preset debug\n\n# build\ncmake --build --preset debug-build\n\n# test\nctest --preset test-debug\n</code></pre>","tags":["cmake","presets"]},{"location":"Programming/cpp/cmake/cmake_preset/#reference","title":"Reference","text":"<p>cmake-preset</p>","tags":["cmake","presets"]},{"location":"Programming/cpp/dev_env/","title":"VSCode CPP dev environment","text":"C/C++ IntelliSense, debugging, and code browsing. Interfacing with the build process","tags":["cpp","vscode","settings","dev environment"]},{"location":"Programming/cpp/dev_env/#build","title":"Build","text":"","tags":["cpp","vscode","settings","dev environment"]},{"location":"Programming/cpp/dev_env/#using-cmake-presets","title":"Using CMake presets","text":"<p>CMake Presets are a standardized, version-controlled way to define build configurations (compiler, build dir, flags, generator, cache vars) so everyone builds the project the same way \u2014 from CLI or IDE.</p> <p>CMake Presets contain information how to: - configure,  - build,  - test  - package a project. </p> <p>Preset information is stored in a JSON files:</p> <pre><code>{\n  \"version\": 6,\n  \"cmakeMinimumRequired\": {\n    \"major\": 3,\n    \"minor\": 23,\n    \"patch\": 0\n  },\n  \"configurePresets\": [\n    {\n      // ...\n    }\n  ],\n  \"buildPresets\": [\n    {\n      // ...\n    }\n  ],\n  \"testPresets\": [\n    {\n      // ...\n    }\n  ]\n}\n</code></pre>","tags":["cpp","vscode","settings","dev environment"]},{"location":"Programming/cpp/dev_env/#preset-types","title":"Preset Types","text":"<p>1\ufe0f\u20e3 Configure presets</p> <p>Define how CMake configures the project</p> <pre><code>\"configurePresets\": [\n  {\n    \"name\": \"debug\",\n    \"generator\": \"Ninja\",\n    \"binaryDir\": \"build/debug\",\n    \"cacheVariables\": {\n      \"CMAKE_BUILD_TYPE\": \"Debug\"\n    }\n  }\n]\n</code></pre> <p>Equivalent to:</p> <pre><code>cmake -S . -B build/debug -DCMAKE_BUILD_TYPE=Debug\n</code></pre> run from cli<pre><code>#cmake --preset &lt;preset name&gt;\ncmake --preset debug\n</code></pre> <p>2\ufe0f\u20e3 Build presets</p> <p>Define how to build after configuration</p> <pre><code>\"buildPresets\": [\n  {\n    \"name\": \"debug\",\n    \"configurePreset\": \"debug\"\n  }\n]\n</code></pre> <p>Equivalent to:</p> <pre><code>cmake --build build/debug\n</code></pre> <pre><code>#cmake --build --preset &lt;preset name&gt;\ncmake --build --preset debug\n</code></pre>","tags":["cpp","vscode","settings","dev environment"]},{"location":"Programming/cpp/dev_env/#vscode","title":"VSCode","text":"<pre><code>{\n  \"cmake.useCMakePresets\": \"always\"\n}\n</code></pre>","tags":["cpp","vscode","settings","dev environment"]},{"location":"Programming/cpp/dev_env/#demo-cmake-presets-with-debug-and-release","title":"Demo: cmake presets with debug and release","text":"<pre><code>{\n  \"version\": 6,\n  \"cmakeMinimumRequired\": {\n    \"major\": 3,\n    \"minor\": 23,\n    \"patch\": 0\n  },\n  \"configurePresets\": [\n    {\n      \"name\": \"debug\",\n      \"generator\": \"Ninja\",\n      \"binaryDir\": \"build/debug\",\n      \"cacheVariables\": {\n        \"CMAKE_BUILD_TYPE\": \"Debug\"\n      }\n    },\n    {\n      \"name\": \"release\",\n      \"generator\": \"Ninja\",\n      \"binaryDir\": \"build/release\",\n      \"cacheVariables\": {\n        \"CMAKE_BUILD_TYPE\": \"Release\"\n      }\n    }\n  ],\n  \"buildPresets\": [\n    {\n      \"name\": \"debug\",\n      \"configurePreset\": \"debug\"\n    },\n    {\n      \"name\": \"release\",\n      \"configurePreset\": \"release\"\n    }\n  ]\n}\n</code></pre> <p>VSCode preset commnads</p> <ul> <li>cmake: Configure</li> <li>cmake: Build</li> <li>cmake: Clean</li> <li>cmake: select configure preset</li> <li>cmake: select build preset</li> </ul>","tags":["cpp","vscode","settings","dev environment"]},{"location":"Programming/cpp/dev_env/#compilers","title":"Compilers","text":"","tags":["cpp","vscode","settings","dev environment"]},{"location":"Programming/cpp/dev_env/#clang","title":"Clang","text":"<ul> <li>Install clang version 19 support cpp-20</li> <li>Config <code>update-alternative</code></li> <li>Install clang libstd</li> </ul> install<pre><code>wget https://apt.llvm.org/llvm.sh\nchmod +x llvm.sh\nsudo ./llvm.sh 19\n#\nsudo apt install libstdc++-12-dev\n# work after fix update-alternatives\nclang++ --version\n</code></pre> config clang using update alternative<pre><code># sudo update-alternatives --install &lt;symlink&gt; &lt;name&gt; &lt;path-to-binary&gt; &lt;priority&gt;\nsudo update-alternatives --install /usr/bin/clang clang /usr/bin/clang-19 100\nsudo update-alternatives --install /usr/bin/clang++ clang++ /usr/bin/clang++-19 100\n\nsudo update-alternatives --install /usr/bin/clang clang /usr/bin/clang-14 50\nsudo update-alternatives --install /usr/bin/clang++ clang++ /usr/bin/clang++-149 50\n\n# switch\nsudo update-alternatives --config clang\nsudo update-alternatives --config clang++\n</code></pre>","tags":["cpp","vscode","settings","dev environment"]},{"location":"Programming/cpp/dev_env/#vscode_1","title":"VSCode","text":"","tags":["cpp","vscode","settings","dev environment"]},{"location":"Programming/cpp/dev_env/#c_cpp","title":"c_cpp","text":"c_cpp_properties.json<pre><code>{\n    \"configurations\": [\n        {\n            \"name\": \"Clang\",\n            \"includePath\": [\n                \"${workspaceFolder}/**\",\n                \"${default}\"\n            ],\n            \"defines\": [],\n            \"compilerPath\": \"/usr/bin/clang++\",\n            \"cStandard\": \"c17\",\n            \"cppStandard\": \"c++20\",\n            \"intelliSenseMode\": \"linux-clang-x64\"\n        }\n    ],\n    \"version\": 4\n}\n</code></pre>","tags":["cpp","vscode","settings","dev environment"]},{"location":"Programming/cpp/dev_env/#tasks","title":"Tasks","text":"<ul> <li>Add task that build current file using <code>clang</code> compiler</li> </ul> tasks.json<pre><code>{\n  \"version\": \"2.0.0\",\n  \"tasks\": [\n    {\n      \"label\": \"build with clang\",\n      \"type\": \"shell\",\n      \"command\": \"clang++\",\n      \"args\": [\n        \"-std=c++20\",\n        \"${file}\",\n        \"-o\",\n        \"${fileDirname}/${fileBasenameNoExtension}\"\n      ],\n      \"group\": {\n        \"kind\": \"build\",\n        \"isDefault\": true\n      },\n      \"problemMatcher\": [\n        \"$gcc\"\n      ]\n    }\n  ]\n}\n</code></pre>","tags":["cpp","vscode","settings","dev environment"]},{"location":"Programming/cpp/gtest/","title":"GTest","text":"<p>Programming / cpp</p>","tags":["gtest","cpp"]},{"location":"Programming/cpp/gtest/#core-concepts","title":"Core Concepts","text":"<ul> <li>ASSERT_* macros: Fatal failures. If an ASSERT_ fails, current function test will abort immidiately.</li> <li>EXPECT_* macro:  Non-fatal failures. If an EXPECT_ fails, current function test continues and allow to find further failures.</li> <li> <p>TEST() macro:  defines a function contains assertions to verify a behavior.     <code>TEST(TestSuiteName, TestName)</code></p> </li> <li> <p>TEST_F() macro: Used to define a test fixture. When we need to perform multiple tests on same object     <code>TEST_F(FixtureName, TestName)</code></p> </li> <li> <p>Test Suite: Group of related test</p> </li> </ul>","tags":["gtest","cpp"]},{"location":"Programming/cpp/gtest/#simple-demo","title":"Simple demo","text":"<p>Minimal gtest and CMakeList, for simplicity add the function on test to the test file</p> test/test_demo.cpp<pre><code>#include &lt;gtest/gtest.h&gt;\n\n// function for which we write unit tests\nint add(int num1, int num2) {\n    return num1 + num2;\n}\n\n// to test addition of positive numbers\nTEST(SumTest, ForPositiveNumbers) {\n    EXPECT_EQ(35, add(23, 12));\n}\n\n// to test addition of negative numbers\nTEST(SumTest, ForNegativeNumbers) {\n    EXPECT_EQ(-1, add(-1, 0));\n}\n</code></pre> <pre><code>cmake_minimum_required(VERSION 3.22)\n\n# Project setup\nproject(DemoApp VERSION 0.1.0 LANGUAGES CXX)\n\n# Require GoogleTest\nfind_package(GTest REQUIRED)\ninclude(GoogleTest)\n\nenable_testing()\n\n# defining executable target and its source file\nadd_executable(\n  test_demo\n  test/test_demo.cpp\n)\n# to link the executable with GoogleTest main library\ntarget_link_libraries(\n  test_demo\n  GTest::gtest_main\n)\n\n# to discover and register all tests in the executable\ngtest_discover_tests(test_demo)\n</code></pre>","tags":["gtest","cpp"]},{"location":"Programming/cpp/gtest/#usage","title":"usage","text":"<pre><code># -S: source folder\n# -B: build folder\ncmake -S . -B build\n\n# compile\ncmake --build build\n\ncd build\n# Test\nctest\n</code></pre>","tags":["gtest","cpp"]},{"location":"Programming/cpp/gtest/#disabled-test","title":"Disabled test","text":"<p>Add <code>DISABLED</code> prefix to test suit name</p> <pre><code>// to test addition of negative numbers\nTEST(DISABLED_SumTest, ForNegativeNumbers) {\n    EXPECT_EQ(-1, add(-1, 0));\n}\n</code></pre> <pre><code>Test project /home/user/projects/cmake_presets/build\n    Start 1: SumTest.ForPositiveNumbers\n1/2 Test #1: SumTest.ForPositiveNumbers .......   Passed    0.00 sec\n    Start 2: SumTest.ForNegativeNumbers\n2/2 Test #2: SumTest.ForNegativeNumbers .......***Not Run (Disabled)   0.00 sec\n</code></pre>","tags":["gtest","cpp"]},{"location":"Programming/cpp/learn_cpp/","title":"Index","text":"<p>Programming / cpp</p> <p>OOP</p> <p>Multithreading</p> <p>Data Structure</p> <ul> <li>Back to Basics: Move Semantics - Nicolai Josuttis - CppCon 2021</li> </ul>","tags":["cpp","learn"]},{"location":"Programming/cpp/learn_cpp/data_structure/","title":"Cpp data structure","text":"<p>Programming / cpp / learn cpp</p>","tags":["cpp","data structure"]},{"location":"Programming/cpp/learn_cpp/data_structure/#stl-data-structure","title":"STL Data structure","text":"Category STL Container Description Sequence containers <code>std::vector</code>, <code>std::array</code>, <code>std::deque</code>, <code>std::list</code> Store ordered collections of elements Associative containers <code>std::set</code>, <code>std::map</code>, <code>std::multiset</code>, <code>std::multimap</code> Sorted data based on keys (balanced BST) Unordered containers <code>std::unordered_map</code>, <code>std::unordered_set</code> Hash-table-based lookup Adapters <code>std::stack</code>, <code>std::queue</code>, <code>std::priority_queue</code> Provide restricted interfaces for specific use cases std::tuple hold different types of values together in a single object. std::pair hold different types of values together in a single object.","tags":["cpp","data structure"]},{"location":"Programming/cpp/learn_cpp/data_structure/#array","title":"Array","text":"<pre><code>#include &lt;iostream&gt;\n    int main() {\n    int arr[5];                // declare array of 5 ints (uninitialized)\n    int nums[5] = {1, 2, 3};   // remaining elements default to 0 \u2192 {1,2,3,0,0}\n    int more[] = {10, 20, 30}; // size inferred automatically (3)\n\n    // Access elements\n    std::cout &lt;&lt; \"First: \" &lt;&lt; arr[0] &lt;&lt; std::endl;\n\n    std::cout &lt;&lt; \"Last: \" &lt;&lt; more[4] &lt;&lt; std::endl;\n\n    nums[4] = 99;\n    // Iterate\n    for (int i = 0; i &lt; 5; i++)\n        std::cout &lt;&lt; nums[i] &lt;&lt; \" \";\n}\n</code></pre> <p>\ud83d\udc49 Run this code on Wandbox</p>","tags":["cpp","data structure"]},{"location":"Programming/cpp/learn_cpp/data_structure/#dynamic-array","title":"Dynamic array","text":"<p><pre><code>#include &lt;iostream&gt;\n#include &lt;memory&gt;\n\nint main() {\n    // Create dynamic array managed by unique_ptr\n    std::unique_ptr&lt;int[]&gt; arr = std::make_unique&lt;int[]&gt;(5);\n\n    for (int i = 0; i &lt; 5; ++i)\n        arr[i] = i * 10;\n\n    for (int i = 0; i &lt; 5; ++i)\n        std::cout &lt;&lt; arr[i] &lt;&lt; \" \";\n    std::cout &lt;&lt; std::endl;\n\n    // No need to delete[] manually \u2014 it\u2019s automatic!\n}\n</code></pre> Run</p>","tags":["cpp","data structure"]},{"location":"Programming/cpp/learn_cpp/data_structure/#stdarray","title":"std::array","text":"<p>Like array just better</p> <pre><code>#include &lt;array&gt;\n#include &lt;iostream&gt;\n\nint main()\n{\n    std::array&lt;int, 5&gt; arr = {1, 2, 3, 4, 5};\n\n    std::cout &lt;&lt; arr.size();  // \u2705 works\n    std::cout &lt;&lt; arr.front(); // \u2705 first element\n    std::cout &lt;&lt; arr.back();  // \u2705 last element\n\n    // Range-based loop\n    for (int val : arr)\n        std::cout &lt;&lt; val &lt;&lt; \" \";\n}\n</code></pre> <p>Run</p>","tags":["cpp","data structure"]},{"location":"Programming/cpp/learn_cpp/data_structure/#stdvector","title":"std::vector","text":"<p>std::vector is a dynamic array in C++ \u2014 it behaves like an array, but can automatically grow or shrink in size.</p> <pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n\nint main() {\n    std::vector&lt;int&gt; nums = {10, 20, 30};\n    nums.push_back(40); // Add element at the end\n    nums.push_back(50);\n    nums.pop_back(); // removes the last element\n    nums.erase(nums.begin()); //removes to first element\n    nums.insert(nums.begin()+2, 99);//insert new element before\n    std::cout &lt;&lt; \"Vector elements: \";\n    for (int n : nums)\n        std::cout &lt;&lt; n &lt;&lt; \" \";\n\n    std::cout &lt;&lt; \"\\nSize: \" &lt;&lt; nums.size() &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"\\nSize: \" &lt;&lt; nums.at(1) &lt;&lt; std::endl;\n\n}\n</code></pre>","tags":["cpp","data structure"]},{"location":"Programming/cpp/learn_cpp/data_structure/#stdlist","title":"std::list","text":"<p>std::list is a doubly linked list container in the C++ Standard Library.</p> Feature <code>std::list</code> <code>std::vector</code> Underlying structure Doubly linked list Dynamic contiguous array Memory layout Elements scattered across heap Elements stored contiguously Random access (<code>list[i]</code>) \u274c Not supported \u2705 Supported (<code>O(1)</code>) Insert/erase in middle \u2705 Fast (<code>O(1)</code>) \u26a0\ufe0f Slow (<code>O(n)</code>, shifting required) Iteration speed \u26a0\ufe0f Slower (poor cache locality) \u2705 Very fast (contiguous memory) Reallocation Never (nodes independent) May reallocate as it grows Sorting Has built-in <code>list.sort()</code> Must use <code>std::sort()</code> When to use Frequent insert/erase in middle Frequent access or random indexing","tags":["cpp","data structure"]},{"location":"Programming/cpp/learn_cpp/data_structure/#stddeque","title":"std::deque","text":"<p>allows fast insertion and removal from both the front and the back.</p> with helper function to limit deque size<pre><code>#include &lt;iostream&gt;\n#include &lt;deque&gt;\n\nint main() {\n    const size_t MAX_SIZE = 5;\n    std::deque&lt;int&gt; dq;\n\n    for (int i = 1; i &lt;= 10; ++i) {\n        if (dq.size() == MAX_SIZE)\n            dq.pop_front();  // remove oldest when full\n\n        dq.push_back(i);     // add new element\n\n        std::cout &lt;&lt; \"Deque: \";\n        for (int x : dq) std::cout &lt;&lt; x &lt;&lt; \" \";\n        std::cout &lt;&lt; \"\\n\";\n    }\n}\n</code></pre>","tags":["cpp","data structure"]},{"location":"Programming/cpp/learn_cpp/data_structure/#stdtuple","title":"std::tuple","text":"<pre><code>#include &lt;tuple&gt;\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nint main() {\n    std::tuple&lt;int, std::string, float&gt; person(29, \"Alice\", 55.5f);\n\n    std::cout &lt;&lt; std::get&lt;0&gt;(person) &lt;&lt; \"\\n\"; // 29\n    std::cout &lt;&lt; std::get&lt;1&gt;(person) &lt;&lt; \"\\n\"; // Alice\n    std::cout &lt;&lt; std::get&lt;2&gt;(person) &lt;&lt; \"\\n\"; // 55.5\n}\n</code></pre> <pre><code>Use auto [x, y, z] = func(); (C++17+) to unpack neatly, just like Python.\n</code></pre> <pre><code>#include &lt;tuple&gt;\n#include &lt;iostream&gt;\n\nstd::tuple&lt;double, double&gt; demo() {\n    return {1.0, 2.0};\n}\n\nint main() {\n    auto [area, perimeter] = demo();\n    std::cout &lt;&lt; \"Area = \" &lt;&lt; area &lt;&lt; \", Perimeter = \" &lt;&lt; perimeter &lt;&lt; \"\\n\";\n}\n</code></pre>","tags":["cpp","data structure"]},{"location":"Programming/cpp/learn_cpp/data_structure/#stdpair","title":"std::pair","text":"<p>std::pair is a container that holds exactly two values, possibly of different types.</p> <pre><code>std::pair&lt;int, double&gt; data(1, 2.5);\nstd::cout &lt;&lt; data.first &lt;&lt; \", \" &lt;&lt; data.second &lt;&lt; \"\\n\";\n\nauto [a, b] = data;\n</code></pre>","tags":["cpp","data structure"]},{"location":"Programming/cpp/learn_cpp/multithread/","title":"CPP Threading","text":"","tags":["cpp","threading"]},{"location":"Programming/cpp/learn_cpp/multithread/#hello-demo","title":"Hello Demo","text":"<pre><code>#include &lt;iostream&gt;\n#include &lt;thread&gt;\n\nvoid threadFunction(int threadNumber) {\n    std::cout &lt;&lt; \"Thread \" &lt;&lt; threadNumber &lt;&lt; \" is running\\n\";\n}\n\nint main() {\n    // thread requires a callable object\n    std::thread t1(threadFunction, 1);\n    std::thread t2(threadFunction, 2);\n\n    // Joining the threads with the main thread\n    t1.join();\n    t2.join();\n\n    std::cout &lt;&lt; \"Both threads have completed their execution\\n\";\n\n    return 0;\n}\n</code></pre>","tags":["cpp","threading"]},{"location":"Programming/cpp/learn_cpp/multithread/#mutex-race-conditiion-and-critical-section","title":"Mutex, Race Conditiion and Critical Section","text":"<p>A std::mutex is an object that prevents multiple threads from accessing a shared resource simultaneously. It ensures that only one thread can lock it at a time, avoiding race conditions.</p> <pre><code>#include&lt;mutex&gt;\n#include&lt;thread&gt;\n#include &lt;iostream&gt;&gt;\n\nusing namespace std;\n\nint amount=0;\n\nstd::mutex m;\n\nvoid addAmount(){\n    m.lock();\n    amount++;//Critical Section\n    m.unlock();\n}\n\nint main(){\n    std::thread t1(addAmount);\n    std::thread t2(addAmount);\n    t1.join();\n    t2.join();\n    cout &lt;&lt; amount &lt;&lt; endl;\n    return 0;\n}\n</code></pre> <ul> <li>std::lock_guard: Automatically locks the mutex when it\u2019s created and unlocks it when destroyed.</li> <li>std::unique_lock: More flexible than lock_guard. Can lock and unlock mutexes multiple times.</li> </ul>","tags":["cpp","threading"]},{"location":"Programming/cpp/learn_cpp/multithread/#lock_guard","title":"lock_guard","text":"<p>Instead of manually calling lock() and unlock(), use std::lock_guard, which automatically releases the lock when it goes out of scope.</p> <ul> <li>Prevents forgetting unlock()</li> <li>Handles exceptions safely</li> </ul> <pre><code>void addAmount(){\n    std::lock_guard&lt;std::mutex&gt; guard(mtx);\n    amount++;//Critical Section\n} // Automatically unlocks when `guard` goes out of scope\n</code></pre>","tags":["cpp","threading"]},{"location":"Programming/cpp/learn_cpp/multithread/#thread-synchronization","title":"Thread Synchronization","text":"<p>logging</p> <p>Using spdlog for logging</p> install<pre><code>sudo apt update &amp;&amp; sudo apt install libspdlog-dev\n</code></pre> usage<pre><code>#include &lt;spdlog/spdlog.h&gt;\n\nint main()\n{\n    spdlog::info(\"Hello, this is an info message!\");\n    spdlog::warn(\"Warning! Something might be wrong.\");\n    spdlog::error(\"An error occurred!\");\n\n    return 0;\n}\n</code></pre> <pre><code>find_package(spdlog REQUIRED)\n...\ntarget_link_libraries(&lt;target&gt; PRIVATE spdlog::spdlog)\n</code></pre> <p>std::condition_variable is used for thread synchronization. It allows one or more threads to wait until a condition is met and another thread notifies them.</p> <ul> <li>std::unique_lock lock(mtx); \u2192 Locks the mutex so no other thread can modify ready. <li>cv.wait(lock, [] { return ready; }); \u2192<ul> <li>Puts the thread to sleep if ready == false.</li> <li>Releases the mutex while waiting (so other threads can change ready).</li> <li>If another thread calls cv.notify_one() or cv.notify_all(), the waiting thread wakes up.</li> <li>Before resuming execution, it relocks the mutex.</li> </ul> </li> <li>The consumer thread continues execution only when ready == true.</li> syc producer/consumer<pre><code>#include &lt;iostream&gt;\n#include &lt;thread&gt;\n#include &lt;mutex&gt;\n#include &lt;condition_variable&gt;\n#include &lt;chrono&gt;\n#include &lt;spdlog/spdlog.h&gt;\n#include &lt;spdlog/sinks/stdout_color_sinks.h&gt;\n\nstd::mutex mtx;\nstd::condition_variable cv;\nbool ready = false;  // Shared flag\n\nvoid producer()\n{\n    std::unique_lock&lt;std::mutex&gt; lock(mtx);\n    spdlog::info(\"Producer: wait 3 sec before notify...\");\n    std::this_thread::sleep_for(std::chrono::seconds(3));\n\n    ready = true; // Update the shared flag\n    spdlog::info(\"Producer: notify consumer\");\n\n    cv.notify_one(); // Notify consumer\n}\n\nvoid consumer()\n{\n    std::unique_lock&lt;std::mutex&gt; lock(mtx);\n    spdlog::info(\"Consumer: waiting for notification...\");\n\n    // Wait until `ready` is true\n    cv.wait(lock, [] { return ready; });\n\n    spdlog::info(\"Consumer: received notification!\");\n}\n\nint main()\n{\n    std::thread prod1(producer);\n    std::thread cons1(consumer);\n    cons1.join();\n    prod1.join();\n\n\n    return 0;\n}\n</code></pre>","tags":["cpp","threading"]},{"location":"Programming/cpp/learn_cpp/multithread/#thread-synchronization-with-timeout","title":"Thread Synchronization with timeout","text":"synchronization with timeout<pre><code>#include &lt;iostream&gt;\n#include &lt;thread&gt;\n#include &lt;condition_variable&gt;\n#include &lt;chrono&gt;\n#include &lt;spdlog/spdlog.h&gt;\n\nstd::condition_variable cv;\nstd::mutex mtx;\nbool ready = false;\n\n\nvoid producer(int period) {\n    std::this_thread::sleep_for(std::chrono::seconds(period));  // Simulate work\n    std::unique_lock&lt;std::mutex&gt; lock(mtx);\n    spdlog::info(\"Producer: notify consumer\");\n    ready = true;\n    cv.notify_one();\n}\n\nvoid consumer(int period) {\n    std::unique_lock&lt;std::mutex&gt; lock(mtx);\n    spdlog::info(\"Consumer: waiting for notification...\");\n\n    if (cv.wait_for(lock, std::chrono::seconds(period), [] { return ready; })) {\n        spdlog::info(\"Received notification!\");\n    } else {\n        spdlog::error(\"Timeout occurred!\");\n    }\n}\n\nint main() {\n    std::thread t1(producer, 3);\n    std::thread t2(consumer, 5);\n\n    t1.join();\n    t2.join();\n    return 0;\n}\n</code></pre> <pre><code># notify:3 timeout: 5\n[2025-02-10 21:26:02.795] [info] Consumer: waiting for notification...\n[2025-02-10 21:26:05.795] [info] Producer: notify consumer\n[2025-02-10 21:26:05.795] [info] Received notification!\n\n# notify:5 timeout: 3\n[2025-02-10 21:28:57.871] [info] Consumer: waiting for notification...\n[2025-02-10 21:29:00.871] [error] Timeout occurred!\n[2025-02-10 21:29:02.871] [info] Producer: notify consumer\n</code></pre>","tags":["cpp","threading"]},{"location":"Programming/cpp/learn_cpp/oop/","title":"Cpp object memory allocation","text":"<p>Programming / cpp / learn cpp</p>","tags":["cpp","oop","allocation"]},{"location":"Programming/cpp/learn_cpp/oop/#encapsulation","title":"Encapsulation","text":"<ul> <li>Use of private/protected fields</li> <li>Getters and setters (if needed)</li> <li>Const-correctness (const member functions)</li> <li>Immutable objects</li> </ul>","tags":["cpp","oop","allocation"]},{"location":"Programming/cpp/learn_cpp/oop/#inheritance","title":"Inheritance","text":"<ul> <li>Base and derived classes</li> <li>public, private, and protected inheritance</li> <li>Virtual functions</li> <li>Constructor chaining (Base(args))</li> </ul>","tags":["cpp","oop","allocation"]},{"location":"Programming/cpp/learn_cpp/oop/#polymorphism","title":"Polymorphism","text":"<ul> <li>Function overriding</li> <li>Virtual destructors</li> <li>Pure virtual functions (= 0)</li> <li>Abstract base classes</li> <li>Runtime polymorphism via pointers or references</li> <li>The role of virtual and override</li> </ul>","tags":["cpp","oop","allocation"]},{"location":"Programming/cpp/learn_cpp/oop/#constructors-and-object-lifecycle","title":"Constructors and Object Lifecycle","text":"<ul> <li>Default constructor, copy constructor, move constructor</li> <li>Copy assignment, move assignment</li> <li>The Rule of Three / Rule of Five</li> <li>Destructor</li> <li>RAII (Resource Acquisition Is Initialization)</li> </ul>","tags":["cpp","oop","allocation"]},{"location":"Programming/cpp/learn_cpp/oop/#operator-overloading","title":"Operator Overloading","text":"<ul> <li>Overload operators like +, ==, &lt;&lt;, [], etc.</li> <li>Understand which should be friend, member, or non-member</li> <li>Best practices and dangers</li> </ul>","tags":["cpp","oop","allocation"]},{"location":"Programming/cpp/learn_cpp/oop/#smart-pointers-and-ownership-modern-c","title":"Smart Pointers and Ownership (Modern C++)","text":"<ul> <li>std::unique_ptr, std::shared_ptr, std::weak_ptr</li> <li>Ownership models</li> <li>Avoiding raw new and delete</li> <li>Avoiding memory leaks and dangling pointers</li> </ul>","tags":["cpp","oop","allocation"]},{"location":"Programming/cpp/learn_cpp/oop/#templates-and-generic-oop-advanced","title":"Templates and Generic OOP (Advanced)","text":"<ul> <li>Template classes and functions</li> <li>Combining OOP and templates</li> <li>CRTP (Curiously Recurring Template Pattern)</li> <li>Type traits (std::is_base_of, etc.)</li> </ul>","tags":["cpp","oop","allocation"]},{"location":"Programming/cpp/learn_cpp/oop/#composition-over-inheritance","title":"Composition over Inheritance","text":"<ul> <li>Prefer combining objects over subclassing</li> <li>Delegation</li> <li>Aggregation vs composition</li> </ul>","tags":["cpp","oop","allocation"]},{"location":"Programming/cpp/learn_cpp/oop/#design-patterns-optional-practical","title":"Design Patterns (Optional, Practical)","text":"<ul> <li>Singleton (with std::unique_ptr)</li> <li>Factory</li> <li>Strategy</li> <li>Observer</li> <li>Builder</li> </ul>","tags":["cpp","oop","allocation"]},{"location":"Programming/cpp/learn_cpp/oop/#modern-c-oop-best-practices","title":"Modern C++ OOP Best Practices","text":"<ul> <li>Favor composition and RAII</li> <li>Prefer = default / = delete over writing boilerplate</li> <li>Avoid unnecessary inheritance</li> <li>Use final to prevent further inheritance when needed</li> <li>Use explicit on single-arg constructors</li> <li>Don\u2019t overuse setters/getters \u2014 prefer invariants</li> </ul>","tags":["cpp","oop","allocation"]},{"location":"Programming/cpp/learn_cpp/oop/#allocation","title":"Allocation","text":"<ul> <li>Stack</li> <li>raw</li> <li>smart pointers</li> </ul> <pre><code>#include &lt;iostream&gt;\n#include &lt;memory&gt;\n\n\nclass Animal {\npublic:\n    std::string name;\n    virtual void speak() {\n        std::cout &lt;&lt; name &lt;&lt; \" speaks\" &lt;&lt; std::endl;\n    }\n};\n\nint main() {\n    // Using stack allocation\n    Animal a;\n    a.name = \"Generic Animal\";\n    a.speak();\n\n\n    // Using heap allocation with raw pointer\n    auto dog = new Animal();\n    dog-&gt;name = \"Dog\";\n    dog-&gt;speak();\n    // Clean up raw pointer\n    delete dog;\n\n    // Using smart pointer (unique_ptr)\n    auto cat = std::make_unique&lt;Animal&gt;();\n    cat-&gt;name = \"Cat\";\n    cat-&gt;speak();\n\n    std::cout &lt;&lt; \"Hello, OOP in C++!\" &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre> <p>cmake debug symbols</p> <pre><code>if(NOT CMAKE_BUILD_TYPE)\n    set(CMAKE_BUILD_TYPE Debug)\nendif()\n</code></pre>","tags":["cpp","oop","allocation"]},{"location":"Programming/cpp/learn_cpp/oop/#using-valgrind","title":"Using valgrind","text":"<pre><code>sudo apt install valgrind\n</code></pre> minimal usage<pre><code># build with debug symbols\nvalgrind --leak-check=full &lt;path to binary&gt;\n</code></pre>","tags":["cpp","oop","allocation"]},{"location":"Programming/cpp/learn_cpp/oop/#find-leak","title":"Find leak","text":"<p>For example comment the delete dog line (25) and run valgrind it found that dog object in line 21 not freed</p> <pre><code>==1079592== \nGeneric Animal speaks\nDog speaks\nCat speaks\nHello, OOP in C++!\n==1079592== \n==1079592== HEAP SUMMARY:\n==1079592==     in use at exit: 40 bytes in 1 blocks\n==1079592==   total heap usage: 4 allocs, 3 frees, 73,808 bytes allocated\n==1079592== \n==1079592== 40 bytes in 1 blocks are definitely lost in loss record 1 of 1\n==1079592==    at 0x4849013: operator new(unsigned long) (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)\n==1079592==    by 0x109300: main (hello.cpp:21)\n==1079592== \n==1079592== LEAK SUMMARY:\n==1079592==    definitely lost: 40 bytes in 1 blocks\n==1079592==    indirectly lost: 0 bytes in 0 blocks\n==1079592==      possibly lost: 0 bytes in 0 blocks\n==1079592==    still reachable: 0 bytes in 0 blocks\n==1079592==         suppressed: 0 bytes in 0 blocks\n==1079592== \n==1079592== For lists of detected and suppressed errors, rerun with: -s\n==1079592== ERROR SUMMARY: 1 errors from 1 contexts (suppressed: 0 from 0)\n</code></pre> <pre><code>flowchart TD\n    A[Camera] --&gt;|ROS2 topic: camera/error_xy| B[Your ROS2 Node\\nmpc_attitude_controller.py]\n    subgraph RUNTIME\n      B --&gt;|build OCP in Python| C[acados_template\\n]\n      C --&gt;|codegen on first run|\\nD[/c_generated_code/]\n      D --&gt;|compiled solver .so|\\nE[[libacados_ocp_solver_img_ang_mpc.so]]\n      E --&gt;|calls into| F[[acados C library]]\n      F --&gt; G[HPIPM &amp; BLASFEO\\n]\n      E --&gt;|solve MPC @ 20 Hz| B\n      B --&gt;|publish AttitudeTarget| H[MAVROS\\n/setpoint_raw/attitude]\n      H --&gt; I[ArduPilot\\n]\n    end</code></pre>","tags":["cpp","oop","allocation"]},{"location":"Programming/cpp/learn_cpp/oop/getter_setter/","title":"CPP OOP class property","text":"<p>Programming / cpp / learn cpp</p> <pre><code>const std::string&amp; getName() const { return name_; }\nvoid setName(std::string name) { name_ = std::move(name); }\n</code></pre> <pre><code>struct Point {\nprivate:\n    int x_ = 0;\npublic:\n    inline int x() const { return x_; }\n    inline void x(int value) { x_ = value; }\n};\n</code></pre> <pre><code>\n</code></pre>","tags":["cpp","oop","getter","setter","property"]},{"location":"Programming/cpp/learn_cpp/templates/","title":"Index","text":"<p>Programming / cpp / learn cpp</p> <pre><code>#include &lt;iostream&gt;\n\ntemplate &lt;typename T&gt;\nT add(T a, T b) {\n    return a + b;\n}\n\nint main() {\n    std::cout &lt;&lt; add(3, 4) &lt;&lt; \"\\n\";       // int\n    std::cout &lt;&lt; add(2.5, 1.2) &lt;&lt; \"\\n\";   // double\n    std::cout &lt;&lt; add(std::string(\"Hi \"), std::string(\"there\")) &lt;&lt; \"\\n\"; // string\n}\n</code></pre>","tags":["cpp","template"]},{"location":"Programming/cpp/libraries/fmt/","title":"fmt library","text":"<p>Programming / cpp / libraries</p> <p>{fmt} is an open-source formatting library providing a fast and safe alternative to C stdio and C++ iostreams.more</p> install<pre><code>sudo apt install libfmt-dev\n</code></pre>","tags":["fmt","cpp","format"]},{"location":"Programming/cpp/libraries/fmt/#simple-demo","title":"Simple Demo","text":"<pre><code>#include &lt;fmt/core.h&gt;\n#include &lt;iostream&gt;\n\n\nint main() {\n    fmt::print(\"Hello, world!\\n\");\n    fmt::print(\"Hello, {}!\\n\", \"world\");\n    fmt::print(\"The answer is {}.\\n\", 42);\n    fmt::print(\"Hex: {:#x}, Oct: {:#o}\\n\", 255, 255);\n    fmt::print(\"Pi is approximately {:.2f}\\n\", 3.14159);\n    fmt::print(\"Binary: {:#b}\\n\", 42);\n    fmt::print(\"{1} {0}\\n\", \"world\", \"Hello\");\n\n    std::string data = fmt::format(\"Formatted number: {:.3f}\", 3.14159);\n    std::cout &lt;&lt; data &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre> <pre><code>cmake_minimum_required(VERSION 3.10)\n\n# Set the project name\nproject(CppTutorial)\n\nset(CMAKE_CXX_STANDARD 17)\nset(CMAKE_CXX_STANDARD_REQUIRED True)\n\n\nfind_package(fmt REQUIRED)\n\nadd_executable(fmt_demo hello.cpp)\ntarget_link_libraries(fmt_demo PRIVATE fmt::fmt)\n</code></pre>","tags":["fmt","cpp","format"]},{"location":"Programming/cpp/libraries/msgpack/","title":"Using MsgPack in CPP","text":"<p>Programming / cpp / libraries</p>","tags":["cpp","msgpack"]},{"location":"Programming/cpp/libraries/msgpack/#install","title":"Install","text":"<pre><code>sudo apt install libmsgpack-dev\n</code></pre> <p>magpack-c</p>","tags":["cpp","msgpack"]},{"location":"Programming/cpp/libraries/msgpack/#demo","title":"Demo:","text":"<p>Header only</p> <pre><code>#include &lt;iostream&gt;\n#include &lt;msgpack.hpp&gt;\n#include &lt;vector&gt;\n#include &lt;string&gt;\n\nint main() {\n    std::cout &lt;&lt; MSGPACK_VERSION &lt;&lt; std::endl;\n\n    // 1\ufe0f\u20e3 Create some data\n    std::vector&lt;std::string&gt; items = {\"apple\", \"banana\", \"cherry\"};\n\n    // 2\ufe0f\u20e3 Pack (serialize) data to binary buffer\n    msgpack::sbuffer buffer; // simple buffer\n    msgpack::pack(buffer, items);\n\n    // 3\ufe0f\u20e3 Unpack (deserialize) data\n    msgpack::object_handle handle = msgpack::unpack(buffer.data(), buffer.size());\n    msgpack::object deserialized = handle.get();\n\n    // 4\ufe0f\u20e3 Convert msgpack::object back to C++ type\n    std::vector&lt;std::string&gt; unpacked;\n    deserialized.convert(unpacked);\n\n    // 5\ufe0f\u20e3 Print the results\n    std::cout &lt;&lt; \"Unpacked vector: \";\n    for (auto &amp;s : unpacked) std::cout &lt;&lt; s &lt;&lt; \" \";\n    std::cout &lt;&lt; std::endl;\n\n    return 0;\n}\n</code></pre> <pre><code>g++ -I/usr/include demo.cpp -o demo\n</code></pre>","tags":["cpp","msgpack"]},{"location":"Programming/cpp/libraries/msgpack/#cmake","title":"cmake","text":"<pre><code>cmake_minimum_required(VERSION 3.10)\nproject(msgpack_define_map_example)\n\nset(CMAKE_CXX_STANDARD 17)\nset(CMAKE_CXX_STANDARD_REQUIRED ON)\n\nfind_package(Msgpack REQUIRED)\n\nadd_executable(msgpack_example demo.cpp)\ntarget_include_directories(msgpack_example PRIVATE  ${MSGPACK_INCLUDE_DIRS})\n</code></pre>","tags":["cpp","msgpack"]},{"location":"Programming/cpp/libraries/msgpack/#pack-struct","title":"pack struct","text":"<pre><code>#include &lt;iostream&gt;\n#include &lt;msgpack.hpp&gt;\n\nstruct Point\n{\n    int x;\n    int y;\n\n    MSGPACK_DEFINE(x, y);\n};\n\nint main()\n{\n    Point p{10, 20};\n    msgpack::sbuffer buf;\n    msgpack::pack(buf, p);\n\n    auto handle = msgpack::unpack(buf.data(), buf.size());\n    msgpack::object obj = handle.get();\n\n    Point p2;\n    obj.convert(p2);\n    std::cout &lt;&lt; \"Point: (\" &lt;&lt; p2.x &lt;&lt; \", \" &lt;&lt; p2.y &lt;&lt; \")\\n\";\n    return 0;\n}\n</code></pre> <p>MSGPACK_DEFINE vs MSGPACK_DEFINE_MAP</p> <p>MSGPACK_DEFINE and MSGPACK_DEFINE_MAP are macros that generate serialization / deserialization code for your struct or class \u2014 but they encode the data in different MessagePack formats.</p> <ul> <li>MSGPACK_DEFINE \u2192 array-based encoding</li> <li>MSGPACK_DEFINE_MAP \u2192 map-based encoding</li> </ul> <p>When sending message between cross language like cpp-python it best to use MSGPACK_DEFINE_MAP</p>","tags":["cpp","msgpack"]},{"location":"Programming/python/","title":"Python","text":"<p>VSCode dev env.</p> <p>python_project</p> <p>python</p> <p>matplotlib</p> <p>asyncio</p>","tags":["python"]},{"location":"Programming/python/#packages","title":"Packages","text":"<ul> <li>zmq</li> <li>protobuf</li> </ul>","tags":["python"]},{"location":"Programming/python/asyncio/","title":"Python asyncio","text":"<p>With asyncio, while we wait, the event loop can do other tasks</p> <ul> <li>asyncio.get_event_loop</li> <li>asyncio.sleep</li> <li>call_later</li> </ul> hello world<pre><code>import asyncio\nimport logging\nlogging.basicConfig(\n    format='%(asctime)s - %(levelname)s - %(message)s',\n    datefmt='%Y-%m-%d %H:%M:%S',\n    level=logging.DEBUG)\n\n\nasync def main():\n    logging.debug(\"Hello ...\")\n    asyncio.get_event_loop().call_later(\n        1.0,\n        lambda: logging.debug(\"Immediate callback executed\"))    \n    await asyncio.sleep(2)\n    logging.debug(\"... World!\")\n\nif __name__ == \"__main__\":\n    asyncio.run(main())\n</code></pre> <p>The lambda function call after 1 sec event we execute <code>asyncio.sleep</code></p> <pre><code>2026-01-20 16:55:01 - DEBUG - Hello ...\n2026-01-20 16:55:02 - DEBUG - Immediate callback executed\n2026-01-20 16:55:03 - DEBUG - ... World!\n</code></pre>","tags":["asyncio"]},{"location":"Programming/python/asyncio/#gather","title":"gather","text":"code <pre><code>import asyncio\nimport logging\nlogging.basicConfig(\n    format='%(asctime)s - %(levelname)s - %(message)s',\n    datefmt='%Y-%m-%d %H:%M:%S',\n    level=logging.DEBUG)\n\nasync def say_hello_async():\n    logging.debug(\"Preparing Async World! and go to sleep...\")\n    await asyncio.sleep(2)  # Simulates waiting for 2 seconds\n    logging.debug(\"Hello, Async World!\")\n\nasync def do_something_else():\n    logging.debug(\"Starting another task...\")\n    await asyncio.sleep(1)  # Simulates doing something else for 1 second\n    logging.debug(\"Finished another task!\")\n\nasync def main():\n    # Schedule both tasks to run concurrently\n    await asyncio.gather(\n        say_hello_async(),\n        do_something_else(),\n    )\n\nasyncio.run(main())\n</code></pre>","tags":["asyncio"]},{"location":"Programming/python/asyncio/#future","title":"Future","text":"future with callback <pre><code>import asyncio\n\n\nasync def producer(fut: asyncio.Future):\n    print(\"Producer: working...\")\n    await asyncio.sleep(2)\n\n    # Fulfill the future\n    fut.set_result(\"Hello from the future!\")\n\n\nasync def consumer(fut: asyncio.Future):\n    print(\"Consumer: waiting for result...\")\n    result = await fut\n    print(f\"Consumer: got -&gt; {result}\")\n\n\nasync def main():\n    loop = asyncio.get_running_loop()\n\n    # Create an empty Future\n    fut = loop.create_future()\n\n    await asyncio.gather(\n        producer(fut),\n        consumer(fut),\n    )\n\n\nasyncio.run(main())\n</code></pre> future with exception <pre><code>import asyncio\n\n\nasync def producer(fut: asyncio.Future):\n    print(\"Producer: working...\")\n    await asyncio.sleep(1)\n\n    # Fulfill the future\n    fut.set_exception(RuntimeError(\"Something went wrong\"))\n\n\nasync def consumer(fut: asyncio.Future):\n    try:\n        await fut\n    except Exception as e:\n        print(\"Consumer caught:\", e)\n\n\nasync def main():\n    loop = asyncio.get_running_loop()\n\n    # Create an empty Future\n    fut = loop.create_future()\n\n    await asyncio.gather(\n        producer(fut),\n        consumer(fut),\n    )\n\n\nasyncio.run(main())\n</code></pre> future with callback <pre><code>import asyncio\n\n\ndef on_ready(fut: asyncio.Future):\n    print(\"Future is ready!\")\n    print(\"Result:\", fut.result())\n\n\nasync def producer(fut: asyncio.Future):\n    await asyncio.sleep(1)\n    fut.set_result(\"done\")\n\n\nasync def main():\n    loop = asyncio.get_running_loop()\n    fut = loop.create_future()\n\n    fut.add_done_callback(on_ready)\n\n    await producer(fut)\n\n\nasyncio.run(main())\n</code></pre> future with thread safe <pre><code>import asyncio\n\n\ndef external_thread(loop, fut):\n    loop.call_soon_threadsafe(fut.set_result, 99)\n\n\nasync def main():\n    loop = asyncio.get_running_loop()\n    fut = loop.create_future()\n\n    fut.add_done_callback(lambda f: print(\"Result:\", f.result()))\n\n    import threading\n    threading.Thread(target=external_thread, args=(loop, fut)).start()\n\n    await fut\n\n\nasyncio.run(main())\n</code></pre>","tags":["asyncio"]},{"location":"Programming/python/asyncio/#mixing","title":"Mixing","text":"<p>Mixing Async and Sync: </p> register corotine in loop from worker thread <pre><code>import asyncio\nimport threading\nimport time\n\n\nasync def job(msg: str):\n    await asyncio.sleep(0.2)\n    print(\"Async job:\", msg)\n\n\ndef worker(loop: asyncio.AbstractEventLoop):\n    for i in range(5):\n        time.sleep(0.5)\n        loop.call_soon_threadsafe(asyncio.create_task, job(f\"hello {i}\"))\n\n\nasync def main():\n    loop = asyncio.get_running_loop()\n    threading.Thread(target=worker, args=(loop,), daemon=True).start()\n\n    await asyncio.sleep(3)\n\n\nasyncio.run(main())\n</code></pre>","tags":["asyncio"]},{"location":"Programming/python/asyncio/#wait-and-timeout","title":"Wait and Timeout","text":"simple wait_for <pre><code>import asyncio\n\n\nasync def slow_task():\n    await asyncio.sleep(2)\n    return \"done\"\n\n\nasync def main():\n    try:\n        result = await asyncio.wait_for(slow_task(), timeout=1.0)\n        print(result)\n    except asyncio.TimeoutError:\n        print(\"Timed out!\")\n\n\nasyncio.run(main())\n</code></pre> wait for the first <pre><code>import asyncio\n\n\nasync def worker(name, delay):\n    await asyncio.sleep(delay)\n    return f\"{name} finished\"\n\n\nasync def main():\n    tasks = [\n        asyncio.create_task(worker(\"A\", 2)),\n        asyncio.create_task(worker(\"B\", 1)),\n        asyncio.create_task(worker(\"C\", 3)),\n    ]\n\n    done, pending = await asyncio.wait(\n        tasks,\n        return_when=asyncio.FIRST_COMPLETED,\n    )\n\n    # One or more tasks finished\n    for task in done:\n        print(\"First result:\", task.result())\n\n    # Optional: cancel the rest\n    for task in pending:\n        task.cancel()\n\n    await asyncio.gather(*pending, return_exceptions=True)\n\n\nasyncio.run(main())\n</code></pre>","tags":["asyncio"]},{"location":"Programming/python/dev_env/","title":"VSCode python dev env.","text":"<p>Using vscode and <code>uv</code> to setup a python development environment.</p>","tags":["python","vscode","dev_env"]},{"location":"Programming/python/dev_env/#create-project-using-uv","title":"create project using uv","text":"<pre><code>uv init\n# create venv install pytest and update pyproject.toml\n</code></pre>","tags":["python","vscode","dev_env"]},{"location":"Programming/python/dev_env/#pytest","title":"pytest","text":"<pre><code>uv add --dev pytest\n</code></pre>","tags":["python","vscode","dev_env"]},{"location":"Programming/python/dev_env/#pyprojecttoml","title":"pyproject.toml","text":"<p>Add pytest settings</p> <pre><code>[tool.pytest.ini_options]\npythonpath = [\n  \".\"\n]\n</code></pre>","tags":["python","vscode","dev_env"]},{"location":"Programming/python/dev_env/#vscode","title":"VSCode","text":"","tags":["python","vscode","dev_env"]},{"location":"Programming/python/dev_env/#extensions","title":"Extensions","text":"<ul> <li>ruff</li> </ul>","tags":["python","vscode","dev_env"]},{"location":"Programming/python/dev_env/#settings","title":"Settings","text":"","tags":["python","vscode","dev_env"]},{"location":"Programming/python/dev_env/#vscode-python-autocomplete","title":"VSCode python autocomplete","text":"<pre><code>\"python.analysis.extraPaths\": [\n    \"${workspaceFolder}/src\"\n]\n</code></pre>","tags":["python","vscode","dev_env"]},{"location":"Programming/python/dev_env/#ruff","title":"ruff","text":"<pre><code>\"ruff.importStrategy\": \"useBundled\",\n\"editor.defaultFormatter\": \"charliermarsh.ruff\",\n\"editor.formatOnPaste\": true,\n\"editor.formatOnSave\": true,\n\"editor.formatOnSaveMode\": \"file\",\n\"editor.codeActionsOnSave\": {\n    \"source.organizeImports\": \"always\",\n    \"source.fixAll\": \"always\"\n},\n</code></pre>","tags":["python","vscode","dev_env"]},{"location":"Programming/python/dev_env/#ruff-settings","title":"ruff settings","text":"ruff.toml<pre><code>line-length = 88\nindent-width = 4\n\n[format]\nquote-style = \"double\"\nindent-style = \"space\"\nskip-magic-trailing-comma = false\nline-ending = \"auto\"\ndocstring-code-format = true\ndocstring-code-line-length = \"dynamic\"\n</code></pre>","tags":["python","vscode","dev_env"]},{"location":"Programming/python/matplotlib/","title":"Matplotlib","text":"<p>Programming / python</p>","tags":["python","matplotlib"]},{"location":"Programming/python/matplotlib/#hello-matplotlib","title":"Hello matplotlib","text":"<pre><code>import matplotlib.pyplot as plt\nimport numpy as np \n\nfig, ax = plt.subplots()             # Create a figure containing a single Axes.\nax.plot([1, 2, 3, 4], [1, 4, 2, 3])  # Plot some data on the Axes.\nplt.show()    \n</code></pre>","tags":["python","matplotlib"]},{"location":"Programming/python/matplotlib/#figure","title":"Figure","text":"<p>The whole figure. The Figure keeps track of all the child Axes, a group of 'special' Artists (titles, figure legends, colorbars, etc.), and even nested subfigures.</p>","tags":["python","matplotlib"]},{"location":"Programming/python/matplotlib/#axes","title":"Axes","text":"<p>An Axes is an Artist attached to a Figure that contains a region for plotting data, and usually includes two (or three in the case of 3D) Axis objects</p>","tags":["python","matplotlib"]},{"location":"Programming/python/matplotlib/#axis","title":"Axis","text":"","tags":["python","matplotlib"]},{"location":"Programming/python/matplotlib/#artist","title":"Artist","text":"<p>3D plot</p> <p>Animation</p> <p>Embedded in QT</p>","tags":["python","matplotlib"]},{"location":"Programming/python/matplotlib/#figure-and-subplots","title":"figure and subplots","text":"<pre><code>import matplotlib.pyplot as plt\nimport numpy as np \n\nfig, axs = plt.subplots(2, 2, figsize=(4, 3), layout='constrained')\nfor row in range(2):\n    for col in range(2):\n        axs[row, col].annotate(f'axs[{row}, {col}]', (0.5, 0.5),\n                            transform=axs[row, col].transAxes,\n                            ha='center', va='center', fontsize=18,\n                            color='darkgrey')\n# ax.plot([1, 2, 3, 4], [1, 4, 2, 3])  # Plot some data on the Axes.\nplt.show()\n</code></pre> <pre><code>import matplotlib.pyplot as plt\nimport numpy as np\n\nfig, axs = plt.subplots(2, 2, figsize=(4, 3), layout=\"constrained\")\n\nx, y = [1, 2], [4, 5]\n\nax = axs[0, 0]\nlinesx = ax.scatter(x, y)\n\nax = axs[0, 1]\nlinesx = ax.plot(x, y)\n\nax = axs[1, 0]\nlinesx = ax.bar(x, y)\n\nax = axs[1, 1]\nimg_2d_array = np.random.rand(10, 10)\nlinesx = ax.imshow(img_2d_array)\n\nplt.show()\n</code></pre>","tags":["python","matplotlib"]},{"location":"Programming/python/matplotlib/3d/","title":"3D matplotlib","text":"<p>Programming / python / matplotlib</p>","tags":["matplotlib","python","3d","quiver"]},{"location":"Programming/python/matplotlib/animation/","title":"Matplotlib animation","text":"<p>Programming / python / matplotlib</p> <p>FuncAnimation is Matplotlib\u2019s built-in way to make animations. You give it:</p> <ul> <li>a Figure to draw on,</li> <li>an update function that changes existing artists (lines, scatters, images) for each frame,</li> <li>an optional init function to set the starting state,</li> <li>and frames (how many frames or an iterable of frame values).</li> </ul> <p>It repeatedly calls your update function and redraws.</p> <pre><code>import numpy as np\nimport matplotlib.pyplot as plt\nfrom matplotlib.animation import FuncAnimation\n\n# Data &amp; figure\nx = np.linspace(0, 2*np.pi, 400)\nfig, ax = plt.subplots()\n(line,) = ax.plot([], [], lw=2)   # artist to update\nax.set_xlim(0, 2*np.pi)\nax.set_ylim(-1.2, 1.2)\nax.grid(True)\n\ndef init():\n    line.set_data([], [])\n    return (line,)       # return a tuple/list of artists\n\ndef update(frame):\n    # frame is an int (0..N-1) or any object from your frames iterable\n    print(f\"Frame {frame}\")  # for debugging\n    y = np.sin(x + 0.05*frame)\n    line.set_data(x, y)  # mutate existing artist\n    return (line,)\n\nanim = FuncAnimation(\n    fig, update, \n    init_func=init,\n    frames=200,          # or frames=range(200) or any iterable/generator\n    interval=20,         # milliseconds between frames\n    blit=True            # only re-draw changed artists (faster on many backends)\n)\n\nplt.show()\n</code></pre> <p>Note</p> <p>The callable <code>update</code> must return an <code>iterable</code> of artist when <code>blit=True</code></p>","tags":["matplotlib","animation"]},{"location":"Programming/python/matplotlib/gui/","title":"Embedded matplotlib in QT","text":"<p>Programming / python / matplotlib</p> <pre><code>import sys\nimport time\n\nimport numpy as np\n\nfrom matplotlib.backends.backend_qtagg import FigureCanvas\nfrom matplotlib.backends.backend_qtagg import \\\n    NavigationToolbar2QT as NavigationToolbar\nfrom matplotlib.backends.qt_compat import QtWidgets\nfrom matplotlib.figure import Figure\n\n\nclass ApplicationWindow(QtWidgets.QMainWindow):\n    def __init__(self):\n        super().__init__()\n        self._main = QtWidgets.QWidget()\n        self.setCentralWidget(self._main)\n        layout = QtWidgets.QVBoxLayout(self._main)\n\n        static_canvas = FigureCanvas(Figure(figsize=(5, 3)))\n\n        layout.addWidget(static_canvas)\n\n        dynamic_canvas = FigureCanvas(Figure(figsize=(5, 3)))\n        layout.addWidget(dynamic_canvas)\n        # layout.addWidget(NavigationToolbar(dynamic_canvas, self))\n\n        self._static_ax = static_canvas.figure.subplots()\n        t = np.linspace(0, 10, 501)\n        self._static_ax.plot(t, np.tan(t), \".\")\n        self._static_ax.set_title(\"Static plot\")\n\n        self._dynamic_ax = dynamic_canvas.figure.subplots()\n        self._dynamic_ax.set_title(\"Dynamic plot\")\n        # Set up a Line2D.\n        self.xdata = np.linspace(0, 10, 101)\n        self._update_ydata()\n        self._line, = self._dynamic_ax.plot(self.xdata, self.ydata)\n        # The below two timers must be attributes of self, so that the garbage\n        # collector won't clean them after we finish with __init__...\n\n        # The data retrieval may be fast as possible (Using QRunnable could be\n        # even faster).\n        self.data_timer = dynamic_canvas.new_timer(1)\n        self.data_timer.add_callback(self._update_ydata)\n        self.data_timer.start()\n        # Drawing at 50Hz should be fast enough for the GUI to feel smooth, and\n        # not too fast for the GUI to be overloaded with events that need to be\n        # processed while the GUI element is changed.\n        self.drawing_timer = dynamic_canvas.new_timer(20)\n        self.drawing_timer.add_callback(self._update_canvas)\n        self.drawing_timer.start()\n\n    def _update_ydata(self):\n        # update the data only\n        self.ydata = np.sin(self.xdata + time.time())\n\n    def _update_canvas(self):\n        # update matplotlib canvas\n        self._line.set_data(self.xdata, self.ydata)\n        self._line.figure.canvas.draw_idle()\n\n\nif __name__ == \"__main__\":\n    # Check whether there is already a running QApplication (e.g., if running\n    # from an IDE).\n    qapp = QtWidgets.QApplication.instance()\n    if not qapp:\n        qapp = QtWidgets.QApplication(sys.argv)\n\n    app = ApplicationWindow()\n    app.show()\n    app.activateWindow()\n    app.raise_()\n    qapp.exec()\n</code></pre> <ul> <li>data_timer: update data only</li> <li>drawing_timer: update the canvas</li> </ul>","tags":["matplotlib","gui","qt"]},{"location":"Programming/python/numpy/reshape/","title":"Numpy reshape","text":"<p>Programming / python / numpy</p>","tags":["numpy","reshape"]},{"location":"Programming/python/numpy/reshape/#methods","title":"methods","text":"<ul> <li>reshape</li> <li>flatten</li> <li>ravel: flattens a multi-dimensional array into a 1D array.</li> </ul>","tags":["numpy","reshape"]},{"location":"Programming/python/numpy/reshape/#reshape","title":"reshape","text":"<p>It returns a view of the same data with a new shape when possible (no copy).</p> <ul> <li>The number of elements must stay the same: <code>np.prod(a.shape) == np.prod(new_shape)</code>.</li> <li>Dtype doesn\u2019t change.</li> </ul> <p>np.prod</p> <p>numpy.prod() computes the product of the array elements over a specified axis.</p> <pre><code>a = np.arange(12)\na.shape\n# (12,)\n\na = a.reshape(3,4)\na.shape\n# shape (3,4)\n\n# A placeholder that tells NumPy to infer that dimension so the total size matches.\na = a.reshape(-1)\na.shape\n# (12,)\n\n# error\na = a.reshape(3,3)\n# cannot reshape array of size 12 into shape (3,3)\n</code></pre> reshape view vs copy<pre><code>a = np.arange(12)\na = a.reshape(3,4)\n\n# View\nr = a.reshape(-1)\nr[0] = 10\na[0,0]\n# np.int64(10)\n\n\n# flat copy\nr = a.flatten()\nr[0] = 10\na[0,0]\n# np.int64(0)\n\n# View if possible\nr = np.ravel(a)\nr[0] = 10\na[0,0]\n# np.int64(0)\n</code></pre> <pre><code>a = np.arange(12)\na = a.reshape(1,6,2)\na. shape\n# (1, 6, 2)\n\n\na = np.arange(12)\na = a.reshape(1,6,2)\na = np.ravel(a)\na.shape\n# (12,)\n</code></pre>","tags":["numpy","reshape"]},{"location":"Programming/python/protobuf/","title":"Python protobuf","text":"","tags":["python","protobuf","protoc"]},{"location":"Programming/python/protobuf/#install","title":"Install","text":"<pre><code>sudo apt install protobuf-compiler\n\npip install protobuf\n</code></pre>","tags":["python","protobuf","protoc"]},{"location":"Programming/python/protobuf/#simple-demo","title":"Simple demo","text":"proto/person.proto<pre><code>syntax = \"proto3\";\n\nmessage Person {\n  string name = 1;\n  int32 id = 2;\n  string email = 3;\n}\n</code></pre> <ul> <li>Import and create person class</li> <li>Serialize</li> <li>Deserialization <code>ParseFromString</code></li> </ul> <pre><code>from msgs import person_pb2\n\n# Create a Person object\nperson = person_pb2.Person()\nperson.name = \"Alice\"\nperson.id = 123\nperson.email = \"alice@example.com\"\n\n# Serialize to bytes\ndata = person.SerializeToString()\n\n# Deserialize\nnew_person = person_pb2.Person()\nnew_person.ParseFromString(data)\n\nprint(f\"Name: {new_person.name}, ID: {new_person.id}, Email: {new_person.email}\")\n</code></pre>","tags":["python","protobuf","protoc"]},{"location":"Programming/python/protobuf/#python-intellisense","title":"Python intellisense","text":"<pre><code>pip install mypy-protobuf\n</code></pre> <ul> <li>Create <code>pyi</code> file for  <pre><code>protoc \\\n--python_out=msgs \\\n--mypy_out=msgs \\\n--proto_path=proto person.proto\n</code></pre></li> </ul>","tags":["python","protobuf","protoc"]},{"location":"Programming/python/python/","title":"Index","text":"<p>Protocols</p> <p>Annotation</p> <p>Dataclass</p>","tags":["python"]},{"location":"Programming/python/python/#good-posts-and-videos","title":"Good Posts and videos","text":"<ul> <li>Understanding Python Decorators in 12 Easy Steps!</li> <li>Transforming Code into Beautiful, Idiomatic Python</li> </ul>","tags":["python"]},{"location":"Programming/python/python/python_verbs_and_terms/","title":"Python verbs and terms","text":"<p>Programming / python</p>","tags":["python","duck"]},{"location":"Programming/python/python/python_verbs_and_terms/#duck-typing-in-python","title":"Duck Typing in python","text":"<pre><code>If it walks like a duck and it quacks like a duck, then it must be a duck.\n</code></pre> <p>In the context of programming, this means that if an object provides the necessary methods and attributes required for a certain operation, it can be treated as if it were of a specific type</p>","tags":["python","duck"]},{"location":"Programming/python/python/python_verbs_and_terms/#monkey-patching-dynamic-class-modification","title":"Monkey Patching / dynamic class modification","text":"<p>When we add / modify attribute/methods of class at runtime</p> <pre><code>class MyClass:\n    pass  # empty class\n\ndef greet(self):\n    print(\"Hello!\")\n\n# Add behavior at runtime\nMyClass.greet = greet\n\nobj = MyClass()\nobj.greet()  # Hello!\n</code></pre>","tags":["python","duck"]},{"location":"Programming/python/python/annotation/","title":"Python type annotation","text":"","tags":["python","typing","annotation","pyright","vscode"]},{"location":"Programming/python/python/annotation/#primitive","title":"primitive","text":"<pre><code>var: str = \"hello\"\nb: bool = False\nf: float = 1.1\nn: int = 1\nnb: int = True\n\ndef foo(names: str) -&gt; None\n    pass\n</code></pre> union<pre><code>var: str | int = 10\nvar = \"hello\"\n\nvar: int | None = None\n\nfrom typing import Optional\n\nvar: Optional(int) = None\n</code></pre>","tags":["python","typing","annotation","pyright","vscode"]},{"location":"Programming/python/python/annotation/#collections","title":"collections","text":"list<pre><code>numbers: list[int] = [1, 2, 3]\n</code></pre> tuple<pre><code>data: tuple[int, str, bool] = (1, \"hello\", True)\nt_of_int[int, ...] = (1, 2, 3, 4, 5, 6)\n</code></pre> sets<pre><code>my_set: set[int] = {1, 2, 3}\n</code></pre> dict<pre><code>my_dict: dict[str, int] = {\"a\": 5}\n</code></pre>","tags":["python","typing","annotation","pyright","vscode"]},{"location":"Programming/python/python/annotation/#_1","title":"Python type annotation","text":"return value<pre><code>def get_data() -&gt; int | None\n    ...\n</code></pre>","tags":["python","typing","annotation","pyright","vscode"]},{"location":"Programming/python/python/annotation/#vscode","title":"VSCode","text":"<pre><code>{\n  \"python.analysis.typeCheckingMode\": \"strict\"\n}\n</code></pre> <ul> <li>off</li> <li>basic</li> <li>standard</li> <li>strict</li> </ul>","tags":["python","typing","annotation","pyright","vscode"]},{"location":"Programming/python/python/annotation/#ruff","title":"RUFF","text":"pyproject.toml<pre><code>[tool.ruff]\ntarget-version = \"py312\"\nline-length = 88\n</code></pre> <p>Generic</p> <p>callable</p> <p>Cast</p>","tags":["python","typing","annotation","pyright","vscode"]},{"location":"Programming/python/python/annotation/#generic","title":"generic","text":"<p>Generics allow you to write code that can work with different types while maintaining type safety. it like templates or placeholders for types that get filled in when you actually use the code.</p>","tags":["python","typing","annotation","pyright","vscode"]},{"location":"Programming/python/python/annotation/#demo-generic-event-class","title":"Demo: generic event class","text":"","tags":["python","typing","annotation","pyright","vscode"]},{"location":"Programming/python/python/annotation/#1-2-3-4-5-6-7-8-9-10-11-12-13-14-15-16-17-18-19-20-21-22-23-24-25-26-27-28-29-30-31-32-33-34-35-36-37-38from-typing-import-callable-typevar-generic-import-logging-t-typevart-logger-logginggetlogger__name__-class-eventgenerict-def-__init__self-none-self_handlers-listcallablet-none-def-__iadd__self-handler-callablet-none-eventt-if-handler-not-in-self_handlers-self_handlersappendhandler-return-self-def-__isub__self-handler-callablet-none-eventt-try-self_handlersremovehandler-except-valueerror-pass-return-self-def-fireself-item-t-none-for-handler-in-listself_handlers-copy-for-safety-try-handleritem-except-exception-loggerexceptionevent-handler-raised-an-exception-def-on_strs-str-none-printreceived-s-event-eventstr-event-on_str-eventfirehello-event-on_str-eventfireworld-nothing-happens","title":"<pre><code>from typing import Callable, TypeVar, Generic\nimport logging\n\nT = TypeVar(\"T\")\nlogger = logging.getLogger(__name__)\n\nclass Event(Generic[T]):\n    def __init__(self) -&gt; None:\n        self._handlers: list[Callable[[T], None]] = []\n\n    def __iadd__(self, handler: Callable[[T], None]) -&gt; \"Event[T]\":\n        if handler not in self._handlers:\n            self._handlers.append(handler)\n        return self\n\n    def __isub__(self, handler: Callable[[T], None]) -&gt; \"Event[T]\":\n        try:\n            self._handlers.remove(handler)\n        except ValueError:\n            pass\n        return self\n\n    def fire(self, item: T) -&gt; None:\n        for handler in list(self._handlers):  # copy for safety\n            try:\n                handler(item)\n            except Exception:\n                logger.exception(\"Event handler raised an exception\")\n\ndef on_str(s: str) -&gt; None:\n    print(\"received:\", s)\n\nevent = Event[str]()\nevent += on_str\nevent.fire(\"hello\")\n\nevent -= on_str\nevent.fire(\"world\")  # nothing happens\n</code></pre>","text":"","tags":["python","typing","annotation","pyright","vscode"]},{"location":"Programming/python/python/annotation/#callable","title":"callable","text":"<pre><code>Callable[[arguments], return]\n</code></pre>","tags":["python","typing","annotation","pyright","vscode"]},{"location":"Programming/python/python/annotation/#1-2-3-4-5-6-7-8-9from-collectionsabc-import-callable-def-funccallback-callableint-str-str-return-callback10-def-foodata-int-str-return-fhello-your-number-is-data-printfuncfoo","title":"<pre><code>from collections.abc import Callable\n\ndef func(callback: Callable[[int], str]) -&gt; str:\n    return callback(10)\n\ndef foo(data: int) -&gt; str:\n    return f\"Hello, your number is {data}\"\n\nprint(func(foo))\n</code></pre>","text":"","tags":["python","typing","annotation","pyright","vscode"]},{"location":"Programming/python/python/annotation/#cast","title":"cast","text":"<p>typing.cast` comes in. It's a function in Python's typing module that lets you tell the computer, \"Hey, even though this variable looks like one thing, I want you to treat it like something else.\"</p> <pre><code>from typing import cast\n\nmy_variable = cast(TargetType, source_variable)\n</code></pre> <p>Just remember, <code>typing.cast</code> doesn't actually change the underlying value of your variable \u2013 it just tells the type checker how to interpret it. So, if you try to do something that doesn't make sense for the target type, you'll still get an error at runtime.</p>","tags":["python","typing","annotation","pyright","vscode"]},{"location":"Programming/python/python/annotation/#reference","title":"Reference","text":"<ul> <li>Why Use Types | Python Type Hints for Beginners </li> </ul>","tags":["python","typing","annotation","pyright","vscode"]},{"location":"Programming/python/python/dataclasses/","title":"Python dataclass","text":"<p>A dataclass is a Python class that is mainly used to store data, and Python automatically generates:</p> <ul> <li><code>__init__</code></li> <li><code>__repr__</code></li> <li><code>__eq__</code></li> </ul> basic<pre><code>from dataclasses import dataclass\n\n@dataclass\nclass Point:\n    x: float\n    y: float\n</code></pre> usage<pre><code>p = Point(1.0, 2.0)\nprint(p)\n</code></pre>","tags":["python","dataclass"]},{"location":"Programming/python/python/dataclasses/#export-as-dict-or-tuple","title":"Export as dict or tuple","text":"<pre><code>from dataclasses import dataclass,asdict, astuple\n\n@dataclass\nclass Point:\n    x: float\n    y: float\n\np = Point(1.0, 2.0)\nprint(asdict(p))\nprint(astuple(p))\n</code></pre>","tags":["python","dataclass"]},{"location":"Programming/python/python/dataclasses/#post_init","title":"post_init","text":"<p><code>__post_init__</code> is a hook that runs immediately after the dataclass-generated<code>__init__</code> finishes.</p>","tags":["python","dataclass"]},{"location":"Programming/python/python/dataclasses/#usage-demo","title":"usage demo","text":"<ul> <li>r : is a calculate field</li> </ul> <pre><code>from dataclasses import dataclass, field\n\n@dataclass\nclass Vector:\n    x: float\n    y: float\n    r: float = field(init=False)\n\n    def __post_init__(self):\n        self.r = (self.x**2 + self.y**2) ** 0.5\n</code></pre>","tags":["python","dataclass"]},{"location":"Programming/python/python/dataclasses/#field","title":"field","text":"<p>You use field() when you want extra control over a property:</p> <ul> <li>default values</li> <li>default factory (for lists, dicts, etc.)</li> <li>exclude from init</li> <li>exclude from repr</li> <li>metadata</li> <li>comparison behavior</li> </ul> <pre><code>attribute: type = field(...)\n</code></pre>","tags":["python","dataclass"]},{"location":"Programming/python/python/dataclasses/#default_factory","title":"default_factory","text":"<p>init the mutable attribute correctly  Use default_factory for: - list - dict - set - custom objects</p> <pre><code>@dataclass\nclass GoodExample:\n    items: list = field(default_factory=list)\n</code></pre>","tags":["python","dataclass"]},{"location":"Programming/python/python/dataclasses/#metadata","title":"metadata","text":"<p>attach extra info to fields:</p> <pre><code>@dataclass\nclass Config:\n    port: int = field(metadata={\"unit\": \"tcp\"})\n</code></pre> <pre><code>Config.__dataclass_fields__[\"port\"].metadata\n# return metadata as dictionary \n</code></pre>","tags":["python","dataclass"]},{"location":"Programming/python/python/dataclasses/#annotation","title":"Annotation","text":"<pre><code>from dataclasses import dataclass\nfrom typing import Annotated\n\n@dataclass\nclass Sensor:\n    angle: Annotated[float, \"deg\", \"imu_angle\"]\n    data: Annotated[float, \"deg\", \"other data\"] = field(default=100)\n</code></pre>","tags":["python","dataclass"]},{"location":"Programming/python/python/dataclasses/#extract-parts-of-annotated","title":"Extract parts of Annotated","text":"<pre><code>from typing import get_origin, get_args\nfrom typing import get_type_hints\n\n\nhints = get_type_hints(Sensor, include_extras=True)\nannot = hints[\"angle\"]\n\nprint(get_origin(annot))  # Annotated\nprint(get_args(annot))    # (float, 'deg', 'imu')\n</code></pre>","tags":["python","dataclass"]},{"location":"Programming/python/python/dataclasses/#field-vs-annotated-when-to-use-which","title":"field() vs Annotated \u2014 when to use which?","text":"Use case Best choice Default values / factories <code>field()</code> Hide from repr/init <code>field()</code> Validation constraints <code>Annotated</code> Serialization hints <code>Annotated</code> or metadata Framework integration <code>Annotated</code>","tags":["python","dataclass"]},{"location":"Programming/python/python/dataclasses/#demo","title":"Demo","text":"<p>Using <code>dataclass</code> and annotation to build <code>struct</code> fmt dynamic from dataclass fields</p> <pre><code>from dataclasses import dataclass\nfrom typing import Annotated\n\n@dataclass\nclass Packet:\n    a: Annotated[int, \"h\"]   # int16\n    b: Annotated[int, \"I\"]   # uint32\n    c: Annotated[float, \"f\"] # float32\n    name: Annotated[str, \"16s\"]\n</code></pre> <pre><code>from typing import get_type_hints, get_origin, get_args\nimport struct\n\ndef struct_format(cls, endian=\"&lt;\"):\n    hints = get_type_hints(cls, include_extras=True)\n    fmt = endian\n\n    for name in cls.__dataclass_fields__:\n        t = hints[name]\n\n        if get_origin(t) is Annotated:\n            _, fmt_char, *_ = get_args(t)\n            fmt += fmt_char\n        else:\n            raise TypeError(f\"Field {name} missing struct annotation\")\n\n    return fmt\n</code></pre> <pre><code>fmt = struct_format(Packet)\nprint(fmt)  # \"&lt;hIf16s\"\n</code></pre> code<pre><code>from dataclasses import dataclass, astuple\nfrom typing import Annotated\nfrom typing import get_type_hints, get_origin, get_args\nimport struct\nfrom functools import cache\n\n@dataclass\nclass Packet:\n    a: Annotated[int, \"h\"]   # int16\n    b: Annotated[int, \"I\"]   # uint32\n    c: Annotated[float, \"f\"] # float32\n    # name: Annotated[str, \"16s\"]\n\n\n    @classmethod\n    @cache\n    def struct_format(cls, endian=\"&lt;\") -&gt; str:\n        \"\"\"\n        Docstring for struct_format\n\n        :param cls: Class to generate format for\n        :param endian: Endianness of the struct format\n        \"\"\"\n        hints = get_type_hints(cls, include_extras=True)\n        fmt = endian\n\n        for name in cls.__dataclass_fields__:\n            t = hints[name]\n\n            if get_origin(t) is Annotated:\n                _, fmt_char, *_ = get_args(t)\n                fmt += fmt_char\n            else:\n                raise TypeError(f\"Field {name} missing struct annotation\")\n\n        return fmt\n\n    def pack(self, endian=\"&lt;\") -&gt; bytes:\n        \"\"\"\n        Return data packed as bytes\n\n        :param endian: Endianness of the struct format\n        :return: Descriptionreturn buffer as bytes\n        :rtype: bytes\n        \"\"\"\n        fmt = self.struct_format(endian)\n        return struct.pack(fmt, *astuple(self))\n\n    @classmethod\n    def from_bytes(cls, data: bytes, endian: str=\"&lt;\") -&gt; \"Packet\":\n        \"\"\"\n        convert bytes to class instance\n\n        :param cls: Class to generate format for\n        :param data: buffer to unpack\n        :type data: bytes\n        :param endian: Endianness of the struct format\n        \"\"\"\n        fmt = cls.struct_format(endian)\n        unpacked_data = struct.unpack(fmt, data)\n        return cls(*unpacked_data)\n\n\n# usage\npacket = Packet(a=1, b=42, c=3.14)\n#pack\nbuffer = packet.pack()\n# print(Packet.struct_format.cache_info())\n\n#unpack\nunpacked_data = Packet.from_bytes(buffer)\nprint(unpacked_data)\n</code></pre>","tags":["python","dataclass"]},{"location":"Programming/python/python/protocol/","title":"Index","text":"<p>Programming / python / python</p> <p>A protocol defines a set of methods and properties that a class must have \u2014 without requiring inheritance.</p> <p>duck typing</p> <p>If it looks like a duck, swims like a duck, and quacks like a duck\u2026 congratulations, Python will call it a duck.</p> <p>The same idea is for protocol, if you can do the job i don't care how you are or in other words \u201cAny object that looks like this, I can use it.\u201d</p> <pre><code>from typing import Protocol\n\nclass Speaker(Protocol):\n    def speak(self) -&gt; None:\n        ...\n\nclass Dog:\n    def speak(self):\n        print(\"Woof!\")\n\nclass Cat:\n    def speak(self):\n        print(\"Meow!\")\n\ndef make_it_talk(animal: Speaker) -&gt; None:\n    animal.speak()\n\nmake_it_talk(Dog())\nmake_it_talk(Cat())\n</code></pre>","tags":["python","protocol"]},{"location":"Programming/python/python/protocol/#runtime_checkable","title":"@runtime_checkable","text":"<p>@runtime_checkable makes a protocol usable with isinstance() or issubclass() at runtime.</p> <pre><code>from typing import Protocol\n\nclass Speaker(Protocol):\n    def speak(self) -&gt; None: ...\n\nclass Dog:\n    def speak(self): print(\"Woof!\")\n\nprint(isinstance(Dog(), Speaker))  # \u274c TypeError\n</code></pre> <pre><code>from typing import Protocol, runtime_checkable\n\n@runtime_checkable\nclass Speaker(Protocol):\n    def speak(self) -&gt; None: ...\n\nclass Dog:\n    def speak(self):\n        print(\"Woof!\")\n\nd = Dog()\nprint(isinstance(d, Speaker))  # \u2705 True\n</code></pre>","tags":["python","protocol"]},{"location":"Programming/python/python_project/","title":"Pack python project as wheel and debian package","text":"<p>pyproject.toml is a standardized file (PEP 518, PEP 621) used to configure Python packaging, building, and tools.</p> <pre><code>my_package/\n\u251c\u2500\u2500 pyproject.toml\n\u251c\u2500\u2500 README.md\n\u2514\u2500\u2500 my_package/\n    \u251c\u2500\u2500 __init__.py\n    \u2514\u2500\u2500 main.py\n</code></pre> <pre><code>[build-system]\nrequires = [\"setuptools&gt;=61\"]\nbuild-backend = \"setuptools.build_meta\"\n\n[project]\nname = \"myproject\"\nversion = \"0.1.0\"\ndescription = \"\"\nreadme = \"README.md\"\nrequires-python = \"&gt;=3.8\"\n</code></pre>","tags":["python","debian","pyproject.toml"]},{"location":"Programming/python/python_project/#build-system","title":"build-system","text":"<p>Defines how your project is built. This tells Python which tools to use when running <code>pip install</code> or <code>python -m build</code>. <code>setuptools</code> is the classic standard and widely use</p> <p>other build tools</p> <ul> <li>Poetry</li> <li>Hatch</li> <li>flit</li> </ul>","tags":["python","debian","pyproject.toml"]},{"location":"Programming/python/python_project/#python-build","title":"python build","text":"<p>How to turn your source code into an installable package</p> <pre><code>pip install build\n</code></pre> usage<pre><code>python -m build\n\n# create wheel in `dist` folder\n</code></pre> <p>Tip</p> <p>use <code>--no-isolation</code> flag to disabled creating isolated virtual environment during build</p>","tags":["python","debian","pyproject.toml"]},{"location":"Programming/python/python_project/#project-metadata-pep-621","title":"project metadata (PEP 621)","text":"<p>The [project] section in pyproject.toml that describes your Python package:</p> <ul> <li>name</li> <li>version</li> <li>dependencies</li> <li>dependencies</li> <li>entry points</li> <li>requires-python</li> <li>and more</li> </ul>","tags":["python","debian","pyproject.toml"]},{"location":"Programming/python/python_project/#version","title":"version","text":"<p>Set manual <pre><code>version = \"0.1.0\"\n</code></pre></p> <p>or dynamic using  tools like <code>setuptools-scm</code>. <pre><code>dynamic = [\"version\"]\n</code></pre></p>","tags":["python","debian","pyproject.toml"]},{"location":"Programming/python/python_project/#dependencies","title":"dependencies","text":"<pre><code>dependencies = [\n    \"requests&gt;=2.28\",\n    \"numpy\",\n]\n</code></pre>","tags":["python","debian","pyproject.toml"]},{"location":"Programming/python/python_project/#more-project-settings","title":"more project settings","text":"<pre><code>[project.optional-dependencies]\ndev = [\"pytest\", \"black\", \"flake8\"]\n\n[project.urls]\nHomepage = \"https://github.com/alice/coolapp\"\nDocs = \"https://coolapp.readthedocs.io\"\n\n[project.scripts]\ncoolapp = \"my_package:main\"\n</code></pre> <ul> <li>[project.optional-dependencies]: install optional package <code>pip install my_package[dev]</code></li> <li>[project.scripts]: entry point/CLI command run <code>coolapp</code> to run application after install</li> </ul> <p>Build Your First Python Package with pyproject.toml</p>","tags":["python","debian","pyproject.toml"]},{"location":"Programming/python/python_project/#from-wheel-to-deb","title":"From wheel to deb","text":"Tool Uses <code>.install</code> Easy Policy-correct Best for dpkg-deb \u274c \u2b50\u2b50\u2b50\u2b50 \u274c quick hacks dpkg-buildpackage \u2705 \u2b50\u2b50 \u2705 real Debian debuild \u2705 \u2b50\u2b50 \u2705 same as above stdeb \u26a0\ufe0f \u2b50\u2b50\u2b50 \u26a0\ufe0f Python-only <p>From source to debain using debuild</p> <p>From source to debain using dpkg-deb</p>","tags":["python","debian","pyproject.toml"]},{"location":"Programming/python/python_project/debuild/","title":"Python project from source to DEB using debuild","text":"<p>Using <code>debuild</code> to pack python projecr into debian package  The python project include <code>pyproject.toml</code> </p>","tags":["python","debian","debuild","dpkg-buildpackage"]},{"location":"Programming/python/python_project/debuild/#install-depend-packages","title":"install depend packages","text":"<pre><code>sudo apt install dh-python\nsudo apt install pybuild-plugin-pyproject\nsudo apt install python3-all\n</code></pre>","tags":["python","debian","debuild","dpkg-buildpackage"]},{"location":"Programming/python/python_project/debuild/#project-basic","title":"Project basic","text":"<ul> <li>using <code>uv</code> to create project files and folders<ul> <li>pyproject.toml</li> </ul> </li> <li>add debian folder <ul> <li>control</li> <li>rules</li> <li>postinst</li> <li>postrm</li> </ul> </li> </ul> <pre><code>\u251c\u2500\u2500 debian\n\u2502   \u251c\u2500\u2500 changelog\n\u2502   \u251c\u2500\u2500 control\n\u2502   \u251c\u2500\u2500 postinst\n\u2502   \u251c\u2500\u2500 postrm\n\u2502   \u2514\u2500\u2500 rules\n\u251c\u2500\u2500 pyproject.toml\n\u251c\u2500\u2500 README.md\n\u251c\u2500\u2500 src\n\u2502   \u2514\u2500\u2500 py2deb\n\u2502       \u251c\u2500\u2500 __init__.py\n\u2502       \u2514\u2500\u2500 py.typed\n\u2514\u2500\u2500 uv.lock\n</code></pre>","tags":["python","debian","debuild","dpkg-buildpackage"]},{"location":"Programming/python/python_project/debuild/#control","title":"control","text":"<pre><code>Source: py2deb\nSection: python\nPriority: optional\nMaintainer: Your Name &lt;you@example.com&gt;\nBuild-Depends:\n debhelper-compat (= 13),\n dh-python,\n python3-all,\n pybuild-plugin-pyproject\nStandards-Version: 4.6.2\n\nPackage: python3-py2deb\nArchitecture: all\nDepends: ${python3:Depends}, ${misc:Depends}\nDescription: py2deb Python library\n Python library installed system-wide using dh-python.\n</code></pre>","tags":["python","debian","debuild","dpkg-buildpackage"]},{"location":"Programming/python/python_project/debuild/#rules","title":"rules","text":"<pre><code>#!/usr/bin/make -f\n\n%:\n    dh $@ --with python3 --buildsystem=pybuild\n\noverride_dh_builddeb:\n    dh_builddeb --destdir=$(CURDIR)/debs\n</code></pre> <p>rule tab indentation</p> settings.json<pre><code>{\n    \"[shellscript]\": {\n        \"editor.insertSpaces\": false,\n        \"editor.tabSize\": 4,\n        \"editor.detectIndentation\": false\n    },\n    \"files.associations\": {\n        \"rules\": \"shellscript\"\n    }\n}\n</code></pre>","tags":["python","debian","debuild","dpkg-buildpackage"]},{"location":"Programming/python/python_project/debuild/#pyprojecttoml","title":"pyproject.toml","text":"<pre><code>[project]\nname = \"py2deb\"\nversion = \"0.1.0\"\ndescription = \"Add your description here\"\nreadme = \"README.md\"\nauthors = [\n    { name = \"robobe\", email = \"robobe2020@gmail.com\" }\n]\nrequires-python = \"&gt;=3.12\"\ndependencies = []\n\n[build-system]\nrequires = [\"setuptools&gt;=68\", \"wheel\"]\nbuild-backend = \"setuptools.build_meta\"\n\n[dependency-groups]\ndev = [\n    \"build&gt;=1.3.0\",\n]\n</code></pre>","tags":["python","debian","debuild","dpkg-buildpackage"]},{"location":"Programming/python/python_project/debuild/#postinst","title":"postinst","text":"","tags":["python","debian","debuild","dpkg-buildpackage"]},{"location":"Programming/python/python_project/debuild/#-debhelper","title":"- #DEBHELPER#","text":"<pre><code>#!/bin/sh\n\n# debhelper will inject its autogenerated code here\n# (triggers, ldconfig, python cache, etc.)\n# DO NOT REMOVE\n#DEBHELPER#\n\nset -e\n\ncase \"$1\" in\n  configure)\n    echo \"Running custom post-install logic\"\n    # your command here\n    ;;\nesac\n\nexit 0\n</code></pre>","tags":["python","debian","debuild","dpkg-buildpackage"]},{"location":"Programming/python/python_project/debuild/#postrm","title":"postrm","text":"","tags":["python","debian","debuild","dpkg-buildpackage"]},{"location":"Programming/python/python_project/debuild/#debhelper","title":"DEBHELPER","text":"","tags":["python","debian","debuild","dpkg-buildpackage"]},{"location":"Programming/python/python_project/debuild/#1-2-3-4-5-6-7-8-9-10-11-12binsh-debhelper-will-inject-its-autogenerated-code-here-triggers-ldconfig-python-cache-etc-do-not-remove-debhelper-set-e-exit-0","title":"<pre><code>#!/bin/sh\n\n# debhelper will inject its autogenerated code here\n# (triggers, ldconfig, python cache, etc.)\n# DO NOT REMOVE\n#DEBHELPER#\n\nset -e\n\n\n\nexit 0\n</code></pre>","text":"","tags":["python","debian","debuild","dpkg-buildpackage"]},{"location":"Programming/python/python_project/debuild/#usage","title":"usage","text":"<p>debs folder</p> <p>debuild create the deb file and other artifacts in project parent folder using <code>rules</code> control where deb fille will locater but it mess <code>dpkg-buildpackage</code> app default behaver</p> rules<pre><code>override_dh_builddeb:\n    dh_builddeb --destdir=$(CURDIR)/debs\n</code></pre> <pre><code>debuild -b -us -uc\n</code></pre>","tags":["python","debian","debuild","dpkg-buildpackage"]},{"location":"Programming/python/python_project/debuild/#todo","title":"TODO","text":"<ul> <li>hot to sync pyproject.toml version with changelog / debian package</li> <li>explain more <code>#DEBHELPER#</code> what are the defaults commends that debuld embedded in <code>postinst</code> and <code>postrm</code></li> </ul>","tags":["python","debian","debuild","dpkg-buildpackage"]},{"location":"Programming/python/python_project/dpkg-deb/","title":"Python project from source to DEB using dpkg-deb","text":"","tags":["python","debian","dpkg-deb"]},{"location":"Programming/python/python_project/dpkg-deb/#dpkg-deb","title":"dpkg-deb","text":"<p>Using <code>dpkg-deb</code> util to create debian package from python project (wrap the whl file create by <code>python3 -m build</code>)</p>","tags":["python","debian","dpkg-deb"]},{"location":"Programming/python/python_project/dpkg-deb/#demo","title":"Demo","text":"<p>demo code  My basic idea is create project DEBIAN folder the include all the file that i need to pack include the whl file that create using <code>python -m build</code></p> <ul> <li>Create root folder named <code>python3-&lt;project-name&gt;</code></li> <li>Create DEBIAN folder</li> <li>Add control file under DEBIAN folder</li> <li>Using <code>python -m build --outdir</code> to place the dir under the project debian folder (dist sub folder)</li> <li>Add <code>postinst</code> and <code>postrm</code> to install the <code>whl</code> file when we install the package</li> <li>Set execte permission to <code>postinst</code> and <code>postrm</code> and <code>644</code> to <code>control</code> file</li> <li>Create <code>debs</code> folder under project root for deb output</li> <li>Run <code>dpkg-deb python3-&lt;project-name&gt; debs</code> </li> <li>Check the debian using <code>dpkg -I</code> and <code>dpkg -c</code></li> </ul>","tags":["python","debian","dpkg-deb"]},{"location":"Programming/python/python_project/dpkg-deb/#project","title":"Project","text":"<pre><code>\u251c\u2500\u2500 pyproject.toml\n\u251c\u2500\u2500 python3-python-project\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 DEBIAN\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 control\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 postinst\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 postrm\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 dist\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 my_package-0.0.1-py3-none-any.whl\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 my_package-0.0.1.tar.gz\n\u251c\u2500\u2500 python_project\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 app.py\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 __init__.py\n\u2514\u2500\u2500 README.md\n</code></pre> control<pre><code>Package: python3-python-project\nVersion: 1.0.0\nSection: python\nPriority: optional\nArchitecture: all\nDepends: python3, python3-pip\nMaintainer: Your Name &lt;you@email.com&gt;\nDescription: My Python project packaged as a Debian package\n</code></pre> postint<pre><code>#!/bin/sh\nset -e\n\npip3 install --no-deps /dist/my_package-0.0.1-py3-none-any.whl\n\necho \"Installation complete.\"\n\nexit 0\n</code></pre>","tags":["python","debian","dpkg-deb"]},{"location":"Programming/python/python_project/dpkg-deb/#postrm1-2-3-4-5-6binsh-set-e-echo-removing-python-package-exit-0","title":"postrm<pre><code>#!/bin/sh\nset -e\n\necho \"Removing Python package...\"\n\nexit 0\n</code></pre>","text":"","tags":["python","debian","dpkg-deb"]},{"location":"Programming/python/python_project/dpkg-deb/#todo","title":"TODO","text":"<ul> <li>i know that run pip from postinst it`s bead idea, </li> </ul>","tags":["python","debian","dpkg-deb"]},{"location":"Programming/python/zmq/","title":"ZMQ","text":"Scope Transport Performance Complexity Recommendation Same process <code>inproc://</code> \u2b50\u2b50\u2b50\u2b50\u2b50 \u2b50 \u2705 Best Same machine <code>ipc://</code> \u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50 \u2705 Best Network <code>tcp://</code> \u2b50\u2b50\u2b50 \u2b50\u2b50 \u2705 Best Any shm \u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50\u2b50 \u274c Avoid <p>Pub / Sub</p> <p>Request / Response</p> <p>Serialization</p> Pattern Direction Fan-out Reliable Typical use REQ/REP 1\u21941 \u274c \u2705 RPC PUB/SUB 1\u2192N \u2705 \u274c Events, streaming PUSH/PULL 1\u2192N \u274c \u2705 Work queues DEALER/ROUTER N\u2194N \u2705 \u2705 Async services XPUB/XSUB 1\u2192N \u2705 \u274c Brokers PAIR 1\u21941 \u274c \u2705 Simple pipes <p>ZMQ with shm</p> <p>Serialization and Zero copy</p>","tags":["python","zmq"]},{"location":"Programming/python/zmq/#inproc","title":"inproc","text":"<p>Communication in same process</p> <p>share the same context</p> <pre><code>import zmq\nimport threading\nimport time\n\nctx = zmq.Context() # type: ignore[attr-defined]\n\ndef publisher():\n    pub = ctx.socket(zmq.PUB) # type: ignore[attr-defined]\n    pub.bind(\"inproc://events\")\n    time.sleep(0.1)  # allow subscribers to connect\n    pub.send_multipart([b\"topic\", b\"hello\"])\n\ndef subscriber():\n    sub = ctx.socket(zmq.SUB) # type: ignore[attr-defined]\n    sub.connect(\"inproc://events\")\n    sub.setsockopt(zmq.SUBSCRIBE, b\"topic\") # type: ignore[attr-defined]\n    print(sub.recv_multipart())\n\nt1 = threading.Thread(target=subscriber)\nt2 = threading.Thread(target=publisher)\n\nt1.start()\nt2.start()\n\nt1.join()\nt2.join()\n</code></pre>","tags":["python","zmq"]},{"location":"Programming/python/zmq/#ipc","title":"ipc","text":"<p>Same machine different process</p> <pre><code>import zmq\nimport time\nimport os\nimport multiprocessing as mp\n\nSOCKET_PATH = \"/tmp/events.ipc\"\n\ndef publisher():\n    # Clean stale socket\n    if os.path.exists(SOCKET_PATH):\n        os.unlink(SOCKET_PATH)\n\n    ctx = zmq.Context()  # type: ignore[attr-defined]\n    pub = ctx.socket(zmq.PUB)  # type: ignore[attr-defined]\n    pub.bind(f\"ipc://{SOCKET_PATH}\")\n\n    time.sleep(0.2)  # allow subscribers to connect\n    pub.send_multipart([b\"topic\", b\"hello\"])\n    time.sleep(0.1)\n\n    pub.close()\n    ctx.term()\n\ndef subscriber():\n    ctx = zmq.Context()  # type: ignore[attr-defined]\n    sub = ctx.socket(zmq.SUB)  # type: ignore[attr-defined]\n\n    sub.connect(f\"ipc://{SOCKET_PATH}\")\n    sub.setsockopt(zmq.SUBSCRIBE, b\"topic\")  # type: ignore[attr-defined]\n\n    print(sub.recv_multipart())\n\n    sub.close()\n    ctx.term()\n\nif __name__ == \"__main__\":\n    mp.set_start_method(\"spawn\", force=True)  # safe default\n\n    p_sub = mp.Process(target=subscriber)\n    p_pub = mp.Process(target=publisher)\n\n    p_sub.start()\n    time.sleep(0.1)   # ensure SUB starts first\n    p_pub.start()\n\n    p_pub.join()\n    p_sub.join()\n</code></pre>","tags":["python","zmq"]},{"location":"Programming/python/zmq/#tcp","title":"tcp","text":"<pre><code>import zmq\nimport time\nimport multiprocessing as mp\n\nENDPOINT = \"tcp://127.0.0.1:5555\"\n\ndef publisher():\n    ctx = zmq.Context()  # type: ignore[attr-defined]\n    pub = ctx.socket(zmq.PUB)  # type: ignore[attr-defined]\n    pub.bind(ENDPOINT)\n\n    time.sleep(0.2)  # allow subscribers to connect\n    pub.send_multipart([b\"topic\", b\"hello\"])\n    time.sleep(0.1)\n\n    pub.close()\n    ctx.term()\n\ndef subscriber():\n    ctx = zmq.Context()  # type: ignore[attr-defined]\n    sub = ctx.socket(zmq.SUB)  # type: ignore[attr-defined]\n\n    sub.connect(ENDPOINT)\n    sub.setsockopt(zmq.SUBSCRIBE, b\"topic\")  # type: ignore[attr-defined]\n\n    print(sub.recv_multipart())\n\n    sub.close()\n    ctx.term()\n\nif __name__ == \"__main__\":\n    mp.set_start_method(\"spawn\", force=True)\n\n    p_sub = mp.Process(target=subscriber)\n    p_pub = mp.Process(target=publisher)\n\n    p_sub.start()\n    time.sleep(0.1)  # SUB first (important)\n    p_pub.start()\n\n    p_pub.join()\n    p_sub.join()\n</code></pre> <ul> <li>zmq_req_rep</li> <li>zmq_req_rep using ipc</li> <li>pub sub with dataclass and msgpack</li> </ul>","tags":["python","zmq"]},{"location":"Programming/python/zmq/dealer/","title":"ZMQ dealer","text":"<pre><code>import zmq\nimport time\nimport msgpack\nimport multiprocessing as mp\n\nENDPOINT = \"ipc:///tmp/dealer.ipc\"\n\n\ndef server():\n    ctx = zmq.Context()\n    sock = ctx.socket(zmq.ROUTER)\n    sock.bind(ENDPOINT)\n\n    print(\"Server: waiting for message...\")\n\n    # ROUTER receives multipart: [identity][data]\n    identity, data = sock.recv_multipart()\n\n    msg = msgpack.unpackb(data, raw=False)\n    print(\"Server received:\", msg)\n\n    reply = {\n        \"status\": \"ok\",\n        \"received_id\": msg[\"id\"],\n    }\n\n    # MUST send identity back\n    sock.send_multipart([\n        identity,\n        msgpack.packb(reply),\n    ])\n\n    print(\"Server: reply sent\")\n\n    sock.close()\n    ctx.term()\n\ndef client():\n    ctx = zmq.Context()\n    sock = ctx.socket(zmq.DEALER)\n\n    # Optional but recommended: explicit identity\n    sock.setsockopt(zmq.IDENTITY, b\"client-1\")\n\n    sock.connect(ENDPOINT)\n\n    msg = {\n        \"id\": 1,\n        \"name\": \"camera\",\n        \"value\": 3.14,\n        \"active\": True,\n    }\n\n    sock.send(msgpack.packb(msg))\n    print(\"Client: message sent\")\n\n    reply = sock.recv()\n    reply_msg = msgpack.unpackb(reply, raw=False)\n    print(\"Client received:\", reply_msg)\n\n    sock.close()\n    ctx.term()\n\nif __name__ == \"__main__\":\n    mp.set_start_method(\"spawn\", force=True)\n\n    p_server = mp.Process(target=server)\n    p_client = mp.Process(target=client)\n\n    p_server.start()\n    time.sleep(0.1)   # server first\n    p_client.start()\n\n    p_client.join()\n    p_server.join()\n</code></pre>","tags":["zmq","dealer"]},{"location":"Programming/python/zmq/pair/","title":"ZMQ Pair","text":"<p>PAIR is the simplest ZeroMQ pattern \u2014 a raw bidirectional pipe.</p> <pre><code>import zmq\nimport time\nimport msgpack\nimport multiprocessing as mp\n\nENDPOINT = \"ipc:///tmp/pair.ipc\"\n\ndef publisher():\n    ctx = zmq.Context()\n    sock = ctx.socket(zmq.PAIR)\n    sock.bind(ENDPOINT)\n\n    print(\"Server: waiting for message...\")\n    data = sock.recv()\n\n    msg = msgpack.unpackb(data, raw=False)\n    print(\"Server received:\", msg)\n\n    reply = {\n        \"status\": \"ok\",\n        \"received_id\": msg[\"id\"],\n    }\n\n    sock.send(msgpack.packb(reply))\n    print(\"Server: reply sent\")\n\n    sock.close()\n    ctx.term()\n\ndef subscriber():\n    ctx = zmq.Context()\n    sock = ctx.socket(zmq.PAIR)\n    sock.connect(ENDPOINT)\n\n    msg = {\n        \"id\": 1,\n        \"name\": \"camera\",\n        \"value\": 3.14,\n        \"active\": True,\n    }\n\n    sock.send(msgpack.packb(msg))\n    print(\"Client: message sent\")\n\n    reply = sock.recv()\n    reply_msg = msgpack.unpackb(reply, raw=False)\n    print(\"Client received:\", reply_msg)\n\n    sock.close()\n    ctx.term()\n\nif __name__ == \"__main__\":\n    mp.set_start_method(\"spawn\", force=True)  # safe default\n\n    p_sub = mp.Process(target=subscriber)\n    p_pub = mp.Process(target=publisher)\n\n    p_sub.start()\n    time.sleep(0.1)   # ensure SUB starts first\n    p_pub.start()\n\n    p_pub.join()\n    p_sub.join()\n</code></pre>","tags":["zmq","pair"]},{"location":"Programming/python/zmq/pub_sub/","title":"ZMQ Pub Sub","text":"<p>PUB/SUB is a one-to-many broadcast pattern.</p> Property Meaning One-to-many One PUB \u2192 many SUBs Fire-and-forget No delivery guarantee Best effort Messages can be dropped Asynchronous PUB never blocks on SUB Scalable Add subscribers freely","tags":["zmq","python","pub / sub"]},{"location":"Programming/python/zmq/pub_sub/#topics","title":"Topics","text":"<p>ZMQ filtering happens on the subscriber side using a prefix match.</p> <pre><code>sub.setsockopt(zmq.SUBSCRIBE, b\"telemetry/\")\n</code></pre> <p>multiple topics</p> <p>subscriber can register to multiple topic just multiple the code line above</p> <p>Multiple topics</p> <p>-</p> <p>Poller</p>","tags":["zmq","python","pub / sub"]},{"location":"Programming/python/zmq/pub_sub/#demos","title":"Demos:","text":"","tags":["zmq","python","pub / sub"]},{"location":"Programming/python/zmq/pub_sub/#multiple-publisher-one-subscriber","title":"Multiple publisher one subscriber","text":"<p>Uses one SUB socket connected to multiple PUB endpoints.</p> Code <pre><code>#!/usr/bin/env python3\nimport time\nimport multiprocessing as mp\nimport zmq\n\n\ndef publisher_proc(pub_id: int, endpoint: str, interval_s: float = 0.2) -&gt; None:\n    ctx = zmq.Context.instance()\n    pub = ctx.socket(zmq.PUB)\n    pub.bind(endpoint)\n\n\n\n    seq = 0\n    topic = f\"pub{pub_id}\".encode()\n\n    while True:\n        payload = f\"hello from pub{pub_id} seq={seq} ts={time.time():.3f}\".encode()\n        pub.send_multipart([topic, payload])\n        seq += 1\n        time.sleep(interval_s)\n\n\ndef subscriber_blocking(endpoints: list[str], subscribe_prefix: bytes = b\"\") -&gt; None:\n    ctx = zmq.Context.instance()\n    sub = ctx.socket(zmq.SUB)\n\n    # Subscribe to everything (b\"\") or a prefix like b\"pub2\"\n    sub.setsockopt(zmq.SUBSCRIBE, subscribe_prefix)\n\n    for ep in endpoints:\n        sub.connect(ep)\n\n    print(f\"SUB connected to: {endpoints}\")\n    print(f\"SUB filter prefix: {subscribe_prefix!r}\")\n\n    while True:\n        topic, payload = sub.recv_multipart()  # blocking\n        print(f\"[{topic.decode()}] {payload.decode()}\")\n\n\ndef main() -&gt; None:\n\n    endpoints = [\n        \"tcp://127.0.0.1:5555\",\n        \"tcp://127.0.0.1:5556\",\n        \"tcp://127.0.0.1:5557\",\n    ]\n\n    procs: list[mp.Process] = []\n    try:\n        # Start publishers\n        for i, ep in enumerate(endpoints, start=1):\n            p = mp.Process(target=publisher_proc, args=(i, ep), daemon=True)\n            p.start()\n            procs.append(p)\n\n        time.sleep(1.0)  # wait for publishers to start\n        # Run the subscriber (blocking)\n        subscriber_blocking(endpoints, subscribe_prefix=b\"\")\n\n    except KeyboardInterrupt:\n        print(\"\\nStopping...\")\n    finally:\n        for p in procs:\n            if p.is_alive():\n                p.terminate()\n        for p in procs:\n            p.join(timeout=1.0)\n\n\nif __name__ == \"__main__\":\n    main()\n</code></pre>","tags":["zmq","python","pub / sub"]},{"location":"Programming/python/zmq/pub_sub/#multiple-publisher-one-subscriber-with-multiple-topics","title":"Multiple publisher one subscriber with multiple topics","text":"<p>Uses one SUB socket connected to multiple PUB endpoints and listen only to specific topics.</p> Code <pre><code>#!/usr/bin/env python3\n\"\"\"\nMultiple PUB processes (each publishes on multiple topics),\none SUB process (subscribes only to specific topic prefixes).\n\nRun:\n  python3 pubsub_multiprocess_topics.py\n\nStop with Ctrl+C.\n\"\"\"\nimport time\nimport multiprocessing as mp\nfrom typing import Iterable\n\nimport zmq\n\n\ndef publisher_proc(pub_name: str, bind_endpoint: str, topics: Iterable[str], interval_s: float = 0.25) -&gt; None:\n    \"\"\"\n    Publish multipart messages:\n      [topic][publisher_name][payload]\n    \"\"\"\n    ctx = zmq.Context.instance()\n    pub = ctx.socket(zmq.PUB)\n    pub.bind(bind_endpoint)\n\n    # Slow-joiner workaround: give SUB time to connect + subscribe\n    time.sleep(0.8)\n\n    topics_b = [t.encode(\"utf-8\") for t in topics]\n    seq = 0\n\n    while True:\n        now = time.time()\n        for topic in topics_b:\n            payload = f\"seq={seq} ts={now:.3f}\".encode(\"utf-8\")\n            pub.send_multipart([topic, pub_name.encode(\"utf-8\"), payload])\n        seq += 1\n        time.sleep(interval_s)\n\n\ndef subscriber_proc(connect_endpoints: list[str], subscribe_topics: Iterable[str]) -&gt; None:\n    \"\"\"\n    Subscribe only to the given topic prefixes.\n    \"\"\"\n    ctx = zmq.Context.instance()\n    sub = ctx.socket(zmq.SUB)\n\n    # Important: set subscriptions BEFORE connecting (helps avoid missing early messages)\n    for t in subscribe_topics:\n        sub.setsockopt(zmq.SUBSCRIBE, t.encode(\"utf-8\"))\n\n    for ep in connect_endpoints:\n        sub.connect(ep)\n\n    print(\"SUB connected to:\")\n    for ep in connect_endpoints:\n        print(\"  \", ep)\n    print(\"SUB subscriptions:\")\n    for t in subscribe_topics:\n        print(\"  \", t)\n\n    while True:\n        topic, pub_name, payload = sub.recv_multipart()\n        print(f\"[{topic.decode()}] from={pub_name.decode()} payload={payload.decode()}\")\n\n\ndef main() -&gt; None:\n    mp.set_start_method(\"spawn\", force=True)\n\n    # Two publishers, each with multiple topics\n    publishers = [\n        {\n            \"name\": \"pubA\",\n            \"bind\": \"tcp://127.0.0.1:5555\",\n            \"topics\": [\"telemetry/\", \"imu/\", \"debug/\"],\n        },\n        {\n            \"name\": \"pubB\",\n            \"bind\": \"tcp://127.0.0.1:5556\",\n            \"topics\": [\"telemetry/\", \"cam/\", \"status/\"],\n        },\n    ]\n\n    # Subscriber wants only these topic prefixes\n    subscribe_topics = [\"telemetry/\", \"cam/\"]  # prefix match\n\n    pub_procs: list[mp.Process] = []\n    sub_proc: mp.Process | None = None\n\n    try:\n        # Start publishers\n        for p in publishers:\n            proc = mp.Process(\n                target=publisher_proc,\n                args=(p[\"name\"], p[\"bind\"], p[\"topics\"]),\n                daemon=True,\n            )\n            proc.start()\n            pub_procs.append(proc)\n\n        # Start subscriber (as its own process too, so everything is multiprocess)\n        sub_proc = mp.Process(\n            target=subscriber_proc,\n            args=([p[\"bind\"] for p in publishers], subscribe_topics),\n            daemon=True,\n        )\n        sub_proc.start()\n\n        # Keep main alive\n        while True:\n            time.sleep(1)\n\n    except KeyboardInterrupt:\n        print(\"\\nStopping...\")\n\n    finally:\n        if sub_proc is not None and sub_proc.is_alive():\n            sub_proc.terminate()\n            sub_proc.join(timeout=1.0)\n\n        for proc in pub_procs:\n            if proc.is_alive():\n                proc.terminate()\n        for proc in pub_procs:\n            proc.join(timeout=1.0)\n\n\nif __name__ == \"__main__\":\n    main()\n</code></pre>","tags":["zmq","python","pub / sub"]},{"location":"Programming/python/zmq/pub_sub/poller/","title":"ZMQ Pub/Sub with poller","text":"<p>A Poller lets you wait on multiple ZMQ sockets at the same time and tells you which socket is ready (read/write/error).</p> <p>Poller is useful when you have: - Multiple ZMQ sockets - Different socket types - One thread / one loop</p> <pre><code>PUB A ---&gt; SUB A \\\n                     ---&gt; application\nPUB B ---&gt; SUB B /\n</code></pre> <pre><code>import zmq\n\nctx = zmq.Context.instance()\n\nsub_a = ctx.socket(zmq.SUB)\nsub_a.setsockopt(zmq.SUBSCRIBE, b\"telemetry/\")\nsub_a.connect(\"tcp://127.0.0.1:5555\")\n\nsub_b = ctx.socket(zmq.SUB)\nsub_b.setsockopt(zmq.SUBSCRIBE, b\"cam/\")\nsub_b.connect(\"tcp://127.0.0.1:5556\")\n\npoller = zmq.Poller()\npoller.register(sub_a, zmq.POLLIN)\npoller.register(sub_b, zmq.POLLIN)\n\nwhile True:\n    events = dict(poller.poll(timeout=1000))  # ms\n\n    if sub_a in events:\n        topic, payload = sub_a.recv_multipart()\n        print(\"telemetry:\", payload)\n\n    if sub_b in events:\n        topic, payload = sub_b.recv_multipart()\n        print(\"camera:\", payload)\n</code></pre>","tags":["zmq","python","poller"]},{"location":"Programming/python/zmq/pub_sub/poller/#demo","title":"Demo:","text":"Code <pre><code>#!/usr/bin/env python3\n\"\"\"\nMultiple PUB processes + one SUB process using zmq.Poller.\n\nMessages are multipart:\n  [topic][publisher_name][payload]\n\nSubscriber:\n- creates ONE SUB socket per publisher endpoint\n- subscribes to selected topic prefixes\n- uses Poller to read whichever socket becomes ready\n\nRun:\n  python3 poller_pubsub_multiprocess.py\nStop:\n  Ctrl+C\n\"\"\"\nimport time\nimport multiprocessing as mp\nfrom typing import Iterable\n\nimport zmq\n\n\ndef publisher_proc(pub_name: str, bind_endpoint: str, topics: Iterable[str], interval_s: float = 0.25) -&gt; None:\n    ctx = zmq.Context.instance()\n    pub = ctx.socket(zmq.PUB)\n    pub.bind(bind_endpoint)\n\n    # Slow-joiner workaround\n    time.sleep(0.8)\n\n    topics_b = [t.encode(\"utf-8\") for t in topics]\n    seq = 0\n\n    while True:\n        now = time.time()\n        for topic in topics_b:\n            payload = f\"seq={seq} ts={now:.3f}\".encode(\"utf-8\")\n            pub.send_multipart([topic, pub_name.encode(\"utf-8\"), payload])\n        seq += 1\n        time.sleep(interval_s)\n\n\ndef subscriber_poller_proc(connect_endpoints: list[str], subscribe_prefixes: Iterable[str]) -&gt; None:\n    ctx = zmq.Context.instance()\n    poller = zmq.Poller()\n\n    subs: list[zmq.Socket] = []\n\n    # One SUB socket per endpoint (so Poller has multiple sockets to watch)\n    for ep in connect_endpoints:\n        s = ctx.socket(zmq.SUB)\n\n        # Set subscriptions BEFORE connect\n        for prefix in subscribe_prefixes:\n            s.setsockopt(zmq.SUBSCRIBE, prefix.encode(\"utf-8\"))\n\n        s.connect(ep)\n        poller.register(s, zmq.POLLIN)\n        subs.append(s)\n\n    print(\"SUB sockets connected to:\")\n    for ep in connect_endpoints:\n        print(\"  \", ep)\n    print(\"Subscribed prefixes:\")\n    for p in subscribe_prefixes:\n        print(\"  \", p)\n\n    while True:\n        # Wait up to 1000ms for any socket to become readable\n        # events = dict(poller.poll())   # \u2190 blocking\n        events = dict(poller.poll(timeout=1000))\n\n        if not events:\n            # No messages this second (optional)\n            continue\n\n        # Handle all ready sockets (could be &gt;1)\n        for s in events.keys():\n            # Drain quickly in case multiple messages queued\n            while True:\n                try:\n                    topic, pub_name, payload = s.recv_multipart(flags=zmq.DONTWAIT)\n                except zmq.Again:\n                    break\n                print(f\"[{topic.decode()}] from={pub_name.decode()} payload={payload.decode()}\")\n\n\ndef main() -&gt; None:\n    mp.set_start_method(\"spawn\", force=True)\n\n    publishers = [\n        {\n            \"name\": \"pubA\",\n            \"bind\": \"tcp://127.0.0.1:5555\",\n            \"topics\": [\"telemetry/\", \"imu/\", \"debug/\"],\n        },\n        {\n            \"name\": \"pubB\",\n            \"bind\": \"tcp://127.0.0.1:5556\",\n            \"topics\": [\"telemetry/\", \"cam/\", \"status/\"],\n        },\n        {\n            \"name\": \"pubC\",\n            \"bind\": \"tcp://127.0.0.1:5557\",\n            \"topics\": [\"cam/\", \"debug/\", \"gps/\"],\n        },\n    ]\n\n    # Subscriber only wants these topic prefixes:\n    subscribe_prefixes = [\"telemetry/\", \"cam/\"]\n\n    pub_procs: list[mp.Process] = []\n    sub_proc: mp.Process | None = None\n\n    try:\n        # Start publishers\n        for p in publishers:\n            proc = mp.Process(\n                target=publisher_proc,\n                args=(p[\"name\"], p[\"bind\"], p[\"topics\"]),\n                daemon=True,\n            )\n            proc.start()\n            pub_procs.append(proc)\n\n        # Start subscriber (poller)\n        sub_proc = mp.Process(\n            target=subscriber_poller_proc,\n            args=([p[\"bind\"] for p in publishers], subscribe_prefixes),\n            daemon=True,\n        )\n        sub_proc.start()\n\n        # Keep main process alive\n        while True:\n            time.sleep(1)\n\n    except KeyboardInterrupt:\n        print(\"\\nStopping...\")\n\n    finally:\n        if sub_proc is not None and sub_proc.is_alive():\n            sub_proc.terminate()\n            sub_proc.join(timeout=1.0)\n\n        for proc in pub_procs:\n            if proc.is_alive():\n                proc.terminate()\n        for proc in pub_procs:\n            proc.join(timeout=1.0)\n\n\nif __name__ == \"__main__\":\n    main()\n</code></pre>","tags":["zmq","python","poller"]},{"location":"Programming/python/zmq/request_response/","title":"ZMQ Req / Rep pattern","text":"<p>REQ/REP is ZeroMQ\u2019s synchronous request\u2013reply pattern. like RPC</p> <ul> <li>REQ (client) \u2192 sends a request</li> <li>REP (server) \u2192 processes it and sends exactly one reply</li> </ul>","tags":["zmq","python","request","replay"]},{"location":"Programming/python/zmq/request_response/#demo-clientserver-reqrep-zmq-pattern-with-msgpack","title":"Demo: Client/Server Req/Rep zmq pattern with msgpack","text":"<p>Synchronous messaging pattern where one side (the Requester) sends a request, and the other side (the Replier) sends a response.</p> <ul> <li>socket zmq.REQ will block on send unless it has successfully received a reply back.</li> <li>socket zmq.REP will block on recv unless it has received a request.</li> </ul> <p>Tip</p> <p>If you want to set a timeout on the REQ socket, you can use the <code>zmq.POLLIN</code> flag with <code>zmq.Poller</code> to check if there is a message to receive. or use RCVTIMEO on the socket.</p>","tags":["zmq","python","request","replay"]},{"location":"Programming/python/zmq/request_response/#install","title":"install","text":"install dependencies<pre><code>pip install msgpack\npip install pyzmq\n</code></pre>","tags":["zmq","python","request","replay"]},{"location":"Programming/python/zmq/request_response/#demo-reqrep-zmq-pattern-with-msgpack","title":"Demo: Req/Rep zmq pattern with msgpack","text":"<p>ZMQ Req/Rep zmq pattern with python dataclasses and msgpack</p> code req/rep<pre><code>import multiprocessing\nimport logging\nfrom dataclasses import dataclass, asdict\nimport msgpack\nimport zmq\n\nFMT = \"%(asctime)s - %(lineno)s - %(levelname)s - %(message)s\"\nlogging.basicConfig(format=FMT, level=logging.INFO)\n\nlog = logging.getLogger(__name__)\n\nTOPIC = b\"topic\"\nSERVICE_PORT = 5555\n\n\n@dataclass\nclass Data_Request:\n    f_int: int\n    f_float: float\n    f_string: str\n\n\n@dataclass\nclass Data_Response:\n    success: bool\n\n\ndef server():\n    context = zmq.Context()\n    socket = context.socket(zmq.REP)\n    socket.bind(f\"tcp://*:{SERVICE_PORT}\")\n    topic, data = socket.recv_multipart()\n\n    msg = msgpack.unpackb(data)\n    log.info(f\"server get request: {msg}\")\n\n    response = Data_Response(success=True)\n    data = msgpack.packb(asdict(response))\n    socket.send(data)\n\n\ndef client():\n    context = zmq.Context()\n    socket = context.socket(zmq.REQ)\n    socket.connect(f\"tcp://127.0.0.1:{SERVICE_PORT}\")\n\n    # Create request msg\n    msg = Data_Request(1, 2.0, \"string\")\n    raw = asdict(msg)\n    data = msgpack.packb(raw)\n    socket.send_multipart([TOPIC, data])\n\n    # Recv response from server\n    data = socket.recv()\n    # unpack socket data\n    raw = msgpack.unpackb(data)\n    # Convert to msg\n    msg = Data_Response(**raw)\n    log.info(f\"server response: {msg.success}\")\n\n\nif __name__ == \"__main__\":\n    p_server = multiprocessing.Process(target=server)\n    p_client = multiprocessing.Process(target=client)\n    p_client.start()\n    p_server.start()\n\n    p_server.join()\n    p_client.join()\n</code></pre>","tags":["zmq","python","request","replay"]},{"location":"Programming/python/zmq/request_response/#demo2-using-socket-rcvtimeo","title":"Demo2 : Using socket RCVTIMEO","text":"code <pre><code>import zmq\nimport time\n\ncontext = zmq.Context()\nsocket = context.socket(zmq.REQ)\nsocket.connect(\"tcp://localhost:5555\")\n\n# Set both send and receive timeouts\nsocket.setsockopt(zmq.RCVTIMEO, 5000)  # 5-second receive timeout\nsocket.setsockopt(zmq.SNDTIMEO, 5000)  # 5-second send timeout\nsocket.setsockopt(zmq.LINGER, 0)       # Prevent blocking on close\n\ntry:\n    print(\"Sending request...\")\n    socket.send(b\"Hello\")  # Send request (this can block)\n\n    message = socket.recv()  # Wait for response (times out after 5 sec)\n    print(f\"Received reply: {message.decode()}\")\n\nexcept zmq.error.Again:\n    print(\"Timeout: No response received, exiting.\")\n\nfinally:\n    socket.close()  # Ensure socket is closed properly\n    context.term()  # Terminate the context to free resources\n\nprint(\"Program exited.\")\n</code></pre>","tags":["zmq","python","request","replay"]},{"location":"Programming/python/zmq/request_response/#demo3-using-zmqpoller","title":"Demo3 : Using zmq.Poller","text":"code <pre><code>import zmq\n\ncontext = zmq.Context()\ntimeout_ms = 5000  # 5-second timeout\nmax_retries = 3    # Number of retries\n\nfor attempt in range(1, max_retries + 1):\n    print(f\"Attempt {attempt}: Sending request...\")\n\n    # Create a new REQ socket for each attempt\n    socket = context.socket(zmq.REQ)\n    socket.connect(\"tcp://localhost:5555\")\n    socket.setsockopt(zmq.LINGER, 0)  # Prevent blocking on close\n\n    poller = zmq.Poller()\n    poller.register(socket, zmq.POLLIN)  # Monitor socket for a response\n\n    try:\n        socket.send(b\"Hello\")  # Send request\n\n        socks = dict(poller.poll(timeout_ms))  # Wait for response with timeout\n\n        if socket in socks:  # If response is received\n            message = socket.recv()\n            print(f\"Received reply: {message.decode()}\")\n            socket.close()\n            break  # Exit loop on success\n        else:\n            print(\"Timeout: No response received.\")\n\n    except zmq.ZMQError as e:\n        print(f\"ZeroMQ Error: {e}\")\n\n    finally:\n        socket.close()  # Ensure the socket is properly closed\n\n    if attempt == max_retries:\n        print(\"Max retries reached. Exiting.\")\n\ncontext.term()  # Clean up context\nprint(\"Program exited.\")\n</code></pre>","tags":["zmq","python","request","replay"]},{"location":"Programming/python/zmq/serialization/","title":"ZMQ serialization","text":"","tags":["zmq","msgpack","protobuf","memoryview","zero copy"]},{"location":"Programming/python/zmq/serialization/#common-serialization-options-used-with-zeromq","title":"Common serialization options used with ZeroMQ","text":"Serialization Speed Size Schema / Versioning Cross-language Zero-copy friendly Best for Downsides Raw bytes (no serialization) \u2b50\u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50\u2b50 None N/A \u2b50\u2b50\u2b50\u2b50\u2b50 Video frames, audio, tensors, opaque blobs You must define your own layout/metadata <code>struct</code> (binary packing) \u2b50\u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50\u2b50 Manual (you define layout) \u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50\u2b50 Fixed-format headers, tiny fast metadata Painful to evolve; endian/alignment concerns MessagePack \u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50 Manual (conventions) \u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50 Fast Python metadata, PUB/SUB payload headers No enforced schema; versioning is on you Protocol Buffers \u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50\u2b50 (excellent) \u2b50\u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50 Stable APIs, multi-language systems Compile step, less \u201cdynamic\u201d, not zero-copy FlatBuffers \u2b50\u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50 High-rate telemetry; fast reads without unpack More complex; schema rigidity; tooling learning curve Cap\u2019n Proto \u2b50\u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50\u2b50 Lowest latency; near zero-copy reads Ecosystem/tooling is heavier; less common in Python JSON \u2b50\u2b50 \u2b50\u2b50 Manual \u2b50\u2b50\u2b50\u2b50\u2b50 \u2b50 Control plane, debugging, configs Big + slow; numeric/typing ambiguity Pickle (Python only) \u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50 N/A \u2b50 \u2b50\u2b50 Quick prototypes within trusted Python-only setup Unsafe with untrusted data; not cross-language <p>Zero copy</p> <p>Flat buffers</p> <p>Raw (numpy and memory view)</p>","tags":["zmq","msgpack","protobuf","memoryview","zero copy"]},{"location":"Programming/python/zmq/serialization/#flatbuffer","title":"FlatBuffer","text":"<p>With FlatBuffers, the message stays in its binary form and fields are read directly from the buffer.</p> install<pre><code>pip install flatbuffers\n\n# install flatc compiler\nsudo apt install flatbuffers-compiler\n</code></pre>","tags":["zmq","msgpack","protobuf","memoryview","zero copy"]},{"location":"Programming/python/zmq/serialization/#demo-simple","title":"Demo: simple","text":"telemetry.fbs<pre><code>namespace Telemetry;\n\ntable Telemetry {\n  seq:uint32;\n  ts:double;\n  temp:float;\n  msg:string;\n}\n\nroot_type Telemetry;\n</code></pre> <pre><code>flatc --python telemetry.fbs\n</code></pre> usage<pre><code>import time\nimport flatbuffers\n\nfrom Telemetry import Telemetry\n\n\ndef build_telemetry(seq: int, ts: float, temp: float, msg: str) -&gt; bytes:\n    b = flatbuffers.Builder(128)\n\n    msg_off = b.CreateString(msg)\n\n    Telemetry.Start(b)\n    Telemetry.AddSeq(b, seq)\n    Telemetry.AddTs(b, ts)\n    Telemetry.AddTemp(b, temp)\n    Telemetry.AddMsg(b, msg_off)\n    obj = Telemetry.End(b)\n\n    b.Finish(obj)\n    return bytes(b.Output())\n\n\ndef read_telemetry(buf: bytes) -&gt; None:\n    t = Telemetry.Telemetry.GetRootAsTelemetry(buf, 0)\n    print(\"seq:\", t.Seq())\n    print(\"ts :\", t.Ts())\n    print(\"temp:\", t.Temp())\n    print(\"msg:\", t.Msg().decode(\"utf-8\"))\n\n\nif __name__ == \"__main__\":\n    data = build_telemetry(\n        seq=1,\n        ts=time.time(),\n        temp=36.5,\n        msg=\"h\",\n    )\n    print(len(data))\n    read_telemetry(data)\n</code></pre>","tags":["zmq","msgpack","protobuf","memoryview","zero copy"]},{"location":"Programming/python/zmq/serialization/#zero-copy","title":"Zero-copy","text":"send<pre><code>sock.send(flatbuf_bytes, copy=False)\n</code></pre> receiving<pre><code>frame = sock.recv(copy=False)\n</code></pre>","tags":["zmq","msgpack","protobuf","memoryview","zero copy"]},{"location":"Programming/python/zmq/serialization/#demo-zmq","title":"Demo: zmq","text":"code <pre><code>#!/usr/bin/env python3\nimport time\nimport multiprocessing as mp\nfrom typing import Iterable\n\nimport zmq\nimport flatbuffers\nfrom flatbuffers.table import Table\nfrom flatbuffers import packer, encode, number_types\nfrom Telemetry import Telemetry  # type: ignore\n# ============================================================\n# Minimal inline \"generated\" FlatBuffers code for:\n#\n# table Telemetry {\n#   seq:uint32;\n#   ts:double;\n#   temp:float;\n#   msg:string;\n# }\n# root_type Telemetry;\n# ============================================================\n\n\ndef build_telemetry_flatbuf(seq: int, ts: float, temp: float, msg: str) -&gt; bytes:\n    \"\"\"\n    Build a Telemetry FlatBuffer and return the underlying bytes.\n    \"\"\"\n    b = flatbuffers.Builder(128)\n\n    msg_off = b.CreateString(msg)\n\n    Telemetry.Start(b)\n    Telemetry.AddSeq(b, seq)\n    Telemetry.AddTs(b, ts)\n    Telemetry.AddTemp(b, temp)\n    Telemetry.AddMsg(b, msg_off)\n    obj = Telemetry.End(b)\n\n    b.Finish(obj)\n    return bytes(b.Output())\n\n\n# ============================================================\n# ZMQ PUB/SUB multiprocessing demo\n# ============================================================\n\ndef publisher_proc(pub_name: str, bind_endpoint: str, topics: Iterable[str], interval_s: float = 0.25) -&gt; None:\n    ctx = zmq.Context.instance()\n    pub = ctx.socket(zmq.PUB)\n    pub.bind(bind_endpoint)\n\n    # Slow-joiner workaround: give subscriber time to connect + set SUBSCRIBE\n    time.sleep(0.8)\n\n    seq = 0\n    topics_b = [t.encode(\"utf-8\") for t in topics]\n\n    while True:\n        now = time.time()\n        for topic in topics_b:\n            msg = build_telemetry_flatbuf(\n                seq=seq,\n                ts=now,\n                temp=20.0 + (seq % 10) * 0.5,\n                msg=f\"from {pub_name} on {topic.decode()}\",\n            )\n            # multipart: [topic][flatbuffer_bytes]\n            pub.send_multipart([topic, msg], copy=False)\n        seq += 1\n        time.sleep(interval_s)\n\n\ndef subscriber_proc(connect_endpoints: list[str], subscribe_prefixes: Iterable[str]) -&gt; None:\n    ctx = zmq.Context.instance()\n    sub = ctx.socket(zmq.SUB)\n\n    # Subscribe to selected topic prefixes (prefix match!)\n    for p in subscribe_prefixes:\n        sub.setsockopt(zmq.SUBSCRIBE, p.encode(\"utf-8\"))\n\n    for ep in connect_endpoints:\n        sub.connect(ep)\n\n    print(\"SUB connected to:\")\n    for ep in connect_endpoints:\n        print(\"  \", ep)\n\n    print(\"SUB subscriptions:\")\n    for p in subscribe_prefixes:\n        print(\"  \", p)\n\n    while True:\n        topic_b, fb_buf = sub.recv_multipart()\n        t = Telemetry.Telemetry.GetRootAsTelemetry(fb_buf, 0)\n\n        print(\n            f\"[{topic_b.decode()}] \"\n            f\"seq={t.Seq()} ts={t.Ts():.3f} temp={t.Temp():.2f} msg='{t.Msg()}'\"\n        )\n\n\ndef main() -&gt; None:\n    mp.set_start_method(\"spawn\", force=True)\n\n    publishers = [\n        {\n            \"name\": \"pubA\",\n            \"bind\": \"tcp://127.0.0.1:5555\",\n            \"topics\": [\"telemetry/\", \"imu/\", \"debug/\"],\n        },\n        {\n            \"name\": \"pubB\",\n            \"bind\": \"tcp://127.0.0.1:5556\",\n            \"topics\": [\"telemetry/\", \"cam/\", \"status/\"],\n        },\n    ]\n\n    # Subscriber only wants these prefixes:\n    subscribe_prefixes = [\"telemetry/\", \"cam/\"]\n\n    pub_procs: list[mp.Process] = []\n    sub_proc: mp.Process | None = None\n\n    try:\n        for p in publishers:\n            proc = mp.Process(\n                target=publisher_proc,\n                args=(p[\"name\"], p[\"bind\"], p[\"topics\"]),\n                daemon=True,\n            )\n            proc.start()\n            pub_procs.append(proc)\n\n        sub_proc = mp.Process(\n            target=subscriber_proc,\n            args=([p[\"bind\"] for p in publishers], subscribe_prefixes),\n            daemon=True,\n        )\n        sub_proc.start()\n\n        # Keep parent alive\n        while True:\n            time.sleep(1)\n\n    except KeyboardInterrupt:\n        print(\"\\nStopping...\")\n\n    finally:\n        if sub_proc is not None and sub_proc.is_alive():\n            sub_proc.terminate()\n            sub_proc.join(timeout=1.0)\n\n        for proc in pub_procs:\n            if proc.is_alive():\n                proc.terminate()\n        for proc in pub_procs:\n            proc.join(timeout=1.0)\n\n\nif __name__ == \"__main__\":\n    main()\n</code></pre>","tags":["zmq","msgpack","protobuf","memoryview","zero copy"]},{"location":"Programming/python/zmq/serialization/#raw","title":"RAW","text":"<p>Raw data = an opaque sequence of bytes.</p> Python object Valid raw ZMQ data? <code>bytes</code> \u2705 <code>bytearray</code> \u2705 <code>memoryview</code> \u2705 (best for zero-copy) <code>numpy.ndarray</code> buffer \u2705 (via <code>memoryview</code>) <code>zmq.Frame</code> \u2705 <pre><code># Sender\narr = np.ascontiguousarray(arr)\nsock.send_multipart(\n    [meta_bytes, memoryview(arr)],\n    copy=False\n)\n</code></pre>","tags":["zmq","msgpack","protobuf","memoryview","zero copy"]},{"location":"Programming/python/zmq/serialization/#1-2-3-4-5-6-7-receiver-meta-frame-sockrecv_multipartcopyfalse-arr-npfrombufferframe-dtypereshape-the-numpy-array-shares-memory-with-the-zmq-frame-that-memory-is-only-valid-until-the-next-recv-or-socket-close","title":"<pre><code># Receiver\nmeta, frame = sock.recv_multipart(copy=False)\narr = np.frombuffer(frame, dtype=...,).reshape(...)\n\n# The NumPy array shares memory with the ZMQ frame.\n\n# That memory is only valid until the next recv or socket close.\n</code></pre>","text":"","tags":["zmq","msgpack","protobuf","memoryview","zero copy"]},{"location":"Programming/python/zmq/serialization/#demo-send-image-with-metadata","title":"Demo: Send image with metadata","text":"Code <pre><code>#!/usr/bin/env python3\n\"\"\"\nMinimal ZMQ PUB/SUB image demo\nMetadata: frame_id only (struct-packed uint32)\nMessage layout:\n  [ topic ][ meta(frame_id) ][ payload(raw image bytes) ]\n\"\"\"\nimport time\nimport struct\nimport multiprocessing as mp\n\nimport numpy as np\nimport zmq\n\n\n# ----------------------------\n# Metadata (just frame_id)\n# ----------------------------\n# little-endian uint32\nMETA_FMT = \"&lt;I\"\nMETA_SIZE = struct.calcsize(META_FMT)\n\n\ndef pack_meta(frame_id: int) -&gt; bytes:\n    return struct.pack(META_FMT, frame_id)\n\n\ndef unpack_meta(b: bytes) -&gt; int:\n    if len(b) != META_SIZE:\n        raise ValueError(\"bad meta size\")\n    (frame_id,) = struct.unpack(META_FMT, b)\n    return frame_id\n\n\n# ----------------------------\n# Publisher\n# ----------------------------\ndef publisher_proc(bind_ep: str, topic: bytes = b\"cam/\", fps: float = 5.0) -&gt; None:\n    ctx = zmq.Context.instance()\n    pub = ctx.socket(zmq.PUB)\n    pub.bind(bind_ep)\n\n    # Slow joiner workaround\n    time.sleep(0.8)\n\n    frame_id = 0\n    period = 1.0 / fps\n\n    # Example image: 240x320 grayscale uint8\n    h, w = 240, 320\n\n    while True:\n        img = np.random.randint(0, 256, size=(h, w), dtype=np.uint8)\n        img = np.ascontiguousarray(img)\n\n        meta = pack_meta(frame_id)\n\n        # Multipart: [topic][meta][payload]\n        pub.send_multipart(\n            [topic, meta, memoryview(img)],\n            copy=False,\n        )\n\n        frame_id += 1\n        time.sleep(period)\n\n\n# ----------------------------\n# Subscriber\n# ----------------------------\ndef subscriber_proc(connect_ep: str, subscribe_prefix: bytes = b\"cam/\") -&gt; None:\n    ctx = zmq.Context.instance()\n    sub = ctx.socket(zmq.SUB)\n    sub.setsockopt(zmq.SUBSCRIBE, subscribe_prefix)\n    sub.connect(connect_ep)\n\n    print(\"SUB connected to:\", connect_ep)\n\n    while True:\n        topic_f, meta_f, payload_f = sub.recv_multipart(copy=False)\n\n        frame_id = unpack_meta(bytes(meta_f))\n\n        # Zero-copy view of payload\n        buf = memoryview(payload_f)\n\n        # Reconstruct image (we must know shape/dtype out-of-band here)\n        img = np.frombuffer(buf, dtype=np.uint8).reshape((240, 320))\n\n        print(f\"topic={bytes(topic_f).decode(\"utf-8\")} frame_id={frame_id} img.shape={img.shape}\")\n\n\n# ----------------------------\n# Main (multiprocessing)\n# ----------------------------\ndef main() -&gt; None:\n    mp.set_start_method(\"spawn\", force=True)\n\n    ep = \"tcp://127.0.0.1:5555\"\n\n    pub_p = mp.Process(target=publisher_proc, args=(ep,), daemon=True)\n    sub_p = mp.Process(target=subscriber_proc, args=(ep,), daemon=True)\n\n    pub_p.start()\n    sub_p.start()\n\n    try:\n        while True:\n            time.sleep(1)\n    except KeyboardInterrupt:\n        print(\"\\nStopping...\")\n    finally:\n        for p in (sub_p, pub_p):\n            if p.is_alive():\n                p.terminate()\n        for p in (sub_p, pub_p):\n            p.join(timeout=1.0)\n\n\nif __name__ == \"__main__\":\n    main()\n</code></pre>","tags":["zmq","msgpack","protobuf","memoryview","zero copy"]},{"location":"Programming/python/zmq/serialization/#memoryview","title":"MemoryView","text":"<p>memoryview is a zero-copy view onto an existing bytes-like buffer.</p> <ul> <li>It does not allocate a new bytes object.</li> <li>It lets you slice/read (and sometimes write) without copying.</li> <li>It works with anything that supports the buffer protocol: bytes, bytearray, array, NumPy arrays, and zmq.Frame.</li> </ul>","tags":["zmq","msgpack","protobuf","memoryview","zero copy"]},{"location":"Programming/python/zmq/serialization/#todo-code-example","title":"TODO: code example","text":"","tags":["zmq","msgpack","protobuf","memoryview","zero copy"]},{"location":"Programming/python/zmq/zmq_and_shm/","title":"ZMQ with shm","text":"<p>Using shm to publish large data and zmq as metadata signaling control</p> <pre><code>import zmq\nimport numpy as np\nimport time\nimport multiprocessing as mp\nfrom multiprocessing import shared_memory\nfrom dataclasses import dataclass, asdict\nfrom typing import Tuple, Dict, Any, cast\n\n# ================= CONFIG =================\nHEIGHT = 480\nWIDTH = 640\nCHANNELS = 3\nDTYPE = np.uint8\nSHAPE = (HEIGHT, WIDTH, CHANNELS)\n\nENDPOINT = \"ipc:///tmp/image_stream.ipc\"\nFPS = 5\nNUM_FRAMES = 10\n# =========================================\n\n\n# ================= METADATA =================\n@dataclass(frozen=True)\nclass ImageMeta:\n    shm_name: str\n    shape: Tuple[int, int, int]\n    dtype: str\n    frame_id: int\n    timestamp: float\n\n    @classmethod\n    def create(cls, shm_name, shape, dtype, frame_id):\n        return cls(\n            shm_name=shm_name,\n            shape=shape,\n            dtype=dtype,\n            frame_id=frame_id,\n            timestamp=time.time(),\n        )\n# ===========================================\n\n\ndef publisher():\n    \"\"\"Generate images \u2192 write to SHM \u2192 notify via ZMQ\"\"\"\n\n    size = np.prod(SHAPE) * np.dtype(DTYPE).itemsize\n\n    # Create SHM once\n    shm = shared_memory.SharedMemory(create=True, size=int(size))\n    img = np.ndarray(SHAPE, dtype=DTYPE, buffer=shm.buf)\n\n    ctx = zmq.Context()\n    pub = ctx.socket(zmq.PUB)\n    pub.bind(ENDPOINT)\n\n    time.sleep(0.3)  # allow subscriber to connect\n\n    for frame_id in range(NUM_FRAMES):\n        # Generate new image directly INTO SHM\n        img[:] = np.random.randint(0, 256, SHAPE, dtype=DTYPE)\n\n        meta = ImageMeta.create(\n            shm_name=shm.name,\n            shape=SHAPE,\n            dtype=\"uint8\",\n            frame_id=frame_id,\n        )\n\n        pub.send_json(asdict(meta))\n        print(f\"[PUB] frame {frame_id}\")\n\n        time.sleep(1.0 / FPS)\n\n    pub.close()\n    ctx.term()\n    shm.close()\n    shm.unlink()\n\n\ndef subscriber():\n    \"\"\"Wait for ZMQ signal \u2192 read image from SHM\"\"\"\n\n    ctx = zmq.Context()\n    sub = ctx.socket(zmq.SUB)\n    sub.connect(ENDPOINT)\n    sub.setsockopt(zmq.SUBSCRIBE, b\"\")\n\n    last_frame = -1\n\n    while True:\n        raw: Dict = cast(Dict[str, Any], sub.recv_json())\n        meta = ImageMeta(**raw)\n\n        shm = shared_memory.SharedMemory(name=meta.shm_name)\n        img = np.ndarray(\n            meta.shape,\n            dtype=np.dtype(meta.dtype),\n            buffer=shm.buf,\n        )\n\n        # Detect dropped frames (normal behavior)\n        if last_frame != -1 and meta.frame_id != last_frame + 1:\n            print(f\"[SUB] dropped {last_frame + 1}..{meta.frame_id - 1}\")\n\n        last_frame = meta.frame_id\n\n        print(\n            f\"[SUB] frame {meta.frame_id}, \"\n            f\"first pixel = {img[0, 0]}\"\n        )\n\n        shm.close()\n\n        if meta.frame_id &gt;= NUM_FRAMES - 1:\n            break\n\n    sub.close()\n    ctx.term()\n\n\nif __name__ == \"__main__\":\n    mp.set_start_method(\"spawn\", force=True)\n\n    p_sub = mp.Process(target=subscriber)\n    p_pub = mp.Process(target=publisher)\n\n    p_sub.start()\n    time.sleep(0.1)  # SUB first (important)\n    p_pub.start()\n\n    p_pub.join()\n    p_sub.join()\n</code></pre>","tags":["zmq","shm"]},{"location":"Programming/rust/","title":"Rust programming","text":"<p>Programming</p> <p>VSCode dev env.</p>","tags":["rust"]},{"location":"Programming/rust/#install-and-rustup","title":"Install and rustup","text":"<pre><code>curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh\n</code></pre> <ul> <li>rustup: toolchain manager</li> <li>rustc: compiler</li> <li>cargo: build &amp; package manager</li> </ul> load rust into shell<pre><code>source ~/.cargo/env\n</code></pre>","tags":["rust"]},{"location":"Programming/rust/#rust-toolchain","title":"rust toolchain","text":"<p>A toolchain is a complete Rust environment consisting: - rustc - cargo - Rust standard library - optional components (clippy, rustfmt)</p>","tags":["rust"]},{"location":"Programming/rust/#rustup","title":"rustup","text":"<p>rustup manages Rust versions, targets, and components on your system.</p> <p>autocomplete</p> <p>Add rustup autocomplete</p> <pre><code>source &lt;(rustup completions bash)\n# add to bashrc\necho 'source &lt;(rustup completions bash)' &gt;&gt; ~/.bashrc\n</code></pre>","tags":["rust"]},{"location":"Programming/rust/#update","title":"update","text":"<p>update and upgrade toolchain and components</p> <pre><code>rustup update\n# its like apt update + apt upgrade\n</code></pre>","tags":["rust"]},{"location":"Programming/rust/#components","title":"Components","text":"<p>A component is an optional tool that plugs into a Rust toolchain.</p> <ul> <li>rustfmt: Formatting</li> <li>clippy: Linting</li> </ul> <pre><code># add to active toolchain\nrustup component add rustfmt\n# for specific toolchain\nrustup component add rustfmt --toolchain nightly\n</code></pre>","tags":["rust"]},{"location":"Programming/rust/#hello-world","title":"Hello world","text":"<p>Simple <code>hello world</code> build and run - Add <code>aarch</code> target and build it for ARM</p> <pre><code>cargo new hello_world\n</code></pre> <pre><code>cargo run        # build + run\ncargo build      # build only\ncargo check      # fast compile check\ncargo fmt        # format code\ncargo clippy     # lint code\n</code></pre>","tags":["rust"]},{"location":"Programming/rust/#add-target","title":"Add target","text":"install rust target<pre><code>rustup target add aarch64-unknown-linux-gnu\n</code></pre> install cross compiler<pre><code>sudo apt update\nsudo apt install gcc-arm-linux-gnueabihf\n</code></pre> ./.cargo/config.toml<pre><code>[target.aarch64-unknown-linux-gnu]\nlinker = \"aarch64-linux-gnu-gcc\"\n</code></pre> build with aarch target<pre><code>cargo build --release --target aarch64-unknown-linux-gnu\n</code></pre>","tags":["rust"]},{"location":"Programming/rust/#reference","title":"Reference","text":"<ul> <li>Let's Get Rusty</li> </ul>","tags":["rust"]},{"location":"Programming/rust/dev_env/","title":"Index","text":"<p>Programming / rust</p>","tags":["vscode","rust"]},{"location":"Programming/rust/dev_env/#vscode-ext","title":"VSCode Ext.","text":"Extension Desc Install rust-analyzer Rust language support for Visual Studio Code <code>ext install rust-lang.rust-analyzer</code> codeLLDB A native debugger powered by LLDB. Debug C++, Rust and other compiled languages. <code>ext install vadimcn.vscode-lldb</code> Even Better TOML Fully-featured TOML support <code>ext install tamasfe.even-better-toml</code> optional Error Lens Improve highlighting of errors, warnings and other language diagnostics. <code>ext install usernamehw.errorlens</code> Dependi manage dependencies <code>ext install fill-labs.dependi</code>","tags":["vscode","rust"]},{"location":"Programming/rust/dev_env/#rust-tools","title":"Rust tools","text":"<ul> <li>rustfmt: format rust code</li> <li>Clippy: static analyzer / linter</li> <li>cargo fix: automatically applied fixed to turustt code base on compiler diagnostics, useful when upgrading rust versions</li> </ul>","tags":["vscode","rust"]},{"location":"Programming/rust/dev_env/#rustfmt","title":"rustfmt","text":"<pre><code>rustup component add rustfmt\n</code></pre> <pre><code>cargo fmt\n</code></pre>","tags":["vscode","rust"]},{"location":"Programming/rust/dev_env/#clippy","title":"Clippy","text":"<pre><code>rustup component add clippy\n</code></pre> <pre><code>cargo clippy\n</code></pre> vscode settings<pre><code>\"rust-analyzer.check.command\": \"clippy\"\n</code></pre>","tags":["vscode","rust"]},{"location":"Programming/rust/dev_env/#cargo-fix","title":"cargo fix","text":"<pre><code>#allow-dirty: Fix code even if the working directory is dirty or has staged changes\ncargo fix --allow-dirty\n</code></pre> <p>VSCode profile</p> <p>Using vscode to handle profile for each type of work Profiles in VS Code let you create separate environments with their own:</p> <pre><code>- Extensions\n- Settings\n- Themes\n- UI layout\n- Keybindings\n- Snippets\n</code></pre> <pre><code>Profiles: Switch Profile  \nProfiles: New Profile  \n</code></pre>","tags":["vscode","rust"]},{"location":"Programming/rust/dev_env/#references","title":"References","text":"<ul> <li>Ultimate VS Code setup for Rust development (2025) </li> </ul>","tags":["vscode","rust"]},{"location":"Programming/rust/stm32/","title":"Index","text":"<p>Programming / rust</p> <pre><code>rustup target list\n</code></pre> <p></p> <p><pre><code>rustup target add thumbv7em-none-eabihf\n</code></pre> - thumbv7em: ARM Cortex-M Thumb instruction set - none: Without OS - enbihf: Embedded Application Binary Interface with hardware floating point support</p> <pre><code>cargo build --target thumbv7em-none-eabihf\n</code></pre> <pre><code>mkdir .cargo\ntouch config.toml\n</code></pre> <pre><code>[build]\ntarget = \"thumbv7em-none-eabihf\"\n</code></pre>","tags":["rust","stm32"]},{"location":"Programming/rust/stm32/#reference","title":"Reference","text":"<ul> <li>Udemy</li> <li>Rust on an STM32 microcontroller</li> <li> Rust Embedded for STM32 Microcontrollers: Intro </li> <li>The Embedded Rust Book</li> <li>A Foray Into Embedded Rust </li> </ul>","tags":["rust","stm32"]},{"location":"Programming/vision/","title":"Computer Vision","text":"<p>Visual Trackers</p> <p>OpenCV</p> <p>nvidia</p> <p>Optical Flow</p>","tags":["vision"]},{"location":"Programming/vision/#article-and-post-to-read","title":"Article and post to read","text":"<ul> <li>Optical Flow (Shi-Tomasi Corner Detection,Sparse(Lucas-kanade, Horn schunck) &amp; Dense(Gunnar Farneback) )-Part I</li> </ul>","tags":["vision"]},{"location":"Programming/vision/#event-base-camera","title":"Event base camera","text":"<ul> <li>Event Cameras - Everything you need to know</li> </ul>","tags":["vision"]},{"location":"Programming/vision/nvidia/","title":"Nvidia cv library","text":"<p>TensorRT</p> <p>VPI</p> <p>Profile</p>","tags":["nvidia"]},{"location":"Programming/vision/nvidia/profile/","title":"Nvidia nsight system","text":"<p>Programming / vision / nvidia</p> <p>Download NVIDIA Nsight Systems</p> <p>Nvidia profiling tools</p>","tags":["nvidia","profile","nsight","nsys"]},{"location":"Programming/vision/nvidia/profile/#nsys","title":"nsys","text":"<pre><code>sudo apt install nvidia-nsight-systems\n</code></pre>","tags":["nvidia","profile","nsight","nsys"]},{"location":"Programming/vision/nvidia/profile/#todo-check","title":"TODO: check","text":"<pre><code>nsys profile -o output python3 your_vpi_script.py\n</code></pre> <pre><code>#!/usr/bin/env python3\nimport vpi\nimport numpy as np\nimport time\n\n# Maximum performance on Jetson\nimport subprocess\nsubprocess.run(\"sudo jetson_clocks\", shell=True)\n\nimg = np.random.randint(0, 255, (1080, 1920, 3), dtype=np.uint8)\n\nstart = time.time()\nwith vpi.Backend.CUDA:\n    frame = vpi.asimage(img, vpi.Format.BGR8).convert(vpi.Format.U8)\n    corners, scores = frame.harriscorners()\n\n# This causes GPU\u2192CPU transfer (shows in profiler)\ncorners_cpu = corners.cpu()\nprint(f\"Time: {(time.time()-start)*1000:.2f}ms\")\n</code></pre> <pre><code>nsys profile -t cuda --stats=true python3 test.py\n</code></pre> <ul> <li>[CUDA memcpy HtoD] = CPU\u2192GPU transfers (minimize these)</li> <li>[CUDA memcpy DtoH] = GPU\u2192CPU transfers (minimize these)</li> <li>[CUDA kernel] = VPI operations on GPU</li> </ul>","tags":["nvidia","profile","nsight","nsys"]},{"location":"Programming/vision/nvidia/tensorrt/","title":"Index","text":"<p>Programming / vision / nvidia</p>","tags":["nvidia","tensorrt"]},{"location":"Programming/vision/nvidia/tensorrt/#tensorrt","title":"TensorRT","text":"<p>TensorRT is NVIDIA\u2019s high-performance deep learning inference engine. TensorRT takes a trained model (from PyTorch, TensorFlow, ONNX, etc.) and optimizes it to run faster on NVIDIA GPUs \u2014 especially for inference</p> <ul> <li>docker install: Docker image</li> </ul>","tags":["nvidia","tensorrt"]},{"location":"Programming/vision/nvidia/tensorrt/docker_install/","title":"TensorRT","text":"","tags":["embedded","nvidia","jetson","orin","tensorrt"]},{"location":"Programming/vision/nvidia/tensorrt/docker_install/#install","title":"Install","text":"<p>Tip</p> <p>To download tensorrt we must login to nvidia</p> <ul> <li>download local repo package</li> <li>install the package</li> <li>register the gpg key</li> <li>run <code>apt update</code></li> <li> <p>install <code>apt tensorrt</code></p> </li> <li> <p>Download from nvidia</p> </li> </ul> <p></p> Install TensorRT<pre><code>dpkg -i nv-tensorrt-local-repo-ubuntu2204-10.3.0-cuda-12.5_1.0-1_arm64.deb \ncp /var/nv-tensorrt-local-repo-ubuntu2204-10.3.0-cuda-12.5/nv-tensorrt-local-F9A70CFC-keyring.gpg /usr/share/keyrings/\napt update\napt install tensorrt\n# check\ndpkg -l | grep tensorrt\n</code></pre> <pre><code>import tensorrt as trt\n\nlogger = trt.Logger(trt.Logger.WARNING)\nruntime = trt.Runtime(logger)\n\nwith open(\"model.engine\", \"rb\") as f:\n    engine = runtime.deserialize_cuda_engine(f.read())\n</code></pre> <p></p>","tags":["embedded","nvidia","jetson","orin","tensorrt"]},{"location":"Programming/vision/nvidia/tensorrt/docker_install/#reference","title":"Reference","text":"<p>TensorRT In Docker</p>","tags":["embedded","nvidia","jetson","orin","tensorrt"]},{"location":"Programming/vision/nvidia/vpi/","title":"NVidia VPI","text":"<p>Programming / vision / nvidia</p> <p>NVIDIA\u00ae Vision Programming Interface (VPI) is a software library that implements computer vision (CV) and image processing (IP) algorithms on several computing hardware platforms available in NVIDIA embedded and discrete devices. VPI provides seamless access to computer hardware.  Within VPI, the same algorithm is implemented in different backends, such as CPU, GPU, PVA1, VIC2 and OFA READ More</p> <p>nvidia</p> <ul> <li>PVA: Programmable Vision Accelerator more</li> <li>VIC: Video Image Compositor </li> <li>OFA: Optical Flow Accelerator  </li> </ul>","tags":["vpi","nvidia"]},{"location":"Programming/vision/nvidia/vpi/#install","title":"Install","text":"<p>nvidia documents</p> <p>vpi installation location</p> <pre><code>/opt/nvidia/vpi3\n</code></pre>","tags":["vpi","nvidia"]},{"location":"Programming/vision/nvidia/vpi/#basic-concepts","title":"Basic Concepts","text":"<ul> <li>Stream</li> <li>backends</li> <li>Algorithms</li> <li>Data Buffers</li> </ul>","tags":["vpi","nvidia"]},{"location":"Programming/vision/nvidia/vpi/#backend","title":"Backend","text":"<p>A backend comprises the compute hardware that ultimately runs an algorithm</p> Backend Device/platform CPU All devices on x86 (linux) and Jetson aarch64 platforms CUDA All devices on x86 (linux) with a Maxwell or superior NVIDIA GPU, and Jetson aarch64 platforms PVA All Jetson AGX Orin and Jetson Orin NX devices VIC All Jetson devices. OFA All Jetson Orin devices.","tags":["vpi","nvidia"]},{"location":"Programming/vision/nvidia/vpi/#hello-vpi","title":"Hello VPI","text":"<p>Very simple application convert image to gray using PIL and VPI</p> <pre><code>import sys\nimport vpi\n\nimport numpy as np\nfrom PIL import Image\n\n\ntry:\n    input = vpi.asimage(np.asarray(Image.open(\"/home/user/projects/nvidia_tutorial/assets/kodim08.png\")))\nexcept IOError:\n    sys.exit(\"Input file not found\")\nexcept:\n    sys.exit(\"Error with input file\")\n\n# 4. Convert it to grayscale .\n# -----------------------------------------------------------------------------\n\n# Enabling the CUDA backend in a python context like done below makes\n# VPI algorithms use CUDA for execution by default. This can be overriden\n# if needed by specifying the parameter `backend=` when calling the algorithm.\nwith vpi.Backend.CUDA:\n    # `image.convert` will return a new VPI image with the desired format, in\n    # this case U8 (grayscale, 8-bit unsigned pixels).\n    # Algorithms returning a new VPI image allows for chaining operations like\n    # done below, as the result of the conversion is then filtered.\n    # The end result is finally stored in a new `output` VPI image.\n    output = input.convert(vpi.Format.U8)\n\n# -----------------------------------------------------------------------------\n\n# The read-lock context enabled below makes sure all processing is finished and\n# results are stored in `output`.\nwith output.rlock_cpu() as outData:\n    # `outData` is a numpy array view (not a copy) of `output`\n    # contents, accessible by host (cpu). \n    # The numpy array is then converted into a Pillo image and saved / show\n    # to the disk\n    Image.fromarray(outData).show()\n</code></pre>","tags":["vpi","nvidia"]},{"location":"Programming/vision/nvidia/vpi/#check-if-backend-available","title":"Check if backend available","text":"<pre><code>import vpi\n\nprint(\"CUDA available? \", bool(vpi.Backend.CUDA &amp; vpi.Backend.AVAILABLE))\nprint(\"PVA available? \", bool(vpi.Backend.PVA &amp; vpi.Backend.AVAILABLE))\nprint(\"VIC available? \", bool(vpi.Backend.VIC &amp; vpi.Backend.AVAILABLE))\nprint(\"OFA available? \", bool(vpi.Backend.OFA &amp; vpi.Backend.AVAILABLE))\n</code></pre>","tags":["vpi","nvidia"]},{"location":"Programming/vision/nvidia/vpi/#convert-vpi-image-to-numpy-view","title":"Convert vpi image to numpy view","text":"vpi to numpy view<pre><code>import matplotlib.pyplot as plt\nimport vpi\n\n# img_vpi is a vpi.Image (any backend). Ensure it's 8-bit gray.\nimg_u8 = img_vpi.convert(vpi.Format.U8)        # or skip if already U8\n\nwith img_u8.rlock_cpu() as np_img:             # NumPy view (no copy)\n    plt.imshow(np_img, cmap='gray', vmin=0, vmax=255)\n    plt.axis('off')\n    plt.show()\n</code></pre>","tags":["vpi","nvidia"]},{"location":"Programming/vision/nvidia/vpi/#lk","title":"LK","text":"<pre><code> class vpi.OpticalFlowPyrLK(frame: vpi.Image, \n    keypoints: vpi.Array, \n    levels: int, *, \n    kptstatus: vpi.Array = None, \n    scale: float = 0.5, \n    backend: vpi.Backend = vpi.Backend.DEFAULT) \u2192 vpi.OpticalFlowPyrLK\n</code></pre>","tags":["vpi","nvidia"]},{"location":"Programming/vision/nvidia/vpi/#reference","title":"Reference","text":"<ul> <li>Introduction to NVIDIA VPI</li> <li>Implementing computer vision and image processing using VPI</li> <li>Python API</li> </ul>","tags":["vpi","nvidia"]},{"location":"Programming/vision/opencv/","title":"Index","text":"<p>Build</p> <p>CUDA</p> <p>Optical Flow</p>","tags":["opencv"]},{"location":"Programming/vision/opencv/#cpp","title":"CPP","text":"install using apt<pre><code># install headers, shared library and cmake config files\nsudo apt install libopencv-dev\n</code></pre>","tags":["opencv"]},{"location":"Programming/vision/opencv/#demo","title":"Demo","text":"","tags":["opencv"]},{"location":"Programming/vision/opencv/opencv_build_from_source/","title":"Build opencv from source with cuda support","text":"","tags":["opencv","build","cuda"]},{"location":"Programming/vision/opencv/opencv_build_from_source/#tip-find-cuda-capability","title":"Tip: find CUDA Capability","text":"<p>using <code>deviceQuery</code> sample application</p> <pre><code>git clone --depth 1 --filter=blob:none --sparse https://github.com/NVIDIA/cuda-samples.git\ncd cuda-samples\ngit sparse-checkout set Samples/1_Utilities/deviceQuery Common\n</code></pre> <pre><code>cd cuda-samples/Samples/1_Utilities/deviceQuery/\nmkdir build\ncmake ..\nmake\n</code></pre> <pre><code>./deviceQuery\n#\n CUDA Device Query (Runtime API) version (CUDART static linking)\n\nDetected 1 CUDA Capable device(s)\n\nDevice 0: \"NVIDIA GeForce MX450\"\n  CUDA Driver Version / Runtime Version          12.6 / 11.5\n  CUDA Capability Major/Minor version number:    7.5\n  ...\n</code></pre>","tags":["opencv","build","cuda"]},{"location":"Programming/vision/opencv/build/","title":"Build opencv from source with cuda support","text":"<p>Using docker to build opencv from source with cuda support for python and cpp. pack the result as debs file to install on other machines.</p> <p>Check machine CUDA version</p> <pre><code>nvidia-smi\n</code></pre> <p>The docker base on the host CUDA version,  I use pre-built docker image from NVIDIA, <code>FROM nvidia/cuda:${CUDA}-cudnn-devel-ubuntu${UBUNTU}</code>,</p> <pre><code>ARG CUDA=\"12.6.0\"\nARG UBUNTU=\"22.04\"\n\n# docker pull nvidia/cuda:12.6.0-cudnn-devel-ubuntu22.04\nFROM nvidia/cuda:${CUDA}-cudnn-devel-ubuntu${UBUNTU}\n\nRUN apt update &amp;&amp; apt install -y --no-install-recommends \\\n    build-essential \\\n    cmake \\\n    cmake-data \\\n    gcc \\\n    g++ \\\n    ninja-build \\\n    gdb \\\n    git \\\n    wget \\\n    curl \\\n    unzip \\\n    yasm \\\n    doxygen \\\n    pkg-config \\\n    checkinstall \\\n    build-essential cmake git libgtk2.0-dev pkg-config libavcodec-dev libavformat-dev \\\n    python3-dev python3-numpy \\\n    libtbb2 libtbb-dev libjpeg-dev libpng-dev libtiff-dev \\\n    libswscale-dev libgtk-3-dev libv4l-dev v4l-utils\\\n    libopenblas-dev libopenblas-base libatlas-base-dev liblapacke-dev \\\n    protobuf-compiler python3-dev python3-venv python3-numpy python3-wheel python3-setuptools \\\n&amp;&amp; rm -rf /var/lib/apt/lists/*\n</code></pre>","tags":["opencv","build","cuda"]},{"location":"Programming/vision/opencv/build/#github","title":"Github","text":"<p>my github with all the files</p>","tags":["opencv","build","cuda"]},{"location":"Programming/vision/opencv/build/#build-process","title":"Build process","text":"<ul> <li>Download and extract opencv and opencv_contrib</li> </ul> <pre><code>version=\"4.10.0\"\nfolder=\"opencv\"\nmkdir $folder\ncd ${folder}\ncurl -L https://github.com/opencv/opencv/archive/${version}.zip -o opencv-${version}.zip\ncurl -L https://github.com/opencv/opencv_contrib/archive/${version}.zip -o opencv_contrib-${version}.zip\nunzip opencv-${version}.zip\nunzip opencv_contrib-${version}.zip\nrm opencv-${version}.zip opencv_contrib-${version}.zip\n</code></pre> <ul> <li>Create build folder</li> <li>Run cmake</li> <li>Build</li> </ul> <pre><code>mkdir opencv-${version}/build\ncd opencv-${version}/build\n\ncmake \\\n-D WITH_CUDA=ON \\\n-D WITH_CUDNN=ON \\\n-D OPENCV_DNN_CUDA=ON \\\n-D CUDA_TOOLKIT_ROOT_DIR=/usr/local/cuda-12.6 \\\n-D CUDA_ARCH_BIN=\"5.2 5.3 6.0 6.1 6.2 7.0 7.2 7.5 8.0 8.6\" \\\n-D CUDA_ARCH_PTX=\"8.6rm -rf\" \\\n-D ENABLE_FAST_MATH=1 \\\n-D CUDA_FAST_MATH=1 \\\n-D OPENCV_GENERATE_PKGCONFIG=ON \\\n-D OPENCV_EXTRA_MODULES_PATH=../../opencv_contrib-4.10.0/modules \\\n-D WITH_GSTREAMER=OFF \\\n-D WITH_LIBV4L=ON \\\n-D BUILD_opencv_python3=ON \\\n-D BUILD_TESTS=OFF \\\n-D BUILD_PERF_TESTS=OFF \\\n-D BUILD_EXAMPLES=OFF \\\n-D CMAKE_BUILD_TYPE=RELEASE \\\n-D CMAKE_INSTALL_PREFIX=/usr/local \\\n-D WITH_QT=ON \\\n-D WITH_GTK=ON \\\n-D WITH_VTK=OFF \\\n-D WITH_FFMPEG=OFF \\\n-D WITH_1394=OFF \\\n-D CPACK_BINARY_DEB=ON \\\n-D BUILD_JAVA=OFF \\\n-D PYTHON3_PACKAGES_PATH=/usr/lib/python3/dist-packages \\\n-D CPACK_PACKAGE_VERSION=4.10.0 \\\n-D CPACK_DEBIAN_PACKAGE_VERSION=4.10.0-1 \\\n..\n\n# Build\nmake -j8\n</code></pre>","tags":["opencv","build","cuda"]},{"location":"Programming/vision/opencv/build/#pack-to-debs","title":"pack to debs","text":"pack<pre><code>make package ..\n</code></pre> <p>Downloads</p> <ul> <li>Dockerfile</li> <li>.devcontainer.json</li> <li>build.sh</li> </ul>","tags":["opencv","build","cuda"]},{"location":"Programming/vision/opencv/build/#install-and-check","title":"Install and check","text":"install<pre><code>dpkg -i *.deb\n</code></pre>","tags":["opencv","build","cuda"]},{"location":"Programming/vision/opencv/build/#check","title":"check","text":"check cuda support<pre><code>&gt;&gt;&gt; import cv2\n&gt;&gt;&gt; cv2.__version__\n'4.10.0'\n&gt;&gt;&gt; cv2.cuda.getCudaEnabledDeviceCount()\n1\n</code></pre> simple.py<pre><code>import cv2\n\n# Load an image from file\nimage = cv2.imread(\"/workspaces/opencv_builder/src/lena.png\")\n\n# Check if the image was loaded successfully\nif image is None:\n    print(\"Failed to load image\")\nelse:\n    # Display the image in a window\n    cv2.imshow(\"My Image\", image)\n\n    # Wait for any key press\n    cv2.waitKey(0)\n\n    # Close all OpenCV windows\n    cv2.destroyAllWindows()\n</code></pre> <p>Download lena img</p> simple.cpp<pre><code>// g++ simple.cpp -o simple `pkg-config --cflags --libs opencv4` -I/usr/include/opencv4/\n\n#include &lt;opencv2/opencv.hpp&gt;\n#include &lt;iostream&gt;\n\nint main()\n{\n    // Load the image\n    cv::Mat image = cv::imread(\"/workspaces/opencv_builder/src/lena.png\");\n\n    // Check if image loaded successfully\n    if (image.empty()) {\n        std::cerr &lt;&lt; \"Failed to load image\" &lt;&lt; std::endl;\n        return 1;\n    }\n\n    // Show the image in a window\n    cv::imshow(\"My Image\", image);\n\n    // Wait for a key press\n    cv::waitKey(0);\n\n    // Close all windows\n    cv::destroyAllWindows();\n\n    return 0;\n}\n</code></pre> build<pre><code>g++ simple.cpp -o simple `pkg-config --cflags --libs opencv4` -I/usr/include/opencv4/\n</code></pre> <p>include search path</p> <ul> <li><code>/usr/include/opencv4/</code> is the default include path for opencv4, if you use other version, please check the path.</li> <li><code>pkg-config --cflags --libs opencv4</code> will return the include path and lib path for opencv4, you can use it in your build command.</li> <li>using <code>pkg-config</code> the include path point <code>-I/usr/local/include/opencv4</code></li> <li>After the installation from debs the include path is <code>/usr/include/opencv4/</code></li> </ul>","tags":["opencv","build","cuda"]},{"location":"Programming/vision/opencv/cuda/","title":"OpenCV CUDA","text":"<p>Programming / vision / opencv</p>","tags":["opencv","cuda"]},{"location":"Programming/vision/opencv/cuda/#check","title":"Check","text":"<p>Check if openCV compiled with cuda support</p> <pre><code>print(\"CUDA support:\", cv2.cuda.getCudaEnabledDeviceCount() &gt; 0)\n</code></pre>","tags":["opencv","cuda"]},{"location":"Programming/vision/opencv/cuda/#simple","title":"Simple","text":"<p>Simple python script that generate image upload to cuda , run alogithim from cv2 suda namespace and download back to cpu usage</p> cuda upload, run , download<pre><code>import cv2\nimport numpy as np\n\ndef test_cuda_functionality():\n    try:\n        # Create a test image\n        img = np.random.randint(0, 255, (100, 100, 3), dtype=np.uint8)\n\n        # Try to upload to GPU\n        gpu_img = cv2.cuda_GpuMat()\n        gpu_img.upload(img)\n\n        # Try a simple operation\n        gpu_gray = cv2.cuda.cvtColor(gpu_img, cv2.COLOR_BGR2GRAY)\n\n        # Download result\n        result = gpu_gray.download()\n\n        print(\"CUDA functionality test: PASSED\")\n        return True\n\n    except Exception as e:\n        print(f\"CUDA functionality test: FAILED - {e}\")\n        return False\n\ntest_cuda_functionality()\n</code></pre>","tags":["opencv","cuda"]},{"location":"Programming/vision/opencv/cuda/#optimize-upload-download-memory-transfer-cpugpu","title":"Optimize Upload / Download memory transfer cpu/gpu","text":"","tags":["opencv","cuda"]},{"location":"Programming/vision/opencv/cuda/#cv2cudahostmem","title":"cv2.cuda.HostMem","text":"<p>using cv2.cuda.HostMem lets you allocate page-locked (pinned) memory in host RAM, which speeds up transfers between CPU \u2194 GPU - Normally, NumPy arrays are allocated in pageable memory \u2192 GPU transfers require an extra copy step. - With HostMem, memory is allocated as page-locked (pinned) memory, which can be directly DMA-transferred to the GPU \u2192 faster upload/download.</p> <ul> <li>PAGE_LOCKED (1)\u2192 pinned memory (fastest transfers)</li> <li>SHARED (2)\u2192 memory accessible by both CPU and GPU</li> <li>WRITE_COMBINED (4) \u2192 faster host-to-device writes, slower reads</li> </ul> <p>python opencv const not expose use integers instead </p> <pre><code>import cv2\nimport numpy as np\n\n# Check if CUDA is available\nif not cv2.cuda.getCudaEnabledDeviceCount():\n    print(\"CUDA is not enabled or no CUDA devices found.\")\n    exit()\n\n# Define image dimensions and type\nrows, cols = 480, 640\nimage_type = cv2.CV_8UC1 # 8-bit, single channel (grayscale)\n\n# 1. Allocate page-locked host memory\n# You can specify the allocation type (PAGE_LOCKED or SHARED)\nPAGE_LOCKED = 1\nhost_mem = cv2.cuda.HostMem(rows, cols, image_type, PAGE_LOCKED)\nhost_mem_download = cv2.cuda.HostMem(rows, cols, image_type, PAGE_LOCKED)\n\n# 2. Access the allocated memory as a NumPy array (Mat header)\n# This creates a NumPy array that shares the underlying memory with HostMem\nhost_mat = host_mem.createMatHeader()\nhost_mat_download = host_mem_download.createMatHeader()\n\n# 3. Fill the host_mat with some data (e.g., a simple pattern)\nfor r in range(rows):\n    for c in range(cols):\n        host_mat[r, c] = (r + c) % 255\n\n# 4. Upload the data from HostMem to a GpuMat\ngpu_mat = cv2.cuda_GpuMat()\ngpu_mat.upload(host_mat)\n\n# 5. Perform a CUDA operation (e.g., Gaussian blur)\ngaussian_filter = cv2.cuda.createGaussianFilter(image_type, image_type, (5, 5), 0)\ngpu_blurred_mat = gaussian_filter.apply(gpu_mat)\n\n# 6. Download the result back to host memory (can be a regular NumPy array)\n# 6. Download from GPU\ngpu_blurred_mat.download(host_mat_download)\n\n\n# 7. Display the original and processed images (optional)\ncv2.imshow(\"Original (from HostMem)\", host_mat)\ncv2.imshow(\"Blurred (on CPU after GPU processing)\", host_mat_download)\ncv2.waitKey(0)\ncv2.destroyAllWindows()\n</code></pre> <p>createMatHeader</p> <p>A HostMem buffer by itself isn\u2019t directly usable as a NumPy array. thy are buffer in host RAM call .createMatHeader(), which returns a cv::Mat header that views into the same memory. (wrap the buffer) and return the buffer as ndarray</p>","tags":["opencv","cuda"]},{"location":"Programming/vision/opencv/cuda/#reference","title":"Reference","text":"<ul> <li>https://www.simonwenkel.com/notes/software_libraries/opencv/opencv-cuda-integration.html#opencv-cuda-intro</li> </ul>","tags":["opencv","cuda"]},{"location":"Programming/vision/opencv/cuda/#build-dev-environment-using-vscode-devcontainer","title":"Build dev environment using vscode devcontainer","text":"<ul> <li>Using the post from Build OpenCV 4.10 with cuda</li> <li>We Got <code>OpenCV-unknown-aarch64-*</code> from ARM (Jetson) and <code>OpenCV-unknown-x86_64-*</code></li> </ul> <pre><code>FROM nvidia/cuda:12.6.0-cudnn-runtime-ubuntu22.04\n\nCOPY opencv_debs/* /tmp/opencv_debs/\nRUN cd /tmp/opencv_debs &amp;&amp; \\\n    apt update &amp;&amp; \\\n    ARCH=$(uname -m) &amp;&amp; \\\n    if [ \"$ARCH\" = \"aarch64\" ]; then \\\n        apt install -y ./OpenCV-unknown-aarch64-*.deb; \\\n    elif [ \"$ARCH\" = \"x86_64\" ]; then \\\n        apt install -y ./OpenCV-unknown-x86_64-*.deb; \\\n    else \\\n        echo \"Unsupported architecture: $ARCH\"; exit 1; \\\n    fi &amp;&amp; \\\n    rm -rf /tmp/opencv_debs\n</code></pre>","tags":["opencv","cuda"]},{"location":"Programming/vision/opencv/cuda/#reference_1","title":"Reference","text":"<ul> <li>Build OpenCV 4.10 with cuda</li> <li>OpenCV CUDA integration</li> </ul>","tags":["opencv","cuda"]},{"location":"Programming/vision/opencv/optical_flow/","title":"OpenCV Optical Flow","text":"<p>Programming / vision / opencv</p> <p>Optical flow is the estimation of the apparent motion of objects or pixels between consecutive frames in a video, based on how the brightness pattern changes.</p> <ul> <li>Input \u2192 two frames (images)</li> <li>Output \u2192 displacement vectors (u,v) showing where each pixel (or feature) moved</li> </ul>","tags":["optical flow","opencv"]},{"location":"Programming/vision/opencv/optical_flow/#types","title":"Types","text":"<ul> <li>Gradient-based (Lucas\u2013Kanade, Horn\u2013Schunck)</li> <li>Feature-based (track sparse keypoints)</li> <li>Dense methods (Farneb\u00e4ck, TV-L1, Brox)</li> <li>Deep learning\u2013based (FlowNet, RAFT).</li> </ul>","tags":["optical flow","opencv"]},{"location":"Programming/vision/opencv/optical_flow/#dense-vs-sparse","title":"Dense vs sparse","text":"","tags":["optical flow","opencv"]},{"location":"Programming/vision/opencv/optical_flow/#dense","title":"Dense","text":"<p>Motion is computed fro every pixel in the image</p>","tags":["optical flow","opencv"]},{"location":"Programming/vision/opencv/optical_flow/#sparse","title":"Sparse","text":"<p>Motion is computed only for selected points (usually features like corners or blobs).</p> <p>Lucas\u2013Kanade</p> <p>---</p> <p>---</p>","tags":["optical flow","opencv"]},{"location":"Programming/vision/opencv/optical_flow/lk/","title":"OpenCV lucas kanade","text":"<p>Programming / vision / opencv / optical flow</p>","tags":["opencv","optical flow","lk","lucas-kanade","goodFeaturesToTrack","calcOpticalFlowPyrLK","cuda"]},{"location":"Programming/vision/opencv/optical_flow/lk/#todo","title":"TODO:","text":"<ul> <li>API</li> <li>understand error and it's usage</li> </ul>","tags":["opencv","optical flow","lk","lucas-kanade","goodFeaturesToTrack","calcOpticalFlowPyrLK","cuda"]},{"location":"Programming/vision/opencv/optical_flow/lk/#demo","title":"Demo","text":"<ul> <li>Flow between two frames</li> </ul> LK cpu version <pre><code>import cv2\nimport numpy as np\nfrom pathlib import Path\n\ndef create_test_sequence():\n    \"\"\"\n    Create simple test images to demonstrate optical flow\n    \"\"\"\n    # Create first image with a white circle\n    img1 = np.zeros((400, 400, 3), dtype=np.uint8)\n    cv2.circle(img1, (150, 200), 30, (255, 255, 255), -1)\n    cv2.rectangle(img1, (50, 100), (100, 150), (0, 255, 0), -1)\n\n    # Create second image with moved objects\n    img2 = np.zeros((400, 400, 3), dtype=np.uint8)  \n    cv2.circle(img2, (200, 220), 30, (255, 255, 255), -1)  # Circle moved right+down\n    cv2.rectangle(img2, (80, 120), (130, 170), (0, 255, 0), -1)  # Rectangle moved right+down\n\n    # Save test images\n    script_dir = Path(__file__).parent\n    cv2.imwrite(script_dir / 'test_frame1.jpg', img1)\n    cv2.imwrite(script_dir / 'test_frame2.jpg', img2)\n\ndef lucas_kanade_with_two_images(img1_path, img2_path):\n    \"\"\"\n    Lucas-Kanade with two specific images\n    \"\"\"\n    # Load two images\n    script_dir = Path(__file__).parent\n    img1 = cv2.imread(script_dir / img1_path)\n    img2 = cv2.imread(script_dir / img2_path)\n\n    if img1 is None or img2 is None:\n        print(\"Error: Could not load images\")\n        return\n\n    # Convert to grayscale\n    gray1 = cv2.cvtColor(img1, cv2.COLOR_BGR2GRAY)\n    gray2 = cv2.cvtColor(img2, cv2.COLOR_BGR2GRAY)\n\n    # Detect features in first image\n    p0 = cv2.goodFeaturesToTrack(gray1, maxCorners=100, qualityLevel=0.3, minDistance=7)\n\n    if p0 is None:\n        print(\"No features detected\")\n        return\n\n    # Calculate optical flow\n    p1, status, error = cv2.calcOpticalFlowPyrLK(\n        gray1, gray2, p0, None,\n        winSize=(15, 15), maxLevel=2,\n        criteria=(cv2.TERM_CRITERIA_EPS | cv2.TERM_CRITERIA_COUNT, 10, 0.03)\n    )\n\n\n    # Filter good points\n    good_new = p1[status == 1]\n    good_old = p0[status == 1]\n\n\n    # Draw motion vectors\n    result = img2.copy()\n    for new, old in zip(good_new, good_old):\n        a, b = new.ravel().astype(int)\n        c, d = old.ravel().astype(int)\n\n        # Draw arrow showing motion\n        cv2.arrowedLine(result, (c, d), (a, b), (0, 255, 255), 2, tipLength=0.3)\n        cv2.circle(result, (a, b), 3, (0, 0, 255), -1)  # Current position\n        cv2.circle(result, (c, d), 3, (255, 0, 0), -1)  # Previous position\n\n    # Display both images\n    combined = np.hstack([img1, result])\n    cv2.imshow('Lucas-Kanade: Before -&gt; After', combined)\n    script_dir = Path(__file__).parent\n    cv2.imwrite(script_dir / 'lk_result.jpg', result)\n    cv2.waitKey(0)\n    cv2.destroyAllWindows()\n\nif __name__ == \"__main__\":\n    # create_test_sequence()\n    lucas_kanade_with_two_images(\"test_frame1.jpg\",\n                                 \"test_frame2.jpg\")\n</code></pre> frame_1 frame_2 Flow","tags":["opencv","optical flow","lk","lucas-kanade","goodFeaturesToTrack","calcOpticalFlowPyrLK","cuda"]},{"location":"Programming/vision/opencv/optical_flow/lk/#demo-cuda","title":"Demo: Cuda","text":"<p>Create cuda version using pin memory for better performance check opencv with cuda</p> <ul> <li><code>cv2.cuda.createGoodFeaturesToTrackDetector</code></li> <li><code>cv2.cuda.SparsePyrLKOpticalFlow_create</code></li> </ul>","tags":["opencv","optical flow","lk","lucas-kanade","goodFeaturesToTrack","calcOpticalFlowPyrLK","cuda"]},{"location":"Programming/vision/opencv/optical_flow/lk/#api","title":"API","text":"detect <pre><code>d_pts = det.detect(d_gray, mask=None, stream=None)\n</code></pre> <ul> <li>d_gray: cv2.cuda_GpuMat, CV_8UC1, grayscale, non-empty.</li> <li>mask (optional): cv2.cuda_GpuMat (CV_8U), same size; non-zero = allowed region.</li> <li>stream (optional): cv2.cuda_Stream for async; if your build errors, omit it.</li> <li>d_pts (return): cv2.cuda_GpuMat (N\u00d71, CV_32FC2), each is (x, y) float32.</li> </ul> calc <pre><code>nextPts, status, err = flow.calc(prevImg, nextImg, prevPts, stream=None)\n</code></pre> <ul> <li>prevImg, nextImg: cv.cuda_GpuMat grayscale (CV_8UC1)<li> <li>prevPts: cv.cuda_GpuMat of shape (N,1), type CV_32FC2 (points as (x,y))<li> <li>returns: nextPts (N\u00d71, CV_32FC2), status (N\u00d71, CV_8U), err (N\u00d71, CV_32F)<li>","tags":["opencv","optical flow","lk","lucas-kanade","goodFeaturesToTrack","calcOpticalFlowPyrLK","cuda"]},{"location":"Programming/vision/opencv/optical_flow/lk/#code","title":"Code","text":"LK cuda version <pre><code>import cv2\nimport numpy as np\nfrom pathlib import Path\n\ndef create_test_sequence():\n    \"\"\"\n    Create simple test images to demonstrate optical flow\n    \"\"\"\n    # Create first image with a white circle\n    img1 = np.zeros((400, 400, 3), dtype=np.uint8)\n    cv2.circle(img1, (150, 200), 30, (255, 255, 255), -1)\n    cv2.rectangle(img1, (50, 100), (100, 150), (0, 255, 0), -1)\n\n    # Create second image with moved objects\n    img2 = np.zeros((400, 400, 3), dtype=np.uint8)  \n    cv2.circle(img2, (200, 220), 30, (255, 255, 255), -1)  # Circle moved right+down\n    cv2.rectangle(img2, (80, 120), (130, 170), (0, 255, 0), -1)  # Rectangle moved right+down\n\n    # Save test images\n    script_dir = Path(__file__).parent\n    cv2.imwrite(script_dir / 'test_frame1.jpg', img1)\n    cv2.imwrite(script_dir / 'test_frame2.jpg', img2)\n\ndef lucas_kanade_with_two_images(img1_path, img2_path):\n    \"\"\"\n    Lucas-Kanade with two specific images\n    \"\"\"\n    # Load two images\n    script_dir = Path(__file__).parent\n    img1 = cv2.imread(script_dir / img1_path)\n    img2 = cv2.imread(script_dir / img2_path)\n\n    if img1 is None or img2 is None:\n        print(\"Error: Could not load images\")\n        return\n\n    w, h, _ = img1.shape\n    # Allocate pinned host memory for faster CPU-GPU transfers\n    PAGE_LOCKED = 1\n    pinned_img1 = cv2.cuda.HostMem(h, w, cv2.CV_8UC3, PAGE_LOCKED)\n    hmat1 = pinned_img1.createMatHeader() \n    pinned_img2 = cv2.cuda.HostMem(h, w, cv2.CV_8UC3, PAGE_LOCKED)\n    hmat2 = pinned_img2.createMatHeader() \n\n    gpu_img1 = cv2.cuda.GpuMat()\n    gpu_img2 = cv2.cuda.GpuMat()\n    gpu_gray1 = cv2.cuda.GpuMat()\n    gpu_gray2 = cv2.cuda.GpuMat()\n\n    hmat1[:] = img1\n    hmat2[:] = img2\n\n    # TODO:         self.gpu_img1.upload_async(self.pinned_img1.ptr(), self.stream)\n    gpu_img1.upload(hmat1)\n    gpu_img2.upload(hmat2)\n\n    # Convert to grayscale on GPU\n    gpu_gray1 = cv2.cuda.cvtColor(gpu_img1, cv2.COLOR_BGR2GRAY)\n    gpu_gray2 = cv2.cuda.cvtColor(gpu_img2, cv2.COLOR_BGR2GRAY)\n\n\n    gpu_detector = cv2.cuda.createGoodFeaturesToTrackDetector(\n            cv2.CV_8UC1,\n            maxCorners=100,\n            qualityLevel=0.3,\n            minDistance=7,\n            blockSize=7\n        )\n\n    # Detect features in first image\n    p0_gpu = gpu_detector.detect(gpu_gray1)\n\n\n\n    # Calculate optical flow\n    lk = cv2.cuda.SparsePyrLKOpticalFlow_create(\n        winSize=(15, 15), \n        maxLevel=2,\n        iters=10, \n        useInitialFlow=False\n    )\n\n    p1_gpu, status_gpu, error_gpu = lk.calc(\n        gpu_gray1,\n        gpu_gray2, \n        p0_gpu,\n        None,)\n    p0 = p0_gpu.download().reshape(-1, 2)\n    p1 = p1_gpu.download().reshape(-1, 2)\n    status = status_gpu.download().reshape(-1).astype(bool)\n\n    if p0 is None:\n        print(\"No features detected\")\n        return\n\n    # Filter good points\n    good_new = p1[status == 1]\n    good_old = p0[status == 1]\n\n\n    # Draw motion vectors\n    result = img2.copy()\n    for new, old in zip(good_new, good_old):\n        a, b = new.ravel().astype(int)\n        c, d = old.ravel().astype(int)\n\n        # Draw arrow showing motion\n        cv2.arrowedLine(result, (c, d), (a, b), (0, 255, 255), 2, tipLength=0.3)\n        cv2.circle(result, (a, b), 3, (0, 0, 255), -1)  # Current position\n        cv2.circle(result, (c, d), 3, (255, 0, 0), -1)  # Previous position\n\n    # Display both images\n    combined = np.hstack([img1, result])\n    cv2.imshow('Lucas-Kanade: Before -&gt; After', combined)\n    script_dir = Path(__file__).parent\n    cv2.imwrite(script_dir / 'lk_result.jpg', result)\n    cv2.waitKey(0)\n    cv2.destroyAllWindows()\n\nif __name__ == \"__main__\":\n    # create_test_sequence()\n    lucas_kanade_with_two_images(\"test_frame1.jpg\",\n                                 \"test_frame2.jpg\")\n</code></pre>","tags":["opencv","optical flow","lk","lucas-kanade","goodFeaturesToTrack","calcOpticalFlowPyrLK","cuda"]},{"location":"Programming/vision/opencv/optical_flow/lk/#demo-cuda-with-pin-memory-and-stream","title":"Demo: Cuda with pin memory and stream","text":"Cuda version with pin memory and stream <pre><code>import cv2 as cv\nimport numpy as np\nfrom pathlib import Path\n\ndef create_test_sequence():\n    img1 = np.zeros((400, 400, 3), dtype=np.uint8)\n    cv.circle(img1, (150, 200), 30, (255, 255, 255), -1)\n    cv.rectangle(img1, (50, 100), (100, 150), (0, 255, 0), -1)\n\n    img2 = np.zeros((400, 400, 3), dtype=np.uint8)\n    cv.circle(img2, (200, 220), 30, (255, 255, 255), -1)\n    cv.rectangle(img2, (80, 120), (130, 170), (0, 255, 0), -1)\n\n    script_dir = Path(__file__).parent\n    cv.imwrite(str(script_dir / 'test_frame1.jpg'), img1)\n    cv.imwrite(str(script_dir / 'test_frame2.jpg'), img2)\n\ndef lucas_kanade_with_two_images(img1_path, img2_path):\n    script_dir = Path(__file__).parent\n    img1 = cv.imread(str(script_dir / img1_path), cv.IMREAD_COLOR)\n    img2 = cv.imread(str(script_dir / img2_path), cv.IMREAD_COLOR)\n    if img1 is None or img2 is None:\n        print(\"Error: Could not load images\")\n        return\n\n    h, w, _ = img1.shape  # NOTE: (rows, cols, ch) -&gt; (H, W, C)\n\n    # --- Pinned host buffers (optional speed-up) ---\n    use_hostmem = hasattr(cv, \"cuda_HostMem\")\n    if use_hostmem:\n        hmem1 = cv.cuda_HostMem(h, w, cv.CV_8UC3, 1)\n        hmem2 = cv.cuda_HostMem(h, w, cv.CV_8UC3, 1)\n        hmat1 = hmem1.createMatHeader(); hmat1[:] = img1\n        hmat2 = hmem2.createMatHeader(); hmat2[:] = img2\n\n    # --- GPU mats + stream ---\n    stream = cv.cuda_Stream()\n    d_img1 = cv.cuda_GpuMat()\n    d_img2 = cv.cuda_GpuMat()\n    d_gray1 = cv.cuda_GpuMat()\n    d_gray2 = cv.cuda_GpuMat()\n\n    if use_hostmem:\n        d_img1.upload(hmat1, stream=stream)\n        d_img2.upload(hmat2, stream=stream)\n    else:\n        d_img1.upload(img1, stream=stream)\n        d_img2.upload(img2, stream=stream)\n\n    # Correct cv.cuda.cvtColor signature: (src, code, dst=..., stream=...)\n    d_gray1 = cv.cuda.cvtColor(d_img1, cv.COLOR_BGR2GRAY, stream=stream)\n    d_gray2 = cv.cuda.cvtColor(d_img2, cv.COLOR_BGR2GRAY, stream=stream)\n\n    # --- CUDA Good Features To Track (Shi\u2013Tomasi) ---\n    detector = cv.cuda.createGoodFeaturesToTrackDetector(\n        cv.CV_8UC1, maxCorners=200, qualityLevel=0.01,\n        minDistance=7, blockSize=7, useHarrisDetector=False\n    )\n    d_p0 = detector.detect(d_gray1, stream=stream)  # Nx1 CV_32FC2\n    stream.waitForCompletion()\n    if d_p0.empty():\n        print(\"No features detected\")\n        return\n\n    # --- CUDA Sparse LK ---\n    lk = cv.cuda.SparsePyrLKOpticalFlow_create(\n        winSize=(15, 15), maxLevel=2, iters=10, useInitialFlow=False\n    )\n    # Order is prev -&gt; next:\n    d_p1, d_status, d_err = lk.calc(d_gray1, d_gray2, d_p0, None, stream=stream)\n    stream.waitForCompletion()\n\n    # --- Download + filter on CPU ---\n    p0 = d_p0.download().reshape(-1, 2)\n    p1 = d_p1.download().reshape(-1, 2)\n    st = d_status.download().reshape(-1).astype(bool)\n\n    good_old = p0[st]\n    good_new = p1[st]\n\n    # --- Draw vectors on img2 ---\n    result = img2.copy()\n    for (a, b), (c, d) in zip(good_new.astype(int), good_old.astype(int)):\n        cv.arrowedLine(result, (c, d), (a, b), (0, 255, 255), 2, tipLength=0.3)\n        cv.circle(result, (a, b), 3, (0, 0, 255), -1)\n        cv.circle(result, (c, d), 3, (255, 0, 0), -1)\n\n    combined = np.hstack([img1, result])\n    cv.imshow(\"Lucas-Kanade: Before -&gt; After\", combined)\n    cv.imwrite(str(script_dir / \"lk_result.jpg\"), result)\n    cv.waitKey(0)\n    cv.destroyAllWindows()\n\nif __name__ == \"__main__\":\n    # create_test_sequence()\n    lucas_kanade_with_two_images(\"test_frame1.jpg\", \"test_frame2.jpg\")\n</code></pre>","tags":["opencv","optical flow","lk","lucas-kanade","goodFeaturesToTrack","calcOpticalFlowPyrLK","cuda"]},{"location":"Programming/vision/opencv/optical_flow/lk/#demo-cuda-with-videoimage-sequence","title":"Demo: Cuda with Video/Image sequence","text":"<ul> <li>upload new_point back to gpu for next iteration</li> </ul> Cuda version with Image sequence <pre><code>\"\"\"\nGenerate synthetic image sequences for testing optical flow algorithms.\nCreate motion on x axes\nUsing cuda to run lucas kanade optical flow\nUsing cuda pinned memory\n\"\"\"\nimport cv2\nimport numpy as np\nimport logging\nfrom typing import NamedTuple\n\nlog = logging.getLogger(__name__)\nlogging.basicConfig(level=logging.DEBUG)\n\n\ndef create_test_sequence(num_frames=300,  motion_speed=3,width=640, height=480):\n    # Initial positions\n    circle_start = (150, 200)    # Circle starts at left\n    rect_start = (120, 100)      # Rectangle starts at left\n\n    # Object properties\n    circle_radius = 30\n    rect_size = (50, 50)  # width, height\n    for frame_idx in range(num_frames):\n        # Create black background\n        img = np.zeros((height, width, 3), dtype=np.uint8)\n\n        # Calculate current positions (moving right)\n        circle_x = circle_start[0] + (frame_idx * motion_speed)\n        circle_y = circle_start[1]\n\n        rect_x = rect_start[0] + (frame_idx * motion_speed)\n        rect_y = rect_start[1]\n\n        # Wrap around if objects go off screen (optional)\n        circle_x = circle_x % (width + circle_radius * 2) - circle_radius\n        rect_x = rect_x % (width + rect_size[0]) - rect_size[0]\n\n        # Draw white circle\n        if -circle_radius &lt;= circle_x &lt;= width + circle_radius:\n            cv2.circle(img, (int(circle_x), int(circle_y)), circle_radius, (0, 0, 255), -1)\n\n        # Draw green rectangle\n        if -rect_size[0] &lt;= rect_x &lt;= width:\n            cv2.rectangle(img, \n                        (int(rect_x), int(rect_y)), \n                        (int(rect_x + rect_size[0]), int(rect_y + rect_size[1])), \n                        (0, 255, 0), -1)\n\n        # Draw green rectangle\n        if -rect_size[0] &lt;= rect_x &lt;= width:\n            rect_y2 = rect_y + 200 * np.sin(frame_idx / 10)  # Add vertical oscillation\n            cv2.rectangle(img, \n                        (int(rect_x), int(rect_y2)), \n                        (int(rect_x + rect_size[0]), int(rect_y2 + rect_size[1])), \n                        (0, 255, 0), -1)\n\n\n        yield img\n\n\nclass LKResult(NamedTuple):\n    good_new: np.ndarray\n    good_old: np.ndarray\n\nclass LK():\n    def __init__(self, w, h):\n        self.gpu_detector = cv2.cuda.createGoodFeaturesToTrackDetector(\n            cv2.CV_8UC1,\n            maxCorners=100,\n            qualityLevel=0.3,\n            minDistance=7,\n            blockSize=7\n        )\n\n        self.lk = cv2.cuda.SparsePyrLKOpticalFlow_create(\n            winSize=(15, 15), \n            maxLevel=5,\n            iters=10, \n            useInitialFlow=False\n        )\n\n\n        # create pin memeory\n        PAGE_LOCKED = 1\n        pinned_img = cv2.cuda.HostMem(h, w, cv2.CV_8UC3, PAGE_LOCKED)\n        self.pin_image = pinned_img.createMatHeader() \n        \"\"\" pinned memory for input image \"\"\"\n\n        self.gpu_img = cv2.cuda.GpuMat() \n        \"\"\" hold the current frame as GpuMat \"\"\"\n        self.gpu_prev_gray = cv2.cuda.GpuMat()\n        \"\"\" hold previous frame as GpuMat \"\"\"\n        self.p0_gpu = cv2.cuda.GpuMat()\n        \"\"\" hold previous points as GpuMat \"\"\"\n\n        self.minmun_points_to_redetect = 2\n\n    def process_frame(self, frame: np.ndarray) -&gt; LKResult:\n        \"\"\"\n        Process a single frame for optical flow tracking.\n        upload the frame to GPU memory from pinned memory.\n        run detection if no points to track. (run on gpu)\n        run lk calculation. on gpu\n        \"\"\"\n        p1_gpu: cv2.cuda.GpuMat\n        status_gpu: cv2.cuda.GpuMat\n        error_gpu: cv2.cuda.GpuMat\n\n        self.pin_image[:] = frame\n        self.gpu_img.upload(self.pin_image)\n        gpu_gray = cv2.cuda.cvtColor(self.gpu_img, cv2.COLOR_BGR2GRAY)\n\n        if self.p0_gpu.empty():\n            self.p0_gpu = self.gpu_detector.detect(gpu_gray)\n            if self.p0_gpu.empty():\n                raise RuntimeError(\"No features detected.\")\n\n            log.debug(f\"---- Initial points detected: {self.p0_gpu.size()}\")\n            self.gpu_prev_gray = gpu_gray.clone()\n\n        # Calculate optical flow\n        p1_gpu, status_gpu, error_gpu = self.lk.calc(\n            self.gpu_prev_gray, \n            gpu_gray,\n            self.p0_gpu,\n            None,)\n\n        # Download point from gpu for fautere filter and process\n        p0 = self.p0_gpu.download().reshape(-1, 2)\n        p1 = p1_gpu.download().reshape(-1, 2)\n        status = status_gpu.download().reshape(-1).astype(bool)\n        error = error_gpu.download().reshape(-1)\n\n        good_new: np.ndarray = p1[status]\n        good_old: np.ndarray = p0[status]\n\n        # upload new point back to gpu for the next iteration\n        if len(good_new) &gt; self.minmun_points_to_redetect:\n            self.p0_gpu.upload(good_new.reshape(1, -1, 2).astype(np.float32))\n        else:\n            log.warning(\"No points to track, re-detecting.\")\n            self.p0_gpu = cv2.cuda.GpuMat()\n\n\n        self.gpu_prev_gray = gpu_gray.clone()\n\n        return LKResult(good_new=good_new, good_old=good_old)\n\n\nif __name__ == \"__main__\":\n    COLOR_NEW = (0, 0, 255) # RED\n    COLOR_OLD = (255, 0, 0) # BLUE\n    new: np.ndarray \n    old: np.ndarray\n\n    lk = LK(640, 480)\n    images = create_test_sequence()\n    while (frame := next(images, None)) is not None:\n        good_new, good_old = lk.process_frame(frame)\n\n        for new, old in zip(good_new, good_old):\n            a, b = new.ravel().astype(int)\n            c, d = old.ravel().astype(int)\n            # cv2.arrowedLine(img, (c, d), (a, b), (0, 255, 255), 2, tipLength=0.3)\n            cv2.circle(frame, (a, b), 3, COLOR_NEW, -1)\n            cv2.circle(frame, (c, d), 3, COLOR_OLD, -1)\n        cv2.imshow(\"LK Optical Flow CUDA\", frame)\n        if cv2.waitKey(100) &amp; 0xFF == 27:\n            break\n</code></pre>","tags":["opencv","optical flow","lk","lucas-kanade","goodFeaturesToTrack","calcOpticalFlowPyrLK","cuda"]},{"location":"Programming/vision/optical_flow/","title":"Optical FLow","text":"<p>Programming / vision</p> <p>Optical flow is the estimation of the apparent motion of objects or pixels between consecutive frames in a video, based on how the brightness pattern changes.</p> <ul> <li>Input \u2192 two frames (images)</li> <li>Output \u2192 displacement vectors (u,v) showing where each pixel (or feature) moved</li> </ul>","tags":["opencv","optical flow"]},{"location":"Programming/vision/optical_flow/#types","title":"Types","text":"<ul> <li>Gradient-based (Lucas\u2013Kanade, Horn\u2013Schunck)</li> <li>Feature-based (track sparse keypoints)</li> <li>Dense methods (Farneb\u00e4ck, TV-L1, Brox)</li> <li>Deep learning\u2013based (FlowNet, RAFT).</li> </ul>","tags":["opencv","optical flow"]},{"location":"Programming/vision/optical_flow/#dense-vs-sparse","title":"Dense vs sparse","text":"","tags":["opencv","optical flow"]},{"location":"Programming/vision/optical_flow/#dense","title":"Dense","text":"<p>Motion is computed fro every pixel in the image</p>","tags":["opencv","optical flow"]},{"location":"Programming/vision/optical_flow/#sparse","title":"Sparse","text":"<p>Motion is computed only for selected points (usually features like corners or blobs).</p> <p>OpenCV Lucas\u2013Kanade OpenCV Lucas\u2013Kanade cuda implementation</p>","tags":["opencv","optical flow"]},{"location":"Programming/vision/vio/","title":"MSCKF","text":"<p>Multi-State Constraint Kalman filter </p> <p>MSCKF | Multi State Constrain Kalman FIlter Owner avatar msckf_vio_python</p>","tags":["vio","vision"]},{"location":"Programming/vision/visual_trackers/","title":"Visual Trackers","text":"<p>Nano Tracker</p> <p>Siam Mask</p> <p>tbd</p>","tags":["vision","tracker","opencv"]},{"location":"Programming/vision/visual_trackers/nano_tracker/","title":"Using opencv to run nano tracker","text":"<p>Using NanoTracker v2</p> <p>SiamTrackers NanoTracker</p> <ul> <li>OpenCV 4.10</li> </ul>","tags":["opencv","nano tracker"]},{"location":"Programming/vision/visual_trackers/nano_tracker/#demo-code","title":"Demo code","text":"nano_tracker_v2.py <pre><code>\"\"\"\nDemo with model v2\n\"\"\"\nimport cv2\nimport pathlib\nimport sys\n\n\nVIDEO_FILE = \"vtest.avi\"\n\ndef preprocess_frame(image):\n    # image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)\n    return image\n\ndef create_tracker():\n    # Create tracker object\n    params = cv2.TrackerNano.Params()\n    # v2\n    params.backbone = \"/workspace/models/nanotrack_backbone_sim.onnx\"\n    params.neckhead = \"/workspace/models/nanotrack_head_sim.onnx\"\n\n\n    params.backend = cv2.dnn.DNN_BACKEND_DEFAULT\n    params.target  = cv2.dnn.DNN_TARGET_CPU\n\n    tracker = cv2.TrackerNano.create(params)  # CSRT tracker offers good accuracy\n    return tracker\n\ndef initialize_tracker(frame, tracker):\n    # Select ROI for tracking\n    bbox = cv2.selectROI('Tracking', frame, fromCenter=False, showCrosshair=True)\n    if bbox[2] &lt;= 0 or bbox[3] &lt;= 0:\n        sys.exit(\"ROI selection cancelled. Exiting...\")\n\n    # Initialize tracker\n    try:\n        tracker.init(frame, bbox)\n    except Exception as e:\n        print('Unable to initialize tracker with requested bounding box. Is there any object?')\n        print(e)\n        print('Try again ...')\n        sys.exit(1)\n    return bbox\n\ndef main():\n    video_path = pathlib.Path(__file__).parent.joinpath(\"..\").joinpath(\"data\").joinpath(VIDEO_FILE)\n    print(video_path.as_posix())\n    video_path = video_path.as_posix()\n\n    cap = cv2.VideoCapture(video_path)\n\n    if not cap.isOpened():\n        print(\"Error: Cannot open video file.\")\n        exit()\n\n    # Read first frame\n    ret, frame = cap.read()\n    if not ret:\n        print(\"Cannot read video file\")\n        sys.exit()\n\n    # Create tracker and initialize\n    tracker = create_tracker()\n\n    frame = preprocess_frame(frame)\n    bbox = initialize_tracker(frame, tracker)\n\n    while True:\n        ret, frame = cap.read()\n        if not ret:\n            break  # End of video\n\n        # Update tracker\n        frame = preprocess_frame(frame)\n        ok, bbox = tracker.update(frame)\n\n        # Draw bounding box\n        if ok:\n            # Tracking success\n            p1 = (int(bbox[0]), int(bbox[1]))\n            p2 = (int(bbox[0] + bbox[2]), int(bbox[1] + bbox[3]))\n            cv2.rectangle(frame, p1, p2, (255,0,0), 2, 1)\n        else:\n            # Tracking failure\n            cv2.putText(frame, \"Tracking failure detected\", (100,80), \n                       cv2.FONT_HERSHEY_SIMPLEX, 0.75,(0,0,255),2)\n        # Display the frame\n        cv2.imshow('nano', frame)\n\n        # Press 'q' to quit\n        if cv2.waitKey(25) &amp; 0xFF == ord('q'):\n            break\n\n    # Release resources\n    cap.release()\n    cv2.destroyAllWindows()\n\n\nif __name__ == \"__main__\":\n    main()\n</code></pre>","tags":["opencv","nano tracker"]},{"location":"Programming/vision/visual_trackers/nano_tracker/#downloads","title":"Downloads","text":"<ul> <li>video</li> <li>nanotrack_backbone_v2</li> <li>nanotrack_head_v2</li> <li>Dockerfile</li> </ul>","tags":["opencv","nano tracker"]},{"location":"Programming/vision/visual_trackers/nano_tracker/#resource","title":"Resource","text":"<ul> <li>NanoTrack_TensorRT: implement nano track using tensorrt</li> </ul>","tags":["opencv","nano tracker"]},{"location":"Programming/vision/visual_trackers/siam_mask/","title":"Siam Mask","text":"<ul> <li>SiamMask</li> <li>siammask_onnx</li> <li>SiamTracker-with-TensorRT</li> </ul>","tags":["siam mask","visual trackers","vision"]},{"location":"ROS/","title":"ROS","text":""},{"location":"ROS/#ros","title":"ROS","text":"Custom styled tooltip <p>Python</p> <p>C/CPP</p> Launch, rviz, rqt, ros bag, colcon  <p>ROS Eco</p> <p>Dev/Build/Deploy Env.</p> Navigation, Localization, Perception and control <p>ROS world</p> Pub Sun Service and more <p>ROS basic</p> <p>ROS and Gazebo harmonic</p> <p>ROS2 Messages</p> <p>Resources</p>"},{"location":"ROS/dev_environment/","title":"ROS2 Dev Build Test Environment","text":"<p>Development</p> <p>Build</p> <p>Prod</p> <p>vscode setting and extension</p> <p>GDB</p> <p>Docker</p>"},{"location":"ROS/dev_environment/#project-template","title":"Project Template","text":"<ul> <li>ros_gz_project_template</li> <li>jazzy harmonic bridge setup</li> </ul>"},{"location":"ROS/dev_environment/build/","title":"ROS2 Build Environment","text":"<ul> <li>Build ARM ROS2 packages using docker</li> <li>Build ROS2 humble docker for Jetson</li> </ul>","tags":["ros","build","docker"]},{"location":"ROS/dev_environment/build/#demo-from-ros-project-to-deploy","title":"Demo: From ROS project to deploy","text":"<ul> <li>Part1: Project struct</li> <li>Part2: Create Debian packages</li> <li>Part2a: Add System files to debian package</li> <li>Part2b: Using github Action to automatic build and deploy</li> <li>Part3: Setup aptly, Install and test on docker</li> <li>Part4: Cross compiler using docker </li> <li>Part5: Cross compiler</li> <li>draft: from ros package to deploy</li> </ul>","tags":["ros","build","docker"]},{"location":"ROS/dev_environment/build/aptly_ros_custom_repo/","title":"Using Docker and Aptly to check package installation","text":"","tags":["ros","aptly","deb","reosdep","bloom","docker"]},{"location":"ROS/dev_environment/build/aptly_ros_custom_repo/#aptly","title":"Aptly","text":"<p>Aptly allows you to mirror remote repositories, manage local package repositories and more. more</p> <p>Warning</p> <p>Download new version 1.6.1 download The ubuntu repo version is 1.4.0 isn't support Zstd compression that use by <code>bloom-generate</code></p> <p>Using aptly to create a custom repository for ROS packages. This is useful when you want to create a custom repository for your ROS packages.</p> <ul> <li>Create a new repository</li> <li>Add packages to the repository</li> <li>Publish the repository</li> <li>Add the repository to the sources list</li> </ul>","tags":["ros","aptly","deb","reosdep","bloom","docker"]},{"location":"ROS/dev_environment/build/aptly_ros_custom_repo/#create-a-new-repository","title":"Create a new repository","text":"<pre><code>aptly -distribution=\"jammy\" -architectures=\"amd64\" \\\nrepo \\\ncreate \\\nmy_ros_app_repo\n</code></pre>","tags":["ros","aptly","deb","reosdep","bloom","docker"]},{"location":"ROS/dev_environment/build/aptly_ros_custom_repo/#add-packages-to-the-repository","title":"Add packages to the repository","text":"<pre><code>aptly repo add my_ros_app_repo \\\nros-humble-pkg-client_0.0.0-0jammy_amd64.deb \\\nros-humble-pkg-server_0.0.0-0jammy_amd64.deb\n</code></pre>","tags":["ros","aptly","deb","reosdep","bloom","docker"]},{"location":"ROS/dev_environment/build/aptly_ros_custom_repo/#publish-the-repository","title":"Publish the repository","text":"<pre><code>aptly -architectures=\"amd64\" -skip-signing=true \\\npublish repo -architectures=\"amd64\" \\\nmy_ros_app_repo local\n</code></pre>","tags":["ros","aptly","deb","reosdep","bloom","docker"]},{"location":"ROS/dev_environment/build/aptly_ros_custom_repo/#serve-the-repository","title":"Serve the repository","text":"<pre><code>aptly serve\n# aptly serve -listen=\":8081\"\n</code></pre>","tags":["ros","aptly","deb","reosdep","bloom","docker"]},{"location":"ROS/dev_environment/build/aptly_ros_custom_repo/#docker","title":"Docker","text":"<p>Install ROS Package on a docker container The docker image base on ubuntu 22.04 with ROS humble base</p> <p>Note</p> <p>For test the installation i use docker from Allison github</p> <pre><code>docker build -t humble:dev --target dev .\n</code></pre> <pre><code>docker run -it --rm \\\n--net host \\\n--hostname ros \\\n--user user \\\nhumble:dev /bin/bash\n</code></pre>","tags":["ros","aptly","deb","reosdep","bloom","docker"]},{"location":"ROS/dev_environment/build/aptly_ros_custom_repo/#add-the-repository-to-the-sources-list","title":"Add the repository to the sources list","text":"<pre><code>deb [trusted=true] http://127.0.0.1:8081/local/ jammy main\n</code></pre>","tags":["ros","aptly","deb","reosdep","bloom","docker"]},{"location":"ROS/dev_environment/build/aptly_ros_custom_repo/#check-for-packages","title":"Check for packages","text":"<pre><code>apt update\napt search ros-humble-pkg*\nSorting... Done\nFull Text Search... Done\nros-humble-pkg-client/jammy 0.0.0-0jammy amd64\n  TODO: Package description\n\nros-humble-pkg-server/jammy 0.0.0-0jammy amd64\n  TODO: Package description\n</code></pre>","tags":["ros","aptly","deb","reosdep","bloom","docker"]},{"location":"ROS/dev_environment/build/aptly_ros_custom_repo/#install","title":"Install","text":"<pre><code>apt install ros-humble-pkg-client\n</code></pre>","tags":["ros","aptly","deb","reosdep","bloom","docker"]},{"location":"ROS/dev_environment/build/aptly_ros_custom_repo/#usage-and-check-installation","title":"Usage and check installation","text":"<pre><code>source /opt/ros/humble/setup.bash\nros2 launch pkg_client client_server.launch.py\n</code></pre>","tags":["ros","aptly","deb","reosdep","bloom","docker"]},{"location":"ROS/dev_environment/build/ros_build_docker_jetson/","title":"ROS2 humble docker for Jetson","text":"","tags":["ros","docker","jetson","build","arm"]},{"location":"ROS/dev_environment/build/ros_build_docker_jetson/#docker-image","title":"Docker image","text":"","tags":["ros","docker","jetson","build","arm"]},{"location":"ROS/dev_environment/build/ros_build_docker_jetson/#build","title":"Build","text":"Dockerfile  Base on ubuntu 22.04 without any nvidia support  <pre><code>FROM ubuntu:22.04\n\nARG VERSION=0.0.1\n\nRUN echo \"image dev version: ${VERSION}\"&gt;/etc/docker_image_dev_version\n\nENV NVIDIA_VISIBLE_DEVICES all\nENV NVIDIA_DRIVER_CAPABILITIES all\n\n\n\n# Install common programs\nRUN apt-get update &amp;&amp; apt-get install -y --no-install-recommends \\\n    curl \\\n    gnupg2 \\\n    lsb-release \\\n    sudo \\\n    software-properties-common \\\n    wget \\\n    &amp;&amp; rm -rf /var/lib/apt/lists/*\n\nARG USERNAME=user\nARG USER_UID=1000\nARG USER_GID=$USER_UID\n\n# Create a non-root user\nRUN groupadd --gid $USER_GID $USERNAME \\\n    &amp;&amp; useradd -s /bin/bash --uid $USER_UID --gid $USER_GID -m $USERNAME \\\n    # Add sudo support for the non-root user\n    &amp;&amp; apt-get update \\\n    &amp;&amp; apt-get install -y sudo \\\n    &amp;&amp; echo $USERNAME ALL=\\(root\\) NOPASSWD:ALL &gt; /etc/sudoers.d/$USERNAME\\\n    &amp;&amp; chmod 0440 /etc/sudoers.d/$USERNAME \\\n    &amp;&amp; rm -rf /var/lib/apt/lists/*\n\n# Install language\nRUN apt-get update &amp;&amp; apt-get install -y \\\n  locales \\\n  &amp;&amp; locale-gen en_US.UTF-8 \\\n  &amp;&amp; update-locale LC_ALL=en_US.UTF-8 LANG=en_US.UTF-8 \\\n  &amp;&amp; rm -rf /var/lib/apt/lists/*\nENV LANG=en_US.UTF-8\n\n# Install timezone\nRUN ln -fs /usr/share/zoneinfo/UTC /etc/localtime \\\n  &amp;&amp; export DEBIAN_FRONTEND=noninteractive \\\n  &amp;&amp; apt-get update \\\n  &amp;&amp; apt-get install -y tzdata \\\n  &amp;&amp; dpkg-reconfigure --frontend noninteractive tzdata \\\n  &amp;&amp; rm -rf /var/lib/apt/lists/*\n\nRUN apt-get update &amp;&amp; apt-get -y upgrade \\\n    &amp;&amp; rm -rf /var/lib/apt/lists/*\n\n\n# Install ROS2\nRUN sudo add-apt-repository universe \\\n  &amp;&amp; curl -sSL https://raw.githubusercontent.com/ros/rosdistro/master/ros.key -o /usr/share/keyrings/ros-archive-keyring.gpg \\\n  &amp;&amp; echo \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/ros-archive-keyring.gpg] http://packages.ros.org/ros2/ubuntu $(. /etc/os-release &amp;&amp; echo $UBUNTU_CODENAME) main\" | sudo tee /etc/apt/sources.list.d/ros2.list &gt; /dev/null \\\n  &amp;&amp; apt-get update &amp;&amp; apt-get install -y --no-install-recommends \\\n    ros-humble-ros-base \\\n    python3-argcomplete \\\n  &amp;&amp; rm -rf /var/lib/apt/lists/*\n\n\nRUN apt-get update &amp;&amp; apt-get install -y --no-install-recommends \\\n  build-essential \\\n  bash-completion \\\n  python-is-python3 \\\n  vim \\\n  ## ros\n  ros-humble-rmw-cyclonedds-cpp \\\n  python3-colcon-common-extensions \\\n  python3-colcon-clean \\\n  python3-rosdep \\\n  python3-bloom \\\n  fakeroot \\\n  debhelper \\\n  dh-python \\\n  ## devops\n  tmux \\\n  tmuxp \\\n&amp;&amp; apt-get clean -y \\\n&amp;&amp; rm -rf /var/lib/apt/lists/*\n\n# Set up autocompletion for user\nRUN apt-get update &amp;&amp; apt-get install -y git-core bash-completion \\\n  &amp;&amp; echo \"if [ -f /opt/ros/${ROS_DISTRO}/setup.bash ]; then source /opt/ros/${ROS_DISTRO}/setup.bash; fi\" &gt;&gt; /home/$USERNAME/.bashrc \\\n  &amp;&amp; echo \"if [ -f /usr/share/colcon_argcomplete/hook/colcon-argcomplete.bash ]; then source /usr/share/colcon_argcomplete/hook/colcon-argcomplete.bash; fi\" &gt;&gt; /home/$USERNAME/.bashrc \\\n  &amp;&amp; rm -rf /var/lib/apt/lists/*\n\nENV DEBIAN_FRONTEND=\nENV AMENT_CPPCHECK_ALLOW_SLOW_VERSIONS=1\n</code></pre> build<pre><code>docker buildx build --platform linux/arm64 -t humble/arm:build -f Dockerfile .\n</code></pre>","tags":["ros","docker","jetson","build","arm"]},{"location":"ROS/dev_environment/build/ros_build_docker_jetson/#usage","title":"Usage","text":"check<pre><code>docker run -it --rm \\\n--platform linux/arm64 \\\n--net host \\\n--hostname ros \\\n--user user \\\nhumble/arm:build uname -a\n</code></pre>","tags":["ros","docker","jetson","build","arm"]},{"location":"ROS/dev_environment/build/ros_build_docker_jetson/#todo","title":"TODO","text":"<ul> <li>support cuda</li> <li>support opencv</li> <li>support tensorrt</li> <li>support pytorch / tensorflow</li> </ul>","tags":["ros","docker","jetson","build","arm"]},{"location":"ROS/dev_environment/build/ros_build_docker_jetson/#reference","title":"Reference","text":"<ul> <li>Dusty - Machine Learning Containers for Jetson and JetPack</li> <li>atinfinity</li> <li>ROS 2 on Jetson Nano using Docker</li> </ul>","tags":["ros","docker","jetson","build","arm"]},{"location":"ROS/dev_environment/build/ros_build_using_docker_cross_compile/","title":"ROS2 Build Environment","text":"","tags":["ros","build","docker","cross compiler","arm"]},{"location":"ROS/dev_environment/build/ros_build_using_docker_cross_compile/#using-docker-to-build-ros2-packages-for-arm","title":"Using docker to build ROS2 packages for ARM","text":"<p>Run ARM docker architecture on x64 machine</p>","tags":["ros","build","docker","cross compiler","arm"]},{"location":"ROS/dev_environment/build/ros_build_using_docker_cross_compile/#prerequisite","title":"Prerequisite","text":"<p>Config and install QEMU to use with docker check</p>","tags":["ros","build","docker","cross compiler","arm"]},{"location":"ROS/dev_environment/build/ros_build_using_docker_cross_compile/#build-ros-arm-docker","title":"Build ROS ARM docker","text":"<p>Use Prebuild image from docker hub as base</p> <p>osrf docker hub</p> pull<pre><code>docker pull --platform linux/arm64 arm64v8/ros:humble-ros-base-jammy\n</code></pre> build<pre><code>docker  buildx build --platform linux/arm64 -t &lt;image&gt;  .\n</code></pre> run<pre><code># test images\ndocker run --platform=linux/arm64 --rm &lt;image&gt; uname -m \n</code></pre>","tags":["ros","build","docker","cross compiler","arm"]},{"location":"ROS/dev_environment/build/demo/build_deploy_ros_project_2/","title":"ROS2 project from development to deployment, Part 2: Build Debian packages","text":"<p>Run the command From package folder</p> <p>deb location</p> <p>The deb file locate in parent folder: <code>src</code> folder</p> <pre><code>bloom-generate rosdebian --ros-distro humble\n</code></pre> build deb<pre><code>fakeroot debian/rules binary\n</code></pre>","tags":["ros","deploy","tutorial"]},{"location":"ROS/dev_environment/build/demo/build_deploy_ros_project_2/#build-offline-without-internet","title":"Build offline without internet","text":"","tags":["ros","deploy","tutorial"]},{"location":"ROS/dev_environment/build/demo/build_deploy_ros_project_2/#files","title":"files","text":"<p>rosdep files index location at <code>/etc/ros/rosdep/sources.list.d</code> the default file <code>20-default.list</code> can be download from github <code>rosdistro/rosdep/source.list.d/20-default.list</code></p> file description base.yaml system dependencies that are not ROS specific like boost, opencv python.yaml map python package name <p>bloom try to download <code>index-v4.yaml</code>  file from github rosdistro it can be override by setting the <code>ROSDISTRO_INDEX_URL</code> environment variable, the default <code>index-v4.yaml</code> map each ros distro to yaml file that also locate in rosdistro github. </p>","tags":["ros","deploy","tutorial"]},{"location":"ROS/dev_environment/build/demo/build_deploy_ros_project_2/#build-offline-rosdep-and-bloom","title":"Build Offline rosdep and bloom","text":"<ul> <li>Download base.yaml, python.yaml, index-v4.yaml and the request distribution.yaml file in our case <code>humble</code> to local folder</li> <li>update <code>20-default.list</code> file entry to point to the download file (replace http:// with file://)</li> <li>Add project_rosdep.yaml file that map the workspace packages, it can be locate in the project folder or in other central location with other projects.</li> <li>update this location in <code>/etc/ros/rosdep/sources.list.d</code> as <code>30-custom_project.list</code></li> <li>set <code>ROSDISTRO_INDEX_URL</code> to index-v4.yaml local location</li> <li>Run <code>rosdep update --rosdistro humble</code></li> <li>Run <code>bloom-generate rosdebian --ros-distro humble</code> to build</li> </ul>","tags":["ros","deploy","tutorial"]},{"location":"ROS/dev_environment/build/demo/build_deploy_ros_project_2a/","title":"ROS2 project from development to deployment, Part 2: Add udev and other system files","text":"<p>How to add additional system files to the package, like udev rules, systemd service, etc.</p>","tags":["ros","deploy","tutorial"]},{"location":"ROS/dev_environment/build/demo/build_deploy_ros_project_2a/#rules","title":"rules","text":"<p>The <code>debian/rules</code> file is a makefile that is used to build the package. It contains the instructions for building, installing, and cleaning up the package. The <code>debian/rules</code> file is generated by bloom when you run the <code>bloom-generate</code> command. You can modify it to add additional steps to the build process.</p> <p>The <code>debian/rules</code> file is a makefile that base on <code>dh</code> (debhelper) and it is used to build the package. It contains the instructions for building, installing, and cleaning up the package.</p> Command What it does <code>dh_auto_configure</code> Runs <code>./configure</code>, <code>cmake</code>, or similar <code>dh_auto_build</code> Runs <code>make</code> or equivalent <code>dh_auto_test</code> Runs test suites if available <code>dh_auto_install</code> Installs built files into <code>debian/&lt;pkg&gt;</code> staging area <code>dh_installdocs</code> Installs docs like README <code>dh_strip</code> Removes debug symbols <code>dh_builddeb</code> Builds the final <code>.deb</code> package","tags":["ros","deploy","tutorial"]},{"location":"ROS/dev_environment/build/demo/build_deploy_ros_project_2a/#demo-override-deb-location","title":"demo: override deb location","text":"<p>Add patch file to edit <code>debian/rules</code> file</p> <ul> <li>Create <code>debian_scripts</code> folder in the project root</li> <li>Create <code>patch_rule.sh</code> and <code>patch_compat.sh</code> files in the <code>debian_scripts</code> folder</li> </ul> file Description patch_rule.sh add override method like override_dh_builddeb  dh_auto_install patch_compat.sh change compat level to 10 or higher debian_scripts/patch_rule.sh<pre><code>    #!/bin/sh\n\n    cat &lt;&lt;'EOF' &gt;&gt; debian/rules\n\n    override_dh_builddeb:\n        dh_builddeb --destdir=/workspace/debs\n    EOF\n</code></pre> <p>override manual</p> <p>Add <code>dh_builddeb</code> rule to end of file</p> debian/rules<pre><code># add this to the end of the file\n\noverride_dh_builddeb:\n    dh_builddeb --destdir=/workspace/debs\n</code></pre> <p>```</p>","tags":["ros","deploy","tutorial"]},{"location":"ROS/dev_environment/build/demo/build_deploy_ros_project_2a/#compat","title":"compat","text":"<p>Bloom uses compat=9 for maximum compatibility across various buildfarm environments and older ROS build tools. the level define the debhelper futures to use.  in out case whe need to change it to 10 or higher to use the <code>--destdir</code> option.</p> debian_scripts/patch_compat.sh<pre><code>cat &lt;&lt;'EOF' &gt; debian/compat\n10\nEOF\n</code></pre> <p>VScode task</p> <p>Using vscode to run bloom , custom script and the fakeroot to build debian package.</p> <pre><code>\"version\": \"2.0.0\",\n\"tasks\": [\n    {\n        \"label\": \"build &lt;package_name&gt;\",\n        \"type\": \"shell\",\n        \"command\": \"bloom-generate rosdebian --ros-distro humble &amp;&amp; ./debian_scripts/patch_rule.sh &amp;&amp; ./debian_scripts/patch_compat.sh &amp;&amp; fakeroot debian/rules binary\",\n        \"options\": {\n            \"cwd\": \"${workspaceFolder}/src/&lt;package_name&gt;\",\n        }\n    }\n]\n</code></pre>","tags":["ros","deploy","tutorial"]},{"location":"ROS/dev_environment/build/demo/build_deploy_ros_project_2a/#demo-add-postinst-script-file","title":"Demo: Add postinst script file","text":"<p>Add postinst to debian file</p> <ul> <li>Create <code>debian_scripts</code> folder in the project root</li> <li>Create <code>patch_rule.sh</code> and <code>patch_compat.sh</code> files in the <code>debian_scripts</code> folder</li> <li>Create <code>postinst</code> file in the <code>debian_scripts</code> folder</li> </ul> debian_scripts/postinst<pre><code>#!/bin/sh\nset -e\n\n# pip install textual==1.0.0\nexit 0\n</code></pre> debian_scripts/patch_rule.sh<pre><code>#!/bin/sh\n\ncat &lt;&lt;'EOF' &gt;&gt; debian/rules\n\noverride_dh_install:\n    dh_install\n    cp \\$(CURDIR)/debian_scripts/postinst debian/postinst\n    chmod 755 debian/postinst\n\noverride_dh_builddeb:\n    dh_builddeb --destdir=/workspace/debs\nEOF\n</code></pre> <ul> <li>Add <code>override_dh_install</code> </li> <li>copy postinst file to <code>debian/postinst</code> folder</li> <li>Add permission to the postinst file</li> <li>Set <code>override_dh_builddeb</code> to copy the debian package to <code>/workspace/debs</code> folder</li> </ul> debian_scripts/patch_compat.sh<pre><code>cat &lt;&lt;'EOF' &gt; debian/compat\n10\nEOF\n</code></pre> <p>TODO: Add dpkg -I to check the package</p>","tags":["ros","deploy","tutorial"]},{"location":"ROS/dev_environment/build/demo/build_deploy_ros_project_2a/#demo-add-udev-rules","title":"Demo: Add udev rules","text":"<p>github action</p> <p>We use github actions and <code>act</code> to run it locally.</p> <p>Add udev rule to <code>/etc/udev/rules.d/</code> </p> <ul> <li>create udev rules file (put it in project root under <code>udev</code> folder)</li> <li>Add install script, this script update debian <code>rules</code> file after bloom generate</li> <li>Add step to github actions command</li> </ul> udev rules<pre><code># any udev rules file\n</code></pre> post_bloom_script.sh<pre><code>#!/bin/bash\n\ncat &lt;&lt;EOF &gt;&gt; src/&lt;package_name&gt;/debian/rules\n\noverride_dh_install:\n    mkdir -p \\$(DEBIAN)/etc/udev/rules.d\n    cp -r udev/* \\$(DEBIAN)/etc/udev/rules.d\n    dh_install\nEOF\n</code></pre> <p>check the $(DEBIAN) path</p> <p>The <code>$(DEBIAN)</code> path is the path where the debian package is created. You can check it by running the following command:</p> <p>TAB not space</p> <p>Make sure to use tab and not space in the <code>post_bloom_script.sh</code> file. You can check it using <code>cat -T</code> command.</p> github action step<pre><code>- name: Add udev rules\n  run: |\n    ./src/&lt;package_name&gt;/post_bloom_script.sh\n</code></pre> <p>TAB VSCode</p> <p>Config vscode to use tab and not spaces for shell script</p> set vscode to use tab and not spaces<pre><code>{\n    \"[shellscript]\": {\n        \"editor.insertSpaces\": false,\n        \"editor.tabSize\": 4,\n        \"editor.detectIndentation\": false\n    },\n}\n</code></pre> <p>TAB check</p> <p>Using cat to check if file contains tab or space</p> <pre><code>cat -T &lt;file&gt;\n</code></pre> <pre><code>#!/bin/bash\n\ncat &lt;&lt;EOF\n^Ia\n^Ib\nEOF\n</code></pre>","tags":["ros","deploy","tutorial"]},{"location":"ROS/dev_environment/build/demo/build_deploy_ros_project_2b/","title":"ROS2 project from development to deployment, Part 2: Using github actions to Automatic build and deploy","text":"<ul> <li>rosdep</li> <li>colcon</li> <li>bloom</li> <li>fakeroot</li> </ul> build package using github action<pre><code>name: My Action\non: [workflow_dispatch]\njobs:\n  build_pc_pkg_interface:\n    runs-on: pc\n    env:\n      PROJECT_NAME: pkg_interface\n    steps:\n      - name: rosdep\n        run: |\n          export ROSDISTRO_INDEX_URL=file://`pwd`/index-v4.yaml \\\n          &amp;&amp; export ROS_DISTRO=humble \\\n          &amp;&amp; echo \"yaml file://`pwd`/rosdep/base.yaml\" &gt; /etc/ros/rosdep/sources.list.d/20-default.list \\\n          &amp;&amp; echo \"yaml file://`pwd`/rosdep/python.yaml\" &gt;&gt; /etc/ros/rosdep/sources.list.d/20-default.list \\\n          &amp;&amp; echo \"yaml file://`pwd`/rosdep/custom_rosdep.yaml\" &gt; /etc/ros/rosdep/sources.list.d/30-custom.list \\\n          &amp;&amp; rosdep update --rosdistro humble\n      - name: colcon\n        run: | \n          colcon build --packages-up-to $PROJECT_NAME \n      - name: bloom\n        run: | \n          export ROSDISTRO_INDEX_URL=file://`pwd`/index-v4.yaml \\\n          &amp;&amp; source /opt/ros/humble/setup.bash \\\n          &amp;&amp; source install/setup.bash \\\n          &amp;&amp; cd src/$PROJECT_NAME \\\n          &amp;&amp; bloom-generate rosdebian \n      - name: fakeroot\n        run: |\n          source install/setup.bash \\\n          &amp;&amp; cd src/$PROJECT_NAME \\\n          &amp;&amp; fakeroot debian/rules binary\n</code></pre>","tags":["ros","deploy","tutorial"]},{"location":"ROS/dev_environment/build/demo/build_deploy_ros_project_3/","title":"ROS2 project from development to deployment, Part 3: Aptly, Docker and Install","text":"","tags":["ros","deploy","tutorial"]},{"location":"ROS/dev_environment/build/demo/build_deploy_ros_project_3/#aptly","title":"Aptly","text":"<p>publish the generate <code>deb</code> package with aptly</p>","tags":["ros","deploy","tutorial"]},{"location":"ROS/dev_environment/build/demo/build_deploy_ros_project_3/#test-docker","title":"Test Docker","text":"<p>Use Prod docker as base share volume </p>","tags":["ros","deploy","tutorial"]},{"location":"ROS/dev_environment/build/demo/build_deploy_ros_project_5/","title":"ROS2 project from development to deployment, Part 4: Cross Compiler","text":"","tags":["ros","deploy","tutorial","cross-compile","mixing"]},{"location":"ROS/dev_environment/build/demo/build_deploy_ros_project_5/#in-progress","title":"In progress","text":"<p>Build package for nvidia jetson using cross compiler using colcon mixin to set cross compiler flags</p>","tags":["ros","deploy","tutorial","cross-compile","mixing"]},{"location":"ROS/dev_environment/build/demo/build_deploy_ros_project_5/#download-and-install-cross-compiler","title":"Download and install cross compiler","text":"<p>Download toolchain from jetpack 6.2</p> <p>toolchain</p> <p>Every jetpack has it own toolchain, so make sure to download the correct one.</p> <p>The toolchain url can be build from</p> <p>get jetson linux version<pre><code>cat /etc/nv_tegra_release\n#\n# R36 (release), REVISION: 4.3,\n</code></pre> <pre><code>https://developer.nvidia.com/embedded/jetson-linux-r3643\n</code></pre></p>","tags":["ros","deploy","tutorial","cross-compile","mixing"]},{"location":"ROS/dev_environment/build/demo/build_deploy_ros_project_5/#build-rootfs","title":"Build rootfs","text":"<p>Build rootfs using Debootstrap</p>","tags":["ros","deploy","tutorial","cross-compile","mixing"]},{"location":"ROS/dev_environment/build/demo/build_deploy_ros_project_5/#config-mixin","title":"config mixin","text":"mixin file<pre><code>mixins:\n  cross-arm64:\n    build-args:\n      cmake:\n        - -DCMAKE_TOOLCHAIN_FILE=/path/to/aarch64_toolchain.cmake\n        - -DCMAKE_CXX_FLAGS=\"--sysroot=/path/to/arm64/sysroot\"\n        - -DCMAKE_C_FLAGS=\"--sysroot=/path/to/arm64/sysroot\"\n        - -DCMAKE_EXE_LINKER_FLAGS=\"--sysroot=/path/to/arm64/sysroot\"\n</code></pre> register mixing file<pre><code>colcon mixin add cross_compile ./cross_compile.mixin\ncolcon mixin update\n</code></pre> usage<pre><code>colcon build --mixin cross-arm64\n</code></pre>","tags":["ros","deploy","tutorial","cross-compile","mixing"]},{"location":"ROS/dev_environment/build/demo/build_deploy_ros_project_5/#demo","title":"Demo","text":"<p>aarch64.cmake<pre><code>set(CMAKE_SYSTEM_NAME Linux)\nset(CMAKE_SYSTEM_PROCESSOR aarch64)  # Change to match your target architecture\nset(CROSS_COMPILER_PATH /home/user/cross_compilers/aarch64--glibc--stable-2022.08-1)\n# Set cross-compiler paths\nset(CMAKE_C_COMPILER ${CROSS_COMPILER_PATH}/bin/${CMAKE_SYSTEM_PROCESSOR}-buildroot-linux-gnu-gcc)\nset(CMAKE_CXX_COMPILER ${CROSS_COMPILER_PATH}/bin/${CMAKE_SYSTEM_PROCESSOR}-linux-gnu-g++)\nset(CMAKE_SYSROOT /home/user/rootfs/ubuntuRootFS)  # Set to your root filesystem\n\n# Set where CMake should look for libraries and headers\nset(CMAKE_FIND_ROOT_PATH ${CMAKE_SYSROOT} ${CMAKE_SYSROOT}/usr ${CMAKE_SYSROOT}/usr/local)\n\n# Only search inside the target rootfs\nset(CMAKE_FIND_ROOT_PATH_MODE_PROGRAM NEVER)\nset(CMAKE_FIND_ROOT_PATH_MODE_LIBRARY ONLY)\nset(CMAKE_FIND_ROOT_PATH_MODE_INCLUDE ONLY)\n\n# ROS 2 paths\nset(AMENT_PREFIX_PATH ${CMAKE_SYSROOT}/opt/ros/humble)\nset(CMAKE_PREFIX_PATH ${AMENT_PREFIX_PATH})\n</code></pre> ` Humble ARM64 cross compiler<pre><code>mixins:\n  cross-arm64:\n    build-args:\n      cmake:\n        - -DCMAKE_TOOLCHAIN_FILE=/opt/cross_toolchain/aarch64.cmake\n</code></pre></p>","tags":["ros","deploy","tutorial","cross-compile","mixing"]},{"location":"ROS/dev_environment/dev/","title":"Using VSCode devcontainer and docker as dev environment","text":"<p>devcontainer</p> <p>remote</p> <p>projects template</p>","tags":["ros","vscode","docker","devcontainer","dev environment"]},{"location":"ROS/dev_environment/dev/#project-docker-images","title":"Project Docker images","text":"","tags":["ros","vscode","docker","devcontainer","dev environment"]},{"location":"ROS/dev_environment/dev/#common-ros-image","title":"Common ROS image","text":"<p>Docker file base on <code>ubuntu</code> base image version depend on ROS version.  It can be base on <code>nvidia</code> cuda image.</p> <p>The image include <code>ros core</code> installation and common dev tools , it add none root user name <code>user</code> (id 1000)</p> <p>TBD: include gazebo in the image (current version include it)</p>","tags":["ros","vscode","docker","devcontainer","dev environment"]},{"location":"ROS/dev_environment/dev/#project-runtime","title":"Project runtime","text":"<p>Docker file base on <code>common_ros</code> image, it include all project dependencies <code>deb</code>,<code>python</code> and others. It use for check project debian (deb) package installation. The main propose it to be the docker image for Application/project production deployment. TBD: use this image for CI/CD</p>","tags":["ros","vscode","docker","devcontainer","dev environment"]},{"location":"ROS/dev_environment/dev/#project-devbuild","title":"Project Dev/Build","text":"<p>Docker file base on <code>runtime</code> image, it include all other tool for development, test and build. Include ROS dev tools and other helper tools for day to day development.</p>","tags":["ros","vscode","docker","devcontainer","dev environment"]},{"location":"ROS/dev_environment/dev/#ongoing","title":"Ongoing","text":"<p>Dockerfile That use by <code>devcontainer</code> it lite Dockerfile for all things and ongoing installation. The idea is to move the ongoing installation and settings to the project runtime and dev images. Keep the <code>devcontainer</code> Dockerfile lite and fast to build.</p> <p>TBD</p> <p>Separate the <code>ros common</code> image to <code>OS</code> and <code>ROS Core</code> images.</p>","tags":["ros","vscode","docker","devcontainer","dev environment"]},{"location":"ROS/dev_environment/dev/dev_container/","title":"VSCode Devcontainer for ROS application","text":"","tags":["ros","vscode","devcontainer"]},{"location":"ROS/dev_environment/dev/dev_container/#project","title":"Project","text":"<pre><code>.\n\u251c\u2500\u2500 .devcontainer\n\u2502   \u251c\u2500\u2500 devcontainer.json\n\u2502   \u251c\u2500\u2500 Dockerfile.humble_dev\n\u2502   \u251c\u2500\u2500 .tmux.conf\n|   \u2514\u2500\u2500 Dockerfile\n\u251c\u2500\u2500 docker-compose.yaml\n\u251c\u2500\u2500 readme.md\n\u2514\u2500\u2500 src\n</code></pre>","tags":["ros","vscode","devcontainer"]},{"location":"ROS/dev_environment/dev/dev_container/#base-docker","title":"Base docker","text":"<ul> <li>ubuntu 22.04</li> <li>ros humble base</li> <li>gazebo11</li> </ul> dockerfile.humble_dev <pre><code># https://github.com/athackst/dockerfiles/blob/main/ros2/humble.Dockerfile\n# docker build -f .devcontainer/Dockerfile.humble_dev --target gazebo_dev -t humble:dev .\n# docker build -f .devcontainer/Dockerfile.humble_cuda_dev --target gazebo_dev -t humble/cuda/devel:dev .\n\n###########################################\n# Base image\n###########################################\nARG BASE_IMAGE=\"ubuntu:22.04\"\nARG IMAGE_VERSION=\"1.0\"\n\nFROM ${BASE_IMAGE} AS base\n\nENV DEBIAN_FRONTEND=noninteractive\n\nRUN echo ${IMAGE_VERSION} &gt; /etc/ros_image_version\n\n# Install language\nRUN apt-get update &amp;&amp; apt-get install -y \\\n  locales \\\n  &amp;&amp; locale-gen en_US.UTF-8 \\\n  &amp;&amp; update-locale LC_ALL=en_US.UTF-8 LANG=en_US.UTF-8 \\\n  &amp;&amp; rm -rf /var/lib/apt/lists/*\nENV LANG en_US.UTF-8\n\n# Install timezone\nRUN ln -fs /usr/share/zoneinfo/UTC /etc/localtime \\\n  &amp;&amp; export DEBIAN_FRONTEND=noninteractive \\\n  &amp;&amp; apt-get update \\\n  &amp;&amp; apt-get install -y tzdata \\\n  &amp;&amp; dpkg-reconfigure --frontend noninteractive tzdata \\\n  &amp;&amp; rm -rf /var/lib/apt/lists/*\n\nRUN apt-get update &amp;&amp; apt-get -y upgrade \\\n    &amp;&amp; rm -rf /var/lib/apt/lists/*\n\n# Install common programs\nRUN apt-get update &amp;&amp; apt-get install -y --no-install-recommends \\\n    curl \\\n    gnupg2 \\\n    lsb-release \\\n    sudo \\\n    software-properties-common \\\n    wget \\\n    &amp;&amp; rm -rf /var/lib/apt/lists/*\n\n# Install ROS2\nRUN sudo add-apt-repository universe \\\n  &amp;&amp; curl -sSL https://raw.githubusercontent.com/ros/rosdistro/master/ros.key -o /usr/share/keyrings/ros-archive-keyring.gpg \\\n  &amp;&amp; echo \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/ros-archive-keyring.gpg] http://packages.ros.org/ros2/ubuntu $(. /etc/os-release &amp;&amp; echo $UBUNTU_CODENAME) main\" | sudo tee /etc/apt/sources.list.d/ros2.list &gt; /dev/null \\\n  &amp;&amp; apt-get update &amp;&amp; apt-get install -y --no-install-recommends \\\n    ros-humble-ros-base \\\n    python3-argcomplete \\\n  &amp;&amp; rm -rf /var/lib/apt/lists/*\n\nENV ROS_DISTRO=humble\nENV AMENT_PREFIX_PATH=/opt/ros/humble\nENV COLCON_PREFIX_PATH=/opt/ros/humble\nENV LD_LIBRARY_PATH=/opt/ros/humble/lib\nENV PATH=/opt/ros/humble/bin:$PATH\nENV PYTHONPATH=/opt/ros/humble/local/lib/python3.10/dist-packages:/opt/ros/humble/lib/python3.10/site-packages\nENV ROS_PYTHON_VERSION=3\nENV ROS_VERSION=2\nENV DEBIAN_FRONTEND=\n\n\n###########################################\n#  Develop image\n###########################################\nFROM base AS dev\n\nENV DEBIAN_FRONTEND=noninteractive\nRUN apt-get update &amp;&amp; apt-get install -y --no-install-recommends \\\n  bash-completion \\\n  build-essential \\\n  cmake \\\n  gdb \\\n  git \\\n  openssh-client \\\n  python3-argcomplete \\\n  python3-pip \\\n  python-is-python3 \\\n  ros-dev-tools \\\n  ros-humble-ament-* \\\n  vim \\\n  ## ros\n  python3-colcon-clean \\\n  ros-humble-rmw-cyclonedds-cpp \\\n  ## dev\n  tmux \\\n  tmuxp \\\n  ## build\n  python3-bloom \\\n  python3-rosdep \\\n  fakeroot \\\n  debhelper \\\n  dh-python \\\n  &amp;&amp; rm -rf /var/lib/apt/lists/*\n\nCOPY .devcontainer/.tmux.conf /etc/tmux.conf\nRUN rosdep init || echo \"rosdep already initialized\"\n\nARG USERNAME=user\nARG USER_UID=1000\nARG USER_GID=$USER_UID\n\n# Create a non-root user\nRUN groupadd --gid $USER_GID $USERNAME \\\n  &amp;&amp; useradd -s /bin/bash --uid $USER_UID --gid $USER_GID -m $USERNAME \\\n  # Add sudo support for the non-root user\n  &amp;&amp; apt-get update \\\n  &amp;&amp; apt-get install -y sudo \\\n  &amp;&amp; echo $USERNAME ALL=\\(root\\) NOPASSWD:ALL &gt; /etc/sudoers.d/$USERNAME\\\n  &amp;&amp; chmod 0440 /etc/sudoers.d/$USERNAME \\\n  &amp;&amp; rm -rf /var/lib/apt/lists/*\n\n# Set up autocompletion for user\nRUN apt-get update &amp;&amp; apt-get install -y git-core bash-completion \\\n  &amp;&amp; echo \"if [ -f /opt/ros/${ROS_DISTRO}/setup.bash ]; then source /opt/ros/${ROS_DISTRO}/setup.bash; fi\" &gt;&gt; /home/$USERNAME/.bashrc \\\n  &amp;&amp; echo \"if [ -f /usr/share/colcon_argcomplete/hook/colcon-argcomplete.bash ]; then source /usr/share/colcon_argcomplete/hook/colcon-argcomplete.bash; fi\" &gt;&gt; /home/$USERNAME/.bashrc \\\n  &amp;&amp; rm -rf /var/lib/apt/lists/* \n\nENV DEBIAN_FRONTEND=\nENV AMENT_CPPCHECK_ALLOW_SLOW_VERSIONS=1\n\n\n###########################################\n#  Dev+Gazebo image\n###########################################\nFROM dev AS gazebo_dev\n\nENV DEBIAN_FRONTEND=noninteractive\n# Install gazebo classic\n# install gazebo classic dev library\n# install ros humble gazebo classic plugins\nRUN wget https://packages.osrfoundation.org/gazebo.gpg -O /usr/share/keyrings/pkgs-osrf-archive-keyring.gpg \\\n  &amp;&amp; echo \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/pkgs-osrf-archive-keyring.gpg] http://packages.osrfoundation.org/gazebo/ubuntu-stable $(lsb_release -cs) main\" | sudo tee /etc/apt/sources.list.d/gazebo-stable.list &gt; /dev/null \\\n  &amp;&amp; apt-get update &amp;&amp; apt-get install -q -y --no-install-recommends \\\n    gazebo \\\n    libgazebo-dev \\\n    ros-humble-gazebo-ros-pkgs \\\n  &amp;&amp; rm -rf /var/lib/apt/lists/*\nENV DEBIAN_FRONTEND=\n\nRUN echo \"base ROS humble image with gazebo classic : ${IMAGE_VERSION}\"&gt;/etc/ros_image_version\n</code></pre> build command <pre><code>docker build -t humble:dev -f .devcontainer/Dockerfile.humble_dev .\n</code></pre>","tags":["ros","vscode","devcontainer"]},{"location":"ROS/dev_environment/dev/dev_container/#dockerfile","title":"Dockerfile","text":"<pre><code>FROM humble:dev\n\nARG VERSION=0.0.1\n\n\nRUN echo \"image dev version: ${VERSION}\"&gt;/etc/docker_image_dev_version\n</code></pre>","tags":["ros","vscode","devcontainer"]},{"location":"ROS/dev_environment/dev/dev_container/#docker-compose","title":"Docker Compose","text":"docker-compose.yml","tags":["ros","vscode","devcontainer"]},{"location":"ROS/dev_environment/dev/dev_container/#devcontainer","title":"devcontainer","text":"devcontainer.json<pre><code>{\n  \"name\": \"gst_stream\",\n  \"dockerComposeFile\": \"../docker-compose.yaml\",\n  \"service\": \"dev\",\n  \"shutdownAction\": \"stopCompose\",\n  \"workspaceFolder\": \"/workspace\",\n  \"remoteUser\": \"user\",\n  \"customizations\": {\n    \"vscode\": {\n      \"extensions\": [],\n      \"settings\": {}\n    }\n  }\n}\n</code></pre> dockerComposeFile service shutdownAction workdpaceFolder","tags":["ros","vscode","devcontainer"]},{"location":"ROS/dev_environment/dev/dev_container/#other-files","title":"Other files","text":".tmux.conf <pre><code># unbind\nunbind C-b\nunbind '\"'\nunbind %\n\n# base1 numbering\nset -g base-index 1\nsetw -g pane-base-index 1\n\n#bind ctrl-a as a prefix\nset-option -g prefix C-a\nbind-key C-a send-prefix\n# kill session\nbind C-c kill-session\n\nbind C-a run \"tmux save-buffer - | xclip -i -sel clipboard\"\n\n# mouse\nset -g mouse on\n\n\n # do like terminator\nbind -n C-E split-window -h\nbind -n C-S-Left resize-pane -L 3\nbind -n C-S-Right resize-pane -R 3\nbind -n C-S-Up resize-pane -U 3\nbind -n C-S-Down resize-pane -D 3\nbind -n C-O split-window -v\n\n# switch panes using Alt-arrow without prefix (not working)\nbind -n M-Left select-pane -L\nbind -n M-Right select-pane -R\nbind -n M-Up select-pane -U\nbind -n M-Down select-pane -D\n\n# Shift arrow to switch windows\n\nbind n next-window\nbind p previous-window\n\nbind c new-window -c \"#{pane_current_path}\"\n\nbind r source-file ~/.tmux.conf\n\n# settings\n</code></pre>","tags":["ros","vscode","devcontainer"]},{"location":"ROS/dev_environment/dev/project_templates/","title":"Ros2 projects templates","text":"<p>multi container</p> <p>TBD</p> <p>TBD</p>","tags":["ros","vscode","docker","devcontainer","docker compose","projects"]},{"location":"ROS/dev_environment/dev/project_templates/#ros2-jezzy","title":"ROS2 jezzy","text":"<pre><code>\u251c\u2500\u2500 .devcontainer\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 devcontainer.json\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 Dockerfile.jazzy\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 Dockerfile.runtime\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 Dockerfile.dev\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 Dockerfile\n\u251c\u2500\u2500 .vscode\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 tasks.json\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 settings.json\n\u251c\u2500\u2500 docker-compose.yml\n\u251c\u2500\u2500 .gitignore\n\u251c\u2500\u2500 README.md\n\u251c\u2500\u2500 colcon_defaults.md\n\u251c\u2500\u2500 env.sh\n\u2514\u2500\u2500 src\n</code></pre> .devcontainer/Dockerfile.jazzy .devcontainer/devcontainer.json <pre><code>{\n    \"name\": \"gz_tutorial\",\n    \"dockerComposeFile\": \"../docker-compose.yaml\",\n    \"service\": \"ros\",\n    \"shutdownAction\": \"stopCompose\",\n    \"workspaceFolder\": \"/workspace\",\n    \"remoteUser\": \"user\",\n    \"customizations\": {\n      \"vscode\": {\n        \"extensions\": [\n            \"ms-python.python\",\n            \"ms-vscode.cpptools\",\n            \"twxs.cmake\",\n            \"redhat.vscode-xml\",\n            \"redhat.vscode-yaml\",\n            \"albert.tabout\",\n            \"actboy168.tasks\",\n            \"streetsidesoftware.code-spell-checker\",\n            \"mhutchie.git-graph\",\n            \"dlech.chmod\",\n            \"smilerobotics.urdf\"\n        ],\n        \"settings\": {}\n      }\n    }\n  }\n</code></pre> docker-compose.yaml <pre><code>services:\n  ros:\n    image: jazzy:base\n    user: \"user:user\"\n    volumes:\n      - .:/workspace:cached\n      - /tmp/.X11-unix:/tmp/.X11-unix:rw \n      - /dev/dri:/dev/dri \n      - /dev/nvidia0:/dev/nvidia0 \n      - /dev/nvidiactl:/dev/nvidiactl \n      - /dev/nvidia-modeset:/dev/nvidia-modeset \n    deploy:\n      resources:\n        reservations:\n          devices:\n            - capabilities: [gpu]\n    hostname: ros\n    extra_hosts:\n      - \"ros:127.0.0.1\"\n    network_mode: host\n    stdin_open: true\n    tty: true\n    environment:\n      - DISPLAY=${DISPLAY}\n      - QT_X11_NO_MITSHM=1\n      - GZ_TRANSPORT_IP=ros\n      - GZ_DISCOVERY_SERVER=gazebo\n      - GZ_PARTITION=my_simulation\n    devices:\n      - /dev/dri:/dev/dri\n</code></pre>","tags":["ros","vscode","docker","devcontainer","docker compose","projects"]},{"location":"ROS/dev_environment/dev/project_templates/#ros","title":"ros","text":"env.sh<pre><code>source /home/ros/.bashrc\nsource /opt/ros/jazzy/setup.bash\nsource install/setup.bash\necho '\ud83d\udc22 Environment ready!'\n# bash key bindings\n# replace bringup with full bringup name\nbind '\"\\C-b\": \"ros2 launch &lt;bringup&gt;\"'\n\n# Function to get git branch\nparse_git_branch() {\n    git branch 2&gt; /dev/null | sed -e '/^[^*]/d' -e 's/* \\(.*\\)/[\\1]/'\n}\n\n# Custom PS1 with turtle icon and git branch\nexport PS1=\"\ud83d\udc22 \\[\\033[32m\\]\\u@\\h\\[\\033[00m\\]:\\[\\033[34m\\]\\w\\[\\033[33m\\]\\$(parse_git_branch)\\[\\033[00m\\]\\$ \"\n</code></pre> colcon_defaults.yaml<pre><code>build:\n  # Use symlink install to speed up builds\n  symlink-install: true\n  # Set build type (e.g., Release or Debug)\n  cmake-args:\n    - \"-DCMAKE_BUILD_TYPE=Release\"\n\ntest:\n  # Run tests in parallel\n  parallel-workers: 4\n\n# Additional settings for colcon test and other commands\ntest-result:\n  verbose: true\n</code></pre>","tags":["ros","vscode","docker","devcontainer","docker compose","projects"]},{"location":"ROS/dev_environment/dev/project_templates/#vscode","title":"VSCode","text":"","tags":["ros","vscode","docker","devcontainer","docker compose","projects"]},{"location":"ROS/dev_environment/dev/project_templates/#tasksjson","title":"tasks.json","text":".vscode/tasks.json<pre><code>{\n    \"version\": \"2.0.0\",\n    \"tasks\": [\n      {\n        \"label\": \"colcon\",\n        \"detail\": \"Build all ros2 packages using colcon\",\n        \"type\": \"shell\",\n        \"command\": \"colcon build\",\n        \"problemMatcher\": [],\n        \"group\": {\n            \"kind\": \"build\",\n            \"isDefault\": true\n        }\n      }\n    ]\n}\n</code></pre> .vscode/settings.json<pre><code>{\n    \"terminal.integrated.profiles.linux\": {\n      \"bash\": {\n          \"path\": \"bash\",\n          \"icon\": \"terminal-bash\",\n          \"args\": [\"--rcfile\", \"env.sh\"]\n      }\n  },\n   \"python.autoComplete.extraPaths\": [\n        \"${workspaceFolder}/install/**\",\n        \"/opt/ros/humble/lib/python3.10/site-packages/\",\n        \"/opt/ros/humble/local/lib/python3.10/dist-packages\"\n\n    ],\n\n    \"python.analysis.extraPaths\": [\n        \"${workspaceFolder}/install/**\",\n        \"/opt/ros/humble/lib/python3.10/site-packages/\",\n        \"/opt/ros/humble/local/lib/python3.10/dist-packages/\",\n    ]\n\n}\n</code></pre>","tags":["ros","vscode","docker","devcontainer","docker compose","projects"]},{"location":"ROS/dev_environment/dev/project_templates/multi_containers/","title":"Multi docker workspace using docker compose","text":"<p>ROS / dev environment / dev / project templates</p> <p>Run multiple docker using docker compose</p>","tags":["ros","workspace","docker","gazebo","compose"]},{"location":"ROS/dev_environment/dev/project_templates/multi_containers/#demo","title":"Demo","text":"<p>Run ROS jazzy in one docker container and gazebo harmonic in the another container</p>","tags":["ros","workspace","docker","gazebo","compose"]},{"location":"ROS/dev_environment/dev/project_templates/multi_containers/#jazzy-docker-file","title":"Jazzy docker file","text":"<ul> <li>Add ros-gz-bridge</li> <li>Add gazebo repo and install libgz-transport13</li> </ul> <pre><code># install gazebo transport\n# transport13 for harmonic version\nRUN apt-get update &amp;&amp; apt-get install -q -y \\\n    curl \\\n    gnupg \\\n    lsb-release \\\n    python3-argcomplete \\\n    sudo \\\n    wget \\\n  &amp;&amp; wget https://packages.osrfoundation.org/gazebo.gpg -O /usr/share/keyrings/pkgs-osrf-archive-keyring.gpg \\\n  &amp;&amp; echo \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/pkgs-osrf-archive-keyring.gpg] http://packages.osrfoundation.org/gazebo/ubuntu-stable $(lsb_release -cs) main\" | tee /etc/apt/sources.list.d/gazebo-stable.list &gt; /dev/null \\\n  &amp;&amp; apt-get update &amp;&amp; apt-get install -y -q \\\n    libgz-transport13 \\\n  &amp;&amp; rm -rf /var/lib/apt/lists/*\n\n# install bridge\nRUN apt-get update &amp;&amp; apt-get install -y --no-install-recommends \\\n    ros-jazzy-ros-gz-bridge \\\n  &amp;&amp; rm -rf /var/lib/apt/lists/*\n</code></pre> devontainer.json<pre><code>{\n    \"name\": \"multi\",\n    \"dockerComposeFile\": \"../docker-compose.yaml\",\n    \"service\": \"ros\",\n    \"runServices\": [\"ros\", \"gazebo\"],\n}\n</code></pre> docker-compose.yaml<pre><code>services:\n  ros:\n    build:\n      context: .\n      dockerfile: .devcontainer/Dockerfile\n    user: \"ros:ros\"\n    volumes:\n      - .:/workspace:cached\n      - /tmp/.X11-unix:/tmp/.X11-unix:rw \n      - /dev/dri:/dev/dri \n      - /dev/nvidia0:/dev/nvidia0 \n      - /dev/nvidiactl:/dev/nvidiactl \n      - /dev/nvidia-modeset:/dev/nvidia-modeset \n    deploy:\n      resources:\n        reservations:\n          devices:\n            - capabilities: [gpu]\n    hostname: ros\n    networks: [sim_net]\n    stdin_open: true\n    tty: true\n    environment:\n      - DISPLAY=${DISPLAY}\n      - XAUTHORITY=${XAUTHORITY}\n      # - LIBGL_ALWAYS_SOFTWARE=1  # Force software rendering\n      - MESA_GL_VERSION_OVERRIDE=3.3\n      - QT_X11_NO_MITSHM=1\n      - GZ_RENDER_ENGINE=ogre2\n      - GZ_TRANSPORT_IP=gazebo\n      - GZ_DISCOVERY_SERVER=gazebo\n      - GZ_PARTITION=my_simulation\n    devices:\n      - /dev/dri:/dev/dri\n  gazebo:\n    build:\n      context: .\n      dockerfile: .devcontainer/Dockerfile.harmonic\n      target: base\n    networks: [sim_net]\n    user: user\n    stdin_open: true\n    tty: true\n    hostname: gz\n    environment:\n      - DISPLAY=${DISPLAY}\n      - QT_X11_NO_MITSHM=1\n      - NVIDIA_VISIBLE_DEVICES=all\n      - NVIDIA_DRIVER_CAPABILITIES=all\n      - GZ_TRANSPORT_IP=gazebo\n      - GZ_DISCOVERY_SERVER=gazebo\n      - GZ_PARTITION=my_simulation\n    volumes:\n      - .:/workspace:cached\n      - ./.gz:/home/user/.gz:cached\n      - /tmp/.X11-unix:/tmp/.X11-unix:rw \n      - /dev/dri:/dev/dri \n      - /dev/nvidia0:/dev/nvidia0 \n      - /dev/nvidiactl:/dev/nvidiactl \n      - /dev/nvidia-modeset:/dev/nvidia-modeset \n    deploy:\n      resources:\n        reservations:\n          devices:\n            - capabilities: [gpu]\nnetworks:\n  sim_net:\n    driver: bridge\n</code></pre>","tags":["ros","workspace","docker","gazebo","compose"]},{"location":"ROS/dev_environment/dev/project_templates/multi_containers/#usage","title":"Usage","text":"<p>Bridge <code>Clock</code></p>","tags":["ros","workspace","docker","gazebo","compose"]},{"location":"ROS/dev_environment/dev/project_templates/multi_containers/#terminal-1-gazebo","title":"Terminal 1 (gazebo)","text":"<p>Get gazebo side terminal using</p> <pre><code># from project workspace\ndocker compose exec gazebo bash\n#\n# run empty world\ngz sim -v4 -r\n</code></pre>","tags":["ros","workspace","docker","gazebo","compose"]},{"location":"ROS/dev_environment/dev/project_templates/multi_containers/#terminal-2-ros","title":"Terminal 2 (ros)","text":"<pre><code>ros2 run ros_gz_bridge parameter_bridge /clock@rosgraph_msgs/msg/Clock[gz.msgs.Clock\n</code></pre>","tags":["ros","workspace","docker","gazebo","compose"]},{"location":"ROS/dev_environment/dev/project_templates/multi_containers/#terminal-3-ros","title":"Terminal 3 (ros)","text":"<pre><code>ros2 topic echo /clock\n#\n---\nclock:\n  sec: 2028\n  nanosec: 785000000\n---\n</code></pre>","tags":["ros","workspace","docker","gazebo","compose"]},{"location":"ROS/dev_environment/dev/remote_ssh/","title":"Using VSCode remote","text":"","tags":["ros","dev","vscode","remote"]},{"location":"ROS/dev_environment/dev/remote_ssh/#ssh-configuration","title":"ssh configuration","text":".ssh/config<pre><code>Host myserver\n  HostName 10.0.0.4\n  Port 22\n  User user\n  ForwardX11 yes\n  ForwardX11Trusted yes\n</code></pre>","tags":["ros","dev","vscode","remote"]},{"location":"ROS/dev_environment/gdb_debug/","title":"GDB Debugging in ROS2","text":"<p>to read</p>","tags":["ros","gdb","debug"]},{"location":"ROS/dev_environment/prod/","title":"ROS Production","text":"<p>Config / Install and Environment variable for ROS Production system</p>","tags":["ros","production"]},{"location":"ROS/dev_environment/prod/#install","title":"Install","text":"","tags":["ros","production"]},{"location":"ROS/dev_environment/prod/#os-settings","title":"OS Settings","text":"<ul> <li>net.core.rmem_max</li> <li>net.core.rmem_default</li> </ul>","tags":["ros","production"]},{"location":"ROS/dev_environment/prod/#environment-variables","title":"Environment Variables","text":"<ul> <li>RMW_IMPLEMENTATION</li> <li>CYCLONEDDS_URI</li> </ul>","tags":["ros","production"]},{"location":"ROS/dev_environment/ros_docker/","title":"Using Docker for ROS2 Development","text":"<p>Images</p> <p>Devices</p> <p>Nvidia</p>","tags":["ros2","docker"]},{"location":"ROS/dev_environment/ros_docker/docker_devices/","title":"Connect devices to docker","text":"<p>How to run docker with devices like camera joysticks and other peripherals.</p> <ul> <li>Must watch and read</li> </ul>","tags":["ros","docker","devices"]},{"location":"ROS/dev_environment/ros_docker/docker_images/","title":"ROS Docker Images for humble and jazzy","text":"<p>Humble</p> <p>Jazzy</p> <p>TBD</p>","tags":["docker","ros","image"]},{"location":"ROS/dev_environment/ros_docker/docker_images/#humble","title":"Humble","text":"","tags":["docker","ros","image"]},{"location":"ROS/dev_environment/ros_docker/docker_images/#humble-base","title":"Humble base","text":"<ul> <li>ros-base</li> <li>build tools</li> <li>ros build tools</li> <li>basic system utilities</li> <li>add none-root user</li> </ul> Dockerfile ROS humble  <pre><code>##############################################\n# base on allision https://github.com/athackst/dockerfiles/blob/main/ros2/humble.Dockerfile\n##############################################\n\n###########################################\n# Base image\n###########################################\nFROM ubuntu:22.04 AS base\n\nENV DEBIAN_FRONTEND=noninteractive\n\n# Install language\nRUN apt-get update &amp;&amp; apt-get install -y --no-install-recommends \\\n  locales \\\n  &amp;&amp; locale-gen en_US.UTF-8 \\\n  &amp;&amp; update-locale LC_ALL=en_US.UTF-8 LANG=en_US.UTF-8 \\\n  &amp;&amp; rm -rf /var/lib/apt/lists/*\nENV LANG=en_US.UTF-8\n\n# Install timezone\nRUN ln -fs /usr/share/zoneinfo/UTC /etc/localtime \\\n  &amp;&amp; export DEBIAN_FRONTEND=noninteractive \\\n  &amp;&amp; apt-get update \\\n  &amp;&amp; apt-get install -y --no-install-recommends tzdata \\\n  &amp;&amp; dpkg-reconfigure --frontend noninteractive tzdata \\\n  &amp;&amp; rm -rf /var/lib/apt/lists/*\n\nRUN apt-get update &amp;&amp; apt-get -y upgrade \\\n    &amp;&amp; rm -rf /var/lib/apt/lists/*\n\n# Install common programs\nRUN apt-get update &amp;&amp; apt-get install -y --no-install-recommends \\\n    curl \\\n    gnupg2 \\\n    lsb-release \\\n    sudo \\\n    software-properties-common \\\n    wget \\\n    &amp;&amp; rm -rf /var/lib/apt/lists/*\n\n# Install ROS2\nRUN sudo add-apt-repository universe \\\n  &amp;&amp; curl -sSL https://raw.githubusercontent.com/ros/rosdistro/master/ros.key -o /usr/share/keyrings/ros-archive-keyring.gpg \\\n  &amp;&amp; echo \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/ros-archive-keyring.gpg] http://packages.ros.org/ros2/ubuntu $(. /etc/os-release &amp;&amp; echo $UBUNTU_CODENAME) main\" | sudo tee /etc/apt/sources.list.d/ros2.list &gt; /dev/null \\\n  &amp;&amp; apt-get update &amp;&amp; apt-get install -y --no-install-recommends \\\n    ros-humble-ros-base \\\n    python3-argcomplete \\\n  &amp;&amp; rm -rf /var/lib/apt/lists/*\n\nENV ROS_DISTRO=humble\nENV AMENT_PREFIX_PATH=/opt/ros/humble\nENV COLCON_PREFIX_PATH=/opt/ros/humble\nENV LD_LIBRARY_PATH=/opt/ros/humble/lib/x86_64-linux-gnu:/opt/ros/humble/lib\nENV PATH=/opt/ros/humble/bin:$PATH\nENV PYTHONPATH=/opt/ros/humble/local/lib/python3.10/dist-packages:/opt/ros/humble/lib/python3.10/site-packages\nENV ROS_PYTHON_VERSION=3\nENV ROS_VERSION=2\nENV ROS_AUTOMATIC_DISCOVERY_RANGE=SUBNET\nENV DEBIAN_FRONTEND=\n###########################################\n#  Develop image\n###########################################\nFROM base AS dev\n\nENV DEBIAN_FRONTEND=noninteractive\nRUN apt-get update &amp;&amp; apt-get install -y --no-install-recommends \\\n  bash-completion \\\n  build-essential \\\n  cmake \\\n  gdb \\\n  git \\\n  openssh-client \\\n  python3-argcomplete \\\n  python3-pip \\\n  python-is-python3 \\\n  tmux \\\n  tmuxp \\\n  vim \\\n  &amp;&amp; rm -rf /var/lib/apt/lists/*\n\nRUN rosdep init || echo \"rosdep already initialized\"\n\nARG USERNAME=user\nARG USER_UID=1000\nARG USER_GID=$USER_UID\n\n# Check if \"ubuntu\" user exists, delete it if it does, then create the desired user\nRUN if getent passwd ubuntu &gt; /dev/null 2&gt;&amp;1; then \\\n        userdel -r ubuntu &amp;&amp; \\\n        echo \"Deleted existing ubuntu user\"; \\\n    fi &amp;&amp; \\\n    groupadd --gid $USER_GID $USERNAME &amp;&amp; \\\n    useradd -s /bin/bash --uid $USER_UID --gid $USER_GID -m $USERNAME &amp;&amp; \\\n    echo \"Created new user $USERNAME\"\n\n# Add sudo support for the non-root user\nRUN apt-get update &amp;&amp; apt-get install -y sudo \\\n  &amp;&amp; echo $USERNAME ALL=\\(root\\) NOPASSWD:ALL &gt; /etc/sudoers.d/$USERNAME\\\n  &amp;&amp; chmod 0440 /etc/sudoers.d/$USERNAME \\\n  &amp;&amp; rm -rf /var/lib/apt/lists/*\n\n\n\nENV AMENT_CPPCHECK_ALLOW_SLOW_VERSIONS=1\n\n\n# Install the full release\nRUN apt-get update &amp;&amp; apt-get install -y --no-install-recommends \\\n  ros-humble-ros-base \\\n  ros-humble-rmw-cyclonedds-cpp \\\n  ros-dev-tools \\\n  python3-colcon-clean \\\n  ros-humble-ament-* \\\n  &amp;&amp; rm -rf /var/lib/apt/lists/*\nENV DEBIAN_FRONTEND=\n\n# Set up autocompletion for user\nRUN apt-get update &amp;&amp; apt-get install -y --no-install-recommends git-core bash-completion \\\n  &amp;&amp; echo \"if [ -f /opt/ros/${ROS_DISTRO}/setup.bash ]; then source /opt/ros/${ROS_DISTRO}/setup.bash; fi\" &gt;&gt; /home/$USERNAME/.bashrc \\\n  &amp;&amp; echo \"if [ -f /usr/share/colcon_argcomplete/hook/colcon-argcomplete.bash ]; then source /usr/share/colcon_argcomplete/hook/colcon-argcomplete.bash; fi\" &gt;&gt; /home/$USERNAME/.bashrc \\\n  &amp;&amp; rm -rf /var/lib/apt/lists/*\n\n  COPY .tmux.conf /etc/tmux.conf\n</code></pre>","tags":["docker","ros","image"]},{"location":"ROS/dev_environment/ros_docker/docker_images/#downloads","title":"Downloads","text":"<ul> <li>Dockerfile</li> <li>tmux config</li> </ul> Build image<pre><code>docker build -t humble:base -f Dockerfile.humble .\n</code></pre>","tags":["docker","ros","image"]},{"location":"ROS/dev_environment/ros_docker/docker_images/#jazzy","title":"Jazzy","text":"","tags":["docker","ros","image"]},{"location":"ROS/dev_environment/ros_docker/docker_images/#jazzy-base","title":"Jazzy base","text":"<ul> <li>base on cuda 12.4.0 ubuntu 24.04</li> <li>ros-base</li> <li>build tools</li> <li>ros build tools</li> <li>basic system utilities</li> <li>add none-root user</li> <li>gazebo bridge (harmonic)</li> </ul> Dockerfile ROS jazzy  <p>cuda version</p> <p>Check host cuda version using <code>nvidia-smi</code> , I encountered problems if the docker image cuda version was higher</p>","tags":["docker","ros","image"]},{"location":"ROS/dev_environment/ros_docker/docker_images/#downloads_1","title":"Downloads","text":"<ul> <li>Dockerfile</li> <li>tmux config</li> </ul> Build image<pre><code>docker build -t jazzy:base -f Dockerfile.jazzy .\n</code></pre>","tags":["docker","ros","image"]},{"location":"ROS/dev_environment/ros_docker/docker_images/#usage","title":"usage","text":"<pre><code>docker run --gpus all -it --rm \\\n--net host \\\n--name jazzy \\\n--hostname jazzy \\\n--user user \\\njazzy:base \\\n/bin/bash\n</code></pre>","tags":["docker","ros","image"]},{"location":"ROS/dev_environment/ros_docker/docker_nvidia/","title":"Using docker on Nvidia Jetson for ROS2","text":"<ul> <li>l4t-ros2-docker</li> </ul>","tags":["ros","nvidia","jetson","l4t","docker"]},{"location":"ROS/dev_environment/tutorials/jazzy_harmonic_setup/","title":"Jazzy Harmonic Bridge Setup","text":"","tags":["ros","jazzy","harmonic","setup","vscode","docker"]},{"location":"ROS/dev_environment/tutorials/jazzy_harmonic_setup/#setup","title":"Setup","text":"<ul> <li>jazzy docker image</li> <li>harmonic docker image</li> <li>both run using docker-compose</li> </ul>","tags":["ros","jazzy","harmonic","setup","vscode","docker"]},{"location":"ROS/dev_environment/tutorials/jazzy_harmonic_setup/#gz_transport","title":"gz_transport","text":"<p>gz_transport is Gazebo's communication middleware, used for inter-process communication (IPC) between different Gazebo components \u2014 like sensors, plugins, UI, and even ROS bridges.</p> <ul> <li>GZ_PARTITION: Isolates topic namespaces between different simulations</li> <li>GZ_DISCOVERY_SERVER:  IP address of the main discovery server (usually the Gazebo server machine)</li> <li>GZ_TRANSPORT_IP:  IP address the local process uses to advertise itself to others</li> </ul>","tags":["ros","jazzy","harmonic","setup","vscode","docker"]},{"location":"ROS/dev_environment/tutorials/jazzy_harmonic_setup/#jazzy","title":"jazzy","text":"<ul> <li>docker-compose.yaml</li> </ul>","tags":["ros","jazzy","harmonic","setup","vscode","docker"]},{"location":"ROS/dev_environment/tutorials/jazzy_harmonic_setup/#bridge-configuration","title":"bridge configuration","text":"config/gz_bridge.yaml <pre><code>- ros_topic_name: \"clock\"\n  gz_topic_name: \"clock\"\n  ros_type_name: \"rosgraph_msgs/msg/Clock\"\n  gz_type_name: \"gz.msgs.Clock\"\n  direction: GZ_TO_ROS\n</code></pre> launch/clock.launch.py <pre><code>import os\n\nfrom ament_index_python.packages import get_package_share_directory\nfrom launch import LaunchDescription\nfrom launch.actions import DeclareLaunchArgument\nfrom launch.actions import IncludeLaunchDescription\nfrom launch.launch_description_sources import PythonLaunchDescriptionSource\nfrom launch.substitutions import LaunchConfiguration\nfrom launch_ros.actions import Node\n\nPACKAGE_NAME = 'gz_tutorial'\n\ndef generate_launch_description():\n    ld = LaunchDescription()\n\n    bridge_params = os.path.join(get_package_share_directory(PACKAGE_NAME),'config','gz_bridge.yaml')\n    ros_gz_bridge = Node(\n        package=\"ros_gz_bridge\",\n        executable=\"parameter_bridge\",\n        arguments=[\n            '--ros-args',\n            '-p',\n            f'config_file:={bridge_params}',\n        ],\n        parameters=[\n            {'use_sim_time': True},\n        ],\n    )\n\n    ld.add_action(ros_gz_bridge)\n\n\n    return ld\n</code></pre>","tags":["ros","jazzy","harmonic","setup","vscode","docker"]},{"location":"ROS/dev_environment/tutorials/jazzy_harmonic_setup/#harmonic","title":"harmonic","text":"<ul> <li>Dockerfile</li> <li>docker-compose.yaml</li> </ul>","tags":["ros","jazzy","harmonic","setup","vscode","docker"]},{"location":"ROS/dev_environment/vscode_settings_and_extension/","title":"VSCode settings, extension and other configuration for ROS users","text":"","tags":["ros","vscode","settings","extensions","tasks"]},{"location":"ROS/dev_environment/vscode_settings_and_extension/#vscode-extension","title":"VSCode extension","text":"ext language / tool ms-python.python python ms-vscode.cpptools cpp twxs.cmake cmake redhat.vscode-xml xml redhat.vscode-yaml yaml TOOLS albert.tabout tab out actboy168.tasks tasks streetsidesoftware.code-spell-checker speller git mhutchie.git-graph git graph OS dlech.chmod set executable bit ROS nonanonno.vscode-ros2 Syntax highlighting for ros2 interface files (.msg, .srv, .action) JaehyunShim.vscode-ros2 Toolset around ROS2 URDF smilerobotics.urdf URDF support for VSCode <pre><code>\"ms-python.python\",\n\"ms-vscode.cpptools\",\n\"twxs.cmake\",\n\"redhat.vscode-xml\",\n\"redhat.vscode-yaml\",\n\"albert.tabout\",\n\"actboy168.tasks\",\n\"streetsidesoftware.code-spell-checker\",\n\"mhutchie.git-graph\",\n\"rioj7.command-variable\",\n\"dlech.chmod\",\n\"mkloubert.vscode-deploy-reloaded\",\n\"nonanonno.vscode-ros2\",\n\"smilerobotics.urdf\",\n\"JaehyunShim.vscode-ros2\"\n</code></pre>","tags":["ros","vscode","settings","extensions","tasks"]},{"location":"ROS/dev_environment/vscode_settings_and_extension/#vscode-tasks","title":"VSCode Tasks","text":"tasks.json<pre><code>{\n    \"version\": \"2.0.0\",\n    \"tasks\": [\n        {\n            \"label\": \"Colcon\",\n            \"type\": \"shell\",\n            \"command\": \"colcon build\",\n            \"problemMatcher\": [],\n            \"group\": {\n                \"isDefault\": true,\n                \"kind\": \"build\"\n            }\n        }\n    ]\n}\n</code></pre>","tags":["ros","vscode","settings","extensions","tasks"]},{"location":"ROS/dev_environment/vscode_settings_and_extension/#vscode-settings","title":"VSCode settings","text":"","tags":["ros","vscode","settings","extensions","tasks"]},{"location":"ROS/dev_environment/vscode_settings_and_extension/#shell","title":"Shell","text":"","tags":["ros","vscode","settings","extensions","tasks"]},{"location":"ROS/dev_environment/vscode_settings_and_extension/#run-script-for-every-new-shell","title":"Run script for every new shell","text":"settings<pre><code>\"terminal.integrated.profiles.linux\": {\n        \"bash_with_ros\": {\n            \"path\": \"bash\",\n            \"icon\": \"terminal-bash\",\n            \"args\": [\n                \"--rcfile\",\n                \"${workspaceFolder}/bashrc\"\n            ]\n        }\n    },\n\"terminal.integrated.defaultProfile.linux\": \"bash_with_ros\"\n</code></pre> bashrc<pre><code>source install/setup.bash\n</code></pre>","tags":["ros","vscode","settings","extensions","tasks"]},{"location":"ROS/dev_environment/vscode_settings_and_extension/#python","title":"Python","text":"<p>python.analysis.extraPaths: The python.analysis.extraPaths setting in Visual Studio Code is used to specify additional directories that the Python language server (Pylance) should include when analyzing your code.</p> <p>python.autoComplete.extraPaths: The python.autoComplete.extraPaths setting in Visual Studio Code is used to specify additional directories that the Python extension should include when providing autocomplete suggestions.</p> <pre><code>{\n    \"python.autoComplete.extraPaths\": [\n        \"${workspaceFolder}/\",\n        \"/opt/ros/humble/lib/python3.10/site-packages/\",\n        \"/opt/ros/humble/local/lib/python3.10/dist-packages\"\n\n    ],\n\n    \"python.analysis.extraPaths\": [\n        \"${workspaceFolder}/\",\n        \"/opt/ros/humble/lib/python3.10/site-packages/\",\n        \"/opt/ros/humble/local/lib/python3.10/dist-packages/\"\n    ]\n}\n</code></pre>","tags":["ros","vscode","settings","extensions","tasks"]},{"location":"ROS/dev_environment/vscode_settings_and_extension/#cpp","title":"Cpp","text":"c_cpp_properties.json<pre><code>{\n    \"configurations\": [\n        {\n            \"name\": \"ROS 2\",\n            \"includePath\": [\n                \"${workspaceFolder}/**\",\n                \"/opt/ros/humble/include/**\",\n                \"/usr/include/**\",\n                \"/usr/local/include/**\"\n            ],\n            \"defines\": [],\n            \"compilerPath\": \"/usr/bin/gcc\",\n            \"cStandard\": \"gnu17\",\n            \"cppStandard\": \"gnu++17\",\n            \"intelliSenseMode\": \"linux-gcc-x64\",\n            \"browse\": {\n                \"path\": [\n                    \"${workspaceFolder}/**\",\n                    \"/opt/ros/humble/include/**\",\n                    \"/usr/include/**\",\n                    \"/usr/local/include/**\"\n                ],\n                \"limitSymbolsToIncludedHeaders\": true,\n                \"databaseFilename\": \"\"\n            }\n        }\n    ],\n    \"version\": 4\n}\n</code></pre>","tags":["ros","vscode","settings","extensions","tasks"]},{"location":"ROS/python/","title":"ROS Python","text":"<p>pytest</p> <p>ROS2 python tutorials</p> <p>TBD</p> <ul> <li>using ament_cmake to create python package</li> </ul>"},{"location":"ROS/python/python_ament_cmake/","title":"python ament cmake","text":"<p>Use ament_cmake to create python package</p> <ul> <li>Create ament package</li> <li>Add folder <code>my_cmake_py_pkg</code> </li> <li>Add <code>__init__.py</code> in <code>my_cmake_py_pkg</code> to mark as python module</li> <li>Add node python file <code>my_node.py</code></li> <li>Set <code>my_node.py</code> as executable</li> <li>Add shabang <code>#!/usr/bin/env python3</code> in <code>my_node.py</code></li> <li>Edit to <code>CMakeLists.txt</code></li> <li>Edit <code>package.xml</code></li> </ul>","tags":["ros","python","cmake","ament"]},{"location":"ROS/python/python_ament_cmake/#create-package","title":"Create package","text":"<pre><code>ros2 pkg create my_cmake_py_pkg --build-type ament_cmake\n</code></pre>","tags":["ros","python","cmake","ament"]},{"location":"ROS/python/python_ament_cmake/#cmakeliststxt","title":"CMakeLists.txt","text":"CMakeLists.txt<pre><code>cmake_minimum_required(VERSION 3.8)\nproject(my_cmake_py_pkg)\n\nif(CMAKE_COMPILER_IS_GNUCXX OR CMAKE_CXX_COMPILER_ID MATCHES \"Clang\")\n  add_compile_options(-Wall -Wextra -Wpedantic)\nendif()\n\n# find dependencies\nfind_package(ament_cmake REQUIRED)\nfind_package(ament_cmake_python REQUIRED)\n\n# install python package\nament_python_install_package(${PROJECT_NAME})\n\nset(NODES\n  my_cmake_py_pkg/my_node.py\n)\n\n\ninstall(PROGRAMS\n    ${NODES}\nDESTINATION lib/${PROJECT_NAME}\n)\n\n\nament_package()\n</code></pre>","tags":["ros","python","cmake","ament"]},{"location":"ROS/python/python_ament_cmake/#packagexml","title":"package.xml","text":"<p>Add <code>ament_cmake_python</code> in <code>buildtool_depend</code></p> <pre><code>&lt;buildtool_depend&gt;ament_cmake_python&lt;/buildtool_depend&gt;\n</code></pre>","tags":["ros","python","cmake","ament"]},{"location":"ROS/python/python_ament_cmake/#python-nodes","title":"python nodes","text":"<ul> <li>Create folder with the package name</li> <li>Create <code>__init__.py</code> in the folder</li> <li>Every node should have <code>#!/usr/bin/env python3</code> as first line</li> <li>Make the node executable <code>chmod +x my_node.py</code></li> </ul> <pre><code>#!/usr/bin/env python3\n\nimport rclpy\nfrom rclpy.node import Node\n\nclass MyNode(Node):\n    def __init__(self):\n        node_name=\"minimal\"\n        super().__init__(node_name)\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = MyNode()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n</code></pre>","tags":["ros","python","cmake","ament"]},{"location":"ROS/python/python_ament_cmake/#usage","title":"usage","text":"<pre><code>ros2 run my_cmake_py_pkg my_node.py\n</code></pre>","tags":["ros","python","cmake","ament"]},{"location":"ROS/python/python_ament_cmake/#vscode-tips","title":"VScode tips","text":"<p>Install <code>chmod</code> extension to set handle executable bit on file</p> <p>chmod extension</p>","tags":["ros","python","cmake","ament"]},{"location":"ROS/python/ros_logging/","title":"Index","text":"<p>ROS / python</p> <pre><code>self.get_logger().info(f'IMU Orientation: Pitch={p} &lt;==&gt;  cmd={self.pitch}', throttle_duration_sec=1.0)\n</code></pre>","tags":["ros","python","logging","throttle_duration_sec"]},{"location":"ROS/python/ros_python/","title":"ROS2 python tutorials and tips","text":"<p>parameters</p> <p>node life cycle</p> <p>TBD</p>","tags":["python","ros","tutorials"]},{"location":"ROS/python/ros_python/lifecycle_node/","title":"ROS2 lifecycle node","text":"<p>Very good reference</p>","tags":["ros","python","lifecycle"]},{"location":"ROS/python/ros_python/parameters/","title":"ROS2 parameters","text":"","tags":["ros","python","parameters"]},{"location":"ROS/python/ros_python/parameters/#parameters-hierarchy","title":"Parameters Hierarchy","text":"<ul> <li>Declare node with parameters name that using dot(.) to describe the yaml struct</li> <li>Create struct yaml file</li> </ul> params.yaml<pre><code>/param_demo:\n  ros__parameters:\n    camera:\n      resolution:\n        width: 640\n    use_sim_time: false\n</code></pre> simple_node.py<pre><code>#!/usr/bin/env python3\n\nimport rclpy\nfrom rclpy.node import Node\n\nNAME = \"param_demo\"\n\nclass ParamDemo(Node):\n    def __init__(self):\n        super().__init__(NAME)\n        self.param1 = self.declare_parameter(\"camera.resolution.width\", 640)\n        self.t = self.create_timer(1.0, self.timer_handler)\n\n    def timer_handler(self):\n        self.get_logger().info(f\"{self.get_parameter('camera.resolution.width').value}\")\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = ParamDemo()\n    rclpy.spin(node)\n\n    node.destroy_node()\n    rclpy.shutdown()\n\n\nif __name__ == \"__main__\":\n    main()\n</code></pre> run node with parameter file<pre><code>ros2 run my_package my_node --ros-args --params-file params.yaml\n</code></pre>","tags":["ros","python","parameters"]},{"location":"ROS/python/ros_python/parameters/#usage","title":"usage","text":"update from cli<pre><code>ros2 param set /param_demo camera.resolution.width 1200\n</code></pre> <p>update string node with numeric value</p> <p>The failure happens only if we set the parameter value as string numeric (number in Quotation marks)</p> <pre><code># parameter declaration\nself.param1 = self.declare_parameter(\"param1\", value=\"1\")\n</code></pre> <pre><code>ros2 param set /param_demo param1 \"12\"\n# \nSetting parameter failed: Wrong parameter type, expected 'Type.STRING' got 'Type.INTEGER'\n</code></pre> <pre><code># use double quotation\nros2 param set /param_demo param1 '\"12\"'\n</code></pre>","tags":["ros","python","parameters"]},{"location":"ROS/python/ros_unit_test/","title":"ROS2 Python Unit Test","text":"<p>base on</p>","tags":["ros2","python","test","pytest"]},{"location":"ROS/python/ros_unit_test/#simple-very-simple-demo","title":"Simple very simple demo","text":"<p>Show how to use pytest in ros2 python package using ament_cmake </p>","tags":["ros2","python","test","pytest"]},{"location":"ROS/python/ros_unit_test/#package","title":"package","text":"<p>Using <code>ament_cmake</code> to create a python package</p> <pre><code>\u251c\u2500\u2500 CMakeLists.txt\n\u251c\u2500\u2500 package.xml\n\u251c\u2500\u2500 ros_py\n\u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u2514\u2500\u2500 simple_node.py\n\u2514\u2500\u2500 test\n    \u2514\u2500\u2500 test_simple.py\n</code></pre>","tags":["ros2","python","test","pytest"]},{"location":"ROS/python/ros_unit_test/#pytest-test","title":"pytest test","text":"simple_node.py<pre><code>def test_math():\n    assert 2 + 2 == 4\n</code></pre>","tags":["ros2","python","test","pytest"]},{"location":"ROS/python/ros_unit_test/#cmakeliststxt","title":"CMakeLists.txt","text":"<ul> <li>Add <code>ament_add_pytest_test</code> to the CMakeLists.txt file to run the test</li> </ul> <pre><code>if(BUILD_TESTING)\n  find_package(ament_cmake_pytest REQUIRED)\n  ament_add_pytest_test(test_math test/test_simple.py)\nendif()\n</code></pre>","tags":["ros2","python","test","pytest"]},{"location":"ROS/python/ros_unit_test/#using-colcon","title":"using colcon","text":"<pre><code># run package test\ncolcon test --packages-select ros_py  --event-handlers console_direct+\n\n# run specific test\ncolcon test --packages-select ros_py --pytest-args -k test_math --event-handlers console_direct+\n</code></pre>","tags":["ros2","python","test","pytest"]},{"location":"ROS/python/ros_unit_test/#reference","title":"Reference","text":"<ul> <li>Integration and unit testing in ROS 2</li> </ul>","tags":["ros2","python","test","pytest"]},{"location":"ROS/ros-micro/","title":"Micro-ROS","text":"<p>ROS</p>","tags":["ros","micro"]},{"location":"ROS/ros-micro/#reference","title":"Reference","text":"<ul> <li>micro ros</li> </ul>","tags":["ros","micro"]},{"location":"ROS/ros2_messages/","title":"ROS2 Messages","text":"<p>Message with stamped and covariance</p> <p>Custom interface</p> <p>TBD</p>","tags":["ros2","messages","interface"]},{"location":"ROS/ros2_messages/custom_message/","title":"ROS2 Custom interface","text":"<ul> <li>Create <code>ament_cmake</code> package</li> <li>Create folders <code>srv</code> and <code>msg</code></li> <li>Update <code>CMakeLists.txt</code> and <code>package.xml</code></li> <li>VSCode tips</li> </ul> <pre><code>\u251c\u2500\u2500 CMakeLists.txt\n\u251c\u2500\u2500 msg\n\u2502   \u2514\u2500\u2500 Demo.msg\n\u251c\u2500\u2500 package.xml\n\u2514\u2500\u2500 srv\n    \u2514\u2500\u2500 Demo.srv\n</code></pre> Demo.msg<pre><code>int32 data\n</code></pre> Demo.srv<pre><code>---\nstring message\nbool success\n</code></pre>","tags":["ros","interface"]},{"location":"ROS/ros2_messages/custom_message/#cmakeliststxt-and-packagexml","title":"CMakelists.txt and package.xml","text":"CMakeLists.txt<pre><code>cmake_minimum_required(VERSION 3.8)\nproject(pkg_interface)\n\nif(CMAKE_COMPILER_IS_GNUCXX OR CMAKE_CXX_COMPILER_ID MATCHES \"Clang\")\n  add_compile_options(-Wall -Wextra -Wpedantic)\nendif()\n\n# find dependencies\nfind_package(ament_cmake REQUIRED)\nfind_package(rosidl_default_generators REQUIRED)\n\nset(MESSAGES\n  \"msg/Demo.msg\"\n)\n\nset(SERVICES \n  \"srv/Demo.srv\"\n)\n\n\nrosidl_generate_interfaces(${PROJECT_NAME}\n  ${MESSAGES}\n  ${SERVICES} \n)\n\n\nament_export_dependencies(rosidl_default_runtime)\n\nament_package()\n</code></pre> package.xml<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;?xml-model href=\"http://download.ros.org/schema/package_format3.xsd\" schematypens=\"http://www.w3.org/2001/XMLSchema\"?&gt;\n&lt;package format=\"3\"&gt;\n  &lt;name&gt;pkg_interface&lt;/name&gt;\n  &lt;version&gt;0.0.1&lt;/version&gt;\n  &lt;description&gt;Simple interface&lt;/description&gt;\n  &lt;maintainer email=\"robo2020@gmail.com\"&gt;user&lt;/maintainer&gt;\n  &lt;license&gt;Apache-2.0&lt;/license&gt;\n\n  &lt;buildtool_depend&gt;ament_cmake&lt;/buildtool_depend&gt;\n\n  &lt;buildtool_depend&gt;rosidl_default_generators&lt;/buildtool_depend&gt;\n  &lt;exec_depend&gt;rosidl_default_runtime&lt;/exec_depend&gt;\n  &lt;member_of_group&gt;rosidl_interface_packages&lt;/member_of_group&gt;\n\n  &lt;export&gt;\n    &lt;build_type&gt;ament_cmake&lt;/build_type&gt;\n  &lt;/export&gt;\n&lt;/package&gt;\n</code></pre>","tags":["ros","interface"]},{"location":"ROS/ros2_messages/custom_message/#vscode-tips","title":"VSCode tips","text":"<p>Fix pylance extra path</p> <pre><code>\"${workspaceFolder}/install/&lt;package_name&gt;/local/lib/python3.10/\n</code></pre> <pre><code>\"python.analysis.extraPaths\": [\n        \"${workspaceFolder}/\",\n        \"${workspaceFolder}/install/pkg_interface/local/lib/python3.10/dist-packages/\",\n        \"/opt/ros/humble/lib/python3.10/site-packages/\",\n        \"/opt/ros/humble/local/lib/python3.10/dist-packages/\"\n    ]\n</code></pre>","tags":["ros","interface"]},{"location":"ROS/ros2_messages/messages/","title":"ROS2 Messages","text":"","tags":["ros2","message","stamped","covariance","PoseWithCovariance"]},{"location":"ROS/ros2_messages/messages/#message-with-covariance","title":"Message with covariance","text":"","tags":["ros2","message","stamped","covariance","PoseWithCovariance"]},{"location":"ROS/ros2_messages/messages/#demo-posewithcovariance","title":"Demo: PoseWithCovariance","text":"<p>geometry_msgs/msg/PoseWithCovariance</p> <pre><code>ros2 interface show geometry_msgs/msg/PoseWithCovariance\n</code></pre> <ul> <li>Pose</li> <li>position (x,y,z)</li> <li>orientation (q)</li> <li>covariance (float64[36])</li> </ul> <p>Covariance Matrix : A 6*6 matrix representing uncertainties and correlations for the 6 degree of freedom (DoF)     - x,y,z     - roll, pith, yaw</p> <pre><code>pose_covariance = [\n    0.0025, 0.0, 0.0, 0.0, 0.0, 0.0,  # x\n    0.0, 0.0025, 0.0, 0.0, 0.0, 0.0,  # y\n    0.0, 0.0, 1e3, 0.0, 0.0, 0.0,   # z\n    0.0, 0.0, 0.0, 1e3, 0.0, 0.0,   # roll\n    0.0, 0.0, 0.0, 0.0, 1e3, 0.0,   # pitch\n    0.0, 0.0, 0.0, 0.0, 0.0, 0.0001  # yaw\n]\n</code></pre>","tags":["ros2","message","stamped","covariance","PoseWithCovariance"]},{"location":"ROS/ros2_resource/","title":"ROS2 Good resources","text":"","tags":["ros","resource"]},{"location":"ROS/ros2_resource/#blogs-and-web-sites","title":"Blogs and WEB Sites","text":"","tags":["ros","resource"]},{"location":"ROS/ros2_resource/#githubs","title":"Githubs","text":"","tags":["ros","resource"]},{"location":"ROS/ros2_resource/#autonomous-mobile-robots","title":"Autonomous Mobile Robots","text":"<p>This repository contains an implementation of the Autonomous Mobile Robots course for ROCV master's program at Innopolis University. The course is instructed by Geesara Prathap. So, this repository contains the course material besides my solutions for the assignments. In addition, I developed PID, LQR controllers for a differential drive robot. Trajectory-tracking error model was developed for applying MPC controller.</p> <p>The course contents includes:</p> <ul> <li>Motion control (Kinematics, control, and dubins path planning).</li> <li>Estimation (Kalman filter, extended kalman filter, particle filter).</li> <li>Localization (Monte carlo, and ekf localization).</li> </ul>","tags":["ros","resource"]},{"location":"ROS/ros_basic/","title":"ROS Basic","text":"<p>Pub/Sub</p> <p>Services</p> <p>QoS</p> <p>QoS</p>"},{"location":"ROS/ros_basic/ros_interface/","title":"ROS2 interfaces","text":"<p>Messages are the fundamental units of data that are exchanged between nodes using topics. They are part of the ROS 2 communication interfaces, which also include services and actions.</p>","tags":["ros","interfaces","message"]},{"location":"ROS/ros_basic/ros_interface/#msg-and-srv-files","title":"msg and srv files","text":"<p>A message in ROS 2 is a typed data structure  Each line define one field <code>&lt;type&gt; &lt;name&gt;</code> message (service and action) files can include</p> <ul> <li>primitive types: int32, float64, string</li> <li>compound predefine message or custom message</li> <li>arrays: int32[]</li> </ul>","tags":["ros","interfaces","message"]},{"location":"ROS/ros_basic/ros_interface/#create-custom-message","title":"Create custom message","text":"","tags":["ros","interfaces","message"]},{"location":"ROS/ros_basic/ros_interface/#cmake","title":"cmake","text":"<pre><code>cmake_minimum_required(VERSION 3.8)\nproject(media_manager_interfaces)\n\nif(CMAKE_COMPILER_IS_GNUCXX OR CMAKE_CXX_COMPILER_ID MATCHES \"Clang\")\n  add_compile_options(-Wall -Wextra -Wpedantic)\nendif()\n\n# find dependencies\nfind_package(ament_cmake REQUIRED)\nfind_package(rosidl_default_generators REQUIRED)\n\nset(msg_files\n\n)\nset(srv_files\n  \"srv/GetMediaFileList.srv\"\n  )\n\n\nrosidl_generate_interfaces(${PROJECT_NAME}\n  ${msg_files}\n  ${srv_files}\n)\n\nament_export_dependencies(rosidl_default_runtime)\n\nament_package()\n</code></pre>","tags":["ros","interfaces","message"]},{"location":"ROS/ros_basic/ros_interface/#packagexml","title":"package.xml","text":"<p>Add this lines before <code>&lt;export&gt;</code> tag</p> <pre><code>  &lt;depend&gt;rosidl_default_generators&lt;/depend&gt;\n  &lt;member_of_group&gt;rosidl_interface_packages&lt;/member_of_group&gt;\n</code></pre>","tags":["ros","interfaces","message"]},{"location":"ROS/ros_basic/ros_pub_sub/","title":"ROS Pub/ Sub","text":"<ul> <li>Node Topics name and remap</li> </ul>","tags":["ros","pub","sub"]},{"location":"ROS/ros_basic/ros_pub_sub/node_topic_nameing/","title":"ROS2 Topic name rename and namespace","text":"","tags":["ros","topic","nameing","remap","namespace"]},{"location":"ROS/ros_basic/ros_pub_sub/node_topic_nameing/#remap","title":"remap","text":"<pre><code>ros2 run package node --ros-args -r old_topic:=new_topic\n</code></pre>","tags":["ros","topic","nameing","remap","namespace"]},{"location":"ROS/ros_basic/ros_pub_sub/node_topic_nameing/#demo","title":"Demo","text":"<ul> <li>Two nodes</li> <li>pub publish string message in <code>pub_topic</code> </li> <li>sub subscribe to string message in <code>sub_topic</code></li> </ul> pub sub code pub node<pre><code>#!/usr/bin/env python3\n\n\nimport rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nTOPIC = \"pub_topic\"\n\nclass PubNode(Node):\n    def __init__(self):\n        node_name=\"pub\"\n        super().__init__(node_name)\n        self.pub = self.create_publisher(String, TOPIC,10)\n        self.timer = self.create_timer(1.0, self.timer_handler)\n        self.get_logger().info(\"Hello PUB\")\n\n    def timer_handler(self):\n        msg = String()\n        msg.data = \"hello\"\n        self.pub.publish(msg)\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = PubNode()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n</code></pre> sub node<pre><code>#!/usr/bin/env python3\n\n\nimport rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nTOPIC = \"sub_topic\"\n\nclass SubNode(Node):\n    def __init__(self):\n        node_name=\"pub\"\n        super().__init__(node_name)\n        self.pub = self.create_subscription(String, TOPIC, self.callback, 10)\n        self.get_logger().info(\"Hello SUB\")\n\n    def callback(self, msg):\n        self.get_logger().info(msg.data)\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = SubNode()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n</code></pre>","tags":["ros","topic","nameing","remap","namespace"]},{"location":"ROS/ros_basic/ros_pub_sub/node_topic_nameing/#usage","title":"usage","text":"<ul> <li>remap subscriber node</li> </ul> terminal1<pre><code>ros2 run g_stream pub.py\n</code></pre> terminal2<pre><code>ros2 run g_stream sub.py --ros-args -r sub_topic:=pub_topic\n</code></pre> <ul> <li>remap pub node</li> </ul> terminal1<pre><code>ros2 run g_stream pub.py --ros-args -r pub_topic:=sub_topic\n</code></pre> terminal2<pre><code>ros2 run g_stream sub.py \n</code></pre>","tags":["ros","topic","nameing","remap","namespace"]},{"location":"ROS/ros_basic/ros_pub_sub/node_topic_nameing/#namespace","title":"Namespace","text":"","tags":["ros","topic","nameing","remap","namespace"]},{"location":"ROS/ros_basic/ros_pub_sub/node_topic_nameing/#change-from-cli","title":"change from CLI","text":"<pre><code>ros2 run g_stream pub.py --ros-args -r __ns:=/ns1\n</code></pre> <pre><code>ros2 topic list\n#\n/ns1/pub_topic\n</code></pre>","tags":["ros","topic","nameing","remap","namespace"]},{"location":"ROS/ros_basic/ros_qos/","title":"Playing with ROS QoS","text":"QoS Parameter Description Options Reliability Defines message delivery guarantees RELIABLE (guaranteed delivery, higher latency)  BEST_EFFORT (lower latency, no guarantee) Durability Determines if old messages are available to late subscribers VOLATILE (no history, new subscribers get only new messages)   TRANSIENT_LOCAL (stores past messages for late joiners) History Controls how many messages are stored before being sent KEEP_LAST(N) (stores last N messages)  KEEP_ALL (stores all messages, limited by memory) Depth Number of messages to store in KEEP_LAST(N) Any positive integer (default 10) Deadline Maximum allowed time between consecutive messages Duration (e.g., 1s, 500ms); triggers an event if missed Lifespan How long messages remain valid before being discarded Duration in sec (default infinity) Liveliness Ensures publishers are active AUTOMATIC (system-managed) MANUAL_BY_TOPIC  (publisher must assert liveliness) Lease  Duration Maximum time a publisher can remain silent before being considered inactive Duration (e.g., 2s, 5s)","tags":["ros","qos"]},{"location":"ROS/ros_basic/ros_qos/#profiles","title":"Profiles","text":"<p>rclpy define predefine profiles that define in the rmw</p> <ul> <li>qos_profile_system_default</li> <li>qos_profile_sensor_data</li> </ul> rmw profile !!! note \"humble version\"     [qos_profiles.h](https://github.com/ros2/rmw/blob/humble/rmw/include/rmw/qos_profiles.h)  <pre><code>static const rmw_qos_profile_t rmw_qos_profile_system_default =\n{\n  RMW_QOS_POLICY_HISTORY_SYSTEM_DEFAULT,\n  RMW_QOS_POLICY_DEPTH_SYSTEM_DEFAULT,\n  RMW_QOS_POLICY_RELIABILITY_SYSTEM_DEFAULT,\n  RMW_QOS_POLICY_DURABILITY_SYSTEM_DEFAULT,\n  RMW_QOS_DEADLINE_DEFAULT,\n  RMW_QOS_LIFESPAN_DEFAULT,\n  RMW_QOS_POLICY_LIVELINESS_SYSTEM_DEFAULT,\n  RMW_QOS_LIVELINESS_LEASE_DURATION_DEFAULT,\n  false\n};\n\nstatic const rmw_qos_profile_t rmw_qos_profile_sensor_data =\n{\n  RMW_QOS_POLICY_HISTORY_KEEP_LAST,\n  5,\n  RMW_QOS_POLICY_RELIABILITY_BEST_EFFORT,\n  RMW_QOS_POLICY_DURABILITY_VOLATILE,\n  RMW_QOS_DEADLINE_DEFAULT,\n  RMW_QOS_LIFESPAN_DEFAULT,\n  RMW_QOS_POLICY_LIVELINESS_SYSTEM_DEFAULT,\n  RMW_QOS_LIVELINESS_LEASE_DURATION_DEFAULT,\n  false\n};\n</code></pre>","tags":["ros","qos"]},{"location":"ROS/ros_basic/ros_qos/#demos","title":"Demos","text":"","tags":["ros","qos"]},{"location":"ROS/ros_basic/ros_qos/#publisher-queue-size","title":"Publisher Queue size","text":"<p>Simulate publisher queue size control for late binding subscribers</p>","tags":["ros","qos"]},{"location":"ROS/ros_basic/ros_qos/#qos_profile_system_default","title":"qos_profile_system_default","text":"<p>In this profile the depth is zero and from result we saw that the subscribe not receives any message from history</p> demo code <pre><code>#!/usr/bin/env python3\n\n\nimport rclpy\nfrom rclpy.executors import MultiThreadedExecutor\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\nfrom rclpy.qos import QoSProfile, ReliabilityPolicy, DurabilityPolicy, HistoryPolicy, LivelinessPolicy\nfrom rclpy.qos import qos_profile_system_default, qos_profile_sensor_data\nfrom rclpy.duration import Duration  # Correct import\n\nTOPIC = \"test_topic\"\n\nSUB_START_DELAY = 5\nPUB_RATE = 1\n\nclass SubNode(Node):\n    def __init__(self):\n        super().__init__(\"sub_node\")\n        self.sub_start_delay = self.create_timer(SUB_START_DELAY, self.timer_handler)\n\n        self.get_logger().info(\"Hello SUB\")\n\n    def timer_handler(self):\n        self.destroy_timer(self.sub_start_delay)\n        self.get_logger().info(\"--Create subscriber--\")\n        self.create_subscription(String, TOPIC, self.callback, qos_profile=qos_profile_system_default)\n\n\n    def callback(self, msg):\n        self.get_logger().info(f\"Received: {msg.data}\")\n\nclass PubNode(Node):\n    def __init__(self):\n        super().__init__(\"pub_node\")\n        self.counter = 0\n        self.pub = self.create_publisher(String, TOPIC, qos_profile=qos_profile_system_default)\n        self.get_logger().info(f\"{self.pub.qos_profile}\")\n        self.timer = self.create_timer(PUB_RATE, self.timer_handler)\n\n        self.get_logger().info(\"Hello PUB\")\n\n    def timer_handler(self):\n        msg = String()\n        msg.data = f\"hello {self.counter}\"\n        self.counter += 1\n        self.pub.publish(msg)\n\ndef main(args=None):\n    rclpy.init(args=args)\n    pub_node = PubNode()\n    sub_node = SubNode()\n    executer = MultiThreadedExecutor()\n    executer.add_node(pub_node)\n    executer.add_node(sub_node)\n\n    executer.spin()\n\n\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n</code></pre> result<pre><code>[INFO] [1742102162.025442844] [pub_node]: Hello PUB\n[INFO] [1742102162.026666484] [sub_node]: Hello SUB\n[INFO] [1742102167.029141089] [sub_node]: --Create subscriber--\n[INFO] [1742102168.029089360] [sub_node]: Received: hello 5\n[INFO] [1742102169.028827506] [sub_node]: Received: hello 6\n[INFO] [1742102170.029061624] [sub_node]: Received: hello 7\n[INFO] [1742102171.029371443] [sub_node]: Received: hello 8\n[INFO] [1742102172.028809769] [sub_node]: Received: hello 9\n[INFO] [1742102173.028644708] [sub_node]: Received: hello 10\n</code></pre>","tags":["ros","qos"]},{"location":"ROS/ros_basic/ros_qos/#qos_profile_sensor_data","title":"qos_profile_sensor_data","text":"<p>In this profile the depth set to 5 but the the durability set to VOLATILE (no history, new subscribers get only new messages), the result saw that late subscriber got only new messages</p> demo code <pre><code>#!/usr/bin/env python3\n\n\nimport rclpy\nfrom rclpy.executors import MultiThreadedExecutor\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\nfrom rclpy.qos import QoSProfile, ReliabilityPolicy, DurabilityPolicy, HistoryPolicy, LivelinessPolicy\nfrom rclpy.qos import qos_profile_system_default, qos_profile_sensor_data\nfrom rclpy.duration import Duration  # Correct import\n\nTOPIC = \"test_topic\"\n\nSUB_START_DELAY = 5\nPUB_RATE = 1\n\nclass SubNode(Node):\n    def __init__(self):\n        super().__init__(\"sub_node\")\n        self.sub_start_delay = self.create_timer(SUB_START_DELAY, self.timer_handler)\n\n        self.get_logger().info(\"Hello SUB\")\n\n    def timer_handler(self):\n        self.destroy_timer(self.sub_start_delay)\n        self.get_logger().info(\"--Create subscriber--\")\n        self.create_subscription(String, TOPIC, self.callback, qos_profile=qos_profile_sensor_data)\n\n\n    def callback(self, msg):\n        self.get_logger().info(f\"Received: {msg.data}\")\n\nclass PubNode(Node):\n    def __init__(self):\n        super().__init__(\"pub_node\")\n        self.counter = 0\n        self.pub = self.create_publisher(String, TOPIC, qos_profile=qos_profile_sensor_data)\n        self.get_logger().info(f\"{self.pub.qos_profile}\")\n        self.timer = self.create_timer(PUB_RATE, self.timer_handler)\n\n        self.get_logger().info(\"Hello PUB\")\n\n    def timer_handler(self):\n        msg = String()\n        msg.data = f\"hello {self.counter}\"\n        self.counter += 1\n        self.pub.publish(msg)\n\ndef main(args=None):\n    rclpy.init(args=args)\n    pub_node = PubNode()\n    sub_node = SubNode()\n    executer = MultiThreadedExecutor()\n    executer.add_node(pub_node)\n    executer.add_node(sub_node)\n\n    executer.spin()\n\n\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n</code></pre> result<pre><code>[INFO] [1742103996.715762333] [pub_node]: Hello PUB\n[INFO] [1742103996.717355657] [sub_node]: Hello SUB\n[INFO] [1742104001.719799187] [sub_node]: --Create subscriber--\n[INFO] [1742104002.713190568] [sub_node]: Received: hello 5\n[INFO] [1742104003.713665142] [sub_node]: Received: hello 6\n[INFO] [1742104004.713264404] [sub_node]: Received: hello 7\n[INFO] [1742104005.713393306] [sub_node]: Received: hello 8\n[INFO] [1742104006.713138227] [sub_node]: Received: hello 9\n[INFO] [1742104007.713481727] [sub_node]: Received: hello 10\n</code></pre>","tags":["ros","qos"]},{"location":"ROS/ros_basic/ros_qos/#queue-and-durability","title":"Queue and Durability","text":"<p>Allow late subscriber to get history</p> <ul> <li>Durability: TRANSIENT_LOCAL stores past messages for late joiners</li> <li>depth: 10</li> </ul> <p>Subscriber QOS settings The queue depth in the subscriber refer to the number of messages the subscriber can store before processing them The durability must be transient local because in VOLATILE means it won't receive old message</p> <ul> <li>depth: 10</li> <li>durability: TRANSIENT_LOCAL </li> </ul> demo code <pre><code>#!/usr/bin/env python3\n\n\nimport rclpy\nfrom rclpy.executors import MultiThreadedExecutor\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\nfrom rclpy.qos import QoSProfile, ReliabilityPolicy, DurabilityPolicy, HistoryPolicy, LivelinessPolicy\nfrom rclpy.qos import qos_profile_system_default, qos_profile_sensor_data\nfrom rclpy.duration import Duration  # Correct import\n\nTOPIC = \"test_topic\"\n\nSUB_START_DELAY = 5\nPUB_RATE = 1\n\nclass SubNode(Node):\n    def __init__(self):\n        super().__init__(\"sub_node\")\n        self.sub_start_delay = self.create_timer(SUB_START_DELAY, self.timer_handler)\n\n        self.get_logger().info(\"Hello SUB\")\n\n    def timer_handler(self):\n        self.destroy_timer(self.sub_start_delay)\n        self.get_logger().info(\"--Create subscriber--\")\n        qos_profile = QoSProfile(\n            reliability=ReliabilityPolicy.RELIABLE,  # or BEST_EFFORT\n            durability=DurabilityPolicy.TRANSIENT_LOCAL,  # or VOLATILE\n            history=HistoryPolicy.KEEP_LAST,  # or KEEP_ALL\n            depth=10,  # Queue depth\n            liveliness=LivelinessPolicy.AUTOMATIC,  # or MANUAL_BY_TOPIC\n        )\n        self.create_subscription(String, TOPIC, self.callback, qos_profile=qos_profile)\n\n\n    def callback(self, msg):\n        self.get_logger().info(f\"Received: {msg.data}\")\n\nclass PubNode(Node):\n    def __init__(self):\n        super().__init__(\"pub_node\")\n        qos_profile = QoSProfile(\n            reliability=ReliabilityPolicy.RELIABLE,  # or BEST_EFFORT\n            durability=DurabilityPolicy.TRANSIENT_LOCAL,  # or VOLATILE\n            history=HistoryPolicy.KEEP_LAST,  # or KEEP_ALL\n            depth=10,  # Queue depth\n            liveliness=LivelinessPolicy.AUTOMATIC,  # or MANUAL_BY_TOPIC\n        )\n        self.counter = 0\n        self.pub = self.create_publisher(String, TOPIC, qos_profile)\n        # self.get_logger().info(f\"{self.pub.qos_profile}\")\n        self.timer = self.create_timer(PUB_RATE, self.timer_handler)\n\n        self.get_logger().info(\"Hello PUB\")\n\n    def timer_handler(self):\n        msg = String()\n        msg.data = f\"hello {self.counter}\"\n        self.counter += 1\n        self.pub.publish(msg)\n\ndef main(args=None):\n    rclpy.init(args=args)\n    pub_node = PubNode()\n    sub_node = SubNode()\n    executer = MultiThreadedExecutor()\n    executer.add_node(pub_node)\n    executer.add_node(sub_node)\n\n    executer.spin()\n\n\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n</code></pre> <p>From the result we saw that we got five (0-4) message from publisher history in the same time slot almost</p> result<pre><code>[INFO] [1742104307.703495396] [pub_node]: Hello PUB\n[INFO] [1742104307.704634957] [sub_node]: Hello SUB\n[INFO] [1742104312.706942284] [sub_node]: --Create subscriber--\n[INFO] [1742104312.709927579] [sub_node]: Received: hello 0\n[INFO] [1742104312.712135500] [sub_node]: Received: hello 1\n[INFO] [1742104312.714533710] [sub_node]: Received: hello 2\n[INFO] [1742104312.717377731] [sub_node]: Received: hello 3\n[INFO] [1742104312.719738278] [sub_node]: Received: hello 4\n[INFO] [1742104313.701471401] [sub_node]: Received: hello 5\n[INFO] [1742104314.701632809] [sub_node]: Received: hello 6\n[INFO] [1742104315.699930835] [sub_node]: Received: hello 7\n[INFO] [1742104316.701096571] [sub_node]: Received: hello 8\n[INFO] [1742104317.701580589] [sub_node]: Received: hello 9\n[INFO] [1742104318.701305347] [sub_node]: Received: hello 10\n</code></pre>","tags":["ros","qos"]},{"location":"ROS/ros_basic/ros_qos/#publisher-livespan","title":"Publisher livespan","text":"<p>Controls how long a message remains valid in the publisher\u2019s queue before it is discarded.</p> <p>lifespan = {0,0} default message never expire store until queue is exceeded</p> demo code  !!! note \"duration\"      Change `DURATION` at line 20 to simulate different duration behavior  <pre><code>#!/usr/bin/env python3\n\n\nimport rclpy\nfrom rclpy.executors import MultiThreadedExecutor\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\nfrom rclpy.qos import QoSProfile, ReliabilityPolicy, DurabilityPolicy, HistoryPolicy, LivelinessPolicy\nfrom rclpy.duration import Duration  # Correct import\n\nTOPIC = \"test_topic\"\n\nSUB_START_DELAY = 5\nPUB_RATE = 1\n\nINFINITY = 0\nTHREE = 3\nFIVE = 5\n\nDURATION = FIVE\n\nclass SubNode(Node):\n    def __init__(self):\n        super().__init__(\"sub_node\")\n        self.sub_start_delay = self.create_timer(SUB_START_DELAY, self.timer_handler)\n\n        self.get_logger().info(\"Hello SUB\")\n\n    def timer_handler(self):\n        self.destroy_timer(self.sub_start_delay)\n        self.get_logger().info(\"--Create subscriber--\")\n        qos_profile = QoSProfile(\n            reliability=ReliabilityPolicy.RELIABLE,  # or BEST_EFFORT\n            durability=DurabilityPolicy.TRANSIENT_LOCAL,  # or VOLATILE\n            history=HistoryPolicy.KEEP_LAST,  # or KEEP_ALL\n            depth=10,  # Queue depth\n            liveliness=LivelinessPolicy.AUTOMATIC,  # or MANUAL_BY_TOPIC\n        )\n        self.create_subscription(String, TOPIC, self.callback, qos_profile=qos_profile)\n\n\n    def callback(self, msg):\n        self.get_logger().info(f\"Received: {msg.data}\")\n\nclass PubNode(Node):\n    def __init__(self):\n        super().__init__(\"pub_node\")\n        qos_profile = QoSProfile(\n            reliability=ReliabilityPolicy.RELIABLE,  # or BEST_EFFORT\n            durability=DurabilityPolicy.TRANSIENT_LOCAL,  # or VOLATILE\n            history=HistoryPolicy.KEEP_LAST,  # or KEEP_ALL\n            depth=10,  # Queue depth\n            liveliness=LivelinessPolicy.AUTOMATIC,  # or MANUAL_BY_TOPIC\n        )\n        qos_profile.lifespan = Duration(seconds=DURATION)\n        self.counter = 0\n        self.pub = self.create_publisher(String, TOPIC, qos_profile)\n        self.timer = self.create_timer(PUB_RATE, self.timer_handler)\n\n        self.get_logger().info(\"Hello PUB\")\n\n    def timer_handler(self):\n        msg = String()\n        msg.data = f\"hello {self.counter}\"\n        self.counter += 1\n        self.pub.publish(msg)\n\ndef main(args=None):\n    rclpy.init(args=args)\n    pub_node = PubNode()\n    sub_node = SubNode()\n    executer = MultiThreadedExecutor()\n    executer.add_node(pub_node)\n    executer.add_node(sub_node)\n\n    executer.spin()\n\n\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n</code></pre> <p>Publisher QOS settings</p> duration infinity<pre><code>[INFO] [1742119324.479144324] [pub_node]: Hello PUB\n[INFO] [1742119324.480279021] [sub_node]: Hello SUB\n[INFO] [1742119329.482579604] [sub_node]: --Create subscriber--\n[INFO] [1742119329.487386342] [sub_node]: Received: hello 0\n[INFO] [1742119329.490330176] [sub_node]: Received: hello 1\n[INFO] [1742119329.493336125] [sub_node]: Received: hello 2\n[INFO] [1742119329.494006959] [sub_node]: Received: hello 3\n[INFO] [1742119329.494655886] [sub_node]: Received: hello 4\n[INFO] [1742119330.477924823] [sub_node]: Received: hello 5\n[INFO] [1742119331.477839792] [sub_node]: Received: hello 6\n[INFO] [1742119332.478648855] [sub_node]: Received: hello 7\n[INFO] [1742119333.479034641] [sub_node]: Received: hello 8\n[INFO] [1742119334.479176439] [sub_node]: Received: hello 9\n[INFO] [1742119335.479199605] [sub_node]: Received: hello 10\n</code></pre> duration 3 sec<pre><code>[INFO] [1742148850.009442835] [pub_node]: Hello PUB\n[INFO] [1742148850.010507589] [sub_node]: Hello SUB\n[INFO] [1742148855.013188581] [sub_node]: --Create subscriber--\n[INFO] [1742148855.017414763] [sub_node]: Received: hello 2\n[INFO] [1742148855.019736517] [sub_node]: Received: hello 3\n[INFO] [1742148855.022239024] [sub_node]: Received: hello 4\n[INFO] [1742148856.008740366] [sub_node]: Received: hello 5\n[INFO] [1742148857.008514352] [sub_node]: Received: hello 6\n[INFO] [1742148858.008535595] [sub_node]: Received: hello 7\n[INFO] [1742148859.008868188] [sub_node]: Received: hello 8\n[INFO] [1742148860.008177597] [sub_node]: Received: hello 9\n[INFO] [1742148861.008890986] [sub_node]: Received: hello 10\n</code></pre> <p>The subscriber start 5 sec after the publisher because the publisher message duration is 5 sec The subscriber got all the message history</p> duration 5 sec<pre><code>[INFO] [1742148971.724443752] [pub_node]: Hello PUB\n[INFO] [1742148971.725656236] [sub_node]: Hello SUB\n[INFO] [1742148976.726798282] [sub_node]: --Create subscriber--\n[INFO] [1742148976.729821746] [sub_node]: Received: hello 0\n[INFO] [1742148976.731418745] [sub_node]: Received: hello 1\n[INFO] [1742148976.732847415] [sub_node]: Received: hello 2\n[INFO] [1742148976.734682250] [sub_node]: Received: hello 3\n[INFO] [1742148976.736104530] [sub_node]: Received: hello 4\n[INFO] [1742148977.722802777] [sub_node]: Received: hello 5\n[INFO] [1742148978.722967570] [sub_node]: Received: hello 6\n[INFO] [1742148979.722813556] [sub_node]: Received: hello 7\n[INFO] [1742148980.723007282] [sub_node]: Received: hello 8\n[INFO] [1742148981.720740806] [sub_node]: Received: hello 9\n[INFO] [1742148982.722850261] [sub_node]: Received: hello 10\n</code></pre>","tags":["ros","qos"]},{"location":"ROS/ros_basic/ros_qos/#deadline","title":"Deadline","text":"QoS and deadline event result<pre><code>#!/usr/bin/env python3\n\n\nimport rclpy\nfrom rclpy.executors import MultiThreadedExecutor\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\nfrom rclpy.qos import QoSProfile, ReliabilityPolicy, DurabilityPolicy, HistoryPolicy, LivelinessPolicy\nfrom rclpy.duration import Duration  # Correct import\nfrom rclpy.qos_event import SubscriptionEventCallbacks\n\nTOPIC = \"test_topic\"\n\nSUB_START_DELAY = 5\nPUB_RATE = 1\n\n\nclass SubNode(Node):\n    def __init__(self):\n        super().__init__(\"sub_node\")\n\n        self.get_logger().info(\"--Create subscriber--\")\n        qos_profile = QoSProfile(\n            reliability=ReliabilityPolicy.RELIABLE,  # or BEST_EFFORT\n            durability=DurabilityPolicy.TRANSIENT_LOCAL,  # or VOLATILE\n            history=HistoryPolicy.KEEP_LAST,  # or KEEP_ALL\n            depth=10,  # Queue depth\n            liveliness=LivelinessPolicy.AUTOMATIC,  # or MANUAL_BY_TOPIC\n        )\n        qos_profile.deadline = Duration(seconds=1, nanoseconds=0)  # Deadline duration\n        self.sub = self.create_subscription(String, TOPIC, self.callback, qos_profile, event_callbacks=SubscriptionEventCallbacks(deadline=self.deadline_missed_callback))\n\n        self.get_logger().info(\"Hello SUB\")\n\n\n    def deadline_missed_callback(self, event):\n        self.get_logger().warning(\"Deadline missed !!\")\n\n    def callback(self, msg):\n        self.get_logger().info(f\"Received: {msg.data}\")\n\nclass PubNode(Node):\n    def __init__(self):\n        super().__init__(\"pub_node\")\n        qos_profile = QoSProfile(\n            reliability=ReliabilityPolicy.RELIABLE,  # or BEST_EFFORT\n            durability=DurabilityPolicy.TRANSIENT_LOCAL,  # or VOLATILE\n            history=HistoryPolicy.KEEP_LAST,  # or KEEP_ALL\n            depth=10,  # Queue depth\n            liveliness=LivelinessPolicy.AUTOMATIC,  # or MANUAL_BY_TOPIC\n        )\n        qos_profile.deadline = Duration(seconds=1, nanoseconds=0)  # Deadline duration\n        self.counter = 0\n        self.pub = self.create_publisher(String, TOPIC, qos_profile)\n        self.timer = self.create_timer(PUB_RATE, self.timer_handler)\n\n        self.get_logger().info(\"Hello PUB\")\n\n    def timer_handler(self):\n        msg = String()\n        msg.data = f\"hello {self.counter}\"\n        self.counter += 1\n        self.pub.publish(msg)\n        if self.counter &gt; 5:\n            self.destroy_timer(self.timer)\n            self.destroy_publisher(self.pub)\n\ndef main(args=None):\n    rclpy.init(args=args)\n    pub_node = PubNode()\n    sub_node = SubNode()\n    executer = MultiThreadedExecutor()\n    executer.add_node(pub_node)\n    executer.add_node(sub_node)\n\n    executer.spin()\n\n\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n</code></pre> <p>The demo code stop to publish after 5 sec, the subscriber trigger the deadline_missed_callback callback</p> <p>Note</p> <p>The publisher rate and deadline both are 1 hz,  the alert in line 6,8 occurs because the narrower delta</p> deadline<pre><code>[INFO] [1742149968.340318813] [pub_node]: Hello PUB\n[INFO] [1742149968.341837588] [sub_node]: --Create subscriber--\n[INFO] [1742149968.342220114] [sub_node]: Hello SUB\n[INFO] [1742149969.337432339] [sub_node]: Received: hello 0\n[INFO] [1742149970.335727680] [sub_node]: Received: hello 1\n[WARN] [1742149971.337700875] [sub_node]: Deadline missed !!\n[INFO] [1742149971.339943550] [sub_node]: Received: hello 2\n[WARN] [1742149972.338132778] [sub_node]: Deadline missed !!\n[INFO] [1742149972.340649610] [sub_node]: Received: hello 3\n[INFO] [1742149973.337361905] [sub_node]: Received: hello 4\n[INFO] [1742149974.337383148] [sub_node]: Received: hello 5\n[WARN] [1742149975.337733058] [sub_node]: Deadline missed !!\n[WARN] [1742149976.337944293] [sub_node]: Deadline missed !!\n[WARN] [1742149977.337851314] [sub_node]: Deadline missed !!\n[WARN] [1742149978.337756163] [sub_node]: Deadline missed !!\n[WARN] [1742149979.337504946] [sub_node]: Deadline missed !!\n[WARN] [1742149980.336326724] [sub_node]: Deadline missed !!\n</code></pre>","tags":["ros","qos"]},{"location":"ROS/ros_basic/ros_qos/#liveliness","title":"Liveliness","text":"<p>Use liveliness if you need to detect dead or disconnected publishers (e.g., checking if a node is still online).</p> <p>deadline</p> <p>Check that message are received on time</p> publisher <pre><code>#!/usr/bin/env python3\n\n\nimport rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\nfrom rclpy.qos import QoSProfile, LivelinessPolicy\nfrom rclpy.duration import Duration\n\nclass LivelinessPublisher(Node):\n    def __init__(self):\n        super().__init__('liveliness_publisher')\n\n        qos_profile = QoSProfile(\n            depth=10,\n            liveliness=LivelinessPolicy.MANUAL_BY_TOPIC,  # Publisher must assert liveliness\n            liveliness_lease_duration=Duration(seconds=3)  # Must assert within 3 seconds\n        )\n\n        self.publisher_ = self.create_publisher(String, 'liveliness_topic', qos_profile)\n        self.timer = self.create_timer(1.0, self.publish_message)  # Publish every 1s\n        # self.liveliness_timer = self.create_timer(2.0, self.assert_liveliness)  # Assert liveliness every 2s\n        self.counter = 0\n\n    def publish_message(self):\n        msg = String()\n        msg.data = f'Hello {self.counter}'\n        self.publisher_.publish(msg)\n        self.get_logger().info(f'Published: {msg.data}')\n        self.counter += 1\n\n    def assert_liveliness(self):\n        self.publisher_.assert_liveliness()  # Manually assert that publisher is alive\n        self.get_logger().info('Liveliness asserted')\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = LivelinessPublisher()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n</code></pre> subscriber <pre><code>#!/usr/bin/env python3\n\nimport rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\nfrom rclpy.qos import QoSProfile, LivelinessPolicy\nfrom rclpy.qos_event import SubscriptionEventCallbacks\nfrom rclpy.duration import Duration\n\nclass LivelinessSubscriber(Node):\n    def __init__(self):\n        super().__init__('liveliness_subscriber')\n\n        qos_profile = QoSProfile(\n            depth=10,\n            liveliness=LivelinessPolicy.MANUAL_BY_TOPIC,\n            liveliness_lease_duration=Duration(seconds=3)  # Expecting liveliness assertion every 3s\n        )\n\n        event_callbacks = SubscriptionEventCallbacks(\n            liveliness=self.liveliness_callback\n        )\n\n        self.subscription = self.create_subscription(\n            String,\n            'liveliness_topic',\n            self.listener_callback,\n            qos_profile,\n            event_callbacks=event_callbacks\n        )\n\n    def listener_callback(self, msg):\n        self.get_logger().info(f'Received: {msg.data}')\n\n    def liveliness_callback(self, event):\n        if event.alive_count == 0:\n            self.get_logger().warn('Liveliness lost! Publisher is inactive.')\n        else:\n            self.get_logger().info(f'Liveliness changed. Active publishers: {event.alive_count}')\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = LivelinessSubscriber()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n</code></pre> <ul> <li>Run the subscriber</li> <li>Start/Stop the publisher trigger the event</li> </ul> liveliness<pre><code>[INFO] [1742157714.393511232] [liveliness_subscriber]: Liveliness changed. Active publishers: 1\n[INFO] [1742157715.395080289] [liveliness_subscriber]: Received: Hello 0\n[INFO] [1742157716.395343254] [liveliness_subscriber]: Received: Hello 1\n[INFO] [1742157717.395050895] [liveliness_subscriber]: Received: Hello 2\n[INFO] [1742157718.395029525] [liveliness_subscriber]: Received: Hello 3\n[INFO] [1742157719.394828524] [liveliness_subscriber]: Received: Hello 4\n[WARN] [1742157720.395358162] [liveliness_subscriber]: Liveliness lost! Publisher is inactive.\n</code></pre>","tags":["ros","qos"]},{"location":"ROS/ros_cpp/","title":"ROS2 Cpp","text":"<p>ROS</p> <p>VSCode dev environment</p> <p>Pluginlib</p> <p>cmake tips</p>","tags":["ros","cpp"]},{"location":"ROS/ros_cpp/#simple-node","title":"Simple Node","text":"<p>Simple cpp node with <code>CMakeLists.txt</code>  Using clang as compiler</p> <p>set clang using update-alternative</p> <pre><code>sudo update-alternatives --install /usr/bin/clang clang /usr/bin/clang-18 100\nsudo update-alternatives --install /usr/bin/clang++ clang++ /usr/bin/clang++-18 100\n</code></pre> <ul> <li>using <code>fmt</code> library to better string format</li> </ul> Simple node <pre><code>#include &lt;chrono&gt;\n#include &lt;memory&gt;\n#include &lt;string&gt;\n#include &lt;fmt/core.h&gt;\n\n#include \"rclcpp/rclcpp.hpp\"\n#include \"std_msgs/msg/string.hpp\"\n\nusing namespace std::chrono_literals;\n\nclass StringPublisher : public rclcpp::Node\n{\npublic:\n    StringPublisher()\n    : Node(\"string_publisher\"), count_(0)\n    {\n        publisher_ = this-&gt;create_publisher&lt;std_msgs::msg::String&gt;(\"chatter\", 10);\n        timer_ = this-&gt;create_wall_timer(\n            500ms, std::bind(&amp;StringPublisher::timer_callback, this));\n    }\n\nprivate:\n    void timer_callback()\n    {\n        auto message = std_msgs::msg::String();\n        message.data = \"Hello, ROS 2! \" + std::to_string(count_++);\n        RCLCPP_INFO(this-&gt;get_logger(), fmt::format(\"Publishing: {}\", message.data).c_str());\n        publisher_-&gt;publish(message);\n    }\n    rclcpp::Publisher&lt;std_msgs::msg::String&gt;::SharedPtr publisher_;\n    rclcpp::TimerBase::SharedPtr timer_;\n    size_t count_;\n};\n\nint main(int argc, char * argv[])\n{\n    rclcpp::init(argc, argv);\n    rclcpp::spin(std::make_shared&lt;StringPublisher&gt;());\n    rclcpp::shutdown();\n    return 0;\n}\n</code></pre> CMakeLists.txt <pre><code>cmake_minimum_required(VERSION 3.8)\nproject(cpp_demo)\n\nset(CMAKE_C_COMPILER clang)\nset(CMAKE_CXX_COMPILER clang++)\n\n# Set C++ standard to C++17\nset(CMAKE_CXX_STANDARD 17)\nset(CMAKE_CXX_STANDARD_REQUIRED ON)\nset(CMAKE_CXX_EXTENSIONS OFF)  # Disable compiler-specific extensions\n\nif(CMAKE_COMPILER_IS_GNUCXX OR CMAKE_CXX_COMPILER_ID MATCHES \"Clang\")\n  add_compile_options(-Wall -Wextra -Wpedantic)\nendif()\n\n# find dependencies\nfind_package(ament_cmake REQUIRED)\nfind_package(rclcpp REQUIRED)\nfind_package(std_msgs REQUIRED)\nfind_package(fmt REQUIRED)\n\nadd_executable(pub_demo src/pub_demo.cpp)\ntarget_link_libraries(pub_demo fmt::fmt)\nament_target_dependencies(pub_demo rclcpp std_msgs)\n\ninstall(TARGETS pub_demo\n  DESTINATION lib/${PROJECT_NAME}\n)\nament_package()\n</code></pre> VSCode c_cpp_properties.json <pre><code>{\n    \"configurations\": [\n        {\n            \"name\": \"ros\",\n            \"includePath\": [\n                \"/opt/ros/jazzy/include/**\"\n            ],\n            \"defines\": [],\n            \"compilerPath\": \"/usr/bin/clang++\",\n            \"cStandard\": \"c17\",\n            \"cppStandard\": \"c++17\",\n            \"intelliSenseMode\": \"linux-clang-x64\"\n        }\n    ],\n    \"version\": 4\n}\n</code></pre> <p>More basic examples</p> <p>---</p> <p>---</p>","tags":["ros","cpp"]},{"location":"ROS/ros_cpp/basic/","title":"Create simple pub/sun node","text":"<p>ROS / ros cpp</p> <p>Basic ros2 node using cpp, split the code into header file in implementation</p>","tags":["ros2","cpp","pub","node","tutorial"]},{"location":"ROS/ros_cpp/basic/#publisher","title":"Publisher","text":"<p>Separate node file into header and implementation file, use main file as entry point</p> <pre><code>cpp_demo\n\u251c\u2500\u2500 CMakeLists.txt\n\u251c\u2500\u2500 include\n\u2502   \u2514\u2500\u2500 cpp_demo\n\u2502       \u2514\u2500\u2500 string_publisher.hpp\n\u251c\u2500\u2500 package.xml\n\u2514\u2500\u2500 src\n    \u251c\u2500\u2500 pub_demo_main.cpp\n    \u2514\u2500\u2500 string_publisher.cpp\n</code></pre> <ol> <li>Code Reusability<ul> <li>The class (e.g., your publisher node) can be reused in other projects or tests without modification.</li> <li>Only the main file is responsible for launching the node, while the logic is encapsulated in the class.</li> </ul> </li> <li>Separation of Concerns<ul> <li>The main function handles application startup and shutdown.</li> <li>The class handles the node\u2019s logic (publishing, subscribing, etc.).</li> </ul> </li> <li>Easier Testing<ul> <li>You can write unit tests for your class without running the whole ROS node.</li> <li>The class can be instantiated and tested independently from the ROS2 runtime.</li> </ul> </li> <li>Cleaner Build Structure<ul> <li>Header and implementation files (.hpp/.cpp) keep interfaces and logic organized.</li> <li>The main.cpp file is small and only responsible for node instantiation and spinning.</li> </ul> </li> </ol> include/string_publisher.hpp <pre><code>#pragma once\n\n#include &lt;rclcpp/rclcpp.hpp&gt;\n#include &lt;std_msgs/msg/string.hpp&gt;\n\nclass StringPublisher : public rclcpp::Node\n{\npublic:\n    StringPublisher();\n\nprivate:\n    void timer_callback();\n    rclcpp::Publisher&lt;std_msgs::msg::String&gt;::SharedPtr publisher_;\n    rclcpp::TimerBase::SharedPtr timer_;\n    size_t count_;\n};\n</code></pre> pub_demo_main.cpp <pre><code>#include \"cpp_demo/string_publisher.hpp\"\n#include &lt;rclcpp/rclcpp.hpp&gt;\n\nint main(int argc, char * argv[])\n{\n    rclcpp::init(argc, argv);\n    rclcpp::spin(std::make_shared&lt;StringPublisher&gt;());\n    rclcpp::shutdown();\n    return 0;\n}\n</code></pre> string_publisher.cpp <pre><code>#include \"cpp_demo/string_publisher.hpp\"\n#include &lt;fmt/core.h&gt;\n\nusing namespace std::chrono_literals;\n\nStringPublisher::StringPublisher()\n: Node(\"string_publisher\"), count_(0)\n{\n    publisher_ = this-&gt;create_publisher&lt;std_msgs::msg::String&gt;(\"chatter\", 10);\n    timer_ = this-&gt;create_wall_timer(\n        500ms, std::bind(&amp;StringPublisher::timer_callback, this));\n}\n\nvoid StringPublisher::timer_callback()\n{\n    auto message = std_msgs::msg::String();\n    message.data = fmt::format(\"Hello, ROS 2! {}\", count_++);\n    RCLCPP_INFO(this-&gt;get_logger(), \"%s\", fmt::format(\"Publishing: {}\", message.data).c_str());\n    publisher_-&gt;publish(message);\n}\n</code></pre> CMakeLists.txt <pre><code>cmake_minimum_required(VERSION 3.8)\nproject(cpp_demo)\n\nset(CMAKE_C_COMPILER clang)\nset(CMAKE_CXX_COMPILER clang++)\n\n# Set C++ standard to C++17\nset(CMAKE_CXX_STANDARD 17)\nset(CMAKE_CXX_STANDARD_REQUIRED ON)\nset(CMAKE_CXX_EXTENSIONS OFF)  # Disable compiler-specific extensions\n\nif(CMAKE_COMPILER_IS_GNUCXX OR CMAKE_CXX_COMPILER_ID MATCHES \"Clang\")\n  add_compile_options(-Wall -Wextra -Wpedantic)\nendif()\n\n# find dependencies\nfind_package(ament_cmake REQUIRED)\nfind_package(rclcpp REQUIRED)\nfind_package(std_msgs REQUIRED)\nfind_package(fmt REQUIRED)\n\n\n# Add include directory\ninclude_directories(include)\n\n# Build the split StringPublisher node\nadd_executable(pub_demo src/pub_demo_main.cpp src/string_publisher.cpp)\ntarget_link_libraries(pub_demo fmt::fmt)\nament_target_dependencies(pub_demo rclcpp std_msgs)\n\ninstall(TARGETS pub_demo\n  DESTINATION lib/${PROJECT_NAME}\n)\nament_package()\n</code></pre>","tags":["ros2","cpp","pub","node","tutorial"]},{"location":"ROS/ros_cpp/cmake_tips/","title":"ROS cmake usage tips","text":"","tags":["cmake","ros","cmakelist","tips"]},{"location":"ROS/ros_cpp/cmake_tips/#install-directory-set-permission-and-filter","title":"Install directory set permission and filter","text":"<pre><code>install(DIRECTORY bin/\n        DESTINATION share/${PROJECT_NAME}\n        FILES_MATCHING PATTERN \"*.py\"\n        PERMISSIONS OWNER_READ GROUP_READ WORLD_READ OWNER_EXECUTE WORLD_EXECUTE)\n</code></pre>","tags":["cmake","ros","cmakelist","tips"]},{"location":"ROS/ros_cpp/cmake_tips/#install-file-set-permission","title":"Install file set permission","text":"<pre><code>install(FILES config.yaml\n        DESTINATION share/${PROJECT_NAME}/config\n        PERMISSIONS OWNER_READ GROUP_READ WORLD_READ)\n</code></pre>","tags":["cmake","ros","cmakelist","tips"]},{"location":"ROS/ros_cpp/cmake_tips/#architecture-detection","title":"Architecture Detection","text":"<pre><code>if(CMAKE_SYSTEM_PROCESSOR STREQUAL \"x86_64\")\n  message(STATUS \"Building for x86_64 architecture\")\nelseif(CMAKE_SYSTEM_PROCESSOR STREQUAL \"aarch64\")\n  message(STATUS \"Building for ARM64 (aarch64)\")\nelse()\n  message(STATUS \"Unknown architecture: ${CMAKE_SYSTEM_PROCESSOR}\")\nendif()\n</code></pre>","tags":["cmake","ros","cmakelist","tips"]},{"location":"ROS/ros_cpp/dev/","title":"ROS2 C++ VSCode setup","text":"<p>ROS / ros cpp</p> <p>Config VScode for ROS2 cpp package  using</p>","tags":["ros","vscode","ide"]},{"location":"ROS/ros_cpp/dev/#configuration","title":"Configuration","text":"<p>The <code>c_cpp_properties.json</code> file configures IntelliSense, code completion, and error checking for C/C++ projects in VS Code.</p> c_cpp_properties.json for gcc  for gcc compiler <pre><code>{\n    \"configurations\": [\n        {\n            \"name\": \"ros\",\n            \"includePath\": [\n                \"/opt/ros/jazzy/include/**\",\n                \"${workspaceFolder}/src/**\"\n            ],\n            \"defines\": [],\n            \"compilerPath\": \"/usr/bin/g++\",\n            \"cStandard\": \"c17\",\n            \"cppStandard\": \"c++17\",\n            \"intelliSenseMode\": \"linux-gcc-x64\"\n        }\n    ],\n    \"version\": 4\n}\n</code></pre> <ul> <li>includePath: Directories for header file lookup. Includes ROS headers and your workspace\u2019s src folder.</li> <li>defines: Preprocessor macros (empty in this config).</li> <li>cStandard and cppStandard: C and C++ language standards (c17 and c++17). ros jazzy build with this standard</li> <li>intelliSenseMode: IntelliSense engine mode (linux-gcc-x64 for Linux GCC).</li> </ul>","tags":["ros","vscode","ide"]},{"location":"ROS/ros_cpp/dev/#build","title":"Build","text":"","tags":["ros","vscode","ide"]},{"location":"ROS/ros_cpp/dev/#tasks","title":"Tasks","text":".vscode/tasks.json","tags":["ros","vscode","ide"]},{"location":"ROS/ros_cpp/dev/#tests","title":"Tests","text":"<pre><code>colcon test --event-handlers console_direct+\n\n# specific package\ncolcon test --packages-select loc_application  --event-handlers console_direct+\n</code></pre>","tags":["ros","vscode","ide"]},{"location":"ROS/ros_cpp/pluginlib/","title":"ROS Pluginlib","text":"<p>Pluginlib is a C++ library for loading and unloading plugins from within a ROS package. Plugins are dynamically loadable classes that are loaded from a runtime library (shared object)</p>","tags":["ros","plugins","pluginlib","cpp"]},{"location":"ROS/ros_cpp/pluginlib/#demo","title":"Demo","text":"<p>Demo how to use pluginlib , the demo include 3 packages:</p> <ul> <li>polygon_base: Interface declaration</li> <li>polygons: Plugin implementation</li> <li>polygons_app: Plugin usage</li> </ul>","tags":["ros","plugins","pluginlib","cpp"]},{"location":"ROS/ros_cpp/pluginlib/#package-setup","title":"Package setup","text":"<pre><code>ros2 pkg create polygon_base --build-type ament_cmake\nros2 pkg create polygons --build-type ament_cmake --dependencies pluginlib polygon_base\nros2 pkg create polygons_app --build-type ament_cmake --dependencies pluginlib polygon_base\n</code></pre>","tags":["ros","plugins","pluginlib","cpp"]},{"location":"ROS/ros_cpp/pluginlib/#polygon_base","title":"polygon_base","text":"<p>polygon_base expose the abstract class that the plugin need to implement The plugin constructor need to haven't any parameters and for plugin initialization we use the <code>init</code> method</p> include/polygon_base/polygon.hpp<pre><code>#pragma once\n\nnamespace PolygonBase\n{\n    class Polygon\n    {\n    public:\n        //! Necessary since constructor can't have parameters!\n        virtual void init(double side_length) = 0; // 1\n        virtual double area() = 0;\n        virtual ~Polygon() {}\n\n    protected:\n        //! This costructor signature is required by pluginlib\n        Polygon() {}\n    };\n\n} // namespace PolygonBase\n</code></pre> <p>Build the package and expose the <code>include</code> folder downstream to other packages</p> CMakeLists.txt<pre><code>cmake_minimum_required(VERSION 3.8)\nproject(polygon_base)\n\nif(CMAKE_COMPILER_IS_GNUCXX OR CMAKE_CXX_COMPILER_ID MATCHES \"Clang\")\n  add_compile_options(-Wall -Wextra -Wpedantic)\nendif()\n\n# find dependencies\nfind_package(ament_cmake REQUIRED)\n\ninstall(DIRECTORY include/  #(1)\n  DESTINATION include)\n\nament_export_include_directories(include) #(2)\n\nament_package()\n</code></pre> <ol> <li>Copy the include folder to installation folder</li> <li>ament_export_include_directories: exports your package\u2019s include directories (e.g., include/) to downstream packages, making headers like provider_pkg/provider.hpp discoverable via ${provider_pkg_INCLUDE_DIRS}.</li> </ol>","tags":["ros","plugins","pluginlib","cpp"]},{"location":"ROS/ros_cpp/pluginlib/#polygons","title":"polygons","text":"<p>Implement plugins and build them as shared library and expose the to pluginlib infa using xml declaration</p> <p>package.xml</p> <p>Don't forget to insert package dependencies <pre><code>&lt;depend&gt;polygon_base&lt;/depend&gt;\n&lt;depend&gt;pluginlib&lt;/depend&gt;\n</code></pre></p> <pre><code>\u251c\u2500\u2500 CMakeLists.txt\n\u251c\u2500\u2500 include\n\u2502   \u2514\u2500\u2500 polygons\n\u2502       \u2514\u2500\u2500 square.hpp\n\u251c\u2500\u2500 package.xml\n\u251c\u2500\u2500 plugins_triangle.xml\n\u251c\u2500\u2500 plugins.xml\n\u2514\u2500\u2500 src\n    \u251c\u2500\u2500 square.cpp\n    \u2514\u2500\u2500 triangle.cpp\n</code></pre> src/triangle.cpp<pre><code> #include &lt;cmath&gt;\n #include &lt;polygon_base/polygon.hpp&gt;\n\n namespace Polygons\n {\n\n    class Triangle : public PolygonBase::Polygon\n    {\n        void init(double side_length)\n        {\n        side_length_ = side_length;\n        }\n\n\n        double area()\n        {\n        return 0.5 * side_length_ * compute_height();\n        }\n\n\n        double compute_height()\n        {\n        return sqrt((side_length_ * side_length_) - ((side_length_ / 2.0) * (side_length_ / 2.0)));\n        }\n\n        private: // (2) best practice to declare private as protected, but it's ok for basic types\n            double side_length_;\n    };\n\n }  // namespace Polygons\n\n#include &lt;pluginlib/class_list_macros.hpp&gt;  //(1)\nPLUGINLIB_EXPORT_CLASS(Polygons::Triangle, PolygonBase::Polygon)\n</code></pre> <ol> <li>Register the plugin in Pluginlib infra</li> <li>Best practice to use internal variable as protected (Private members might cause issues in dynamic loading scenarios.)</li> </ol> plugins_triangle.xml<pre><code>&lt;library path=\"triangle\"&gt; \n  &lt;class type=\"Polygons::Triangle\" base_class_type=\"PolygonBase::Polygon\"&gt;\n    &lt;description&gt;This is a Triangle plugin.&lt;/description&gt;\n  &lt;/class&gt;\n&lt;/library&gt;\n</code></pre> CMakeLists.txt<pre><code>cmake_minimum_required(VERSION 3.8)\nproject(polygons)\n\nif(CMAKE_COMPILER_IS_GNUCXX OR CMAKE_CXX_COMPILER_ID MATCHES \"Clang\")\n  add_compile_options(-Wall -Wextra -Wpedantic)\nendif()\n\n# find dependencies\nfind_package(ament_cmake REQUIRED)\nfind_package(polygon_base REQUIRED)\nfind_package(pluginlib REQUIRED)\n\n\nadd_library(triangle SHARED src/triangle.cpp)\ntarget_compile_features(triangle PUBLIC c_std_99 cxx_std_17)  # Require C99 and C++17\nament_target_dependencies(\n  triangle\n  pluginlib\n  polygon_base)\n\n\ninstall(\n  TARGETS triangle\n  EXPORT export_${PROJECT_NAME} #(2)\n  LIBRARY DESTINATION lib)\n\n\npluginlib_export_plugin_description_file(polygon_base plugins_triangle.xml) #(1)\n\n\nament_package()\n</code></pre> <ol> <li>The macro PLUGINLIB_EXPORT_PLUGIN_DESCRIPTION_FILE is used in ROS 2 pluginlib to specify the plugin XML file that describes available plugins. This macro helps the pluginlib system locate and register plugins when loading them dynamically.</li> <li>The install() command in CMake is used to define installation rules for compiled targets (executables, libraries, etc.). The EXPORT keyword allows us to export a CMake target so that other projects can easily find and use it.</li> </ol>","tags":["ros","plugins","pluginlib","cpp"]},{"location":"ROS/ros_cpp/pluginlib/#square-plugin","title":"Square Plugin","text":"<p>Add square plugin, for the purpose of the demo build it as separate library (so)</p> Header file <pre><code>#pragma once\n\n#include &lt;polygon_base/polygon.hpp&gt;\n\n//! Namespaces must reflect what is written in plugins.xml!\nnamespace Polygons\n{\n\n    /**\n     * Regular polygon with four sides.\n     */\n    class Square : public PolygonBase::Polygon\n    {\n    public:\n        void init(double side_length) override;\n        double area() override;\n\n    //! There must not be any private members (best practice)\n    protected:\n        double side_length_;\n    };\n\n} // namespace Polygons\n\n//! Necessary to register plugin classes with pluginlib\n#include &lt;pluginlib/class_list_macros.hpp&gt;\nPLUGINLIB_EXPORT_CLASS(Polygons::Square, PolygonBase::Polygon)\n</code></pre> plugin cpp file square.cpp<pre><code>#include &lt;cmath&gt;\n\n#include \"polygons/square.hpp\"\n\nnamespace Polygons\n{\n\n    void Square::init(double side_length)\n    {\n        side_length_ = side_length;\n    }\n\n    double Square::area()\n    {\n        return pow(side_length_, 2.0);\n    }\n\n}\n</code></pre> Plugin xml plugins.xml<pre><code>&lt;library path=\"square\"&gt;\n  &lt;class type=\"Polygons::Square\" base_class_type=\"PolygonBase::Polygon\"&gt;\n    &lt;description&gt;This is a square plugin.&lt;/description&gt;\n  &lt;/class&gt;\n&lt;/library&gt;\n</code></pre> Full CMakeLists.txt <pre><code>cmake_minimum_required(VERSION 3.8)\nproject(polygons)\n\nif(CMAKE_COMPILER_IS_GNUCXX OR CMAKE_CXX_COMPILER_ID MATCHES \"Clang\")\n  add_compile_options(-Wall -Wextra -Wpedantic)\nendif()\n\n# find dependencies\nfind_package(ament_cmake REQUIRED)\nfind_package(polygon_base REQUIRED)\nfind_package(pluginlib REQUIRED)\n\n# square library\nadd_library(square SHARED src/square.cpp)\ntarget_compile_features(square PUBLIC c_std_99 cxx_std_17)  # Require C99 and C++17\ntarget_include_directories(square PUBLIC\n  $&lt;BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/include&gt;\n  $&lt;INSTALL_INTERFACE:include&gt;)\nament_target_dependencies(\n  square\n  pluginlib\n  polygon_base)\n\n# square library\nadd_library(triangle SHARED src/triangle.cpp)\ntarget_compile_features(triangle PUBLIC c_std_99 cxx_std_17)  # Require C99 and C++17\n\nament_target_dependencies(\n  triangle\n  pluginlib\n  polygon_base)\n\ninstall(\n    TARGETS square\n    EXPORT export_${PROJECT_NAME}\n    LIBRARY DESTINATION lib)\n\ninstall(\n  TARGETS triangle\n  EXPORT export_${PROJECT_NAME}\n  LIBRARY DESTINATION lib)\n\n#! link plugins with base class for pluginlib\npluginlib_export_plugin_description_file(polygon_base plugins.xml)\npluginlib_export_plugin_description_file(polygon_base plugins_triangle.xml)\n\n\nament_package()\n</code></pre>","tags":["ros","plugins","pluginlib","cpp"]},{"location":"ROS/ros_cpp/pluginlib/#polygon_app","title":"Polygon_app","text":"<p>ROS package that load the plugin dynamically and usage it</p> src/main.cpp<pre><code>#include &lt;iostream&gt;\n#include &lt;pluginlib/class_loader.hpp&gt;\n#include &lt;polygon_base/polygon.hpp&gt;\n\n#define UNUSED(arg) (void)(arg)\n\nint main(int argc, char ** argv)\n{\n  UNUSED(argc);\n  UNUSED(argv);\n\n  try\n  {\n    pluginlib::ClassLoader&lt;PolygonBase::Polygon&gt; loader(\"polygon_base\", \"PolygonBase::Polygon\");\n\n    std::shared_ptr&lt;PolygonBase::Polygon&gt; square = loader.createSharedInstance(\"Polygons::Square\");\n    std::shared_ptr&lt;PolygonBase::Polygon&gt; triangle = loader.createSharedInstance(\"Polygons::Triangle\");\n\n    triangle-&gt;init(10.0);\n    square-&gt;init(10.0);\n\n    std::cout &lt;&lt; \"Square area: \" &lt;&lt; square-&gt;area() &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"Triangle area: \" &lt;&lt; triangle-&gt;area() &lt;&lt; std::endl;\n  }\n  catch(const pluginlib::PluginlibException &amp; e)\n  {\n    std::cerr &lt;&lt; e.what() &lt;&lt; std::endl;\n    exit(EXIT_FAILURE);\n  }\n\n\n  exit(EXIT_SUCCESS);\n}\n</code></pre> CMakeLists.txt<pre><code>cmake_minimum_required(VERSION 3.8)\nproject(polygons_app)\n\nif(CMAKE_COMPILER_IS_GNUCXX OR CMAKE_CXX_COMPILER_ID MATCHES \"Clang\")\n  add_compile_options(-Wall -Wextra -Wpedantic)\nendif()\n\n# find dependencies\nfind_package(ament_cmake REQUIRED)\nfind_package(pluginlib REQUIRED)\nfind_package(polygon_base REQUIRED)\n\nadd_executable(polygons_tester src/main.cpp)\ntarget_compile_features(polygons_tester PUBLIC c_std_99 cxx_std_17)  # Require C99 and C++17\nament_target_dependencies(\n  polygons_tester\n  pluginlib\n  polygon_base)\n\ninstall(TARGETS polygons_tester\n  DESTINATION lib/${PROJECT_NAME})\n\nament_package()\n</code></pre> <p>The package not know about the <code>plugins</code> package it loaded dynamic by the pluginlib. It only reference to the package with the abstract class</p> package.xml<pre><code>  &lt;depend&gt;pluginlib&lt;/depend&gt;\n  &lt;depend&gt;polygon_base&lt;/depend&gt;\n</code></pre>","tags":["ros","plugins","pluginlib","cpp"]},{"location":"ROS/ros_cpp/pluginlib/#usage","title":"Usage","text":"<pre><code>ros2 run polygons_app polygons_tester \n#\nSquare area: 100\nTriangle area: 43.3013\n</code></pre>","tags":["ros","plugins","pluginlib","cpp"]},{"location":"ROS/ros_eco/","title":"ROS Eco system","text":"<p>Ros packages and tools that are used in the ROS eco system.</p> <p>ROS2 launch</p> <p>ROS2 Packages</p> <p>ROS2 Bag</p> <p>URDF, XACRO and Gazebo</p> <p>Build System</p> <p>rviz, rqt and other tools</p> <p>ROS Hardware</p>"},{"location":"ROS/ros_eco/build_system/","title":"Build System","text":"<p>Colcon</p> <p>ament</p> <p>bloom and rosdep</p> <p>ROS: The build system</p>","tags":["ros","build system","colcon","ament"]},{"location":"ROS/ros_eco/build_system/#colcon-clean","title":"colcon-clean","text":"<p>Extension for colcon to clean package workspaces</p> <pre><code>sudo apt install python3-colcon-clean\n# ubuntu 24.04\npip install colcon-clean\n</code></pre> Usage<pre><code>colcon clean workspace\n\ncolcon clean packages \n</code></pre>","tags":["ros","build system","colcon","ament"]},{"location":"ROS/ros_eco/build_system/#colcon-mixin","title":"colcon-mixin","text":"<p>Colcon mixin is a powerful feature of the colcon build system that allows you to define and reuse commonly used build configurations. It's particularly useful for cross-compilation scenarios because it helps you avoid typing long, complex build commands repeatedly. cross compiler example</p> <pre><code>sudo apt install python3-colcon-mixin\n</code></pre> Usage<pre><code>colcon mixin list\n</code></pre>","tags":["ros","build system","colcon","ament"]},{"location":"ROS/ros_eco/build_system/ament/","title":"ament","text":"<ul> <li>The build system for ROS 2 packages</li> <li>A set of tools, CMake macros, and Python utilities</li> </ul> <p>ament_environment_hooks</p> <p>tbd</p>","tags":["ros","build","ament","hooks","dsv"]},{"location":"ROS/ros_eco/build_system/ament/ament_cmake_extension/","title":"Ament cmake extension","text":"","tags":["ament","ros","build system"]},{"location":"ROS/ros_eco/build_system/ament/ament_cmake_extension/#reference","title":"Reference","text":"<ul> <li>ament_cmake_extension</li> </ul>","tags":["ament","ros","build system"]},{"location":"ROS/ros_eco/build_system/ament/ament_macros/ament_environment_hooks/","title":"ament_environment_hooks using .dev file","text":"<p><code>.dsv</code> file use to export environment variables in your ROS 2 package is a delimiter-separated description of environment variable operations.</p> <pre><code>&lt;operation&gt;;&lt;variable&gt;;&lt;value&gt;\n</code></pre> Operation Meaning <code>set</code> Overwrite the variable <code>prepend</code> Add a value at the beginning <code>prepend-non-duplicate</code> Same as prepend, BUT avoid duplicates <code>append</code> Add at the end <code>append-non-duplicate</code> Same as append, but avoid duplicates <code>path</code> Special logic for PATH-like variables","tags":["ros","ament_environment_hooks","ament","hooks","dsv","GZ_SIM_RESOURCE_PATH"]},{"location":"ROS/ros_eco/build_system/ament/ament_macros/ament_environment_hooks/#demo","title":"Demo","text":"<p>package name: bumperbot_gazebo</p> <p>!!! Note dsv.in     Becomes <code>.dsv</code> after build</p> hooks/.dsv.in<pre><code>prepend-non-duplicate;GZ_SIM_RESOURCE_PATH;@CMAKE_INSTALL_PREFIX@/share/@PROJECT_NAME@/worlds\n</code></pre> <p>!!! Tip substitutions can you use inside .in files     Any CMake variable can be substituted using:     <pre><code>@VARIABLE_NAME@\n</code></pre></p> <pre><code>examples\n\n| CMake variable                    | Meaning                                                |\n| --------------------------------- | ------------------------------------------------------ |\n| `@CMAKE_INSTALL_PREFIX@`          | The installation path of the package                   |\n| `@PROJECT_NAME@`                  | Name of the current CMake project (ROS 2 package name) |\n| `@PROJECT_VERSION@`               | Version from `project()`                               |\n| `@CMAKE_CURRENT_SOURCE_DIR@`      | Source folder                                          |\n| `@CMAKE_CURRENT_BINARY_DIR@`      | Build folder                                           |\n| `@CMAKE_INSTALL_FULL_LIBDIR@`     | Install lib directory                                  |\n| `@CMAKE_INSTALL_FULL_INCLUDEDIR@` | Install include directory                              |\n| `@CMAKE_PREFIX_PATH@`             | Prefix path list                                       |\n| `@CMAKE_BINARY_DIR@`              | Workspace build root                                   |\n| `@CMAKE_SOURCE_DIR@`              | Workspace source root                                  |\n</code></pre> <ul> <li>Add <code>ament_environment_hooks</code> to CMakeLists.txt <pre><code>ament_environment_hooks(\"${CMAKE_CURRENT_SOURCE_DIR}/hooks/${PROJECT_NAME}.dsv.in\")\n</code></pre></li> </ul> <p>Note</p> <ul> <li> <p>gazebo_resource.dsv.in \u2192 configured by CMake \u2192 becomes .dsv file.</p> </li> <li> <p>colcon reads the .dsv file when generating local_setup.*.</p> </li> <li> <p>For EACH shell it creates code based on the .dsv instructions.</p> </li> </ul> <ul> <li>build using colcon</li> <li>source install/setup.bash</li> <li>check </li> </ul> <pre><code>echo $GZ_SIM_RESOURCE_PATH\n</code></pre>","tags":["ros","ament_environment_hooks","ament","hooks","dsv","GZ_SIM_RESOURCE_PATH"]},{"location":"ROS/ros_eco/build_system/rosdep_bloom/","title":"Package.xml, Rosdep, Bloom and other tools","text":"","tags":["ros","rosdep","bloom","package.xml"]},{"location":"ROS/ros_eco/build_system/rosdep_bloom/#packagexml","title":"Package.xml","text":"<p>It provides metadata about the package, such as its name, version, dependencies, and other important information.</p> <p>check REP 149 for more details here</p>","tags":["ros","rosdep","bloom","package.xml"]},{"location":"ROS/ros_eco/build_system/rosdep_bloom/#dependencies","title":"Dependencies","text":"<ul> <li>depend: Specifies dependencies required to build and run the package.  A  tag is equivalent to specifying ,  and , all on the same package or key. The  tag cannot be used in combination with any of the three equivalent tags for the same package or key name. <li>build_depend: Specifies dependencies required to build the package (e.g., libraries needed at build time).</li> <li>exec_depend: Specifies runtime dependencies (e.g., libraries or tools needed when running the package).</li> <li>test_depend: Specifies dependencies needed for running tests. doc_depend: Specifies dependencies related to documentation.</li> <li>buildtool_depend: Specifies build tools required for the package.</li>","tags":["ros","rosdep","bloom","package.xml"]},{"location":"ROS/ros_eco/build_system/rosdep_bloom/#rosdep","title":"Rosdep","text":"<p>rosdep is a command-line tool for installing system dependencies more</p> install<pre><code>sudo apt-get install python3-rosdep\n</code></pre>","tags":["ros","rosdep","bloom","package.xml"]},{"location":"ROS/ros_eco/build_system/rosdep_bloom/#commands","title":"commands","text":"<p>resdep command reference</p> <p>init<pre><code>sudo rosdep init\nrosdep update\n</code></pre> - init: Download/update rosdep sources to  <code>/etc/ros/rosdep/sources.list.d/20-default.list</code> - update: Download databases from the above sources and store them in <code>~/.ros/rosdep</code></p>","tags":["ros","rosdep","bloom","package.xml"]},{"location":"ROS/ros_eco/build_system/rosdep_bloom/#rosdep-install","title":"rosdep install","text":"install<pre><code>rosdep install --from-paths src --ignore-src -r -y\n</code></pre>","tags":["ros","rosdep","bloom","package.xml"]},{"location":"ROS/ros_eco/build_system/rosdep_bloom/#rosdep-check","title":"rosdep check","text":"<p>check if the dependencies of package(s) have been met.</p> check<pre><code>rosdep check --from-paths src --ignore-src -r\n</code></pre>","tags":["ros","rosdep","bloom","package.xml"]},{"location":"ROS/ros_eco/build_system/rosdep_bloom/#rosdep-keys","title":"rosdep keys","text":"<p>list the rosdep keys that the packages depend on.</p> <pre><code>rosdep keys --from-path src\n#\nrqt_gui_py\nament_cmake_pytest\nrqt_gui\nrosidl_default_runtime\nament_lint_common\ndiagnostic_updater\nrosidl_default_generators\nament_cmake\npython3-pyqt5\nament_lint_auto\n</code></pre>","tags":["ros","rosdep","bloom","package.xml"]},{"location":"ROS/ros_eco/build_system/rosdep_bloom/#rosdep-resolve-python3-rosdep","title":"rosdep resolve python3-rosdep","text":"<p>resolve <code>&lt;rosdeps&gt;</code> to system dependencies</p> <pre><code>#rosdep resolve &lt;rosdep&gt;\nrosdep resolve diagnostic_updater\n#apt\nros-humble-diagnostic-updater\n</code></pre> <p>Note</p> <p>for example <code>bluez-hcidump</code> not defined for <code>ubuntu</code> is <pre><code>rosdep resolve bluez-hcidump\n#\nWARNING: ROS_PYTHON_VERSION is unset. Defaulting to 3\n\nERROR: No definition of [bluez-hcidump] for OS [ubuntu]\n\nNo definition of [bluez-hcidump] for OS [ubuntu]\n        rosdep key : bluez-hcidump\n        OS name    : ubuntu\n        OS version : jammy\n        Data:\ndebian:\n                - bluez-hcidump\n                fedora:\n                - bluez-hcidump\n                gentoo:\n                - net-wireless/bluez-hcidump\n</code></pre></p>","tags":["ros","rosdep","bloom","package.xml"]},{"location":"ROS/ros_eco/build_system/rosdep_bloom/#rosdep-db","title":"rosdep db","text":"<p>generate the dependency database and print it to the console.</p> db<pre><code>rosdep db | grep diagnostic\n#\ndiagnostic_msgs -&gt; ros-humble-diagnostic-msgs\ndiagnostic_aggregator -&gt; ros-humble-diagnostic-aggregator\ndiagnostic_common_diagnostics -&gt; ros-humble-diagnostic-common-diagnostics\ndiagnostic_updater -&gt; ros-humble-diagnostic-updater\ndiagnostics -&gt; ros-humble-diagnostics\n...\n</code></pre>","tags":["ros","rosdep","bloom","package.xml"]},{"location":"ROS/ros_eco/build_system/rosdep_bloom/#rosdep-update","title":"rosdep update","text":"<p>update the local rosdep database based on the rosdep sources.</p>","tags":["ros","rosdep","bloom","package.xml"]},{"location":"ROS/ros_eco/build_system/rosdep_bloom/#custom-rosdep-yaml-file","title":"Custom rosdep yaml file","text":"<p>The yaml schema define in REP-111</p> <p>Note</p> <p>The rosdistro repository contains the package information for ROS distributions.  found in git https://github.com/ros/rosdistro/tree/master</p> <p>Note</p> <p><code>yaml     ROSDEP_NAME:         OS_NAME1:             PACKAGE_MANAGER1:             PACKAGE_ARGUMENTS_A         OS_NAME2:             PACKAGE_MANAGER2:             PACKAGE_ARGUMENTS_A</code></p> <ul> <li>package_manager: apt, pip</li> <li>os_name: ubuntu, debian</li> </ul> <p><code>yaml adafruit-pca9685-pip:     ubuntu:         pip:         packages: [adafruit-pca9685]</code></p>","tags":["ros","rosdep","bloom","package.xml"]},{"location":"ROS/ros_eco/build_system/rosdep_bloom/#demo-create-custom-rosdep-yaml-file","title":"Demo: Create custom rosdep yaml file","text":"<ul> <li>Create yaml file named <code>custom_rosdep.yaml</code></li> <li>Update rosdep sources</li> <li>Run rosdep update</li> <li>Check with rosdep resolve</li> </ul> custom_rosdeps.yaml<pre><code># ROSDEP_NAME:\n#   OS_NAME1:\n#     PACKAGE_MANAGER1:\n#       PACKAGE_ARGUMENTS_A\n\nparameters_utils:\n  ubuntu:\n    path: /workspace/submodules/parameters_utils\n    apt: ros-humble-parameters-utils\n</code></pre> <pre><code>sudo sh -c 'echo \"yaml file:///workspace/custom_rosdep.yaml\" &gt; /etc/ros/rosdep/sources.list.d/30-custom.list'\n</code></pre>","tags":["ros","rosdep","bloom","package.xml"]},{"location":"ROS/ros_eco/build_system/rosdep_bloom/#update","title":"Update","text":"update<pre><code>rosdep update\n#\nreading in sources list data from /etc/ros/rosdep/sources.list.d\nHit https://raw.githubusercontent.com/ros/rosdistro/master/rosdep/osx-homebrew.yaml\nHit https://raw.githubusercontent.com/ros/rosdistro/master/rosdep/base.yaml\nHit https://raw.githubusercontent.com/ros/rosdistro/master/rosdep/python.yaml\nHit https://raw.githubusercontent.com/ros/rosdistro/master/rosdep/ruby.yaml\nHit https://raw.githubusercontent.com/ros/rosdistro/master/releases/fuerte.yaml\nHit file:///workspace/custom_rosdep.yaml\n</code></pre>","tags":["ros","rosdep","bloom","package.xml"]},{"location":"ROS/ros_eco/build_system/rosdep_bloom/#resolve","title":"Resolve","text":"resolve<pre><code>rosdep resolve parameters_utils\n#apt\nros-humble-parameters-utils\n</code></pre>","tags":["ros","rosdep","bloom","package.xml"]},{"location":"ROS/ros_eco/build_system/rosdep_bloom/#bloom","title":"Bloom","text":"<p>A tool for helping release software into git-buildpackage repositories. more</p> install<pre><code>sudo apt-get install python3-bloom\nsudo apt install python3-rosdep \\\n    fakeroot \\\n    debhelper \\\n    dh-python\n</code></pre> <pre><code>bloom-generate rosdebian\n</code></pre> <p></p> <ul> <li>Add custom_rosdep.yaml to workspace</li> <li>Update rosdep sources</li> <li>Run rosdep update</li> </ul> custom_rosdeps.yaml<pre><code>pkg_server:\n  ubuntu:\n    apt: ros-humble-pkg-server\n</code></pre> 30-custom.list<pre><code>yaml file://&lt;workspace full path to yaml file&gt;/custom_rosdep.yaml\n</code></pre> <pre><code># run again\nbloom-generate rosdebian\n</code></pre> <p></p> build deb<pre><code>fakeroot debian/rules binary\n</code></pre>","tags":["ros","rosdep","bloom","package.xml"]},{"location":"ROS/ros_eco/build_system/rosdep_bloom/#check-deb-package","title":"Check deb package","text":"dpkg -I<pre><code>dpkg -I ros-humble-pkg-client_0.0.0-0jammy_amd64.deb \n#\n new Debian package, version 2.0.\n size 6390 bytes: control archive=1189 bytes.\n     233 bytes,     9 lines      control              \n    2650 bytes,    27 lines      md5sums              \n Package: ros-humble-pkg-client\n Version: 0.0.0-0jammy\n Architecture: amd64\n Maintainer: user &lt;robo2020@gmail.com&gt;\n Installed-Size: 62\n Depends: ros-humble-pkg-server\n Section: misc\n Priority: optional\n Description: TODO: Package description\n</code></pre>","tags":["ros","rosdep","bloom","package.xml"]},{"location":"ROS/ros_eco/build_system/rosdep_bloom/#tools","title":"Tools","text":"<p>Note</p> <p>git-buildpackage is a tool that helps you build Debian packages from a git repository. more</p>","tags":["ros","rosdep","bloom","package.xml"]},{"location":"ROS/ros_eco/build_system/rosdep_bloom/#references","title":"References","text":"<ul> <li>How to release a ROS 2 binary package</li> <li>to read</li> </ul>","tags":["ros","rosdep","bloom","package.xml"]},{"location":"ROS/ros_eco/build_system/rosdep_bloom/#todo-learn-more","title":"Todo: learn more","text":"","tags":["ros","rosdep","bloom","package.xml"]},{"location":"ROS/ros_eco/build_system/tips_settings/","title":"Tips / Settings","text":"","tags":["ros","colcon","tips","settings"]},{"location":"ROS/ros_eco/build_system/tips_settings/#colcon-auto-completion","title":"Colcon auto completion","text":"<p>colcon site</p> <p>source <code>colcon_argcomplete</code> in your <code>.bashrc</code> file</p> <pre><code># debian install location\nsource /usr/share/colcon_argcomplete/hook/colcon-argcomplete.bash\n</code></pre>","tags":["ros","colcon","tips","settings"]},{"location":"ROS/ros_eco/build_system/tips_settings/#colcon-defaults","title":"colcon defaults","text":"<p>colcon read the docs</p> <p>Set default option for <code>colcon</code> by create file <code>colcon_defaults.yaml</code> file at <code>workspace</code> directory.</p> colcon_defaults.yaml<pre><code>build:\n  # Use symlink install to speed up builds\n  symlink-install: true\n  # Set build type (e.g., Release or Debug)\n  cmake-args:\n    - \"-DCMAKE_BUILD_TYPE=Release\"\n\ntest:\n  # Run tests in parallel\n  parallel-workers: 4\n\n# Additional settings for colcon test and other commands\ntest-result:\n  verbose: true\n</code></pre>","tags":["ros","colcon","tips","settings"]},{"location":"ROS/ros_eco/launch/","title":"Index","text":"<p>ROS / ros eco</p>","tags":["ros","launch"]},{"location":"ROS/ros_eco/launch/#ros2-launch","title":"ROS2 launch","text":"<p>Launch system is used to start multiple nodes and configure their execution. The Python-based launch system (launch_ros) provides flexibility through Python scripts or YAML</p> <p>PYTHON</p> <p>YAML</p>","tags":["ros","launch"]},{"location":"ROS/ros_eco/launch/#minimal-yaml","title":"Minimal YAML","text":"<pre><code>launch:\n\n- node:\n    pkg: demo_nodes_cpp\n    exec: talker\n\n- node:\n    pkg: demo_nodes_cpp\n    exec: listener\n</code></pre>","tags":["ros","launch"]},{"location":"ROS/ros_eco/launch/#minimal-example","title":"Minimal example","text":"minimal launch file to run ros2 node<pre><code>from launch import LaunchDescription\nfrom launch_ros.actions import Node\n\ndef generate_launch_description():\n    ld = LaunchDescription()\n\n    node = Node(\n        package='your_package_name',\n        executable='your_node_executable',\n        name='your_node_name',\n        output='screen'\n    )\n\n    ld.add_action(node)\n\n    return ld\n</code></pre> cmake copy launch to share<pre><code>install(DIRECTORY launch/\n  DESTINATION share/${PROJECT_NAME}/launch\n)\n</code></pre>","tags":["ros","launch"]},{"location":"ROS/ros_eco/launch/#ros2-launch-system-api","title":"ROS2 Launch system API","text":"<ul> <li>launch.substitutions: Tools for dynamic values, e.g.:<ul> <li>LaunchConfiguration: References launch arguments.</li> <li>TextSubstitution: Inserts static text.</li> <li>PythonExpression: Evaluates Python expressions.</li> </ul> </li> <li> <p>launch.conditions: Conditional execution (e.g., IfCondition, UnlessCondition).</p> </li> <li> <p>DeclareLaunchArgument and LaunchConfiguration</p> </li> <li>PathJoinSubstitution</li> <li>IncludeLaunchDescription</li> <li>EnvironmentVariable</li> <li>Conditions</li> <li>events</li> </ul>","tags":["ros","launch"]},{"location":"ROS/ros_eco/launch/python/","title":"ROS python launch system","text":"<p>ROS / ros eco / launch</p> <p>Actions</p> <p>Substitute</p> <p>Events and condition</p> <p>Gazebo</p> <p>Rviz</p> <p>Process</p>","tags":["ros","launch","python"]},{"location":"ROS/ros_eco/launch/python/environment_variable/","title":"Environment variable","text":"set use_sim_time parameter from environment variable<pre><code>from launch import LaunchDescription\nfrom launch_ros.actions import Node\nfrom launch.substitutions import EnvironmentVariable, PythonExpression\n\ndef generate_launch_description():\n    # Get the environment variable as a string\n    use_sim_time_str = EnvironmentVariable('USE_SIM_TIME', default_value='false')\n\n    # Convert to boolean using PythonExpression\n    use_sim_time = PythonExpression([\"'\", use_sim_time_str, \"' == 'true'\"])\n\n    example_node = Node(\n        package='your_package_name',\n        executable='your_node_executable',\n        name='example_node',\n        parameters=[{\n            'use_sim_time': use_sim_time\n        }]\n    )\n\n    return LaunchDescription([\n        example_node\n    ])\n</code></pre>","tags":["ros2","launch","python","EnvironmentVariable"]},{"location":"ROS/ros_eco/launch/python/launch_config_and_argument/","title":"DeclareLaunchArgument and LaunchConfiguration","text":"","tags":["ros2","launch","python","DeclareLaunchArgument","LaunchConfiguration"]},{"location":"ROS/ros_eco/launch/python/launch_config_and_argument/#declarelaunchargument","title":"DeclareLaunchArgument","text":"<p>Defines an argument (a variable) that can be passed to a launch file via  CLI , each argument can have default value.</p>","tags":["ros2","launch","python","DeclareLaunchArgument","LaunchConfiguration"]},{"location":"ROS/ros_eco/launch/python/launch_config_and_argument/#launchconfiguration","title":"LaunchConfiguration","text":"<p>LaunchConfiguration represents the value of a launch argument at runtime. It acts as a placeholder or reference to an argument declared with DeclareLaunchArgument</p> launch_argument_demo.launch.py<pre><code>from launch import LaunchDescription\nfrom launch.actions import DeclareLaunchArgument\nfrom launch.substitutions import LaunchConfiguration\nfrom launch_ros.actions import Node\nfrom launch.actions import LogInfo\n\ndef generate_launch_description():\n    ld = LaunchDescription()\n\n    arg1_decalre = DeclareLaunchArgument('arg1', description=\"simple arg1 for demo\", default_value='hello world')\n    arg1 = LaunchConfiguration('arg1')\n\n    log1 = LogInfo(msg=[\"argument demo from cli using subsitution \",arg1])\n\n    ld.add_action(arg1_decalre)\n    ld.add_action(log1)\n    return ld\n</code></pre>","tags":["ros2","launch","python","DeclareLaunchArgument","LaunchConfiguration"]},{"location":"ROS/ros_eco/launch/python/launch_config_and_argument/#usage","title":"usage","text":"list all launch arguments<pre><code># Output default value\nros2 launch launch_tutorial args_log_demo.launch.py \n#\n[INFO] [launch.user]: Argument 'arg1' value: hello world\n</code></pre> run with argument<pre><code># Show launch arguments\nros2 launch launch_tutorial args_log_demo.launch.py -s\n#\nArguments (pass arguments as '&lt;name&gt;:=&lt;value&gt;'):\n\n    'arg1':\n        simple arg1 for demo\n        (default: 'hello world')\n\n# Get Argument from CLI\nros2 launch launch_tutorial args_log_demo.launch.py arg1:=\"data to arg1 from cli\"\n#\n[INFO] [launch.user]: Argument 'arg1' value: data to arg1 from cli\n</code></pre>","tags":["ros2","launch","python","DeclareLaunchArgument","LaunchConfiguration"]},{"location":"ROS/ros_eco/launch/python/launch_events/","title":"Launch file event API","text":"<p>Reference</p>","tags":["ros2","launch","python","events","OnExecutionComplete","OnProcessExit","OnProcessIO","OnProcessStart","OnShutdown"]},{"location":"ROS/ros_eco/launch/python/launch_include_demo/","title":"IncludeLaunchDescription","text":"<p>IncludeLaunchDescription method allows to include one launch description (essentially a sub-launch file) inside another, enabling better organization and scalability of complex robot systems. This is particularly useful when you want to break down a large system into smaller, reusable components.</p>","tags":["ros2","launch","python","IncludeLaunchDescription","PythonLaunchDescriptionSource"]},{"location":"ROS/ros_eco/launch/python/launch_include_demo/#demo-very-simple","title":"Demo: Very simple","text":"<p>Parent launch file <code>include_demo.launch.py</code> include the <code>args_log_demo.launch.py</code> as sub launch</p> <ul> <li><code>args_log_demo.launch.py</code> use as sub launch</li> <li><code>include_demo.launch.py</code> us as parent launch</li> </ul> args_log_demo.launch.py<pre><code>from launch import LaunchDescription\nfrom launch.actions import DeclareLaunchArgument\nfrom launch.substitutions import LaunchConfiguration\nfrom launch.actions import LogInfo\n\ndef generate_launch_description():\n    ld = LaunchDescription()\n\n    arg1_decalre = DeclareLaunchArgument('arg1', description=\"simple arg1 for demo\", default_value='hello world')\n    arg1 = LaunchConfiguration('arg1')\n\n    log1 = LogInfo(msg=[\"Argument 'arg1' value: \",arg1])\n\n    ld.add_action(arg1_decalre)\n    ld.add_action(log1)\n    return ld\n</code></pre> include_demo.launch.py<pre><code>from launch import LaunchDescription\nfrom launch.actions import IncludeLaunchDescription\nfrom launch.launch_description_sources import PythonLaunchDescriptionSource\nfrom ament_index_python.packages import get_package_share_directory\nimport os\n\ndef generate_launch_description():\n    ld = LaunchDescription()\n    my_robot_pkg = get_package_share_directory('launch_tutorial')\n\n    robot_launch = IncludeLaunchDescription(\n        PythonLaunchDescriptionSource(\n            os.path.join(my_robot_pkg, 'launch', 'args_log_demo.launch.py')\n        ),\n        launch_arguments={\n            'arg1': 'call from parent',\n        }.items()\n    )\n\n    ld.add_action(robot_launch)\n    return ld\n</code></pre>","tags":["ros2","launch","python","IncludeLaunchDescription","PythonLaunchDescriptionSource"]},{"location":"ROS/ros_eco/launch/python/launch_include_demo/#usage","title":"usage","text":"<pre><code>ros2 launch launch_tutorial include_demo.launch.py \n# result\n[INFO] [launch]: Default logging verbosity is set to INFO\n[INFO] [launch.user]: Argument 'arg1' value: call from parent\n</code></pre>","tags":["ros2","launch","python","IncludeLaunchDescription","PythonLaunchDescriptionSource"]},{"location":"ROS/ros_eco/launch/python/launch_path_and_paramfile/","title":"PathJoinSubstitution and parameter config file","text":"<p>Using <code>PathJoinSubstitution</code> to build path to parameter yaml file.</p>","tags":["ros2","launch","python","PathJoinSubstitution","parameters","ParameterValue"]},{"location":"ROS/ros_eco/launch/python/launch_path_and_paramfile/#project","title":"Project","text":"<pre><code>\u251c\u2500\u2500 CMakeLists.txt\n\u251c\u2500\u2500 config\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 params.yaml\n\u251c\u2500\u2500 launch\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 param_yaml_demo.launch.py\n\u251c\u2500\u2500 launch_tutorial\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 __init__.py\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 simple_node.py\n\u251c\u2500\u2500 package.xml\n\u2514\u2500\u2500 src\n</code></pre> param.yaml config/params.yaml<pre><code>/**:\n  ros__parameters:\n    arg1: \"from param file\"\n</code></pre> param_yaml_demo.launch.py launch/param_yaml_demo.launch<pre><code>import os\n\nfrom ament_index_python.packages import get_package_share_directory\nfrom launch import LaunchDescription\nfrom launch.actions import DeclareLaunchArgument\nfrom launch.substitutions import PathJoinSubstitution\nfrom launch.launch_description_sources import PythonLaunchDescriptionSource\nfrom launch.substitutions import LaunchConfiguration\nfrom launch_ros.actions import Node\n\n\ndef generate_launch_description():\n    ld = LaunchDescription()\n\n    config_file = PathJoinSubstitution([\n        get_package_share_directory('launch_tutorial'),\n        'config',\n        'params.yaml'\n    ])\n\n    node = Node(\n        package='launch_tutorial',\n        executable='simple_node.py',\n        name='simple',\n        output='screen',\n        parameters=[config_file])\n\n    ld.add_action(node)\n    return ld\n</code></pre> simple_node.py <pre><code>#!/usr/bin/env python3\n\nimport rclpy\nfrom rclpy.node import Node\n\nclass MyNode(Node):\n    def __init__(self):\n        node_name=\"minimal\"\n        super().__init__(node_name)\n        self.declare_parameter('arg1', \"hello default\")\n        self.get_logger().info(\"Hello ROS2\")\n        self.get_logger().info(self.get_parameter(\"arg1\").value)\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = MyNode()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n</code></pre>","tags":["ros2","launch","python","PathJoinSubstitution","parameters","ParameterValue"]},{"location":"ROS/ros_eco/launch/python/launch_path_and_paramfile/#demo-launch-gz-ros-bridge","title":"Demo: Launch gz ros bridge","text":"<p>Launch gz bridge with yaml file that set from argument using: </p> <ul> <li>DeclareLaunchArgument</li> <li>LaunchConfiguration</li> <li>PathJoinSubstitution</li> <li>ParameterValue</li> </ul> <p>```python from ament_index_python.packages import get_package_share_directory from launch import LaunchDescription from launch_ros.actions import Node from launch.substitutions import PathJoinSubstitution from launch.actions import DeclareLaunchArgument from launch.substitutions import LaunchConfiguration from launch_ros.parameter_descriptions import ParameterValue</p> <p>PKG_BRINGUP = 'ardupilot_bringup' BRIDGE_CONFIG = \"bridge.yaml\" CONFIG_FOLDER = \"config\"</p> <p>def generate_launch_description():     ld = LaunchDescription()</p> <pre><code>config_file_arg = DeclareLaunchArgument(\n    'config_file',\n    default_value=BRIDGE_CONFIG,\n    description='Name of the bridge config file'\n)\n\n\nconfig_file = LaunchConfiguration('config_file')\n\nbridge_file = PathJoinSubstitution([\n    get_package_share_directory(PKG_BRINGUP),\n    CONFIG_FOLDER,\n    config_file\n])\n\nros_gz_bridge = Node(\n    package=\"ros_gz_bridge\",\n    executable=\"parameter_bridge\",\n    parameters=[\n        {'use_sim_time': True},\n        {'config_file': ParameterValue(bridge_file, value_type=str)}\n    ],\n)\n\nld.add_action(config_file_arg)\nld.add_action(ros_gz_bridge)\n\n\nreturn ld\n```\n</code></pre>","tags":["ros2","launch","python","PathJoinSubstitution","parameters","ParameterValue"]},{"location":"ROS/ros_eco/launch/python/gazebo/","title":"Launch Gazebo and spawn robot","text":"<p>ROS / ros eco / launch / python</p> <p>Launch gazebo and spawn robot from urdf/xacro file</p>","tags":["ros","gazebo","launch"]},{"location":"ROS/ros_eco/launch/python/gazebo/#basic","title":"Basic","text":"<p>launch gazebo with custom world gazebo search for worlds using <code>GZ_SIM_RESOURCE_PATH</code> environment</p>","tags":["ros","gazebo","launch"]},{"location":"ROS/ros_eco/launch/python/gazebo/#launch-gazebo-world","title":"Launch gazebo world","text":"gazebo.launch.py","tags":["ros","gazebo","launch"]},{"location":"ROS/ros_eco/launch/python/gazebo/#launch-gazebo-and-spawn-robot","title":"Launch gazebo and spawn robot","text":"sim.launch.py","tags":["ros","gazebo","launch"]},{"location":"ROS/ros_eco/launch/python/gazebo/#declare-gz_sim_resource_path","title":"Declare GZ_SIM_RESOURCE_PATH","text":"<p>Use dsv to set environment variable</p> <p>ament dsv</p> <pre><code>.\n\u251c\u2500\u2500 CMakeLists.txt\n\u251c\u2500\u2500 hooks\n\u2502   \u251c\u2500\u2500 robot_loc_gazebo.dsv.in\n\u2502   \u2514\u2500\u2500 robot_loc_gazebo.sh.in\n</code></pre> robot_loc_gazebo.dsv.in<pre><code>prepend-non-duplicate;GZ_SIM_RESOURCE_PATH;share;@CMAKE_INSTALL_PREFIX@/share/robot_loc_gazebo/worlds\n</code></pre> obot_loc_gazebo.sh.in<pre><code>ament_prepend_unique_value GZ_SIM_RESOURCE_PATH \"$AMENT_CURRENT_PREFIX/share/@PROJECT_NAME@/worlds\"\n</code></pre> CMakeLists.txt<pre><code>ament_environment_hooks(\"${CMAKE_CURRENT_SOURCE_DIR}/hooks/${PROJECT_NAME}.dsv.in\")\nament_environment_hooks(\"${CMAKE_CURRENT_SOURCE_DIR}/hooks/${PROJECT_NAME}.sh.in\")\n\nament_package()\n</code></pre>","tags":["ros","gazebo","launch"]},{"location":"ROS/ros_eco/launch/python/launch_actions/","title":"Index","text":"<p>ROS / ros eco / launch / python</p>","tags":["ros","launch","actions","node"]},{"location":"ROS/ros_eco/launch/python/launch_actions/#ros2-launch-actions","title":"ROS2 Launch Actions","text":"<ul> <li>Node (from launch_ros.actions): Launches a ROS 2 node.</li> <li>IncludeLaunchDescription: Embeds another launch file.</li> <li>ExecuteProcess: Runs a generic process.</li> <li>DeclareLaunchArgument: Defines launch arguments.</li> </ul>","tags":["ros","launch","actions","node"]},{"location":"ROS/ros_eco/launch/python/launch_actions/#node","title":"Node","text":"<ul> <li>package: The ROS 2 package containing the node.</li> <li>executable: The name of the executable (e.g., script or binary).</li> <li>name: The name of the node instance (optional, overrides the default node name).</li> <li>parameters: A list or dict of parameters to pass to the node.</li> <li>arguments: Command-line arguments for the executable (non-ROS args).</li> <li>output='screen': Ensures logs are visible in the terminal</li> <li>respawn=True: Automatically restarts the node if it crashes.</li> <li>respawn_delay=5.0: Delay before respawning the node.</li> <li>namespace: Places the node in a ROS 2 namespace, prefixing its topics, services, and parameters.</li> <li>remappings: Renames topics or services the  node uses. list of tuples. <code>[('old_topic', 'new_topic')]</code></li> <li>additional_env: Sets environment variables for the node. Dictionary of key-value pairs.</li> <li>condition: Specifies a condition for launching the node. If the condition is not met, the node won't be launched.</li> <li>prefix: Adds a command prefix (e.g., gdb for debugging).</li> <li>emulate_tty: ??</li> </ul>","tags":["ros","launch","actions","node"]},{"location":"ROS/ros_eco/launch/python/launch_events_and_condition/","title":"Index","text":"<p>ROS / ros eco / launch / python</p>","tags":["ros","launch","events","condition"]},{"location":"ROS/ros_eco/launch/python/launch_events_and_condition/#ros2-launch-events-and-conditions","title":"ROS2 Launch Events and Conditions","text":"","tags":["ros","launch","events","condition"]},{"location":"ROS/ros_eco/launch/python/launch_events_and_condition/#launch-events","title":"Launch Events","text":"<ul> <li>OnProcessStart: Triggers when a process (like a node) starts</li> <li>OnProcessExit: Triggers when a process exits</li> <li>OnShutdown: Triggers when the system is shutting down ??</li> </ul>","tags":["ros","launch","events","condition"]},{"location":"ROS/ros_eco/launch/python/launch_events_and_condition/#conditions","title":"Conditions","text":"<p>Conditions allow you to include or exclude actions based on certain logic.</p> <ul> <li>IfCondition</li> <li>UnlessCondition</li> </ul>","tags":["ros","launch","events","condition"]},{"location":"ROS/ros_eco/launch/python/launch_substitute/","title":"ROS2 Launch Substitute","text":"<p>Substitutions are used \u2014 they allow you to compute or insert values dynamically during the launch process.</p> <ul> <li>LaunchConfiguration</li> <li>PathJoinSubstitution</li> <li>FindPackageShare</li> <li>EnvironmentVariable</li> <li>TextSubstitution</li> <li>Command</li> </ul>","tags":["ros","launch","substitute"]},{"location":"ROS/ros_eco/launch/python/process/","title":"Launch process","text":"<p>ROS / ros eco / launch / python</p> <p>Launch Process from launch file</p> <pre><code>from launch import LaunchDescription\nfrom launch.actions import ExecuteProcess\nfrom ament_index_python.packages import get_package_share_directory\n\n\nPKG = 'ardupilot_bringup'\n\ndef generate_launch_description():\n    package_share_dir = get_package_share_directory(PKG)\n    sitl_bin = f\"{package_share_dir}/bin/arducopter\"\n    param_path = f\"{package_share_dir}/params/copter_default.param\"\n\n    ld = LaunchDescription()\n    sitl = ExecuteProcess(\n            cmd=[sitl_bin, '--model', 'quad', '--speedup', '1', '--slave', '0',\n                 '--defaults', param_path,\n                 '--sim-address', '127.0.0.1', '-I0'],\n            output='screen'\n        )\n\n    ld.add_action(sitl)\n    return ld\n</code></pre>","tags":["ros","launch","process"]},{"location":"ROS/ros_eco/launch/python/rviz/","title":"Launch RVIZ and robot_description","text":"<p>ROS / ros eco / launch / python</p> <p>Launch file template to load robot_description from xacro file and view in RVIZ</p> <ul> <li>Set rviz config file path using <code>PathJoinSubstitution</code></li> <li>Set xacro file path using <code>PathJoinSubstitution</code></li> <li>Use <code>command</code> to run xacro </li> <li>Use <code>joint_state_publisher_gui</code> to control joints</li> </ul> description.launch.py<pre><code>\n</code></pre>","tags":["ros","rviz","launch","xacro","robot_description"]},{"location":"ROS/ros_eco/launch/python/rviz/#install","title":"Install","text":"install<pre><code>sudo apt install ros-jazzy-joint-state-publisher-gui\n</code></pre>","tags":["ros","rviz","launch","xacro","robot_description"]},{"location":"ROS/ros_eco/launch/yaml/","title":"ROS yaml launch","text":"<p>ROS / ros eco / launch</p> <ul> <li>Minimal</li> <li>remap topic</li> <li>parameters</li> <li>let</li> <li>Argument</li> <li>basic</li> <li>with default</li> <li>with multiple choice</li> <li>Include</li> </ul> <p>With parameter file</p> <p>rviz</p> <p>gazebo</p>","tags":["ros","launch","yaml"]},{"location":"ROS/ros_eco/launch/yaml/#minimal","title":"Minimal","text":"<p>Launch two nodes</p> <pre><code>launch:\n\n- node:\n    pkg: demo_nodes_cpp\n    exec: talker\n\n- node:\n    pkg: demo_nodes_cpp\n    exec: listener\n</code></pre>","tags":["ros","launch","yaml"]},{"location":"ROS/ros_eco/launch/yaml/#remap-topic","title":"remap topic","text":"remapping topic<pre><code>launch:\n\n  - node:\n      pkg: demo_nodes_cpp\n      exec: talker\n      remap:\n        - from: chatter\n          to: my_topic\n\n  - node:\n      pkg: demo_nodes_cpp\n      exec: listener\n      remap:\n        - from: chatter\n          to: my_topic\n</code></pre>","tags":["ros","launch","yaml"]},{"location":"ROS/ros_eco/launch/yaml/#parameters","title":"parameters","text":"","tags":["ros","launch","yaml"]},{"location":"ROS/ros_eco/launch/yaml/#1-2-3-4-5-6-7-8-9-10-11-12launch-node-pkg-ros_gz_image-exec-image_bridge-output-screen-args-cameraimage-param-name-use_sim_time-value-true-name-cameraimagecompressedjpeg_quality-value-75","title":"<pre><code>launch:\n  - node:\n      pkg: \"ros_gz_image\"\n      exec: \"image_bridge\"\n      output: screen\n      args:\n          \"/camera/image\"\n      param:\n          - name: use_sim_time\n            value : true\n          - name: camera.image.compressed.jpeg_quality          \n            value: 75\n</code></pre>","text":"","tags":["ros","launch","yaml"]},{"location":"ROS/ros_eco/launch/yaml/#let","title":"let","text":"<ul> <li>Create a local variable for reuse within the launch file.</li> <li>Cannot be overridden from the command line.</li> </ul> <pre><code>launch:\n- let:\n    name: model_path\n    value: $(find-pkg-share yaml_launch)/models\n\n- executable:\n    cmd: echo $(var model_path)\n    output: screen\n</code></pre>","tags":["ros","launch","yaml"]},{"location":"ROS/ros_eco/launch/yaml/#argument","title":"Argument","text":"<p>Define an argument that can be overridden via the command line when launching</p>","tags":["ros","launch","yaml"]},{"location":"ROS/ros_eco/launch/yaml/#basic","title":"basic","text":"<pre><code>launch:\n- arg:\n    name: simple_arg\n\n- executable:\n    cmd: echo $(var simple_arg)\n    output: screen\n</code></pre> <pre><code>ros2 launch yaml_launch arg_example.launch.yaml simple_arg:=\"hello world\"\n</code></pre>","tags":["ros","launch","yaml"]},{"location":"ROS/ros_eco/launch/yaml/#with-default","title":"with default","text":"arg_example_default.launch.yaml<pre><code>launch:\n- arg:\n    name: simple_arg\n    default: Hello, YAML Launch!\n    description: An example argument with a default value.\n\n- executable:\n    cmd: echo $(var simple_arg)\n    output: screen\n</code></pre> <pre><code># list arguments\nros2 launch yaml_launch arg_example_default.launch.yaml -s\n\n#usage\nros2 launch yaml_launch arg_example_default.launch.yaml\n</code></pre>","tags":["ros","launch","yaml"]},{"location":"ROS/ros_eco/launch/yaml/#with-multiple-choice","title":"with multiple choice","text":"<pre><code>launch:\n\n- arg:\n    name: arg_with_choices\n    default: choice_1\n    choice: [value: choice_1, value: choice_2, value: choice_3]\n\n- executable:\n    cmd: echo $(var arg_with_choices)\n    output: screen\n</code></pre> <pre><code>ros2 launch yaml_launch arg_example_default.launch.yaml arg_with_choices:=choice_2\n\n# raise exception\nros2 launch yaml_launch arg_example_default.launch.yaml arg_with_choices:=choice_20\n</code></pre>","tags":["ros","launch","yaml"]},{"location":"ROS/ros_eco/launch/yaml/#include","title":"Include","text":"launch/include.launch.yaml<pre><code>launch:\n  - include:\n      file: \"$(find-pkg-share yaml_launch)/launch/arg_example.launch.yaml\"\n      arg:\n        - name: \"simple_arg\"\n          value: \"data from include\"\n</code></pre> launch/arg_example.launch.yaml<pre><code>launch:\n- arg:\n    name: simple_arg\n\n- executable:\n    cmd: echo $(var simple_arg)\n    output: screen\n</code></pre>","tags":["ros","launch","yaml"]},{"location":"ROS/ros_eco/launch/yaml/gazebo/","title":"ROS yaml launch gazebo","text":"","tags":["ros","launch","yaml","gazebo"]},{"location":"ROS/ros_eco/launch/yaml/gazebo/#launch-gazebo-harmonic","title":"Launch gazebo harmonic","text":"","tags":["ros","launch","yaml","gazebo"]},{"location":"ROS/ros_eco/launch/yaml/gazebo/#gazebo","title":"Gazebo","text":"<pre><code>launch:\n\n- executable:\n    cmd: gz sim -v 4 -r empty.sdf\n</code></pre>","tags":["ros","launch","yaml","gazebo"]},{"location":"ROS/ros_eco/launch/yaml/gazebo/#demo","title":"Demo","text":"<ul> <li>launch gazebo</li> <li>spawn robot</li> <li>spawn bridge</li> </ul> <pre><code>launch:\n  - arg:\n      name: \"robot_description_file\"\n      default: \"$(find-pkg-share my_robot_description)/urdf/my_robot.urdf.xacro\"\n  - arg:\n      name: \"bridge_config_file\"\n      default: \"$(find-pkg-share my_robot_bringup)/config/bridge.yaml\"\n\n  #gazebo simulation\n  - executable:\n      cmd: gz sim -v 4 -r empty.sdf\n\n  # robot state publisher\n  - node:\n      pkg: \"robot_state_publisher\"\n      exec: \"robot_state_publisher\"\n      name: \"robot_state_publisher\"\n      param:\n        - name: \"robot_description\"\n          value : \"$(command '$(find-exec xacro) $(var robot_description_file)')\"\n\n  #spawn robot in gazebo\n  - node:\n      pkg: \"ros_gz_sim\"\n      exec: \"create\"\n      output: screen\n      args:\n          \"-topic robot_description -name robot\"\n\n  #ros-gz bridge\n  - node:\n      pkg: \"ros_gz_bridge\"\n      exec: \"parameter_bridge\"\n      output: screen\n      args:\n          \"--ros-args -p config_file:=$(var bridge_config_file)\"\n</code></pre>","tags":["ros","launch","yaml","gazebo"]},{"location":"ROS/ros_eco/launch/yaml/param_file/","title":"ROS yaml launch with parameter file","text":"config/params.yaml<pre><code>simple_param_node:\n  ros__parameters:\n    greeting: \"Hi from YAML!\"\n</code></pre> <pre><code>launch:\n- node:\n    pkg: \"yaml_launch\"\n    exec: \"simple_param_node.py\"\n    param:\n      - from: $(find-pkg-share yaml_launch)/config/params.yaml\n</code></pre> <p>Note</p> <p>We can load params from multiple file using multiple <code>form</code></p>","tags":["ros","launch","yaml"]},{"location":"ROS/ros_eco/launch/yaml/rviz/","title":"ROS yaml launch RVIZ","text":"","tags":["ros","launch","yaml","rviz"]},{"location":"ROS/ros_eco/launch/yaml/rviz/#rviz","title":"Rviz","text":"<pre><code>launch:\n  - arg:\n      name: \"rviz_config_file\"\n      default: \"$(find-pkg-share bumperbot_bringup)/config/rviz.rviz\"\n  - arg:\n      name: \"robot_description_file\"\n      default: \"$(find-pkg-share bumperbot_description)/urdf/bumperbot.urdf.xacro\"\n  - node:\n      pkg: rviz2\n      exec: rviz2\n      name: rviz2\n      output: screen\n      args:\n          \"-d $(var rviz_config_file)\"\n  - node:\n      pkg: \"robot_state_publisher\"\n      exec: \"robot_state_publisher\"\n      name: \"robot_state_publisher\"\n      param:\n        - name: \"robot_description\"\n          value : \"$(command '$(find-exec xacro) $(var robot_description_file)')\"\n  - node:\n      pkg: \"joint_state_publisher_gui\"\n      exec: \"joint_state_publisher_gui\"\n      name: \"joint_state_publisher_gui\"\n      output: screen\n</code></pre>","tags":["ros","launch","yaml","rviz"]},{"location":"ROS/ros_eco/packages/","title":"Index","text":"<p>{{ render_nav_path }}</p>","tags":["ros","packages"]},{"location":"ROS/ros_eco/packages/#ros-eco-system","title":"ROS Eco system","text":"<p>Ros packages and tools that are used in the ROS eco system.</p> <p>Diagnostics</p> <p>parameters generate</p> <p>TBD</p> <p>Mavros</p> <p>Web bridge</p> <p>TBD</p>","tags":["ros","packages"]},{"location":"ROS/ros_eco/packages/#gscam","title":"Gscam","text":"<p>ROS Package for broadcasting gstreamer video stream via ROS2 camera API, more</p>","tags":["ros","packages"]},{"location":"ROS/ros_eco/packages/#message_filters","title":"Message_filters","text":"<p>Message_filters is a collection of message \"filters\" which take messages in. and may or may not output the message at some time in the future, depending on a policy defined for that filter. more</p>","tags":["ros","packages"]},{"location":"ROS/ros_eco/packages/#topic_tools","title":"topic_tools","text":"<p>Tools for directing, throttling, selecting, and otherwise manipulating ROS 2 topics at a meta-level. These tools do not generally perform serialization on the streams being manipulated, instead acting on generic binary data using rclcpp's GenericPublisher and GenericSubscription ros_packages_topic_tools</p>","tags":["ros","packages"]},{"location":"ROS/ros_eco/packages/ros_package_message_filter/","title":"Message Filters","text":"<p>Message_filters is a collection of message \"filters\" which take messages in. and may or may not output the message at some time in the future, depending on a policy defined for that filter. more</p> <p>Tutorials</p>","tags":["ros","packages","message_filters"]},{"location":"ROS/ros_eco/packages/ros_package_message_filter/#timesynchronizer-demo","title":"TimeSynchronizer demo","text":"<p>TimeSynchronizer listens on multiple input message and invokes the callback when it has a collection of messages with matching timestamps.</p> TimeSynchronizer <pre><code>#!/usr/bin/env python3\n\nimport rclpy\nfrom rclpy.node import Node\nfrom rclpy.time import Time\n\nimport message_filters\nfrom geometry_msgs.msg import PointStamped\n\nclass MyNode(Node):\n    def __init__(self):\n        node_name=\"TimeSynchronizer_demo\"\n        super().__init__(node_name)\n        self.get_logger().info(\"Hello ROS2\")\n        self.pub1 = self.create_publisher(PointStamped, \"topic1\", 10)\n        self.pub2 = self.create_publisher(PointStamped, \"topic2\", 10)\n\n        sub1 = message_filters.Subscriber(self, PointStamped, \"topic1\")\n        sub2 = message_filters.Subscriber(self, PointStamped, \"topic2\")\n\n        ts = message_filters.TimeSynchronizer([sub1, sub2], 10)\n        ts.registerCallback(self.cb)\n        self.counter = 0\n        self.t1 = self.create_timer(1.0, self.timer_cb)\n\n    def cb(self, point1: PointStamped, point2: PointStamped):\n        self.get_logger().info(f\"----{Time.from_msg(point1.header.stamp)}\")\n\n    def timer_cb(self):\n        self.counter += 1\n        point = PointStamped()\n        sync_time = self.get_clock().now().to_msg()\n        point.header.stamp = sync_time\n        point.point.x = 1.0\n        self.pub1.publish(point)\n        if not (self.counter % 2 == 0):\n            point2 = PointStamped()\n            point2.header.stamp = sync_time\n            point2.point.x = 2.0\n            self.pub2.publish(point2)\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = MyNode()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n</code></pre> <p>The demo publish two PointStamped messages with the same timestamp  - one message is published every second  - other every two seconds. The TimeSynchronizer will invoke the callback when it has both in the same time , meaning it publish every two seconds.</p>","tags":["ros","packages","message_filters"]},{"location":"ROS/ros_eco/packages/ros_package_message_filter/#approximatetimesynchronizer-demo","title":"ApproximateTimeSynchronizer demo","text":"<p>Like the TimeSynchronizer demo, but with a time window. The callback will be invoked when the timestamps of the messages are within the time window. the slop argument is the time window in seconds.</p> ApproximateTimeSynchronizer <pre><code>#!/usr/bin/env python3\n\nimport rclpy\nfrom rclpy.node import Node\nfrom rclpy.time import Time\nimport time\nimport message_filters\nfrom geometry_msgs.msg import PointStamped\n\nclass MyNode(Node):\n    def __init__(self):\n        node_name=\"ApproximateTimeSynchronizer_demo\"\n        super().__init__(node_name)\n        self.get_logger().info(\"Hello ROS2\")\n        self.pub1 = self.create_publisher(PointStamped, \"topic1\", 10)\n        self.pub2 = self.create_publisher(PointStamped, \"topic2\", 10)\n\n        sub1 = message_filters.Subscriber(self, PointStamped, \"topic1\")\n        sub2 = message_filters.Subscriber(self, PointStamped, \"topic2\")\n\n        ts = message_filters.ApproximateTimeSynchronizer([sub1, sub2], 10, slop=0.2)\n        ts.registerCallback(self.cb)\n        self.counter = 0\n        self.t1 = self.create_timer(1.0, self.timer_cb)\n\n    def cb(self, point1: PointStamped, point2: PointStamped):\n        self.get_logger().info(f\"----{Time.from_msg(point1.header.stamp)}\")\n\n    def timer_cb(self):\n        self.counter += 1\n        point = PointStamped()\n        point.header.stamp = self.get_clock().now().to_msg()\n        point.point.x = 1.0\n        self.pub1.publish(point)\n        time.sleep(0.1)\n        point2 = PointStamped()\n        point2.header.stamp = self.get_clock().now().to_msg()\n        point2.point.x = 2.0\n        self.pub2.publish(point2)\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = MyNode()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n</code></pre> <p>The demo publish two PointStamped messages with timestamps that are within 0.1 seconds of each other</p> <p>The ApproximateTimeSynchronizer will invoke the callback when it has both in the same time window, meaning it publish every second.</p>","tags":["ros","packages","message_filters"]},{"location":"ROS/ros_eco/packages/diagnostics/","title":"ROS diagnostics","text":"<p>ROS diagnostics gives you the ability to monitor your system. There are two components in its architecture:</p> <ul> <li>diagnostic_updater</li> <li>diagnostic_aggregator</li> </ul> <p>The diagnostic_updater publishes diagnostic status messages on the <code>/diagnostics</code> topic, and the aggregator listens to these statuses, aggregates them, and publishes the results on the <code>/diagnostics_agg</code> topic.</p>","tags":["ros","diagnostics"]},{"location":"ROS/ros_eco/packages/diagnostics/#diagnostic_updater","title":"diagnostic_updater","text":"<p>Provide an easy way to publish diagnostic information from node </p>","tags":["ros","diagnostics"]},{"location":"ROS/ros_eco/packages/diagnostics/#diagnostic_aggregator","title":"diagnostic_aggregator","text":"<p>The aggregator collects, categorizes, and groups the statuses from all the system components. You can take a look at what is being published on the /diagnostics and /diagnostics_agg topics with the rqt_runtime_monitor and rqt_robot_monitor tools</p> <p>Diagnostic Tasks</p> <p>Diagnostic aggregator</p> <p>Diagnostic monitor</p>","tags":["ros","diagnostics"]},{"location":"ROS/ros_eco/packages/diagnostics/#install","title":"install","text":"<pre><code>sudo apt update\nsudo apt install -y \\\n  ros-humble-diagnostic-updater \\\n  ros-humble-diagnostic-aggregator \\\n  ros-humble-diagnostic-msgs \\\n  ros-humble-diagnostic-common-diagnostics\n\n# rqt\nsudo apt install ros-humble-rqt-robot-monitor\nsudo apt install ros-humble-rqt-runtime-monitor\n</code></pre>","tags":["ros","diagnostics"]},{"location":"ROS/ros_eco/packages/diagnostics/#diagnostics_msg","title":"diagnostics_msg","text":"<ul> <li>DiagnosticStatus.msg</li> <li>DiagnosticArray</li> </ul> <pre><code>octet OK=0\noctet WARN=1\noctet ERROR=2\noctet STALE=3\noctet level\nstring name\nstring message\nstring hardware_id\ndiagnostic_msgs/msg/KeyValue[] values\n</code></pre>","tags":["ros","diagnostics"]},{"location":"ROS/ros_eco/packages/diagnostics/#diagnostic_aggregator_1","title":"diagnostic_aggregator","text":"<p>Aggregator is a node that subscribes to <code>/diagnostics</code>, processes it and republishes aggregated data on <code>/diagnostics_agg</code>.</p> <p>The aggregator creates a series of analyzers to handle incoming <code>DiagnosticStatus</code></p> <p>API</p> <p></p> <p></p>","tags":["ros","diagnostics"]},{"location":"ROS/ros_eco/packages/diagnostics/#demos","title":"Demos","text":"<ul> <li>Diagnostic status function - - minimal implementation as diagnostic function</li> <li>DiagnosticTask class - minimal implementation as diagnostic task class</li> <li>Builtin tasks (FrequencyStatus)</li> <li>Remove task</li> <li>Composite task</li> </ul>","tags":["ros","diagnostics"]},{"location":"ROS/ros_eco/packages/diagnostics/#reference","title":"Reference","text":"<ul> <li>REP-107 Diagnostic System for Robots Running ROS</li> <li>ros diagnostic</li> <li>wiki</li> <li>python example</li> </ul>","tags":["ros","diagnostics"]},{"location":"ROS/ros_eco/packages/diagnostics/#projects-to-check","title":"projects to check","text":"<ul> <li>rviz_2d_overlay_plugins)</li> </ul>","tags":["ros","diagnostics"]},{"location":"ROS/ros_eco/packages/diagnostics/diagnostic_aggregator/","title":"Diagnostic aggregator","text":"<p>The Diagnostic Aggregator in ROS 2 is a tool designed to organize and categorize diagnostic messages efficiently.  It helps in monitoring system health by grouping diagnostic messages into a structured hierarchy,  making it easier to analyze the status of different components. it's subscribe to <code>/diagnostic</code> topic and publish to <code>/diagnostic_agg</code> topic. The aggregator make use of Analyzers, The analyzer are plugins that define how diagnostic data is processed, categorized, and reported.</p>","tags":["ros","diagnostic","aggregator"]},{"location":"ROS/ros_eco/packages/diagnostics/diagnostic_aggregator/#analyzer","title":"Analyzer","text":"<p>An analyzer processes incoming diagnostic messages, organizes them into a hierarchical structure, and generates processed diagnostic output. Each analyzer is responsible for:</p> <ul> <li>Matching: Determining which diagnostic messages it should process based on their names or other criteria.</li> <li>Analyzing: Processing the matched messages (e.g., checking for errors, staleness, or specific conditions).</li> <li>Reporting: Producing a structured output, typically as a vector of diagnostic_msgs/DiagnosticStatus messages, with a defined hierarchy.</li> </ul> <p>Analyzers are loaded dynamically by the aggregator_node at runtime using the pluginlib framework, and their behavior is configured via parameters (usually specified in a YAML file).</p> <p>The Aggregator came with few predefine analyzers</p> <ul> <li>GenericAnalyzer</li> <li>AnalyzerGroup</li> <li>DiscardAnalyzer</li> </ul>","tags":["ros","diagnostic","aggregator"]},{"location":"ROS/ros_eco/packages/diagnostics/diagnostic_aggregator/#analyzergroup","title":"AnalyzerGroup","text":"<p>This analyzer acts as a container for other analyzers, enabling hierarchical grouping of diagnostic data. It doesn\u2019t process data itself but delegates to its \"sub-analyzers.\"</p> <p>TODO: create yaml example and demo</p>","tags":["ros","diagnostic","aggregator"]},{"location":"ROS/ros_eco/packages/diagnostics/diagnostic_aggregator/#genericanalyzer","title":"GenericAnalyzer","text":"<p>Matches diagnostic messages based on criteria</p> <ul> <li>path: Defines the category name in the aggregated output.</li> <li>startswith: Groups diagnostics messages that start with a certain prefix.</li> <li>expected: Lists expected diagnostic topics (useful for error checking).</li> <li>contains: Groups messages that contain a specific word.</li> <li>timeout: Monitors staleness (e.g., if a message hasn\u2019t been updated within a timeout period, it\u2019s marked as stale). #TODO: create example</li> </ul> <pre><code>diagnostic_aggregator:\n  ros__parameters:\n    analyzers:\n\n      sensors:\n        type: \"diagnostic_aggregator/GenericAnalyzer\"\n        path: \"Sensors\"\n        startswith: [\"/sensors\"]\n        expected: [\"/sensors/camera\", \"/sensors/lidar\"]\n\n      motors:\n        type: \"diagnostic_aggregator/GenericAnalyzer\"\n        path: \"Motors\"\n        startswith: [\"/motors\"]\n        expected: [\"/motors/left_wheel\", \"/motors/right_wheel\"]\n\n      system:\n        type: \"diagnostic_aggregator/GenericAnalyzer\"\n        path: \"System\"\n        contains: [\"temperature\", \"battery\"]\n</code></pre>","tags":["ros","diagnostic","aggregator"]},{"location":"ROS/ros_eco/packages/diagnostics/diagnostic_aggregator/#expected","title":"expected","text":"<p>The expected parameter in the aggregator checks for the presence of specific name values inside the messages published to /diagnostics.</p> <p>stale</p> <p>In diagnostic_aggregator, stale severity is the severity level assigned to a diagnostic status when a message is not received within the configured timeout. This helps in detecting missing diagnostics.</p>","tags":["ros","diagnostic","aggregator"]},{"location":"ROS/ros_eco/packages/diagnostics/diagnostic_aggregator/#demo-stale-hb-message","title":"Demo: Stale HB message","text":"<ul> <li>Run node with heartbeat diagnostic</li> <li>Run Aggregator</li> <li>Run Monitor</li> <li>When stop the heartbeat , the aggregator alert on staled message</li> </ul> heartbeat node <pre><code>#!/usr/bin/env python3\n\nimport rclpy\nfrom rclpy.node import Node\nfrom diagnostic_updater import Heartbeat, Updater\n\nclass MyNode(Node):\n    def __init__(self):\n        node_name=\"node_name\"\n        super().__init__(node_name)\n        updater = Updater(self)\n        updater.hwid = \"hwid\"\n        self.task = Heartbeat()\n        updater.add(self.task)\n        self.get_logger().info(\"Hello ROS2\")\n\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = MyNode()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n</code></pre> terminal1: heartbeat node1<pre><code>python3 /workspace/src/dia_demo/scripts/diagnostic_hb.py --ros-args -r __node:=node1\n</code></pre> terminal2: heartbeat node2<pre><code>python3 /workspace/src/dia_demo/scripts/diagnostic_hb.py --ros-args -r __node:=node2\n</code></pre> terminal3: diagnostics aggregator<pre><code>ros2 run diagnostic_aggregator aggregator_node --ros-args --params-file /workspace/src/dia_demo/config/dia_agg.yaml\n</code></pre> terminal4: monitor<pre><code>ros2 run rqt_robot_monitor rqt_robot_monitor\n</code></pre> <p>downaload tmuxp script to run all above terminals</p> Aggregator config config/dia_agg.yaml<pre><code>analyzers:\n  ros__parameters:\n    analyzers:\n      master_caution:\n        type: 'diagnostic_aggregator/AnalyzerGroup'\n        path: master_caution\n        analyzers:\n          node_hb:\n            type: diagnostic_aggregator/GenericAnalyzer\n            path: node1\n            find_and_remove_prefix: [\"node1: \"]\n            expected: [ 'node1: Heartbeat']\n            timeout: 2.0\n          node2:\n            type: diagnostic_aggregator/GenericAnalyzer\n            path: node2\n            find_and_remove_prefix: [\"node2: \"]\n            expected: [ 'node2: Heartbeat']\n            timeout: 2.0\n</code></pre> <p></p> <ul> <li> <p>Node 1 stop running </p> </li> <li> <p>Node 2 stop running </p> </li> </ul>","tags":["ros","diagnostic","aggregator"]},{"location":"ROS/ros_eco/packages/diagnostics/diagnostic_aggregator/#demo-ignore-messages","title":"Demo: Ignore messages","text":"<ul> <li>Use to heartbeat from previous demo</li> <li>Run with new configuration</li> <li>Echo topic <code>diagnostics_agg</code></li> </ul> config <pre><code>analyzers:\n  ros__parameters:\n    analyzers:\n      discard1:\n        type: diagnostic_aggregator/DiscardAnalyzer\n        path: \"remove\"\n        startswith:\n          - \"node1\"\n          - \"node2\"\n</code></pre>","tags":["ros","diagnostic","aggregator"]},{"location":"ROS/ros_eco/packages/diagnostics/diagnostic_aggregator/#usage","title":"usage","text":"<p>Download tmuxp script to run the demo</p> <p></p> <p>empty diagnostic_agg topic</p>","tags":["ros","diagnostic","aggregator"]},{"location":"ROS/ros_eco/packages/diagnostics/diagnostic_monitor/","title":"Diagnostic Monitor","text":"","tags":["ros","diagnostics","monitor"]},{"location":"ROS/ros_eco/packages/diagnostics/diagnostic_monitor/#rqt","title":"RQT","text":"install<pre><code>sudo apt install ros-humble-rqt-robot-monitor\nsudo apt install ros-humble-rqt-runtime-monitor\n</code></pre>","tags":["ros","diagnostics","monitor"]},{"location":"ROS/ros_eco/packages/diagnostics/diagnostic_monitor/#robot-monitor","title":"robot monitor","text":"<p>subscribe to:</p> <ul> <li>/diagnostics_agg</li> </ul>","tags":["ros","diagnostics","monitor"]},{"location":"ROS/ros_eco/packages/diagnostics/diagnostic_monitor/#robot-runtime-monitor","title":"robot runtime monitor","text":"<p>Show stale message</p> <p>stale</p> <p>In diagnostic_aggregator, stale severity is the severity level assigned to a diagnostic status when a message is not received within the configured timeout. This helps in detecting missing diagnostics.</p> <p>subscribe to:</p> <ul> <li>/diagnostics</li> <li>/diagnostics_agg</li> </ul>","tags":["ros","diagnostics","monitor"]},{"location":"ROS/ros_eco/packages/diagnostics/diagnostic_tasks/","title":"Diagnostic Tasks","text":"<p>DiagnosticTask is an abstract base class for collecting diagnostic data. </p> <p>A DiagnosticTask has a name, and a function that is called to create a DiagnosticStatusWrapper. </p> <p>DiagnosticsTask subclass by</p> <ul> <li>CompositeDiagnosticTask</li> <li>FrequencyStatus</li> <li>GenericFunctionDiagnosticTask</li> <li>Heartbeat</li> <li>TimeStampStatus</li> </ul>","tags":["ros","diagnostic","tasks"]},{"location":"ROS/ros_eco/packages/diagnostics/diagnostic_tasks/#diagnosticstatus-as-a-function","title":"DiagnosticStatus as a function","text":"<p>Implement DiagnosticStatus as function that register to DiagnosticUpdater</p> Demo code <pre><code>#!/usr/bin/env python3\n\nimport rclpy\nfrom rclpy.node import Node\nfrom diagnostic_msgs.msg import DiagnosticStatus\nimport diagnostic_updater\n\ndef dummy_diagnostic(stat: diagnostic_updater.DiagnosticStatusWrapper):\n   stat.message =\"message dummy_diagnostic\"\n   stat.level = DiagnosticStatus.WARN\n   stat.name = \"dummy_diagnostic\"\n\n   return stat\n\nclass MyNode(Node):\n    def __init__(self):\n        node_name=\"minimal\"\n        super().__init__(node_name)\n        updater = diagnostic_updater.Updater(self)\n        updater.add(\"Function updater\", dummy_diagnostic)\n        self.get_logger().info(\"Hello ROS2\")\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = MyNode()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n</code></pre> <ul> <li> <p>dummy_diagnostic method get one argument stat of type diagnostic_updater.DiagnosticStatusWrapper DiagnosticStatusWrapper is a derived class of diagnostic_msgs.msg.DiagnosticStatus that provides a set of convenience methods.</p> </li> <li> <p>diagnostic_updater use <code>add</code> method to register diagnostic method</p> </li> <li>The updater publish diagnostic message every one second</li> </ul> /diagnostics topic ros2 topic echo /diagnostics<pre><code>---\nheader:\n  stamp:\n    sec: 1743564548\n    nanosec: 360259990\n  frame_id: ''\nstatus:\n- level: \"\\x01\"\n  name: 'minimal: dummy_diagnostic'\n  message: message dummy_diagnostic\n  hardware_id: ''\n  values: []\n---\nheader:\n  stamp:\n    sec: 1743564549\n    nanosec: 360183120\n  frame_id: ''\nstatus:\n- level: \"\\x01\"\n  name: 'minimal: dummy_diagnostic'\n  message: message dummy_diagnostic\n  hardware_id: ''\n  values: []\n</code></pre>","tags":["ros","diagnostic","tasks"]},{"location":"ROS/ros_eco/packages/diagnostics/diagnostic_tasks/#heartbeat","title":"Heartbeat","text":"<p>Diagnostic task to monitor whether a node is alive. This diagnostic task always reports as OK and 'Alive' when it runs</p> Demo code <pre><code>#!/usr/bin/env python3\n\nimport rclpy\nfrom rclpy.node import Node\nfrom diagnostic_updater import Heartbeat, Updater\n\nclass MyNode(Node):\n    def __init__(self):\n        node_name=\"node_name\"\n        super().__init__(node_name)\n        updater = Updater(self)\n        updater.hwid = \"hwid\"\n        self.task = Heartbeat()\n        updater.add(self.task)\n        self.get_logger().info(\"Hello ROS2\")\n\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = MyNode()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n</code></pre> /diagnostic topic <pre><code>---\nheader:\n  stamp:\n    sec: 1743565018\n    nanosec: 240255516\n  frame_id: ''\nstatus:\n- level: \"\\0\"\n  name: 'node_name: Heartbeat'\n  message: Alive\n  hardware_id: hwid\n  values: []\n---\nheader:\n  stamp:\n    sec: 1743565019\n    nanosec: 239948956\n  frame_id: ''\nstatus:\n- level: \"\\0\"\n  name: 'node_name: Heartbeat'\n  message: Alive\n  hardware_id: hwid\n  values: []\n</code></pre>","tags":["ros","diagnostic","tasks"]},{"location":"ROS/ros_eco/packages/generate_parameter_library/","title":"generate_parameter_library","text":"<p>Generate C++ or Python code for ROS 2 parameter declaration, getting, and validation using declarative YAML. The generated library contains a C++ struct with specified parameters. Additionally, dynamic parameters and custom validation are made easy. more</p>","tags":["generate_parameter_library"]},{"location":"ROS/ros_eco/packages/gscam/","title":"GSCAM","text":"<p>ROS Package for broadcasting <code>gstreamer</code> video stream via ROS2 camera API, publish video as <code>sensors_msgs/Image</code> with frame_id and timestamp</p>","tags":["ros","gscam","gstreamer"]},{"location":"ROS/ros_eco/packages/gscam/#demo","title":"Demo","text":"<p>gstreamer pipe</p> <p>input gstreamer pipe can set by environment variable <code>GSCAM_CONFIG</code> or ros parameter <code>gscam_config</code></p> <pre><code>export GSCAM_CONFIG=\"videotestsrc ! video/x-raw,width=640,height=480,framerate=10/1 ! videoconvert\"\n\n#\nros2 run gscam gscam_node\n\n# \nros2 run rqt_image_view rat_image_view\n</code></pre> <p></p>","tags":["ros","gscam","gstreamer"]},{"location":"ROS/ros_eco/packages/gscam/#more-control","title":"More control","text":"","tags":["ros","gscam","gstreamer"]},{"location":"ROS/ros_eco/packages/gscam/#qos","title":"QOS","text":"<p>Run with parameter <code>use_sensor_data_qos:=true</code> to publish as <code>best_effort</code> qos</p> <pre><code>ros2 run gscam gscam_node --ros-args \\\n-p use_sensor_data_qos:=true \\\n-p gscam_config:=\"videotestsrc pattern=basll ! video/x-raw,width=640,height=480,framerate=10/1 ! videoconvert\"\n</code></pre>","tags":["ros","gscam","gstreamer"]},{"location":"ROS/ros_eco/packages/gscam/#camera-info","title":"Camera info","text":"<p>gscam using <code>camera_info_manager</code> package to control <code>camera_info</code> topic , we can change the data using <code>set_camera_info</code> service</p> <p>The init <code>camera_info</code> can control by parameter <code>camera_info_url</code></p> <pre><code>ros2 run gscam gscam_node --ros-args \\\n-p use_sensor_data_qos:=true \\\n-p camera_info_url:=file:///&lt;absolute&gt;/gscam_demo/config/uncalibrated_parameters.ini\n</code></pre> camera calibration file <pre><code># Camera intrinsics\n\n[image]\n\nwidth\n1280\n\nheight\n720\n\n[camera]\n\ncamera matrix\n900.00000 0.00000 640.00000 \n0.00000 900.00000 360.00000 \n0.00000 0.00000 1.00000 \n\ndistortion\n0.10000 -0.05000 0.00100 0.00200 0.00000 \n\n\nrectification\n0.00000 0.00000 0.00000 \n0.00000 0.00000 0.00000 \n0.00000 0.00000 0.00000 \n\nprojection\n0.00000 0.00000 0.00000 0.00000 \n0.00000 0.00000 0.00000 0.00000 \n0.00000 0.00000 0.00000 0.00000 \n</code></pre> <p>Download ini file</p>","tags":["ros","gscam","gstreamer"]},{"location":"ROS/ros_eco/packages/gscam/#update-service","title":"update service","text":"<p>The <code>/set_camera_info</code> service is part of camera_info_manager</p> <p>Note</p> <p>The service update/save the data to source ini file</p> <pre><code>#!/bin/python\n\n\nimport rclpy\nfrom rclpy.node import Node\nfrom sensor_msgs.msg import CameraInfo\nfrom sensor_msgs.srv import SetCameraInfo\n\n\nclass CameraInfoClient(Node):\n    def __init__(self):\n        super().__init__('camera_info_client')\n        self.client = self.create_client(SetCameraInfo, '/set_camera_info')\n\n        # Wait for the service to be available\n        while not self.client.wait_for_service(timeout_sec=3.0):\n            self.get_logger().warn(\"Waiting for /set_camera_info service...\")\n\n        self.send_request()\n\n    def send_request(self):\n        request = SetCameraInfo.Request()\n\n        # Fill the CameraInfo message\n        request.camera_info = CameraInfo()\n        request.camera_info.width = 1280\n        request.camera_info.height = 720\n        request.camera_info.k = [900.0, 0.0, 640.0, 0.0, 900.0, 360.0, 0.0, 0.0, 1.0]  # Intrinsic matrix\n        request.camera_info.d = [0.1, -0.05, 0.001, 0.002, 0.0]  # Distortion coefficients\n        request.camera_info.distortion_model = \"plumb_bob\"\n\n        self.future = self.client.call_async(request)\n        self.future.add_done_callback(self.response_callback)\n\n    def response_callback(self, future):\n        try:\n            response = future.result()\n            if response.success:\n                self.get_logger().info(\"Camera info updated successfully!\")\n            else:\n                self.get_logger().error(\"Failed to update camera info!\")\n        except Exception as e:\n            self.get_logger().error(f\"Service call failed: {str(e)}\")\n\n\ndef main():\n    rclpy.init()\n    node = CameraInfoClient()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n</code></pre>","tags":["ros","gscam","gstreamer"]},{"location":"ROS/ros_eco/packages/mavros/","title":"Mavros","text":"<p>ROS / ros eco / packages</p> <p>MAVLink extendable communication node for ROS2.</p>","tags":["ros","mavros","mavlink","ardupilot"]},{"location":"ROS/ros_eco/packages/mavros/#connections-url","title":"Connections url","text":"<ul> <li>Serial: /path/to/serial/device[:baudrate]</li> <li>Serial: serial:///path/to/serial/device[:baudrate][?ids=sysid,compid]</li> <li>UDP: udp://[bind_host][:port]@[remote_host[:port]][/?ids=sysid,compid]</li> <li>TCP client: tcp://[server_host][:port][/?ids=sysid,compid]</li> </ul> ardupilot connection<pre><code>ros2 launch mavros apm.launch fcu_url:=tcp://localhost:5760 gcs_url:=udp://@localhost:14550\n</code></pre> using node.launch connect to APM SITL and control pluginlist and config<pre><code>ros2 launch mavros node.launch \\\nfcu_url:=tcp://0.0.0.0:5760@ \\\ngcs_url:=udp://@127.0.0.1:14560 \\\ntgt_system:=1 \\\ntgt_component:=1 \\\npluginlists_yaml:=plugins.yaml \\\nconfig_yaml:=config.yaml\n</code></pre> using node.launch connect to APM HW and control pluginlist and config<pre><code>ros2 launch mavros node.launch \\\nfcu_url:=/dev/ttyACM1:115200 \\\ngcs_url:=udp://@127.0.0.1:14560 \\\ntgt_system:=1 \\\ntgt_component:=1 \\\npluginlists_yaml:=/workspace/src/ardupilot_bringup/config/plugins.yaml \\\nconfig_yaml:=/workspace/src/ardupilot_bringup/config/config.yaml\n</code></pre> <p>message interval</p> <pre><code>ros2 service call /mavros/set_message_interval mavros_msgs/srv/MessageInterval \"{message_id: 74, message_rate: 1.0}\"\n</code></pre>","tags":["ros","mavros","mavlink","ardupilot"]},{"location":"ROS/ros_eco/packages/mavros/#mavlink-mav_frame","title":"Mavlink MAV_FRAME","text":"<ul> <li>GLOBAL: Global coordinate frame with WGS84 latitude/longitude and altitude positive over mean sea level (MSL) by default</li> <li>RELATIVE_ALT: Altitude is relative to the vehicle home position rather than MSL.</li> <li>TERRAIN_ALT: Altitude is relative to ground level rather than MSL.</li> <li> <p>INT: Latitude/longitude (in degrees) are scaled by multiplying by 1E7.</p> </li> <li> <p>LOCAL: Origin of local frame is fixed relative to earth.  origin of the vehicle position-estimator (\"EKF\").</p> </li> <li>BODY: Origin of local frame travels with the vehicle. NOTE, \"BODY\" does NOT indicate alignment of frame axis with vehicle attitude.</li> </ul>","tags":["ros","mavros","mavlink","ardupilot"]},{"location":"ROS/ros_eco/packages/mavros/#enu-and-ned-coordinate-frame","title":"ENU and NED coordinate frame","text":"<ul> <li>NED: North East Down</li> <li>ENU: East North Down (use by ROS)</li> </ul>","tags":["ros","mavros","mavlink","ardupilot"]},{"location":"ROS/ros_eco/packages/mavros/#ned","title":"NED","text":"<p>This frame is widely used in aviation and maritime applications  - North (X-axis): Points towards true North. - East (Y-axis): Points towards East, perpendicular to the North axis. - Down (Z-axis): Points downwards, perpendicular to the North-East plane.</p>","tags":["ros","mavros","mavlink","ardupilot"]},{"location":"ROS/ros_eco/packages/mavros/#enu","title":"ENU","text":"<p>This frame is commonly used in robotics and ROS</p> <ul> <li>East (X-axis): Points towards East.</li> <li>North (Y-axis): Points towards true North, perpendicular to the East axis.</li> <li>Up (Z-axis): Points upwards, perpendicular to the East-North plane.</li> </ul>","tags":["ros","mavros","mavlink","ardupilot"]},{"location":"ROS/ros_eco/packages/mavros/#plugins","title":"Plugins","text":"<p>altitude</p> <p>command</p> <p>distance_sensor</p> <p>do_set_mode</p> <p>gimbal_control</p> <p>global_position</p> <p>home_position</p> <p>imu</p> <p>local_position</p> <p>param</p> <p>RangeFinder</p> <p>rc_io</p> <p>setpoint_attitude</p> <p>setpoint_raw</p> <p>setpoint_velocity</p> <p>sys_status</p> <p>sys_time</p> <p>terrain</p> <p>tf</p> <p>vfr_hud</p> <p>vision_speed_estimation</p>","tags":["ros","mavros","mavlink","ardupilot"]},{"location":"ROS/ros_eco/packages/mavros/#reference","title":"Reference","text":"<ul> <li>Mavros read the docs</li> </ul>","tags":["ros","mavros","mavlink","ardupilot"]},{"location":"ROS/ros_eco/packages/mavros/altitude/","title":"Altitude plugin","text":"<p>ROS / ros eco / packages / mavros</p> <p>The current system altitude.</p>","tags":["ros","mavros","altitude"]},{"location":"ROS/ros_eco/packages/mavros/altitude/#mavlink","title":"MAvlink","text":"<p>Altitude(141)</p> altitude_monotonic altitude_amsl altitude_local altitude_relative altitude_terrain bottom_clearance","tags":["ros","mavros","altitude"]},{"location":"ROS/ros_eco/packages/mavros/altitude/#-amsl-above-mean-sea-level","title":"- amsl: above mean sea level","text":"","tags":["ros","mavros","altitude"]},{"location":"ROS/ros_eco/packages/mavros/altitude/#ardupilot","title":"Ardupilot","text":"<p>The message remove from ardupilot code</p> <pre><code>ros2 service call /mavros/set_message_interval mavros_msgs/srv/MessageInterval \"{message_id: 141, message_rate: 1.0}\"\nresponse:\nmavros_msgs.srv.MessageInterval_Response(success=False)\n\n# mavros log\n[mavros_node-1] [INFO] [1753786083.525031132] [mavros.sys]: FCU: No ap_message for mavlink id (141)\n[mavros_node-1] [ERROR] [1753786083.525544178] [mavros.sys]: SYS: command plugin service call failed!\n</code></pre>","tags":["ros","mavros","altitude"]},{"location":"ROS/ros_eco/packages/mavros/altitude/#check-alternative-message-to-get-the-information","title":"Check alternative message to get the information","text":"<p>GLOBAL_POSITION_INT (message ID 33)</p> <pre><code>Contains alt (AMSL) and relative_alt (relative to home)\n</code></pre> <p>VFR_HUD (message ID 74)</p> <pre><code>Contains alt, climb\n</code></pre> <p>HOME_POSITION (for reference altitude)</p>","tags":["ros","mavros","altitude"]},{"location":"ROS/ros_eco/packages/mavros/command/","title":"Mavros Command Plugin","text":"<p>ROS / ros eco / packages / mavros</p> <p>Expose mavlink command_long(76) and command_int(75), and wrap multiple service that use this command like</p> <ul> <li>arming</li> <li>set_home</li> <li>takeoff</li> <li>land</li> <li>trigger_control</li> <li>trigger_interval</li> <li>vtol_transition</li> <li>land_local</li> <li>takeoff_local</li> </ul> <p>This service send the command and wait for acknowledge</p>","tags":["ros","mavros","command"]},{"location":"ROS/ros_eco/packages/mavros/command/#mavlink","title":"Mavlink ()","text":"<p>Check mavlink command protocol</p> <pre><code>sequenceDiagram\n    participant GCS\n    participant Drone\n\n    GCS-&gt;&gt;Drone: COMMAND_LONG(confirmation=0)\n    Drone--&gt;&gt;GCS: COMMAND_ACK\n</code></pre>","tags":["ros","mavros","command"]},{"location":"ROS/ros_eco/packages/mavros/command/#command_ack-77","title":"Command_ACK (77)","text":"<p>Report status of a command. Includes feedback whether the command was executed.</p> <p>for example</p> <ul> <li>0: Command accept (success)</li> <li>3: unsupported command</li> <li>4: failed</li> </ul> <p>check MAV_RESULT for more result values</p> <p>set_home</p> <p>do_set_servo</p>","tags":["ros","mavros","command"]},{"location":"ROS/ros_eco/packages/mavros/command/do_set_servo/","title":"DO_SET_SERVO","text":"<p>ROS / ros eco / packages / mavros / command</p> <p>Using mavros command to send DO_SET_SERVO command</p>","tags":["ros","mavros","servo","mav_cmd"]},{"location":"ROS/ros_eco/packages/mavros/command/do_set_servo/#mavlink","title":"Mavlink","text":"<p>MAV_CMD_DO_SET_SERVO (183)  Set a servo to a desired PWM value.</p> <p>Servo function</p> <p>SERVOx_FUNCTION must be (0) disabled for manual control</p>","tags":["ros","mavros","servo","mav_cmd"]},{"location":"ROS/ros_eco/packages/mavros/command/do_set_servo/#mavros","title":"Mavros","text":"<ul> <li>Param1: Servo instance number (zero base)</li> <li>Param2: PWM value (us)</li> </ul> <pre><code>ros2 service call /mavros/cmd/command mavros_msgs/srv/CommandLong \"{\n  broadcast: false,\n  command: 183,\n  confirmation: 0,\n  param1: 12,\n  param2: 1750,\n  param3: 0.0,\n  param4: 0.0,\n  param5: 0.0,\n  param6: 0.0,\n  param7: 0.0\n}\"\n</code></pre>","tags":["ros","mavros","servo","mav_cmd"]},{"location":"ROS/ros_eco/packages/mavros/command/set_home/","title":"SET_HOME","text":"<p>ROS / ros eco / packages / mavros / command</p> <p>Sets the home position to either to the current position or a specified position. The home position is the default position that the system will return to and land on. The position is set automatically by the system during the takeoff</p>","tags":["ros","mavros","set_home","mav_cmd"]},{"location":"ROS/ros_eco/packages/mavros/command/set_home/#mavlink","title":"Mavlink","text":"<p>MAV_CMD_DO_SET_HOME (179)</p> Param (Label) Description Values Units 1 (Use Current) Use current location (<code>MAV_BOOL_FALSE</code>: use specified location). Values not equal to 0 or 1 are invalid. <code>MAV_BOOL</code> 2 (Roll) Roll angle (of surface). Range: -180..180 degrees. <code>NaN</code> or 0 means value not set. <code>0.01</code> indicates zero roll. min: -180, max: 180 deg 3 (Pitch) Pitch angle (of surface). Range: -90..90 degrees. <code>NaN</code> or 0 means value not set. <code>0.01</code> means zero pitch. min: -90, max: 90 deg 4 (Yaw) Yaw angle. <code>NaN</code> to use default heading. Range: -180..180 degrees. min: -180, max: 180 deg 5 (Latitude) Latitude 6 (Longitude) Longitude 7 (Altitude) Altitude m","tags":["ros","mavros","set_home","mav_cmd"]},{"location":"ROS/ros_eco/packages/mavros/command/set_home/#without-gps","title":"without GPS","text":"set home position<pre><code>ros2 service call /mavros/cmd/set_home mavros_msgs/srv/CommandHome \"{current_gps: false, yaw: 0.0, latitude: 32.46107376716858, longitude: 34.943326818586755, altitude: 100.0}\"\n</code></pre> <p>command failed</p> <pre><code>ros2 topic pub /mavros/set_gp_origin geographic_msgs/msg/GeoPoint \"{latitude: 32.0853, longitude: 34.7818, altitude: 50.0}\"\n</code></pre>","tags":["ros","mavros","set_home","mav_cmd"]},{"location":"ROS/ros_eco/packages/mavros/distance_sensor/","title":"Distance sensor","text":"<p>ROS / ros eco / packages / mavros</p>","tags":["ros","mavros","distance_sensor"]},{"location":"ROS/ros_eco/packages/mavros/distance_sensor/#plugin","title":"Plugin","text":"<p>mavros_extra distance_sensor</p> <p>The plugin use as publisher for mavlink DISTANCE_SENSOR(132) And can be Subscriber and send range data into the FCU</p> <p>Rangefinder</p> <p>Ardupilot send mavlink message Rangefinder (173) There is a plugin in that handle this message mavros_extra.rangefinder</p> <pre><code>ros2 service call /mavros/set_message_interval mavros_msgs/srv/MessageInterval \"{message_id: 173, message_rate: 1.0}\"\n</code></pre>","tags":["ros","mavros","distance_sensor"]},{"location":"ROS/ros_eco/packages/mavros/distance_sensor/#topic-and-mavlink-message","title":"Topic and Mavlink message","text":"mavlink mavros topic(message) DISTANCE_SENSOR(132) rangefinder (sensor_msgs/msg/Range) <p>Topic name</p> <p>The topic name set by the config param </p> <p><code>rangefinder_pub</code> is the topic name for sensor id 0</p> <pre><code>/**/distance_sensor:\n  ros__parameters:\n    config: |\n    rangefinder_pub: \n        id: 0\n</code></pre>","tags":["ros","mavros","distance_sensor"]},{"location":"ROS/ros_eco/packages/mavros/distance_sensor/#usage","title":"usage","text":"set message interval<pre><code>ros2 service call /mavros/set_message_interval mavros_msgs/srv/MessageInterval \"{message_id: 132, message_rate: 1.0}\"\n</code></pre>","tags":["ros","mavros","distance_sensor"]},{"location":"ROS/ros_eco/packages/mavros/distance_sensor/#parameters","title":"Parameters","text":"para<pre><code>/**/distance_sensor:\n  ros__parameters:\n    config: |\n      rangefinder_pub: \n        id: 0\n        frame_id: \"lidar\"\n        # orientation: PITCH_270  # sended by FCU\n        field_of_view: 0.0        # XXX TODO\n        send_tf: false\n        sensor_position: {x:  0.0, y:  0.0, z:  -0.1}\n      rangefinder_sub:\n        subscriber: true\n        id: 1\n        orientation: PITCH_270  # only that orientation are supported by APM 3.4+\n</code></pre> <ol> <li>line 4: use as publisher topic name</li> <li>line 11: use as subscriber topic name</li> </ol>","tags":["ros","mavros","distance_sensor"]},{"location":"ROS/ros_eco/packages/mavros/distance_sensor/#config-publisher","title":"Config publisher","text":"field usage subscriber default(false) id sensor id frame_id use by message header <code>frame_id</code> and tf message field_of_view sensor info send_tf send data as tf default(false) <p>| custom_orientation  |   |</p>","tags":["ros","mavros","distance_sensor"]},{"location":"ROS/ros_eco/packages/mavros/distance_sensor/#config-subscriber","title":"Config subscriber","text":"field usage orientation covariance horizontal_fov_ratio vertical_fov_ratio sensor_position ---","tags":["ros","mavros","distance_sensor"]},{"location":"ROS/ros_eco/packages/mavros/distance_sensor/#reference","title":"Reference","text":"<ul> <li>RangeFinders Setup Overview</li> </ul>","tags":["ros","mavros","distance_sensor"]},{"location":"ROS/ros_eco/packages/mavros/gimbal_control/","title":"Index","text":"<p>ROS / ros eco / packages / mavros</p>","tags":["ros","mavros","gimbal"]},{"location":"ROS/ros_eco/packages/mavros/gimbal_control/#mavlink-gimbal-protocol-v2","title":"MAvlink (gimbal protocol v2)","text":"<p>The gimbal protocol  allows MAVLink control over the attitude/orientation of cameras (or other sensors) mounted on the drone</p> <ul> <li>Gimbal Device: the actual gimbal device, hardware and software.</li> <li>Gimbal Manager: software to deconflict gimbal messages and commands from different sources, and to abstract the capabilities of the Gimbal Device from gimbal users.</li> </ul> GIMBAL_DEVICE_ATTITUDE_STATUS ~/device/attitude_status Send out its attitude and status at a regular rate, e.g. 10 Hz This message is a meant as broadcast GIMBAL_MANAGER_STATUS Current status about a high level gimbal manager. This message should be broadcast at a low regular rate (e.g. 5Hz). GIMBAL_DEVICE_INFORMATION Information about a low level gimbal. This message should be requested by the gimbal manager or a ground station using MAV_CMD_REQUEST_MESSAGE. GIMBAL_MANAGER_INFORMATION Information about a high level gimbal manager. This message should be requested by a ground station using <code>MAV_CMD_REQUEST_MESSAGE</code>. GIMBAL_DEVICE_SET_ATTITUDE Low level message to control a gimbal device's attitude. This message is to be sent from the gimbal manager to the gimbal device component. GIMBAL_MANAGER_SET_ATTITUDE High level message to control a gimbal's attitude. GIMBAL_MANAGER_SET_PITCHYAW High level message to control a gimbal's pitch and yaw angles.","tags":["ros","mavros","gimbal"]},{"location":"ROS/ros_eco/packages/mavros/gimbal_control/#gimbal_manager_set_attitude-282","title":"GIMBAL_MANAGER_SET_ATTITUDE (282)","text":"<p>Mavlink</p> Field Name Type Units Values Description target_system uint8_t System ID target_component uint8_t Component ID flags uint32_t GIMBAL_MANAGER_FLAGS High level gimbal manager flags to use. gimbal_device_id uint8_t Component ID of gimbal device to address (or 1\u20136 for non-MAVLink gimbal), 0 for all gimbal device components. Send command multiple times for more than one gimbal (but not all). Messages with same value are from the same source (instance). q float[4] Quaternion components: w, x, y, z. (1 0 0 0 is the null-rotation. The frame depends on whether the flag <code>GIMBAL_MANAGER_FLAGS_YAW_LOCK</code> is set) angular_velocity_x float rad/s invalid:NaN X component of angular velocity. Positive is rolling to the right. <code>NaN</code> means ignore. angular_velocity_y float rad/s invalid:NaN Y component of angular velocity. Positive is pitching up. <code>NaN</code> means ignore. angular_velocity_z float rad/s invalid:NaN Z component of angular velocity. Positive is yawing to the right. <code>NaN</code> means ignore.","tags":["ros","mavros","gimbal"]},{"location":"ROS/ros_eco/packages/mavros/gimbal_control/#ardupilot","title":"Ardupilot","text":"<p>Control a Gimbal / Camera Mount</p> Running SITL with GIMBAL<pre><code>./arducopter --model quad --speedup 1 --slave 0 --default default.param --sim-address 127.0.0.1 -I0 --gimbal\n</code></pre>","tags":["ros","mavros","gimbal"]},{"location":"ROS/ros_eco/packages/mavros/gimbal_control/#params","title":"Params","text":"<p>Ardupilot support two gimbals </p> parameter default/setting description MNTx_ROLL_MAX/ MNTx_ROLL_MIN MNTx_PITCH_MAX/ MNTx_PITCH_MIN MNTx_YAW_MAX/ MNTx_YAW_MIN MNTx_RETRACT_X/Y/Z MNTx_NEUTRAL_X/Y/Z","tags":["ros","mavros","gimbal"]},{"location":"ROS/ros_eco/packages/mavros/gimbal_control/#gimbal-mode-vs-control-mode","title":"Gimbal Mode vs Control Mode","text":"<ul> <li>Gimbal Mode = how the gimbal interprets the world (lock/follow/stabilize)</li> <li>Control Mode = how you command it (MAVLink, RC, ROI, scripts)</li> </ul> Feature Stabilize Lock What it does Cancels out drone motion (vibrations, tilt) Maintains a fixed orientation in world coordinates Frame reference Relative to vehicle Relative to world Example usage Keeps video stable while drone moves Keeps camera pointed north even if drone turns Input source Uses IMU/gyro feedback to cancel motion Uses attitude + world frame input (e.g., target quaternion) Updates? Still follows pilot commands / RC / MAVLink pitch Ignores movement unless new command is sent Use case Smooth footage Survey, inspection, target tracking <p>SITL</p> <p>ArduPilot uses the FLU frame for mount/gimbal orientation</p> <ul> <li>Pitch = -90\u00b0 \u2192 camera pitches upward (toward +Z, up)</li> <li>Pitch = +90\u00b0 \u2192 camera pitches downward (toward -Z, down)</li> </ul>","tags":["ros","mavros","gimbal"]},{"location":"ROS/ros_eco/packages/mavros/gimbal_control/#camera-centric-coordinate-system","title":"Camera centric coordinate system","text":"","tags":["ros","mavros","gimbal"]},{"location":"ROS/ros_eco/packages/mavros/gimbal_control/#axis","title":"Axis","text":"Axis Direction (when facing forward through the lens) X Right Y Down (often, or up in some variants) Z Forward (out of the lens)","tags":["ros","mavros","gimbal"]},{"location":"ROS/ros_eco/packages/mavros/gimbal_control/#rotational-axes","title":"Rotational Axes","text":"Rotation Around Axis Positive Direction Yaw Z Turn right (CW when viewed from above) Pitch X Tilt up Roll Y Tilt right","tags":["ros","mavros","gimbal"]},{"location":"ROS/ros_eco/packages/mavros/gimbal_control/#sitlflu-hardwarecamera-centric","title":"SITL(FLU) / HARDWARE(Camera-Centric)","text":"Aspect Camera-Centric FLU (Vehicle-Centric) Pitch + Camera tilts up Vehicle nose tilts up (camera looks down) Used by Gimbal manufacturers, vision ArduPilot SITL, PX4 internals Orientation origin Camera lens Vehicle body center Application Imaging, targeting Navigation, control <ul> <li>GIMBAL_DEVICE_ATTITUDE_STATUS (3hz)</li> <li>GIMBAL_MANAGER_STATUS(1hz)</li> </ul>","tags":["ros","mavros","gimbal"]},{"location":"ROS/ros_eco/packages/mavros/gimbal_control/#more-terms","title":"More terms","text":"","tags":["ros","mavros","gimbal"]},{"location":"ROS/ros_eco/packages/mavros/gimbal_control/#nadir-and-zenith","title":"Nadir and zenith","text":"","tags":["ros","mavros","gimbal"]},{"location":"ROS/ros_eco/packages/mavros/gimbal_control/#mavros","title":"Mavros","text":"<pre><code># add gimbal_control plugin\n/mavros/**:\n  ros__parameters:\n    plugin_denylist:\n      # common\n      - '*'\n\n    plugin_allowlist:\n      - sys_time\n      - sys_status\n      - command\n      - gimbal_control\n</code></pre> ~/device/get_info GIMBAL_DEVICE_INFORMATION ~/manager/get_info command_long Trigger manager/info  <code>/mavros/gimbal_control/manager/info</code> ~/manager/configure ~/manager/pitchyaw ~/manager/set_roi ~/manager/camera_track","tags":["ros","mavros","gimbal"]},{"location":"ROS/ros_eco/packages/mavros/gimbal_control/#gimbal_manager_set_attitude","title":"GIMBAL_MANAGER_SET_ATTITUDE","text":"<p>Mavlink GIMBAL_MANAGER_SET_ATTITUDE (282)  High level message to control a gimbal's attitude. This message is to be sent to the gimbal manager , rate can be ignore by sending NaN.</p>","tags":["ros","mavros","gimbal"]},{"location":"ROS/ros_eco/packages/mavros/gimbal_control/#code-snippet-to-be-move-from-here","title":"Code snippet to be move from here","text":"<pre><code># Image point (u, v), image size, and camera intrinsics (fx, fy, cx, cy)\nx_cam = (u - cx) / fx\ny_cam = (v - cy) / fy\nz_cam = 1.0\n\n# 3D ray in camera frame\nray_camera = np.array([x_cam, y_cam, z_cam])\nray_camera /= np.linalg.norm(ray_camera)\n\n# Convert to FLU/world frame (if needed)\nray_world = camera_to_world @ ray_camera  # If using TF or known pose\n\nquat = look_at_quaternion(ray_world)\n</code></pre> <pre><code>import numpy as np\nfrom scipy.spatial.transform import Rotation as R\n\ndef look_at_quaternion(forward_target, up=np.array([0, 0, 1])):\n    # Normalize direction\n    z = forward_target / np.linalg.norm(forward_target)\n\n    # Compute orthogonal axes\n    x = np.cross(up, z)\n    if np.linalg.norm(x) &lt; 1e-5:\n        # up and forward are aligned \u2192 default right vector\n        x = np.array([1, 0, 0])\n    x /= np.linalg.norm(x)\n    y = np.cross(z, x)\n\n    rot_matrix = np.vstack((x, y, z)).T  # FLU: forward=Z\n    return R.from_matrix(rot_matrix).as_quat()  # [x, y, z, w]\n</code></pre> <pre><code>you can interpolate quaternions with SLERP to smooth the motion\n</code></pre>","tags":["ros","mavros","gimbal"]},{"location":"ROS/ros_eco/packages/mavros/gimbal_control/#this-is-the-code-i-need","title":"This is the code i need","text":"<pre><code>from geometry_msgs.msg import Quaternion\nfrom scipy.spatial.transform import Rotation as R\nimport numpy as np\n\ndef correct_gimbal_quaternion(q_current, u, v, cx, cy, fx, fy):\n    # Calculate angular error\n    dx = (u - cx) / fx\n    dy = (v - cy) / fy\n\n    yaw_error = -dx\n    pitch_error = -dy\n\n    # Convert errors to rotation delta\n    error_rot = R.from_euler('zy', [yaw_error, pitch_error])\n    q_current_rot = R.from_quat(q_current)  # [x, y, z, w]\n\n    q_new = q_current_rot * error_rot\n    return q_new.as_quat()  # [x, y, z, w]\n</code></pre>","tags":["ros","mavros","gimbal"]},{"location":"ROS/ros_eco/packages/mavros/global_position/","title":"Mavros global position plugin","text":"<p>ROS / ros eco / packages / mavros</p> <p>ECEF Coordinate system</p> <p>Earth-Centered, Earth-Fixed</p> <ul> <li>Origin: Earth center of mass</li> <li>X-axis: </li> <li>Y-axis</li> <li>Z-axis: Point to the north pole</li> <li>latitude (\u03d5):</li> <li>longitude (\u03bb) </li> </ul>","tags":["ros","mavros","global_position","ekf origin"]},{"location":"ROS/ros_eco/packages/mavros/global_position/#topics","title":"Topics","text":"","tags":["ros","mavros","global_position","ekf origin"]},{"location":"ROS/ros_eco/packages/mavros/global_position/#publisher","title":"Publisher","text":"topic gp_lp_offset gp_origin GPS_GLOBAL_ORIGIN compass_hdg rel_alt altitude above home position local GLOBAL_POSITION_INT odometry global GLOBAL_POSITION_INT NavSetFix /raw/satellites /raw/gps_vel GPS_RAW_INT /raw/fix GPS_RAW_INT","tags":["ros","mavros","global_position","ekf origin"]},{"location":"ROS/ros_eco/packages/mavros/global_position/#subscribers","title":"Subscribers","text":"topic home_position/home set_gp_origin","tags":["ros","mavros","global_position","ekf origin"]},{"location":"ROS/ros_eco/packages/mavros/global_position/#mavlink","title":"Mavlink","text":"mavlink mavros topic(message) GLOBAL_POSITION_INT (33) GPS_GLOBAL_ORIGIN (49) GPS_RAW_INT (24) LOCAL_POSITION_NED_SYSTEM_GLOBAL_OFFSET (89) gp_lp_offset","tags":["ros","mavros","global_position","ekf origin"]},{"location":"ROS/ros_eco/packages/mavros/global_position/#_1","title":"Mavros global position plugin","text":"<pre><code># GLOBAL_POSITION_INT\nros2 service call /mavros/set_message_interval mavros_msgs/srv/MessageInterval \"{\\\"message_id\\\": 33, \\\"message_rate\\\": 2 }\"\n\n#GPS_GLOBAL_ORIGIN\nros2 service call /mavros/set_message_interval mavros_msgs/srv/MessageInterval \"{\\\"message_id\\\": 49, \\\"message_rate\\\": 2 }\"\n</code></pre>","tags":["ros","mavros","global_position","ekf origin"]},{"location":"ROS/ros_eco/packages/mavros/global_position/#latitude-longitude-and-coordinate-system","title":"Latitude, Longitude and Coordinate system","text":"<p>Latitude (\u03d5) lines run east-west and are parallel to each other but measure north-north. So if you go north, latitude values increase. Finally, latitude values (Y-values) range between -90 and +90 degrees.</p> <p>Longitude (\u03bb) lines run north-south and measure east-west. They converge at the poles. And its X-coordinates are between -180 and +180 degrees.</p> <p></p>","tags":["ros","mavros","global_position","ekf origin"]},{"location":"ROS/ros_eco/packages/mavros/global_position/#demo","title":"Demo","text":"<pre><code>lat, lon\nTel Aviv \u2192 (32.0853\u00b0 N, 34.7818\u00b0 E)\n</code></pre> <p>bearing_deg</p> <p>The bearing_deg is the direction of travel, measured in degrees clockwise from North:</p> <p>0\u00b0 \u2192 North</p> <p>90\u00b0 \u2192 East</p> <p>180\u00b0 \u2192 South</p> <p>270\u00b0 \u2192 West</p>","tags":["ros","mavros","global_position","ekf origin"]},{"location":"ROS/ros_eco/packages/mavros/global_position/#calc-next-point","title":"Calc next point","text":"calc next point using distance and bearing<pre><code>from math import radians, degrees, sin, cos, atan2, asin\n\ndef move_point(lat, lon, distance_m, bearing_deg):\n    R = 6371000  # Earth radius in meters\n\n    lat1 = radians(lat)\n    lon1 = radians(lon)\n    bearing = radians(bearing_deg)\n\n    lat2 = asin(sin(lat1) * cos(distance_m/R) +\n                cos(lat1) * sin(distance_m/R) * cos(bearing))\n\n    lon2 = lon1 + atan2(sin(bearing) * sin(distance_m/R) * cos(lat1),\n                        cos(distance_m/R) - sin(lat1) * sin(lat2))\n\n    return degrees(lat2), degrees(lon2)\n\n# Example: move 500m east\nlat, lon = 32.0853, 34.7818\nnew_lat, new_lon = move_point(lat, lon, 500, 90)\n\nprint(f\"Original: {lat:.6f}, {lon:.6f}\")\nprint(f\"New point: {new_lat:.6f}, {new_lon:.6f}\")\n</code></pre> calc distance and bearing between two points<pre><code>from math import radians, sin, cos, sqrt, atan2, degrees\n\ndef haversine(coord1, coord2):\n    # Coordinates: (lat, lon)\n    R = 6371.0  # Earth radius in kilometers\n\n    lat1, lon1 = map(radians, coord1)\n    lat2, lon2 = map(radians, coord2)\n\n    dlat = lat2 - lat1\n    dlon = lon2 - lon1\n\n    a = sin(dlat/2)**2 + cos(lat1) * cos(lat2) * sin(dlon/2)**2\n    c = 2 * atan2(sqrt(a), sqrt(1-a))\n\n    return R * c\n\ndef bearing_between_points(lat1, lon1, lat2, lon2):\n    # Convert to radians\n    lat1, lon1, lat2, lon2 = map(radians, [lat1, lon1, lat2, lon2])\n\n    dlon = lon2 - lon1\n\n    x = sin(dlon) * cos(lat2)\n    y = cos(lat1) * sin(lat2) - sin(lat1) * cos(lat2) * cos(dlon)\n\n    initial_bearing = atan2(x, y)\n\n    # Convert from radians to degrees and normalize 0-360\n    bearing = (degrees(initial_bearing) + 360) % 360\n    return bearing\n\n# Example\norigin = (32.0853, 34.7818)   # Tel Aviv\ntarget = (32.085300, 34.787107)   # next point ~500m east\n\nprint(f\"Distance: {haversine(origin, target):.2f} km\")\nprint(f\"Bearing (from north cw): {bearing_between_points(32.0853, 34.7818, 32.085300, 34.787107):.2f}\u00b0\")\n</code></pre>","tags":["ros","mavros","global_position","ekf origin"]},{"location":"ROS/ros_eco/packages/mavros/global_position/#datum","title":"Datum","text":"<p>A datum in geodesy and mapping is a reference framework that defines the shape, size, and position of the coordinate system used to describe locations on Earth.</p> <p>WGS84 (World Geodetic System 1984) is one of the most important modern datums, is use by GPS navigation system.</p>","tags":["ros","mavros","global_position","ekf origin"]},{"location":"ROS/ros_eco/packages/mavros/home_position/","title":"Mavros home_position plugin","text":"<p>ROS / ros eco / packages / mavros</p> <p>Contains the home position. The home position is the default position that the system will return to and land on (RTL). Under normal conditions it describes the heading and terrain slope, which can be used by the aircraft to adjust the approach</p> <p>Get and Set <code>home_position</code> using mavlink message HOME_POSITION and SET_HOME_POSITION</p> <p>SET_HOME_POSITION deprecated</p> <p>Replace by MAV_CMD_DO_SET_HOME (179) The command expose by command plugin </p>","tags":["ros","mavros","home_position"]},{"location":"ROS/ros_eco/packages/mavros/home_position/#mavros","title":"Mavros","text":"<p>Publish home position as <code>mavros_msgs::msg::HomePosition</code> message under topic <code>` ~/home The message publish once when successful it cancel timer the send</code>GET_HOME_POSITION` command every 10s</p> <p>MAV_CMD_GET_HOME_POSITION DEPRECATED</p> <p>And replace with MAV_CMD_REQUEST_MESSAGE(512)</p>","tags":["ros","mavros","home_position"]},{"location":"ROS/ros_eco/packages/mavros/home_position/#ardupilot","title":"Ardupilot","text":"<p>The <code>home_position</code> set every time the vehicle ARM and can be change using <code>MAV_CMD_DO_SET_HOME</code> mavlink message</p> <p>EKF Origin</p> <p>The \u201cEKF origin\u201d is the location that the EKF (aka AHRS) uses for internal calculations. This location is normally set to the vehicle\u2019s location soon after the GPS provides a good quality location,Once set the EKF origin cannot be moved, the EKF origin publish my <code>GPS_GLOBAL_ORIGIN</code> and handle by MAVROS <code>global_position</code> plugin.</p>","tags":["ros","mavros","home_position"]},{"location":"ROS/ros_eco/packages/mavros/imu/","title":"Mavros IMU","text":"<p>ROS / ros eco / packages / mavros</p>","tags":["imu","mavros"]},{"location":"ROS/ros_eco/packages/mavros/imu/#mavlink-messages","title":"mavlink messages","text":"<ul> <li>attitude: The attitude in the aeronautical frame (x-front, y-right, z-down).)</li> <li>attitude_quaternion: The attitude in the aeronautical frame (q: w, x, y, z)</li> <li>highres_imu (105): The IMU readings in SI units in NED body frame</li> <li>raw_imu (27): The RAW IMU readings for a 9DOF sensor, which is identified by the id (default IMU1). This message should always contain the true raw values without any scaling to allow data capture and system debugging.</li> <li>scaled_imu (26): The RAW IMU readings for the usual 9DOF sensor setup. </li> <li>scaled_pressure: </li> </ul> <p>ATTITUDE_QUATERNION_COV(61)</p> <p>This message not use by mavros and Not support by ardupilot</p> mavlink mavros topic(message) ATTITUDE (30) data (sensor_msgs::msg::Imu) ATTITUDE_QUATERNION(31) data (sensor_msgs::msg::Imu) HIGHRES_IMU(105) data_raw (sensor_msgs::msg::Imu) RAW_IMU(27) data_raw (sensor_msgs::msg::Imu) SCALED_IMU(26) data_raw (sensor_msgs::msg::Imu) SCALED_PRESSURE","tags":["imu","mavros"]},{"location":"ROS/ros_eco/packages/mavros/imu/#message-topic-mapping","title":"Message Topic mapping","text":"<p>there two imu topic and the code map the priorities mavlink message</p> <ul> <li>~/data: The topic publish/mapping mavlink <code>ATTITUDE</code> or <code>ATTITUDE_QUATERNION</code> if publish by the FCU </li> <li>~/data_raw: the topic publish/mapping selected mavlink message with priority <code>HIGHRES_IMU</code> or <code>SCALED_IMU</code> or <code>RAW_IMU</code> </li> </ul>","tags":["imu","mavros"]},{"location":"ROS/ros_eco/packages/mavros/imu/#message-priority-variables","title":"Message priority variables","text":"<ul> <li>has_hr_imu = set to true automaticlay if system send <code>HIGHRES_IMU</code> message, disabled handle/publish <code>RAW_IMU</code> and <code>SCALED_IMU</code> message.</li> <li>has_raw_imu = set to true automaticlay if system send <code>RAW_IMU</code> message;</li> <li>has_scaled_imu = set to true automaticlay if system send <code>SCALED_IMU</code> message, disabled handle/publish <code>RAW_IMU</code> message.</li> <li>has_att_quat : set to true automaticlay if system send <code>ATTITUDE_QUATERNION</code> message, disabled handle/publish <code>ATTITUDE</code> message.</li> </ul> <p>data_raw\" vs \"data</p> <p>data_raw: Publish only gyro and accelerometer data: Publish Orientation and gyro</p>","tags":["imu","mavros"]},{"location":"ROS/ros_eco/packages/mavros/imu/#ros-imu-msg","title":"ROS Imu msg","text":"<p>sensor_msgs/msg/Imu.msg</p> <pre><code>std_msgs/msg/Header header\ngeometry_msgs/msg/Quaternion orientation\ndouble[9] orientation_covariance\ngeometry_msgs/msg/Vector3 angular_velocity\ndouble[9] angular_velocity_covariance\ngeometry_msgs/msg/Vector3 linear_acceleration\ndouble[9] linear_acceleration_covariance\n</code></pre>","tags":["imu","mavros"]},{"location":"ROS/ros_eco/packages/mavros/imu/#covariance","title":"Covariance","text":"<p>The message covariance filed by parameters</p> parameter name field name linear_acceleration_stdev IMU.linear_acceleration_covariance angular_velocity_stdev IMU.angular_velocity_covariance orientation_stdev / unk_orientation_cov IMU.orientation_covariance magnetic_stdev MagneticField.magnetic_field_covariance","tags":["imu","mavros"]},{"location":"ROS/ros_eco/packages/mavros/imu/#the-1-convention-in-imu-covariance","title":"The -1 convention in IMU covariance","text":"<p>Each covariance array (orientation_covariance, angular_velocity_covariance, linear_acceleration_covariance) is a 3\u00d73 matrix stored row-major.</p> <p>Normally you\u2019d put variances (\u03c3\u00b2) on the diagonal.</p> <p>BUT: If a sensor does not provide that measurement, the convention is to set the first element to -1.</p>","tags":["imu","mavros"]},{"location":"ROS/ros_eco/packages/mavros/imu/#demo-attitude-message-mavrosimudata","title":"Demo: Attitude message (/mavros/imu/data)","text":"set message stream<pre><code>ros2 service call /mavros/set_message_interval mavros_msgs/srv/MessageInterval \"{message_id: 30, message_rate: 1.0}\"\n</code></pre> <pre><code>ros2 topic echo --once /mavros/imu/data\n#\nheader:\n  stamp:\n    sec: 0\n    nanosec: 0\n  frame_id: base_link\norientation:\n  x: 0.00042285808111321393\n  y: -4.743792265771591e-05\n  z: -0.7445043500394287\n  w: -0.6676174740920542\norientation_covariance:\n- 1.0\n- 0.0\n- 0.0\n- 0.0\n- 1.0\n- 0.0\n- 0.0\n- 0.0\n- 1.0\nangular_velocity:\n  x: -0.0001230202615261078\n  y: 9.356345981359479e-05\n  z: -0.00024927849881350994\nangular_velocity_covariance:\n- 1.2184696791468346e-07\n- 0.0\n- 0.0\n- 0.0\n- 1.2184696791468346e-07\n- 0.0\n- 0.0\n- 0.0\n- 1.2184696791468346e-07\nlinear_acceleration:\n  x: 0.0\n  y: 0.0\n  z: 0.0\nlinear_acceleration_covariance:\n- -1.0\n- 0.0\n- 0.0\n- 0.0\n- 8.999999999999999e-08\n- 0.0\n- 0.0\n- 0.0\n- 8.999999999999999e-08\n</code></pre>","tags":["imu","mavros"]},{"location":"ROS/ros_eco/packages/mavros/imu/#covariance-explain","title":"Covariance explain","text":"<ul> <li>orientation_covariance: default orientation_stdev is: 1.0</li> <li>angular_velocity_covariance: default angular_velocity_stdev: 0.02*(pi/180)</li> <li>linear_acceleration_covariance: -1 , no orientation sensor data</li> </ul> <p>calculate variance from angular_velocity_stdev parameter</p>","tags":["imu","mavros"]},{"location":"ROS/ros_eco/packages/mavros/imu/#_1","title":"Mavros IMU","text":"\\[0.02^\\circ = 0.02 \\times \\frac{\\pi}{180} = 0.00034906585 \\ \\text{rad/s}$$ **Variance = (stdev)\u00b2** $$\\sigma^2 = (0.00034906585)^2 = 1.21846968 \\times 10^{-7} \\ (\\text{rad/s})^2\\]","tags":["imu","mavros"]},{"location":"ROS/ros_eco/packages/mavros/imu/#demo-scaled_imu-message-mavrosimudata_raw","title":"Demo:  scaled_imu message (/mavros/imu/data_raw)","text":"set message stream<pre><code>ros2 service call /mavros/set_message_interval mavros_msgs/srv/MessageInterval \"{message_id: 26, message_rate: 1.0}\"\n</code></pre> <pre><code>ros2 service call /mavros/set_message_interval mavros_msgs/srv/MessageInterval \"{message_id: 26, message_rate: 1.0}\"\n</code></pre> <pre><code>ros2 topic echo --once /mavros/imu/data_raw\nheader:\n  stamp:\n    sec: 0\n    nanosec: 0\n  frame_id: base_link\norientation:\n  x: 0.0\n  y: 0.0\n  z: 0.0\n  w: 1.0\norientation_covariance:\n- -1.0\n- 0.0\n- 0.0\n- 0.0\n- 0.0\n- 0.0\n- 0.0\n- 0.0\n- 0.0\nangular_velocity:\n  x: 0.0\n  y: 0.0\n  z: 0.0\nangular_velocity_covariance:\n- 1.2184696791468346e-07\n- 0.0\n- 0.0\n- 0.0\n- 1.2184696791468346e-07\n- 0.0\n- 0.0\n- 0.0\n- 1.2184696791468346e-07\nlinear_acceleration:\n  x: 0.0\n  y: 1.202169221539125e-15\n  z: 9.81645665\nlinear_acceleration_covariance:\n- 8.999999999999999e-08\n- 0.0\n- 0.0\n- 0.0\n- 8.999999999999999e-08\n- 0.0\n- 0.0\n- 0.0\n- 8.999999999999999e-08\n---\n</code></pre>","tags":["imu","mavros"]},{"location":"ROS/ros_eco/packages/mavros/imu/#covariance-explain_1","title":"Covariance explain","text":"<ul> <li>orientation_covariance: -1 , no orientation sensor data</li> <li>angular_velocity_covariance: like <code>data</code> message</li> <li>linear_acceleration_covariance: default value 0.0003 is <code>9e-8</code></li> </ul>","tags":["imu","mavros"]},{"location":"ROS/ros_eco/packages/mavros/local_position/","title":"Mavros local_position plugin","text":"<p>ROS / ros eco / packages / mavros</p>","tags":["local_position","mavros","odometry"]},{"location":"ROS/ros_eco/packages/mavros/local_position/#topics","title":"Topics","text":"topic pose publish position in <code>enu</code> coordinate system pose_cov velocity_local publish linear and angular velocity <code>enu</code> coordinate system angulate velocity_body publish linera and angular velocity <code>body</code> coordinate system (angular velocity fill from other source TODO: check) velocity_body_cov accel only <code>LOCAL_POSITION_NED_COV</code> include acceleration data, publish in <code>enu</code> coordinate system odom","tags":["local_position","mavros","odometry"]},{"location":"ROS/ros_eco/packages/mavros/local_position/#mavlink","title":"Mavlink","text":"<p>mavlink site definition</p> <p>The filtered local position (e.g. fused computer vision and accelerometers). Coordinate frame is right-handed, Z-axis down (aeronautical frame, NED / north-east-down convention)</p> <p>todo: check ardupilot message sources</p> <pre><code># LOCAL_POSITION_NED\nros2 service call /mavros/set_message_interval mavros_msgs/srv/MessageInterval \"{\\\"message_id\\\": 32, \\\"message_rate\\\": 2 }\"\n\n# LOCAL_POSITION_NED_COV\nros2 service call /mavros/set_message_interval mavros_msgs/srv/MessageInterval \"{\\\"message_id\\\": 65, \\\"message_rate\\\": 2 }\"\n</code></pre> mavlink mavros topic(message) LOCAL_POSITION_NED (32) odom LOCAL_POSITION_NED (32) pose LOCAL_POSITION_NED (32) velocity_local LOCAL_POSITION_NED (32) velocity_body LOCAL_POSITION_NED_COV (64) odom LOCAL_POSITION_NED_COV (64) pose_cov LOCAL_POSITION_NED_COV (64) velocity_body_cov LOCAL_POSITION_NED_COV (64) accel <p>if we register to both message the odom message data publish from <code>LOCAL_POSITION_NED_COV</code> the <code>tf</code> if enable publish from <code>LOCAL_POSITION_NED</code> data</p> <p>!!!     LOCAL_POSITION_NED_COV include acceleration data</p>","tags":["local_position","mavros","odometry"]},{"location":"ROS/ros_eco/packages/mavros/local_position/#parameters","title":"Parameters","text":"Name Desc default frame_id map tf.send false tf.frame_id map tf_child_frame_id control to odom message chile_frame_id base_link","tags":["local_position","mavros","odometry"]},{"location":"ROS/ros_eco/packages/mavros/local_position/#nav_msgsodometry","title":"nav_msgs/Odometry","text":"<p>The odometry carries both pose and velocity</p> <p>Frames</p> <ul> <li>header.frame_id: The reference frame for pose (commonly odom or map)</li> <li> <p>child_frame_id: The moving frame being described (commonly base_link or base_footprint)</p> </li> <li> <p>Pose: expressed in the header.frame_id (usually odom frame).</p> </li> <li>Velocity : expressed in the child_frame_id (usually base_link).         - twist.twist.linear.x \u2192 forward speed along the robot\u2019s x-axis         - twist.twist.linear.y \u2192 sideways (lateral) speed along the robot\u2019s y-axis         - twist.twist.linear.z \u2192 vertical speed (up/down)         - twist.twist.angular \u2192 angular velocity around each axis, also in the child frame</li> </ul> nav_msgs/Odometry<pre><code>std_msgs/Header header\nstring child_frame_id\ngeometry_msgs/PoseWithCovariance pose\ngeometry_msgs/TwistWithCovariance twist\n</code></pre>","tags":["local_position","mavros","odometry"]},{"location":"ROS/ros_eco/packages/mavros/local_position/#mavros-methods","title":"Mavros methods","text":"Method Description / usage ftf::transform_frame_baselink_enu ftf::transform_frame_enu_baselink","tags":["local_position","mavros","odometry"]},{"location":"ROS/ros_eco/packages/mavros/odometry/","title":"Mavros odometry plugin","text":"<p>ROS / ros eco / packages / mavros</p> <p>Odometry plugin implement in odom.cpp locate in mavros_extra package</p> <pre><code>/mavros/**:\n  ros__parameters:\n    plugin_denylist:\n      # common\n      - '*'\n\n    plugin_allowlist:\n      # - sys_time\n      - sys_status\n      - command\n      - odometry\n</code></pre> <p><code>bash   ros2 service call /mavros/set_message_interval mavros_msgs/srv/MessageInterval \"{\\\"message_id\\\": 331, \\\"message_rate\\\": 10 }\"</code></p> <p>ardupilot</p> <p>Ardupilot not implement odometry (331) message and only received this message from to companion computer</p>","tags":["ros","mavros","odometry"]},{"location":"ROS/ros_eco/packages/mavros/rangefinder/","title":"Mavros rangefinder","text":"<p>ROS / ros eco / packages / mavros</p>","tags":["mavros","rangefinder"]},{"location":"ROS/ros_eco/packages/mavros/rangefinder/#plugin","title":"Plugin","text":"<p>mavros_extra rangefinder</p>","tags":["mavros","rangefinder"]},{"location":"ROS/ros_eco/packages/mavros/rangefinder/#topic-and-mavlink-message","title":"Topic and Mavlink message","text":"mavlink mavros topic(message) RANGEFINDER (173) rangefinder (sensor_msgs/msg/Range) <p>Ardupilot message</p> <p>Ardupilot send mavlink message Rangefinder (173) There is a plugin in that handle this message mavros_extra.rangefinder</p> set message interval<pre><code>ros2 service call /mavros/set_message_interval mavros_msgs/srv/MessageInterval \"{message_id: 173, message_rate: 1.0}\"\n</code></pre>","tags":["mavros","rangefinder"]},{"location":"ROS/ros_eco/packages/mavros/rangefinder/#simulate","title":"Simulate","text":"<p>Config SITL to simulate RangeFinder</p> <pre><code>RNGFND1_TYPE = 100        # Type = simulated sonar\nRNGFND1_MIN_CM = 20     # Min distance (cm)\nRNGFND1_MAX_CM = 700    # Max distance (cm)\nRNGFND1_ORIENT = 25     # Orientation: downward-facing\nRNGFND1_FUNCTION = 1       # Model = linear\n</code></pre> <p>TODO: Extend the plugin, - Add variance  - read min and max from parameter - read rotation from parameter</p>","tags":["mavros","rangefinder"]},{"location":"ROS/ros_eco/packages/mavros/rc_io/","title":"Mavros rc plugin","text":"<p>ROS / ros eco / packages / mavros</p>","tags":["ros","mavros","rc","rc_channels_override","rc_channels_raw"]},{"location":"ROS/ros_eco/packages/mavros/rc_io/#mavlink","title":"Mavlink","text":"Message Desc RC_CHANNELS_RAW(35) The RAW values of the RC channels received (8 channels) RC_CHANNELS(65) The PPM values of the RC channels received (18 channels) SERVO_OUTPUT_RAW(36) The RAW values of the servo outputs RC_CHANNELS_OVERRIDE(70) The RAW values of the RC channels sent to the MAV to override info received from the RC radio <p>RC_CHANNELS_RAW vs RC_CHANNELS</p> <p>The different is that the <code>rc_channel</code> send the same information until 18 channels in one message, the <code>rc_channel_raw</code> send 8 channels in make if it from main or aux port</p> <p><code>rc_channel</code> has <code>chancount</code> field the mark the number of channels supported but the command return maximum of 18 channels</p>","tags":["ros","mavros","rc","rc_channels_override","rc_channels_raw"]},{"location":"ROS/ros_eco/packages/mavros/rc_io/#mavros","title":"Mavros","text":"mavros mavlink /mavros/rc/in RC_CHANNELS_RAW / RC_CHANNELS pub /mavros/rc/out SERVO_OUTPUT_RAW pub /mavros/rc/override RC_CHANNELS_OVERRIDE sub","tags":["ros","mavros","rc","rc_channels_override","rc_channels_raw"]},{"location":"ROS/ros_eco/packages/mavros/rc_io/#rc_channels_raw-rc_channels","title":"RC_CHANNELS_RAW / RC_CHANNELS","text":"<p>If <code>rc_channels</code> receive then <code>rc_channel_raw</code> dropped</p>","tags":["ros","mavros","rc","rc_channels_override","rc_channels_raw"]},{"location":"ROS/ros_eco/packages/mavros/rc_io/#rc_channels_override","title":"RC_CHANNELS_OVERRIDE","text":"<p>Allows an external system like QGroundControl, MAVROS, or your own script to simulate RC transmitter inputs by injecting RC values directly into the autopilot.</p> <ul> <li>Send at ~10\u201350 Hz for reliable override </li> <li>ArduPilot expects regular updates or will revert to RC input</li> <li>Use 65535 for any channel you don't want to override</li> </ul> <p>Ardupilot </p> <p>Ardupilot accept rc_channels_override only from gcs_id (usually 255)</p> <pre><code>void GCS_MAVLINK::handle_rc_channels_override(const mavlink_message_t &amp;msg)\n{\n    if(msg.sysid != gcs().sysid_gcs()) {\n        return; // Only accept control from our gcs\n    }\n</code></pre> <p>We need to start mavros with system_id 255</p> <pre><code>/**/mavros:\n    ros__parameters:\n        system_id: 255\n</code></pre> <pre><code>[INFO] [1753461231.734660719] [mavros.mavros]: MAVROS UAS via /uas1 started. MY ID 255.191, TARGET ID 1.1\n</code></pre> <pre><code>ros2 param get mavros/mavros system_id\nInteger value is: 255\n</code></pre>","tags":["ros","mavros","rc","rc_channels_override","rc_channels_raw"]},{"location":"ROS/ros_eco/packages/mavros/setpoint_attitude/","title":"Mavros setpoint_attitude plugin","text":"<p>ROS / ros eco / packages / mavros</p>","tags":["mavros","set_attitude_target"]},{"location":"ROS/ros_eco/packages/mavros/setpoint_attitude/#mavros","title":"Mavros","text":"<p>plugin name: setpoint_attitude</p>","tags":["mavros","set_attitude_target"]},{"location":"ROS/ros_eco/packages/mavros/setpoint_raw/","title":"Mavros setpoint_raw","text":"<p>ROS / ros eco / packages / mavros</p>","tags":["ros","mavros","setpoint_raw"]},{"location":"ROS/ros_eco/packages/mavros/setpoint_raw/#mavlink","title":"Mavlink","text":"<ul> <li>POSITION_TARGET_LOCAL_NED (85)</li> <li>POSITION_TARGET_GLOBAL_INT(87)</li> <li>ATTITUDE_TARGET (83)</li> <li>SET_ATTITUDE_TARGET</li> </ul>","tags":["ros","mavros","setpoint_raw"]},{"location":"ROS/ros_eco/packages/mavros/setpoint_raw/#mav-frame","title":"MAV FRAME","text":"<p>Mavlink documentation - GLOBAL: Global coordinate frame with WGS84 latitude/longitude and altitude positive over mean sea level (MSL) by default. The following modifiers may be used with \"GLOBAL\": - INT: Latitude/longitude (in degrees) are scaled by multiplying by 1E7. - LOCAL: Origin of local frame is fixed relative to earth. Unless otherwise specified this origin is the origin of the vehicle position-estimator (\"EKF\").</p>","tags":["ros","mavros","setpoint_raw"]},{"location":"ROS/ros_eco/packages/mavros/setpoint_raw/#position_target_local_ned85","title":"POSITION_TARGET_LOCAL_NED(85)","text":"<p>Set the vehicle\u2019s target position (as an offset in NED from the EKF origin)</p>","tags":["ros","mavros","setpoint_raw"]},{"location":"ROS/ros_eco/packages/mavros/setpoint_raw/#position_target_global_int87","title":"POSITION_TARGET_GLOBAL_INT(87)","text":"<p>Reports the current commanded vehicle position, velocity, and acceleration as specified by the autopilot. This should match the commands sent in SET_POSITION_TARGET_GLOBAL_INT if the vehicle is being controlled this way.</p>","tags":["ros","mavros","setpoint_raw"]},{"location":"ROS/ros_eco/packages/mavros/setpoint_raw/#set_attitude_target82","title":"SET_ATTITUDE_TARGET(82)","text":"<p>Sets a desired vehicle attitude. Used by an external controller to command the vehicle (manual controller or other system). (SET_ATTITUDE_TARGET</p> Value Name Description 1 ATTITUDE_TARGET_TYPEMASK_BODY_ROLL_RATE_IGNORE Ignore body roll rate 2 ATTITUDE_TARGET_TYPEMASK_BODY_PITCH_RATE_IGNORE Ignore body pitch rate 4 ATTITUDE_TARGET_TYPEMASK_BODY_YAW_RATE_IGNORE Ignore body yaw rate 32 ATTITUDE_TARGET_TYPEMASK_THRUST_BODY_SET Use 3D body thrust setpoint instead of throttle 64 ATTITUDE_TARGET_TYPEMASK_THROTTLE_IGNORE Ignore throttle)[https://mavlink.io/en/messages/common.html#SET_ATTITUDE_TARGET]","tags":["ros","mavros","setpoint_raw"]},{"location":"ROS/ros_eco/packages/mavros/setpoint_raw/#demo-send-attitude-target-only-with-rpy-and-thrust","title":"Demo: send attitude target only with RPY and thrust","text":"<p>mask = 7 ignore all rate part</p>","tags":["ros","mavros","setpoint_raw"]},{"location":"ROS/ros_eco/packages/mavros/setpoint_raw/#reference","title":"Reference","text":"<ul> <li>Copter Commands in Guided Mode\u00b6</li> </ul>","tags":["ros","mavros","setpoint_raw"]},{"location":"ROS/ros_eco/packages/mavros/setpoint_velocity/","title":"Mavros setpoint_velocity","text":"<p>ROS / ros eco / packages / mavros</p> <p>setpoint get ROS <code>twist</code> or <code>twiststamped</code> message and send <code>SET_POSITION_TARGET_LOCAL_NED</code> mavlink message with mask that allow only velocity and yaw rate</p> Value Name Description Bit mask 1 POSITION_TARGET_TYPEMASK_X_IGNORE Ignore position x 0 1 2 POSITION_TARGET_TYPEMASK_Y_IGNORE Ignore position y 1 1 4 POSITION_TARGET_TYPEMASK_Z_IGNORE Ignore position z 2 1 8 POSITION_TARGET_TYPEMASK_VX_IGNORE Ignore velocity x 3 16 POSITION_TARGET_TYPEMASK_VY_IGNORE Ignore velocity y 4 32 POSITION_TARGET_TYPEMASK_VZ_IGNORE Ignore velocity z 5 64 POSITION_TARGET_TYPEMASK_AX_IGNORE Ignore acceleration x 6 1 128 POSITION_TARGET_TYPEMASK_AY_IGNORE Ignore acceleration y 7 1 256 POSITION_TARGET_TYPEMASK_AZ_IGNORE Ignore acceleration z 8 1 512 POSITION_TARGET_TYPEMASK_FORCE_SET Use force instead of acceleration 9 1024 POSITION_TARGET_TYPEMASK_YAW_IGNORE Ignore yaw 10 1 2048 POSITION_TARGET_TYPEMASK_YAW_RATE_IGNORE Ignore yaw rate 11","tags":["ros","mavros","setpoint_velocity"]},{"location":"ROS/ros_eco/packages/mavros/setpoint_velocity/#set_position_target_local_ned","title":"SET_POSITION_TARGET_LOCAL_NED","text":"<p>Sets a desired vehicle position in a local north-east-down coordinate frame. Used by an external controller to command the vehicle (manual controller or other system).</p> <p>LOCAL</p> <p>Origin of local frame is fixed relative to earth. Unless otherwise specified this origin is the origin of the vehicle position-estimator (\"EKF\").</p>","tags":["ros","mavros","setpoint_velocity"]},{"location":"ROS/ros_eco/packages/mavros/setpoint_velocity/#parameters","title":"Parameters","text":"Param mav_frame LOCAL_NED","tags":["ros","mavros","setpoint_velocity"]},{"location":"ROS/ros_eco/packages/mavros/sys_status/","title":"sys_state","text":"<p>ROS / ros eco / packages / mavros</p>","tags":["ros","mavros","sys_state"]},{"location":"ROS/ros_eco/packages/mavros/sys_status/#sys_state","title":"sys_state","text":"<p>command plugin</p> <p>sys_state depend on command plugin to get ardupilot version and  set_message_interval service </p> mavlink id description HEARTBEAT 0 The heartbeat message shows that a system or component is present and responding. EVENT 410 SYS_STATUS 1 mavlink common STATUSTEXT 253 mavlink common BATTERY_STATUS 147 mavlink common ESTIMATOR_STATUS 230 mavlink common REQUEST_DATA_STREAM 66 mavlink common  use by set_stream_rate service","tags":["ros","mavros","sys_state"]},{"location":"ROS/ros_eco/packages/mavros/sys_status/#parameters","title":"Parameters","text":"name default description conn_timeout 10.0 if no heartbeat for <code>conn_timeout</code> mavros set connection to false disable_diag false Disabled node diagnostics (batt, system, mem , hw and sw) heartbeat_mav_type onboard_controller set heartbeat MAV_TYPE to FCU heartbeat_rate 1.0 control heartbeat rate to FCU min_voltage vector Set minimal voltage to alert use in diagnostics qos_overrides./parameter_events.publisher.depth TBD: ROS2 related qos_overrides./parameter_events.publisher.durability TBD: ROS2 related qos_overrides./parameter_events.publisher.history TBD: ROS2 related qos_overrides./parameter_events.publisher.reliability TBD: ROS2 related start_type_description_service TBD: ROS2 related service","tags":["ros","mavros","sys_state"]},{"location":"ROS/ros_eco/packages/mavros/sys_status/#service","title":"Service","text":"mavlink default description set_mode set_stream_rate set_message_interval use command plugin vehicle_info_get <p>Streaming</p> <p>We can control mavlink message RATE by group or by message id set_stream_rate service set rate for group for example: STREAM_RAW_SENSORS (1) STREAM_EXTRA1 (10) STREAM_EXTRA2(11) for complete list Ardupilot</p> <p></p> <p></p>","tags":["ros","mavros","sys_state"]},{"location":"ROS/ros_eco/packages/mavros/sys_status/#mavlink-messages-send-by-plugin","title":"Mavlink messages send by plugin","text":"","tags":["ros","mavros","sys_state"]},{"location":"ROS/ros_eco/packages/mavros/sys_status/#heartbeat","title":"Heartbeat","text":"<ul> <li>Send heartbeat to FCU the rate control by <code>heartbeat_rate</code> parameter (0 disabled sending) , mavros send heartbeat with MAV_TYPE <code>ONBOARD_CONTROLLER</code> as default control by <code>heartbeat_mav_type</code> parameter</li> </ul>","tags":["ros","mavros","sys_state"]},{"location":"ROS/ros_eco/packages/mavros/sys_time/","title":"Clock/Time Synchronisation","text":"<p>ROS / ros eco / packages / mavros</p> <p>The flight controller and companion computer clocks can be synchronised using MAVLink\u2019s SYSTEM_TIME and TIMESYNC messages. This is important so that each side can blend data from the other side into its EKF.</p> <ul> <li>SYSTEM_TIME</li> <li>TIMESYNC</li> </ul>","tags":["ros","mavlink","time","clock","system_time","timesync","brd_rtc_types","mavros"]},{"location":"ROS/ros_eco/packages/mavros/sys_time/#system_time-2","title":"SYSTEM_TIME (2)","text":"<p>The system time is the time of the master clock. The message send both way and the master clock set by <code>BRD_RTC_TYPES</code> in ardupilot</p> Field Name Type Description <code>time_unix_usec</code> <code>uint64_t</code> Unix time in microseconds (UTC). 0 if unknown. <code>time_boot_ms</code> <code>uint32_t</code> Time since system boot in milliseconds. Starts at 0 on every system reset. <p>Autopilots (e.g., PX4, ArduPilot) may set time_unix_usec based on GPS time once available .</p> <p>The message publish by the fcu if no gps the time_unix_usec are zero (1/1/1970)</p> <p>TM: Wrong FCU time.</p> <p>if pixhawk has no time source like gps, and his unix data &lt; Sat Feb 14 02:31:30 MSK 2009 mavros not publish <code>SYSTEM_TIME</code> to topic <code>/mavros/time_reference</code> and we got <code>[WARN] [] [mavros.time]: TM: Wrong FCU time.</code></p>","tags":["ros","mavlink","time","clock","system_time","timesync","brd_rtc_types","mavros"]},{"location":"ROS/ros_eco/packages/mavros/sys_time/#brd_rtc_types-parameter","title":"BRD_RTC_TYPES parameter","text":"<p>In Ardupilot we can control the time source using BRD_RTC_TYPES parameter</p> <p></p> <ul> <li>GPS (0): Time init from GPS</li> <li>MAVLINK_SYSTEM_TIME(1): for example mavros send system time implement from sys_time plugin the rate control by <code>system_time_rate</code> 0 disabled sending</li> <li>HW(2): Using external hardware like <code>DS3231</code> or <code>RV3028</code> there is no driver implementation, i read about LUA driver implementation</li> </ul>","tags":["ros","mavlink","time","clock","system_time","timesync","brd_rtc_types","mavros"]},{"location":"ROS/ros_eco/packages/mavros/sys_time/#timesync-111","title":"TIMESYNC (111)","text":"<p>The MAVLink TIMESYNC message is used to synchronize time between two systems \u2014 typically between a companion computer and an autopilot (FCU) like Pixhawk.</p> Field Description <code>tc1</code> Remote system\u2019s time in microseconds <code>ts1</code> Local system\u2019s time in microseconds","tags":["ros","mavlink","time","clock","system_time","timesync","brd_rtc_types","mavros"]},{"location":"ROS/ros_eco/packages/mavros/sys_time/#sync-sequence","title":"Sync sequence","text":"<pre><code>sequenceDiagram\n    participant Companion\n    participant FCU\n\n    Note right of Companion: Companion initiates timesync\n    Companion-&gt;&gt;FCU: TIMESYNC (tc1 = 0, ts1 = T_local_send)\n\n    Note right of FCU: FCU receives and replies with its own time\n    FCU--&gt;&gt;Companion: TIMESYNC (tc1 = T_fcu_now, ts1 = T_local_send)\n\n    Note right of Companion: Companion receives response\n    Note right of Companion: Computes RTT = T_local_recv - ts1\n    Note right of Companion: Computes offset = tc1 + RTT/2 - T_local_recv\n\n    Note over Companion, FCU: Repeat periodically to refine offset\n</code></pre>","tags":["ros","mavlink","time","clock","system_time","timesync","brd_rtc_types","mavros"]},{"location":"ROS/ros_eco/packages/mavros/sys_time/#pymavlink-code-example","title":"pymavlink code example","text":"demo code <pre><code>from pymavlink import mavutil\nimport time\n\n# Connect to MAVLink\n# master = mavutil.mavlink_connection('udp:localhost:14550')\nmaster = mavutil.mavlink_connection('/dev/ttyACM0', baud=115200)\n\ndef current_time_us():\n    \"\"\"Return current time in microseconds\"\"\"\n    return int(time.time() * 1_000_000)\n\nprint(\"Waiting for heartbeat...\")\nmaster.wait_heartbeat()\nprint(\"Heartbeat received\")\n\n# Send initial TIMESYNC message to start sync loop (optional)\nmaster.mav.timesync_send(0, current_time_us())\n\nwhile True:\n    msg = master.recv_match(type='TIMESYNC', blocking=True, timeout=5)\n    if msg is None:\n        print(\"No TIMESYNC message received\")\n        continue\n\n    print(f\"Received TIMESYNC: tc1={msg.tc1}, ts1={msg.ts1}\")\n\n    if msg.tc1 == 0:\n        # Autopilot is requesting time sync \u2014 reply with our time\n        master.mav.timesync_send(0, current_time_us())\n        print(\"Responded with timesync\")\n    else:\n        # Autopilot responded to our request, calculate offset\n        now = current_time_us()\n        rtt = now - msg.ts1\n        offset = msg.tc1 + rtt // 2 - now\n        print(f\"RTT: {rtt} \u00b5s, Time offset estimate: {offset} \u00b5s\")\n</code></pre>","tags":["ros","mavlink","time","clock","system_time","timesync","brd_rtc_types","mavros"]},{"location":"ROS/ros_eco/packages/mavros/sys_time/#mavros","title":"MAVROS","text":"","tags":["ros","mavlink","time","clock","system_time","timesync","brd_rtc_types","mavros"]},{"location":"ROS/ros_eco/packages/mavros/sys_time/#parameters","title":"Parameters","text":"name default description time_ref_source fcu just a string for source filed in sensor_msgs::msg::TimeReference message (SYSTEM_TIME) timesync_mode mavlink - none, passthrough, mavlink, onboard system_time_rate 0.0 (disabled) send SYSTEM_TIME rate from CC to FCU timesync_rate 0.0 (disabled) send timesync rate , sync mode control by  timesync_mode","tags":["ros","mavlink","time","clock","system_time","timesync","brd_rtc_types","mavros"]},{"location":"ROS/ros_eco/packages/mavros/sys_time/#timesync_mode","title":"timesync_mode","text":"<ul> <li>mavlink: Send time sync request tc1=0, tc2=CC time</li> <li>onboard: Run time sync on board (TODO: explain more)</li> </ul>","tags":["ros","mavlink","time","clock","system_time","timesync","brd_rtc_types","mavros"]},{"location":"ROS/ros_eco/packages/mavros/sys_time/#reference","title":"Reference","text":"<ul> <li>Ardupilot clock/time sync</li> </ul>","tags":["ros","mavlink","time","clock","system_time","timesync","brd_rtc_types","mavros"]},{"location":"ROS/ros_eco/packages/mavros/terrain/","title":"Index","text":"<p>ROS / ros eco / packages / mavros</p>","tags":["ros","mavros","terrain"]},{"location":"ROS/ros_eco/packages/mavros/terrain/#srtm","title":"SRTM","text":"<p>terrain altitude data</p>","tags":["ros","mavros","terrain"]},{"location":"ROS/ros_eco/packages/mavros/terrain/#plugin","title":"Plugin","text":"<p>Publish terrain data as message stream</p> Topic Msg report TerrainReport <p>Set message rate</p> <p>Don't forget to set message rate</p> <pre><code>ros2 service call /mavros/set_message_interval mavros_msgs/srv/MessageInterval \"{\\\"message_id\\\": 136, \\\"message_rate\\\": 2 }\"\n</code></pre>","tags":["ros","mavros","terrain"]},{"location":"ROS/ros_eco/packages/mavros/terrain/#message-explain","title":"Message explain","text":"<pre><code>header:\n  stamp:\n    sec: 1752417366\n    nanosec: 28968923\n  frame_id: terrain\nlatitude: -35.363262\nlongitude: 149.1652373\nspacing: 100\nterrain_height: 583.843994140625\ncurrent_height: 0.23602294921875\npending: 0\nloaded: 504\n</code></pre> Field unit desc terrain_height m Terrain height MSL current_height m Current vehicle height above lat/lon terrain height","tags":["ros","mavros","terrain"]},{"location":"ROS/ros_eco/packages/mavros/terrain/#mavlink","title":"Mavlink","text":"Mavlink TERRAIN_REPORT (136)","tags":["ros","mavros","terrain"]},{"location":"ROS/ros_eco/packages/mavros/terrain/#ardupilot-parameters","title":"Ardupilot parameters","text":"parameter value TERRAIN_SPACING # TODO: explain all terrain parameters","tags":["ros","mavros","terrain"]},{"location":"ROS/ros_eco/packages/mavros/terrain/#loading-terrain-into-sd-card","title":"Loading terrain into SD card","text":"","tags":["ros","mavros","terrain"]},{"location":"ROS/ros_eco/packages/mavros/terrain/#ardupilot","title":"Ardupilot","text":"","tags":["ros","mavros","terrain"]},{"location":"ROS/ros_eco/packages/mavros/terrain/#reference","title":"Reference","text":"<ul> <li>ardupilot terrain</li> <li>Terrain Following (plane)</li> <li>Mavlink terrain protocol</li> </ul>","tags":["ros","mavros","terrain"]},{"location":"ROS/ros_eco/packages/mavros/tf/","title":"Mavros TF's","text":"<p>ROS / ros eco / packages / mavros</p>","tags":["ros","mavros","tf"]},{"location":"ROS/ros_eco/packages/mavros/tf/#mavros","title":"mavros","text":"<p>mavros node add 3 static_tf between ENU and NED</p> <ul> <li>map</li> <li>odom</li> <li>base_link</li> </ul> <p>The tf's name control by 3 parameters:</p> <ul> <li>map_frame_id</li> <li>odom_frame_id</li> <li>base_link_frame_id</li> </ul> tf frame global drift jump usage map V X V resocialization Global localization odom V X smooth Local motion (EKF) base_link follow the robot robot body <p>odom</p> <p>ROS deliberately keeps odom as a local, continuous frame that doesn\u2019t \"jump\" when localization improves. This is important for controllers (e.g., velocity PID or path planners) to avoid sudden changes in robot pose.</p> <p>Dead Reckoning</p> <p>Dead reckoning is a method for estimating a robot\u2019s current position based solely on its last known position and motion over time, without external reference (like GPS or SLAM).</p>","tags":["ros","mavros","tf"]},{"location":"ROS/ros_eco/packages/mavros/tf/#odometry","title":"Odometry","text":"","tags":["ros","mavros","tf"]},{"location":"ROS/ros_eco/packages/mavros/vio/","title":"Index","text":"<p>ROS / ros eco / packages / mavros</p> <ul> <li>VISION_POSITION_ESTIMATE (102)</li> <li>VISION_VELOCITY_ESTIMATE (103)</li> <li>GLOBAL_VISION_POSITION_ESTIMATE</li> <li>ODOMETRY</li> <li>OPTICAL_FLOW</li> <li>VISION_POSITION_DELTA</li> </ul> Param name Value Desc AHRS_EKF_TYPE 3 EK3_ENABLE 1 EK3_SRC1_POSXY 6 ExternalNav EK3_SRC1_POSZ EK3_SRC1_YAW <p>VISO_TYPE</p>","tags":["ros","mavros","vio","odometry","optical flow"]},{"location":"ROS/ros_eco/packages/mavros/vio/#optical-flow","title":"Optical flow","text":"<p>ekf3-optical-flow-and-gps-behavior/</p>","tags":["ros","mavros","vio","odometry","optical flow"]},{"location":"ROS/ros_eco/packages/mavros/vio/#reference","title":"Reference","text":"<ul> <li>GPS/non-GPS Navigation Transitions - Randy Mackay</li> <li>Integration of ArduPilot and VIO tracking camera (Part 4)</li> </ul>","tags":["ros","mavros","vio","odometry","optical flow"]},{"location":"ROS/ros_eco/packages/mavros/vision_speed_estimation/","title":"Vision Speed Estimation","text":"<p>ROS / ros eco / packages / mavros</p>","tags":["ros","mavros","mavros_extra","vision_speed"]},{"location":"ROS/ros_eco/packages/mavros/vision_speed_estimation/#mavlink","title":"Mavlink","text":"<p>VISION_SPEED_ESTIMATE (103)  Speed estimate from a vision source.</p> <p>Here is your data converted into a Markdown table:</p> Field Name Type Units Description usec uint64_t us Timestamp (UNIX time or time since system boot) x float m/s Global X speed y float m/s Global Y speed z float m/s Global Z speed covariance ++ float[9] Row-major representation of 3x3 linear velocity covariance matrix (states: vx, vy, vz; 1st three entries - 1st row, etc.). If unknown, assign NaN value to first element in the array. reset_counter++ uint8_t Estimate reset counter. This should be incremented when the estimate resets in any of the dimensions (position, velocity, attitude, angular speed). Used when e.g. SLAM detects a loop-closure and the estimate jumps. <p>Explain Global</p> <p>\"global\" often refers to a frame that is fixed relative to the Earth, as opposed to being fixed to the vehicle's body. However, it's not truly global in the sense of latitude and longitude (which would be a WGS84 ECEF or similar frame). Instead, it refers to a local tangent plane approximation of the Earth.</p> <p>Why not use \"Local X/Y/Z speed\" The reason they might use \"Global\" instead of \"Local\" is to distinguish it from a \"body frame\" velocity. A body frame velocity would be relative to the vehicle's own orientation</p> <p>Global (WGS84) vs. Global (Local NED)</p>","tags":["ros","mavros","mavros_extra","vision_speed"]},{"location":"ROS/ros_eco/packages/mavros/vision_speed_estimation/#mavros","title":"Mavros","text":"<p>vision_speed plugin</p>","tags":["ros","mavros","mavros_extra","vision_speed"]},{"location":"ROS/ros_eco/packages/topic_tools/","title":"Topic Tools","text":"<p>Tools for directing, throttling, selecting, and otherwise manipulating ROS 2 topics at a meta-level. These tools do not generally perform serialization on the streams being manipulated, instead acting on generic binary data using rclcpp's GenericPublisher and GenericSubscription</p> <p>github</p> <ul> <li>Relay: Subscribes to a topic and republishes to another.</li> <li>RelayField: Republishes data in a different message type.</li> <li>Transform: Manipulates a topic or a field and outputs data on another topic.</li> <li>Throttle: Republishes data with bandwidth or rate limit.</li> <li>Drop: Republishes by dropping X out of every Y incoming messages.</li> <li>Mux: Multiplexes incoming topics to an output.</li> <li>Delay: Delays and republishes incoming data.</li> </ul>","tags":["ros","package","topic","tools","throttle"]},{"location":"ROS/ros_eco/packages/topic_tools/#throttle","title":"Throttle","text":"<p>Throttle is ROS 2 node that subscribes to a topic and republishes incoming data to another topic, either at a maximum bandwidth or maximum message rate.</p>","tags":["ros","package","topic","tools","throttle"]},{"location":"ROS/ros_eco/packages/topic_tools/#rate-throttle-message","title":"Rate (throttle message)","text":"<pre><code>ros2 run topic_tools throttle messages &lt;in topic&gt; &lt;msgs_per_sec&gt; [out topic]\n</code></pre>","tags":["ros","package","topic","tools","throttle"]},{"location":"ROS/ros_eco/packages/topic_tools/#demo","title":"Demo","text":"<p>Decrease incoming topic rate</p> <ul> <li>Node that publish counter data at 10hz</li> <li>topic tool throttle republish message at 1hz</li> <li>Topic echo to view to throttle output</li> </ul> counter_publisher.py<pre><code>#!/bin/python3\n\nimport rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import Int32\n\nclass CounterPublisher(Node):\n    def __init__(self):\n        super().__init__('counter_publisher')\n        self.publisher_ = self.create_publisher(Int32, 'counter', 10)\n        self.counter = 0\n        self.timer = self.create_timer(0.1, self.timer_callback)\n\n    def timer_callback(self):\n        msg = Int32()\n        msg.data = self.counter\n        self.publisher_.publish(msg)\n        self.get_logger().info(f'Publishing: {msg.data}')\n        self.counter += 1\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = CounterPublisher()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n</code></pre> topic_throttle.yaml<pre><code>session_name: my_session\nwindows:\n  - window_name: my_window\n    layout: even-vertical\n    shell_command_before:\n      - source /opt/ros/humble/setup.bash\n      - export RMW_IMPLEMENTATION=rmw_cyclonedds_cpp\n    panes:\n      - shell_command: #\n          - printf '\\033]2;%s\\033\\\\' 'pub'\n          - python3 /workspace/src/g_stream/scripts/counter_publisher.py\n      - shell_command: #\n          - printf '\\033]2;%s\\033\\\\' 'throttle'\n          - ros2 run topic_tools throttle messages counter 1.0 counter_t\n      - shell_command: #\n          - printf '\\033]2;%s\\033\\\\' 'sub'\n          - ros2 topic echo /counter_t\n</code></pre>","tags":["ros","package","topic","tools","throttle"]},{"location":"ROS/ros_eco/packages/topic_tools/#output","title":"output","text":"","tags":["ros","package","topic","tools","throttle"]},{"location":"ROS/ros_eco/packages/topic_tools/#mux","title":"Mux","text":"<p>Mux is a ROS2 node that subscribes to a set of incoming topics and republishes incoming data from one of them to another topic</p> <pre><code>ros2 run topic_tools mux &lt;outopic&gt; &lt;intopic1&gt; [intopic2...]\n</code></pre>","tags":["ros","package","topic","tools","throttle"]},{"location":"ROS/ros_eco/packages/topic_tools/#demo_1","title":"Demo","text":"<p>Subscribe to multiple (two) image source and select between them using MuxSelect service Using <code>gscam</code> package to create image source</p> <p>Note</p> <ul> <li>list</li> <li>add</li> <li>delete</li> <li>select</li> </ul> topic_mux.yaml<pre><code>session_name: my_session\nwindows:\n  - window_name: my_window\n    layout: even-vertical\n    shell_command_before:\n      - source /opt/ros/humble/setup.bash\n      - export RMW_IMPLEMENTATION=rmw_cyclonedds_cpp\n    panes:\n      - shell_command: #\n          - printf '\\033]2;%s\\033\\\\' 'source1'\n          - export GSCAM_CONFIG=\"videotestsrc ! video/x-raw,width=640,height=480,framerate=30/1 ! videoconvert\"\n          - ros2 run gscam gscam_node --ros-args -r /camera/image_raw:=image1\n      - shell_command: #\n          - printf '\\033]2;%s\\033\\\\' 'source2'\n          - export GSCAM_CONFIG=\"videotestsrc pattern=snow ! video/x-raw,width=640,height=480,framerate=30/1 ! videoconvert\"\n          - ros2 run gscam gscam_node --ros-args -r /camera/image_raw:=image2\n      - shell_command: #\n          - printf '\\033]2;%s\\033\\\\' 'mux'\n          - ros2 run topic_tools mux out_image image1 image2  \n      - shell_command: #\n          - printf '\\033]2;%s\\033\\\\' 'mux'\n          - ros2 run rqt_image_view rqt_image_view out_image\n      - shell_command: \n          - printf '\\033]2;%s\\033\\\\' 'control'\n          - ros2 service call /mux/list topic_tools_interfaces/srv/MuxList \"{}\"\n          # - ros2 service call /mux/select topic_tools_interfaces/srv/MuxSelect \"{topic: 'image2'}\"\n</code></pre>","tags":["ros","package","topic","tools","throttle"]},{"location":"ROS/ros_eco/packages/topic_tools/#todo-check-transform-and-implement-it-in-cpp-using-exprtk-library","title":"TODO: check transform and implement it in cpp using exprTk library","text":"","tags":["ros","package","topic","tools","throttle"]},{"location":"ROS/ros_eco/packages/web_bridge/","title":"ROS2 web bridge","text":"<p>ROS / ros eco / packages</p> <p>WebBridge  is a bridge between ROS and the Web. - exposes ROS topics, services, and parameters over WebSockets using JSON messages. - A browser or any web app can connect via roslib.js (JavaScript client). - There are other client implementation except js like python <code>roslibpy</code></p>","tags":["web_bridge","rosbridge_suite"]},{"location":"ROS/ros_eco/packages/web_bridge/#install","title":"install","text":"<pre><code>sudo apt install ros-humble-ros-humble-rosbridge-suite\n</code></pre>","tags":["web_bridge","rosbridge_suite"]},{"location":"ROS/ros_eco/packages/web_bridge/#usage","title":"usage","text":"launch<pre><code>ros2 launch rosbridge_server rosbridge_websocket_launch.xml\n</code></pre>","tags":["web_bridge","rosbridge_suite"]},{"location":"ROS/ros_eco/packages/web_bridge/#minimal","title":"minimal","text":"<ul> <li>Connect for javascript</li> <li>Open <code>Console</code> from web developer tools for view log output <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;meta charset=\"utf-8\" /&gt;\n&lt;script src=\"https://cdn.jsdelivr.net/npm/roslib@1/build/roslib.min.js\"&gt;&lt;/script&gt;\n&lt;title&gt;ROS Bridge Demo&lt;/title&gt;\n\n&lt;script&gt;\n  // Connecting to ROS\n  // -----------------\n  var ros = new ROSLIB.Ros();\n  ros.connect('ws://localhost:9090');\n    ros.on('connection', function() {\n        console.log('Connected to websocket server.');\n    });\n    ros.on('error', function(error) {\n        console.log('Error connecting to websocket server: ', error);\n    });\n    ros.on('close', function() {\n        console.log('Connection to websocket server closed.');\n    }); \n    // -----------------    \n&lt;/script&gt;\n</code></pre></li> </ul>","tags":["web_bridge","rosbridge_suite"]},{"location":"ROS/ros_eco/packages/web_bridge/#parameter","title":"Parameter","text":"<ul> <li>declare parameter</li> </ul> <pre><code>var param1 = new ROSLIB.Param({\n        ros: ros,\n        name: '/minimal:param1'\n    });\n</code></pre> <p>parameter name</p> <p><code>node_name:param_name</code></p> <ul> <li>get / set</li> </ul> <pre><code>//get\nparam1.get(function(value) {\n            displayParam1(value);\n        });\n//set\nparam1.set(newValue);\n</code></pre> ros2 node <pre><code>#!/usr/bin/env python3\n\n\nimport rclpy\nfrom rclpy.node import Node\nfrom rcl_interfaces.msg import SetParametersResult\n\nPARAM1 = \"param1\"\nPARAM2 = \"param2\"\n\nclass MyNode(Node):\n    def __init__(self):\n        node_name=\"minimal\"\n        super().__init__(node_name)\n        p1 = self.declare_parameter(PARAM1, 1)\n        p2 = self.declare_parameter(PARAM2, 2)\n        self.get_logger().info(f\"P1: {p1.value}\")\n        self.get_logger().info(f\"P1: {p2.value}\")\n        self.add_on_set_parameters_callback(self.param_callback)\n\n\n    def param_callback(self, params):\n        for param in params:\n            self.get_logger().info(f\"Parameter '{param.name}' changed to: {param.value}\")\n\n        return SetParametersResult(successful=True)\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = MyNode()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n</code></pre> HTML/Js full demo<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;meta charset=\"utf-8\" /&gt;\n&lt;script src=\"https://cdn.jsdelivr.net/npm/roslib@1/build/roslib.min.js\"&gt;&lt;/script&gt;\n&lt;title&gt;ROS Bridge Demo&lt;/title&gt;\n\n&lt;script&gt;\n  // Connecting to ROS\n  // -----------------\n  var ros = new ROSLIB.Ros();\n  ros.connect('ws://localhost:9090');\n    ros.on('connection', function() {\n        console.log('Connected to websocket server.');\n    });\n    ros.on('error', function(error) {\n        console.log('Error connecting to websocket server: ', error);\n    });\n    ros.on('close', function() {\n        console.log('Connection to websocket server closed.');\n    }); \n    // -----------------    \n&lt;/script&gt;\n\n\n&lt;script&gt;\n    // Reading the parameter 'param1'\n    var param1 = new ROSLIB.Param({\n        ros: ros,\n        name: '/minimal:param1'\n    });\n\n&lt;/script&gt;\n\n&lt;body&gt;\n    &lt;label for=\"param1Value\"&gt;param1 value:&lt;/label&gt;\n    &lt;span id=\"param1Value\"&gt;Loading...&lt;/span&gt;\n    &lt;button onclick=\"refreshParam1()\"&gt;Refresh&lt;/button&gt;\n    &lt;button onclick=\"updateParam1()\"&gt;Update&lt;/button&gt;\n\n    &lt;script&gt;\n        function displayParam1(value) {\n            document.getElementById('param1Value').textContent = value;\n        }\n\n        // Initial fetch and display\n        param1.get(function(value) {\n            displayParam1(value);\n        });\n\n        // Refresh button handler\n        function refreshParam1() {\n            param1.get(function(value) {\n                displayParam1(value);\n            });\n        }\n\n        function updateParam1() {\n            const newValue = prompt(\"Enter new value for param1:\");\n            if (newValue !== null) {\n                param1.set(newValue);\n                refreshParam1();\n            }\n        }\n\n\n    &lt;/script&gt;\n&lt;/body&gt;\n</code></pre>","tags":["web_bridge","rosbridge_suite"]},{"location":"ROS/ros_eco/packages/web_bridge/#subscriber","title":"Subscriber","text":"<p>Implement subscriber to ros topic The demo topic publish int counter The js subscribe using bridge</p> <p>don't forget</p> <pre><code>ros2 launch rosbridge_server rosbridge_websocket_launch.xml\n</code></pre> simple publisher <pre><code>import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import Int32\n\nclass CounterPublisher(Node):\n    def __init__(self):\n        super().__init__('counter_publisher')\n        self.publisher_ = self.create_publisher(Int32, 'counter', 10)\n        self.counter = 0\n        self.timer = self.create_timer(1.0, self.timer_callback)\n\n    def timer_callback(self):\n        msg = Int32()\n        msg.data = self.counter\n        self.publisher_.publish(msg)\n        self.get_logger().info(f'Publishing: {self.counter}')\n        self.counter += 1\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = CounterPublisher()\n    try:\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        node.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n</code></pre> simple web bridge subscriber <pre><code>\n</code></pre>","tags":["web_bridge","rosbridge_suite"]},{"location":"ROS/ros_eco/packages/web_bridge/#service","title":"Service","text":"<p>don't forget</p> <pre><code>ros2 launch rosbridge_server rosbridge_websocket_launch.xml\n</code></pre> simple service <pre><code>#!/usr/bin/env python3\n\n\nimport rclpy\nfrom rclpy.node import Node\nfrom std_srvs.srv import Trigger\nfrom rclpy.qos import qos_profile_services_default\n\nTOPIC = \"trigger_srv\"\n\nclass MyNode(Node):\n    def __init__(self):\n        node_name=\"minimal_srv\"\n        super().__init__(node_name)\n        self.srv = self.create_service(Trigger, TOPIC, self.handler, qos_profile=qos_profile_services_default)\n        self.get_logger().info(\"Hello ROS2\")\n\n    def handler(self, request: Trigger.Request, response: Trigger.Response):\n        self.get_logger().info(\"Trigger service called\")\n        response.success = True\n        response.message = \"success\"\n        print(response)\n        return response\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = MyNode()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n</code></pre> simple web bridge subscriber <pre><code>\n</code></pre>","tags":["web_bridge","rosbridge_suite"]},{"location":"ROS/ros_eco/ros_bag/","title":"ROS Bag","text":"<p>ROS / ros eco</p>","tags":["ros","bag","mcap"]},{"location":"ROS/ros_eco/ros_bag/#mcap-cli","title":"MCAP Cli","text":"<p>Download last release</p>","tags":["ros","bag","mcap"]},{"location":"ROS/ros_eco/ros_bag/#convert-db3-file-to-mcap","title":"Convert db3 file to mcap","text":"","tags":["ros","bag","mcap"]},{"location":"ROS/ros_eco/ros_bag/#resource","title":"Resource","text":"<ul> <li>mcap</li> <li>mcap cli</li> </ul>","tags":["ros","bag","mcap"]},{"location":"ROS/ros_eco/ros_hardware/","title":"ROS2 Hardware","text":"<p>ROS / ros eco</p> <p>Event Camera</p> <p></p> <p></p>","tags":["ros2","hardware"]},{"location":"ROS/ros_eco/ros_hardware/event_camera/","title":"ROS2 event camera interface and messages","text":"<p>ROS / ros eco / ros hardware</p> <p>ROS 2 support for event cameras is provided through a set of packages designed to handle their unique data stream. Unlike traditional cameras that output frames at a fixed rate, event cameras output asynchronous events, which represent per-pixel brightness changes.</p>","tags":["ros","event camera"]},{"location":"ROS/ros_eco/ros_hardware/event_camera/#event_camera_msgs","title":"event_camera_msgs","text":"","tags":["ros","event camera"]},{"location":"ROS/ros_eco/ros_hardware/event_camera/#resource","title":"Resource","text":"<ul> <li>event_camera_py</li> </ul>","tags":["ros","event camera"]},{"location":"ROS/ros_eco/rviz_rqt/","title":"Rviz RQT and other ROS tools","text":"<p>rqt</p> <p>rviz</p> <p>plotjuggler</p> <p>VSC</p>","tags":["ros","rviz","rqt","tools","plotjuggler","vsc"]},{"location":"ROS/ros_eco/rviz_rqt/plotjuggler/","title":"PlotJuggler","text":"<p>PlotJuggler github</p>","tags":["ros","plot","plotjugller"]},{"location":"ROS/ros_eco/rviz_rqt/plotjuggler/#install","title":"Install","text":"","tags":["ros","plot","plotjugller"]},{"location":"ROS/ros_eco/rviz_rqt/plotjuggler/#ros-package","title":"ROS Package","text":"<pre><code># The install method from snap include ROS2, zmq, websocket and MQTT\nsudo snap install plotjuggler\n#\n#sudo apt install ros-humble-plotjuggler-ros\n</code></pre>","tags":["ros","plot","plotjugller"]},{"location":"ROS/ros_eco/rviz_rqt/plotjuggler/#plugins","title":"Plugins","text":"","tags":["ros","plot","plotjugller"]},{"location":"ROS/ros_eco/rviz_rqt/plotjuggler/#websocket","title":"Websocket","text":"code <pre><code>pip install websocket-client\n</code></pre> <pre><code>import websocket\nimport math\nimport json\nfrom time import sleep\nimport numpy as np\n\n\nws = websocket.WebSocket()\nws.connect(\"ws://localhost:9871\")\n\n\ntime = 0.0\n\nwhile True:\n   sleep(0.05)\n   time += 0.05\n   print(time)\n   data = {\n       \"timestamp\": time,\n       \"test_data\": {\n           \"cos\": math.cos(time),\n           \"sin\": math.sin(time),\n           \"floor\": np.floor(np.cos(time)),\n           \"ceil\": np.ceil(np.cos(time))\n       }\n   }\n\n   ws.send(json.dumps(data))\n</code></pre>","tags":["ros","plot","plotjugller"]},{"location":"ROS/ros_eco/rviz_rqt/plotjuggler/#usage","title":"Usage","text":"<p>Config plotjuggle to websocket listener that get json data</p> <p></p>","tags":["ros","plot","plotjugller"]},{"location":"ROS/ros_eco/rviz_rqt/plotjuggler/#zmq","title":"ZMQ","text":"code <pre><code>pip install websocket-client\n</code></pre> <pre><code>import zmq\nimport math\nimport json\nfrom time import sleep\nimport numpy as np\n\n\ncontext = zmq.Context()\nserverSocket = context.socket(zmq.PUB)\nport = 9872\nserverSocket.bind(\"tcp://*:\"+str(port))\ntime = 0.0\nwhile True:\n   sleep(0.05)\n   time += 0.05\n   print(time)\n   data = {\n       \"timestamp\": time,\n       \"test_data\": {\n           \"cos\": math.cos(time),\n           \"sin\": math.sin(time),\n           \"floor\": np.floor(np.cos(time)),\n           \"ceil\": np.ceil(np.cos(time))\n       }\n\n   }\n\n   serverSocket.send_string(json.dumps(data))\n</code></pre>","tags":["ros","plot","plotjugller"]},{"location":"ROS/ros_eco/rviz_rqt/plotjuggler/#usage_1","title":"usage","text":"","tags":["ros","plot","plotjugller"]},{"location":"ROS/ros_eco/rviz_rqt/plotjuggler/#mqtt","title":"MQTT","text":"","tags":["ros","plot","plotjugller"]},{"location":"ROS/ros_eco/rviz_rqt/plotjuggler/#prerequisites","title":"Prerequisites","text":"<p>Install mqtt broker on ubuntu machine</p> <pre><code>sudo apt install mosquitto mosquitto-clients\n</code></pre> <pre><code>sudo systemctl status mosquitto\n</code></pre>","tags":["ros","plot","plotjugller"]},{"location":"ROS/ros_eco/rviz_rqt/plotjuggler/#test-mqtt-broker","title":"Test mqtt broker","text":"<ul> <li>Without authentication</li> </ul> terminal 1, subscriber<pre><code>mosquitto_sub -t \"hello/topic\"\n</code></pre> terminal 2, publisher<pre><code>mosquitto_pub -t 'hello/topic' -m 'hello MQTT'\n</code></pre>","tags":["ros","plot","plotjugller"]},{"location":"ROS/ros_eco/rviz_rqt/plotjuggler/#install_1","title":"Install","text":"<pre><code>sudo snap install plotjuggler\n</code></pre>","tags":["ros","plot","plotjugller"]},{"location":"ROS/ros_eco/rviz_rqt/plotjuggler/#python-code","title":"Python code","text":"Python code <pre><code>pip install paho-mqtt numpy\n</code></pre> <pre><code>import paho.mqtt.client as mqtt\nimport math\nimport json\nfrom time import sleep\nimport numpy as np\n\n# MQTT Broker details\nBROKER = \"localhost\"  # Change to your MQTT broker address\nPORT = 1883  # Default MQTT port\nTOPIC = \"sensor/data\"  # MQTT topic to publish data\n\n# Create MQTT client\nclient = mqtt.Client()\nclient.connect(BROKER, PORT, 60)\n\ntime_counter = 0.0\n\nwhile True:\n    sleep(0.05)  # 50 ms sleep for 10 Hz\n    time_counter += 0.05  # Increment time\n\n    # Create data payload\n    data = {\n        \"timestamp\": time_counter,\n        \"test_data\": {\n            \"cos\": math.cos(time_counter),\n            \"sin\": math.sin(time_counter),\n            \"floor\": np.floor(np.cos(time_counter)),\n            \"ceil\": np.ceil(np.cos(time_counter))\n        }\n    }\n\n    # Convert to JSON and publish\n    client.publish(TOPIC, json.dumps(data))\n    print(f\"Published: {data}\")\n</code></pre>","tags":["ros","plot","plotjugller"]},{"location":"ROS/ros_eco/rviz_rqt/plotjuggler/#usage_2","title":"usage","text":"","tags":["ros","plot","plotjugller"]},{"location":"ROS/ros_eco/rviz_rqt/rqt/","title":"RQT","text":"<p>Custom Plugin</p> <p></p> <p></p>","tags":["ros","rqt"]},{"location":"ROS/ros_eco/rviz_rqt/rqt/#install","title":"Install","text":"<p>Install RQT with default plugin</p> <pre><code># source the ros folder before run the command\nsudo apt install ros-${ROS_DISTRO}-rqt ros-${ROS_DISTRO}-rqt-common-plugins\n</code></pre>","tags":["ros","rqt"]},{"location":"ROS/ros_eco/rviz_rqt/rqt/#pliugins","title":"Pliugins","text":"<ul> <li>RQt Image Overlay</li> </ul>","tags":["ros","rqt"]},{"location":"ROS/ros_eco/rviz_rqt/rqt/custom_plugins/","title":"RQT Custom plugin","text":"<p>Create Simple RQT python plugin</p>","tags":["ros","rqt","custom","plugin"]},{"location":"ROS/ros_eco/rviz_rqt/rqt/custom_plugins/#prerequisite","title":"Prerequisite","text":"<pre><code>sudo apt install ros-humble-rqt \nsudo apt install ros-humble-qt-gui \n</code></pre>","tags":["ros","rqt","custom","plugin"]},{"location":"ROS/ros_eco/rviz_rqt/rqt/custom_plugins/#code","title":"Code","text":"<ul> <li>Create ros2 ament_cmake package</li> </ul> <pre><code>\u251c\u2500\u2500 CMakeLists.txt\n\u251c\u2500\u2500 demo_control\n\u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u251c\u2500\u2500 rqt_demo.py\n\u2502   \u2514\u2500\u2500 rqt_plugin.py\n\u251c\u2500\u2500 package.xml\n\u251c\u2500\u2500 plugin.xml\n\u2514\u2500\u2500 resource\n   \u2514\u2500\u2500 Demo.ui\n</code></pre> CMakeLists.txt<pre><code>&lt;exec_depend&gt;rqt_gui&lt;/exec_depend&gt;\n&lt;exec_depend&gt;rqt_gui_py&lt;/exec_depend&gt;\n&lt;exec_depend&gt;python3-pyqt5&lt;/exec_depend&gt;\n\n&lt;export&gt;\n&lt;build_type&gt;ament_cmake&lt;/build_type&gt;\n\n&lt;rqt_gui plugin=\"${prefix}/plugin.xml\"/&gt; &lt;!--(1)--&gt; \n&lt;/export&gt;\n</code></pre> <ol> <li>Register plugin</li> </ol> plugin.xml<pre><code>&lt;library path=\"src\"&gt;\n&lt;class name=\"demo\" type=\"demo_control.rqt_plugin.DemoPlugin\" base_class_type=\"rqt_gui_py::Plugin\"&gt;\n    &lt;description&gt;\n        Demo rqt plugin\n    &lt;/description&gt;\n    &lt;qtgui&gt;\n        &lt;group&gt;\n            &lt;label&gt;Demo&lt;/label&gt;\n        &lt;/group&gt;\n        &lt;label&gt;simple demo plugin&lt;/label&gt;\n        &lt;icon type=\"theme\"&gt;system-help&lt;/icon&gt;\n        &lt;statustip&gt;Simple demo plugin.&lt;/statustip&gt;\n    &lt;/qtgui&gt;\n&lt;/class&gt;\n&lt;/library&gt;\n</code></pre>","tags":["ros","rqt","custom","plugin"]},{"location":"ROS/ros_eco/rviz_rqt/rqt/custom_plugins/#cmakelists","title":"CMakeLists","text":"<ul> <li>Copy <code>plugin.xml</code> and <code>resource</code> folder into project shared</li> </ul> <pre><code>cmake_minimum_required(VERSION 3.8)\nproject(g_stream_control)\n\nif(CMAKE_COMPILER_IS_GNUCXX OR CMAKE_CXX_COMPILER_ID MATCHES \"Clang\")\n  add_compile_options(-Wall -Wextra -Wpedantic)\nendif()\n\n# find dependencies\nfind_package(ament_cmake REQUIRED)\nfind_package(ament_cmake_python REQUIRED)\n\nament_python_install_package(${PROJECT_NAME})\n\nset(PLUGIN\n  g_stream_control/rqt_plugin.py\n)\n\n\ninstall(PROGRAMS\n    ${PLUGIN}\nDESTINATION lib/${PROJECT_NAME}\n)\n\ninstall(FILES\n    plugin.xml\n  DESTINATION share/${PROJECT_NAME}\n)\n\ninstall(DIRECTORY\n  resource\nDESTINATION share/${PROJECT_NAME}\n)\n\nament_package()\n</code></pre>","tags":["ros","rqt","custom","plugin"]},{"location":"ROS/ros_eco/rviz_rqt/rqt/custom_plugins/#plugin","title":"Plugin","text":"<ul> <li>Load widget</li> <li>Init ros</li> </ul> <pre><code>#!/usr/bin/env python3\n\n\nimport rclpy\nfrom rclpy.node import Node\nfrom qt_gui.plugin import Plugin\nfrom std_srvs.srv import SetBool, Trigger\nfrom g_stream_interface.srv import Preset\nfrom .rqt_demo import DemoWidget\nfrom rcl_interfaces.srv import SetParameters\nfrom rcl_interfaces.msg import Parameter, ParameterValue\nfrom functools import partial\n\nclass DemoPlugin(Plugin):\n    def __init__(self, context):\n        super(DemoPlugin, self).__init__(context)\n\n        # load ui\n        self._widget = DemoWidget()\n        self.setObjectName('RQTDemo')\n\n        # init ros node\n        self.node = context.node if context.node else rclpy.create_node(\"my_rqt_plugin\")\n</code></pre>","tags":["ros","rqt","custom","plugin"]},{"location":"ROS/ros_eco/rviz_rqt/rqt/custom_plugins/#widget","title":"Widget","text":"<ul> <li>Load <code>ui</code> file</li> </ul> rqt_demo.py<pre><code>import os\nfrom ament_index_python import get_resource\nfrom python_qt_binding import loadUi\nfrom python_qt_binding.QtWidgets import QWidget\n\n\nclass DemoWidget(QWidget):\n    def __init__(self):\n        super(DemoWidget, self).__init__()\n\n        _, package_path = get_resource('packages', 'demo_control')\n        ui_file = os.path.join(package_path, 'share', 'demo_control', 'resource', 'Demo.ui')\n        loadUi(ui_file, self)\n</code></pre>","tags":["ros","rqt","custom","plugin"]},{"location":"ROS/ros_eco/rviz_rqt/rqt/custom_plugins/#ui","title":"ui","text":"Demo.ui<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;ui version=\"4.0\"&gt;\n &lt;class&gt;TopicWidget&lt;/class&gt;\n &lt;widget class=\"QWidget\" name=\"TopicWidget\"&gt;\n  &lt;property name=\"geometry\"&gt;\n   &lt;rect&gt;\n    &lt;x&gt;0&lt;/x&gt;\n    &lt;y&gt;0&lt;/y&gt;\n    &lt;width&gt;731&lt;/width&gt;\n    &lt;height&gt;412&lt;/height&gt;\n   &lt;/rect&gt;\n  &lt;/property&gt;\n  &lt;property name=\"windowTitle\"&gt;\n   &lt;string&gt;Demo plugin&lt;/string&gt;\n  &lt;/property&gt;\n  &lt;widget class=\"QWidget\" name=\"verticalLayoutWidget\"&gt;\n   &lt;property name=\"geometry\"&gt;\n    &lt;rect&gt;\n     &lt;x&gt;170&lt;/x&gt;\n     &lt;y&gt;60&lt;/y&gt;\n     &lt;width&gt;160&lt;/width&gt;\n     &lt;height&gt;251&lt;/height&gt;\n    &lt;/rect&gt;\n   &lt;/property&gt;\n   &lt;layout class=\"QVBoxLayout\" name=\"verticalLayout\"&gt;\n\n    &lt;item&gt;\n     &lt;widget class=\"QPushButton\" name=\"pushButton\"&gt;\n      &lt;property name=\"text\"&gt;\n       &lt;string&gt;Demo&lt;/string&gt;\n      &lt;/property&gt;\n     &lt;/widget&gt;\n    &lt;/item&gt;\n   &lt;/layout&gt;\n  &lt;/widget&gt;\n &lt;/widget&gt;\n &lt;resources/&gt;\n &lt;connections/&gt;\n&lt;/ui&gt;\n</code></pre>","tags":["ros","rqt","custom","plugin"]},{"location":"ROS/ros_eco/rviz_rqt/rqt/custom_plugins/#usage","title":"Usage","text":"<pre><code># -v verbose\n# --force-discover force a rediscover of plugins\nrqt --force-discover -v\n</code></pre>","tags":["ros","rqt","custom","plugin"]},{"location":"ROS/ros_eco/rviz_rqt/rviz/","title":"RVIZ2","text":"<p>ROS / ros eco / rviz rqt</p> <p>rviz2 is a visualization tool in ROS 2.</p> <p>It provides a 3D GUI to visualize:</p> <ul> <li>Robot models (URDF)</li> <li>Sensor data (e.g., LIDAR, cameras)</li> <li>TF transforms</li> <li>Path planning</li> <li>Maps and occupancy grids</li> </ul>","tags":["ros","rviz"]},{"location":"ROS/ros_eco/rviz_rqt/rviz/#install","title":"install","text":"<pre><code>sudo apt install ros-jazzy-rviz2\nsudo apt install ros-${ROS_DISTRO}-rviz2\n</code></pre>","tags":["ros","rviz"]},{"location":"ROS/ros_eco/rviz_rqt/rviz/#usage","title":"usage","text":"load with config<pre><code>rviz2 -d /path/to/config\n# config file  and parameters\nrviz2 -d /path/to/config --ros-args -p use_sim_time:=True\n</code></pre> launch file<pre><code>import os\n\nfrom ament_index_python.packages import get_package_share_directory\nfrom launch import LaunchDescription\nfrom launch.substitutions import PathJoinSubstitution\nfrom launch_ros.actions import Node\n\nPKG_BRINGUP = \"turtlebot_bringup\"\n\n\ndef generate_launch_description():\n    ld =  LaunchDescription()\n\n    config_file = PathJoinSubstitution([\n        get_package_share_directory(PKG_BRINGUP),\n        'config',\n        'config.rviz'\n    ])\n\n    rviz_node = Node(\n        package='rviz2',\n        executable='rviz2',\n        name='rviz2',\n        output='screen',\n        arguments=['-d', config_file],\n        parameters=[{'use_sim_time': True}]\n    )\n\n    ld.add_action(rviz_node)\n    return ld\n</code></pre>","tags":["ros","rviz"]},{"location":"ROS/ros_eco/rviz_rqt/rviz/#resource","title":"Resource","text":"<ul> <li> Visualizations in ROS with RViz</li> </ul>","tags":["ros","rviz"]},{"location":"ROS/ros_eco/rviz_rqt/vsc_tool/","title":"VSC Tool","text":"<p>Command-line tools for maintaining a workspace of projects from multiple version-control systems.  ROS Wiki</p> install<pre><code>sudo apt install python3-vcstool\n</code></pre>","tags":["vsc","ros","tools"]},{"location":"ROS/ros_eco/rviz_rqt/vsc_tool/#repos-file","title":"Repos file","text":"project.repo<pre><code>repositories:\n  my_robot_pkg:\n    type: git\n    url: https://github.com/my-org/my_robot_pkg.git\n    version: main\n  nav2_bringup:\n    type: git\n    url: https://github.com/ros-planning/navigation2.git\n    version: humble\n</code></pre>","tags":["vsc","ros","tools"]},{"location":"ROS/ros_eco/rviz_rqt/vsc_tool/#import-and-update","title":"Import and update","text":"import<pre><code>vsc import &lt; project.repos\n</code></pre> update<pre><code>vsc pull\n</code></pre>","tags":["vsc","ros","tools"]},{"location":"ROS/ros_eco/rviz_rqt/vsc_tool/#export","title":"Export","text":"export<pre><code>vsc export &gt; project.repos\n</code></pre>","tags":["vsc","ros","tools"]},{"location":"ROS/ros_eco/rviz_rqt/vsc_tool/#use-case","title":"Use case","text":"<ul> <li>Import <code>.repos</code> file from a GitHub repository or using other whays like <code>curl</code> or <code>wget</code>.</li> <li>Run <code>vsc import</code> to clone the repositories.</li> </ul>","tags":["vsc","ros","tools"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/","title":"URDF, XACRO and Gazebo","text":"<p>URDF</p> <p>xacro</p> <p>Gazebo classic</p> <p>Gazebo harmonic</p>","tags":["xacro","urdf"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/#urdf","title":"URDF","text":"<p>Quick run rviz</p> <p>Quick visualize and manipulate URDF file using RVIZ and joint state publisher <pre><code>sudo apt install ros-humble-urdf-tutorial\n</code></pre></p> <pre><code>ros2 launch urdf_tutorial display.launch.py model:=/gz_tutorial_description/urdf/my_robot.urdf\n</code></pre>","tags":["xacro","urdf"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/#more-arguments","title":"more arguments","text":"<ul> <li>rvizconfig: absolute path to rviz config</li> </ul>","tags":["xacro","urdf"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/#toread","title":"ToRead","text":"<ul> <li>QoS mismatch between gazebo_ros_camera and gazebo_ros_video</li> </ul>","tags":["xacro","urdf"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/urdf_robot_state_publisher/","title":"robot state publisher","text":"<p>The robot_state_publisher node takes a robot\u2019s URDF model and joint positions and computes the full set of TF transforms between all robot links.</p> <p></p>","tags":["urdf","ros","robot_state_publisher"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/urdf_robot_state_publisher/#install","title":"Install","text":"<pre><code>sudo apt install ros-${ROS_DISTRO}-robot-state-publisher\n# joint state gui\nsudo apt install ros-${ROS_DISTRO}-joint-state-publisher-gui\n# parse xacro files and convert to urdf\nsudo apt install ros-${ROS_DISTRO}-xacro\n</code></pre>","tags":["urdf","ros","robot_state_publisher"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/urdf_robot_state_publisher/#usage","title":"usage","text":"<p>launch robot-state-publisher, joint_state_publisher_gui and rviz</p> <pre><code>launch:\n  - arg:\n      name: \"rviz_config_file\"\n      default: \"$(find-pkg-share bumperbot_bringup)/config/rviz.rviz\"\n  - arg:\n      name: \"robot_description_file\"\n      default: \"$(find-pkg-share bumperbot_description)/urdf/bumperbot.urdf.xacro\"\n  - node:\n      pkg: rviz2\n      exec: rviz2\n      name: rviz2\n      output: screen\n      args:\n          \"-d $(var rviz_config_file)\"\n  - node:\n      pkg: \"robot_state_publisher\"\n      exec: \"robot_state_publisher\"\n      name: \"robot_state_publisher\"\n      param:\n        - name: \"robot_description\"\n          value : \"$(command '$(find-exec xacro) $(var robot_description_file)')\"\n  - node:\n      pkg: \"joint_state_publisher_gui\"\n      exec: \"joint_state_publisher_gui\"\n      name: \"joint_state_publisher_gui\"\n      output: screen\n</code></pre>","tags":["urdf","ros","robot_state_publisher"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_classic/","title":"ROS2 gazebo classic plugins","text":"install<pre><code>sudo apt install ros-humble-gazebo-ros-pkgs\n</code></pre> <ul> <li>Diff drive</li> <li>Camera</li> </ul>","tags":["ros","gazebo classic","plugin"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_classic/camera/","title":"ROS2 Gazebo classic Camera Sensor and Plugin","text":"urdf gazebo camera<pre><code>&lt;!-- camera --&gt;\n&lt;gazebo reference=\"camera_link\"&gt;\n  &lt;sensor type=\"camera\" name=\"camera1\"&gt;\n    &lt;update_rate&gt;30.0&lt;/update_rate&gt;\n    &lt;camera name=\"head\"&gt;\n      &lt;horizontal_fov&gt;1.3962634&lt;/horizontal_fov&gt;\n      &lt;image&gt;\n        &lt;width&gt;800&lt;/width&gt;\n        &lt;height&gt;800&lt;/height&gt;\n        &lt;format&gt;R8G8B8&lt;/format&gt;\n      &lt;/image&gt;\n      &lt;clip&gt;\n        &lt;near&gt;0.02&lt;/near&gt;\n        &lt;far&gt;300&lt;/far&gt;\n      &lt;/clip&gt;\n      &lt;noise&gt;\n        &lt;type&gt;gaussian&lt;/type&gt;\n        &lt;!-- Noise is sampled independently per pixel on each frame.\n              That pixel's noise value is added to each of its color\n              channels, which at that point lie in the range [0,1]. --&gt;\n        &lt;mean&gt;0.0&lt;/mean&gt;\n        &lt;stddev&gt;0.007&lt;/stddev&gt;\n      &lt;/noise&gt;\n    &lt;/camera&gt;\n    &lt;plugin name=\"camera_controller\" filename=\"libgazebo_ros_camera.so\"&gt;\n      &lt;alwaysOn&gt;true&lt;/alwaysOn&gt;\n      &lt;updateRate&gt;0.0&lt;/updateRate&gt;\n      &lt;cameraName&gt;rrbot/camera1&lt;/cameraName&gt;\n      &lt;imageTopicName&gt;image_raw&lt;/imageTopicName&gt;\n      &lt;cameraInfoTopicName&gt;camera_info&lt;/cameraInfoTopicName&gt;\n      &lt;frameName&gt;camera_link_optical&lt;/frameName&gt;\n      &lt;hackBaseline&gt;0.07&lt;/hackBaseline&gt;\n      &lt;distortionK1&gt;0.0&lt;/distortionK1&gt;\n      &lt;distortionK2&gt;0.0&lt;/distortionK2&gt;\n      &lt;distortionK3&gt;0.0&lt;/distortionK3&gt;\n      &lt;distortionT1&gt;0.0&lt;/distortionT1&gt;\n      &lt;distortionT2&gt;0.0&lt;/distortionT2&gt;\n    &lt;/plugin&gt;\n  &lt;/sensor&gt;\n&lt;/gazebo&gt;\n</code></pre>","tags":["ros","gazebo","classic","camera"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_classic/diff_drive/","title":"ROS2 Diff drive plugin","text":"","tags":["ros2","gazebo","classic","diff"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_classic/diff_drive/#demo","title":"Demo","text":"my_robot.gazebo.xacro<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;robot xmlns:xacro=\"http://www.ros.org/wiki/xacro\"&gt;\n\n    &lt;gazebo&gt;\n        &lt;plugin name=\"diff_drive\" filename=\"libgazebo_ros_diff_drive.so\"&gt;\n\n            &lt;!-- Wheel Information --&gt;\n            &lt;left_joint&gt;left_wheel_joint&lt;/left_joint&gt;\n            &lt;right_joint&gt;right_wheel_joint&lt;/right_joint&gt;\n            &lt;wheel_separation&gt;0.297&lt;/wheel_separation&gt;\n            &lt;wheel_diameter&gt;0.066&lt;/wheel_diameter&gt;\n\n\n            &lt;!-- Limits --&gt;\n            &lt;max_wheel_torque&gt;200&lt;/max_wheel_torque&gt;\n            &lt;max_wheel_acceleration&gt;10.0&lt;/max_wheel_acceleration&gt;\n\n\n            &lt;!-- Output --&gt;\n            &lt;odometry_frame&gt;odom&lt;/odometry_frame&gt;\n            &lt;robot_base_frame&gt;base_link&lt;/robot_base_frame&gt;\n\n            &lt;publish_odom&gt;true&lt;/publish_odom&gt;\n            &lt;publish_odom_tf&gt;true&lt;/publish_odom_tf&gt;\n            &lt;publish_wheel_tf&gt;true&lt;/publish_wheel_tf&gt;\n\n        &lt;/plugin&gt;\n    &lt;/gazebo&gt;\n\n\n&lt;/robot&gt;\n</code></pre>","tags":["ros2","gazebo","classic","diff"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/","title":"ROS2 Gazebo harmonic integration","text":"<p>Bridge</p> <p>Interface</p> <p>Project</p> Variable Desc GZ_SIM_RESOURCE_PATH Where gz sim looks for models, worlds, textures, media. GZ_SIM_PLUGIN_PATH Where gz sim looks for shared libraries (.so) for system plugins, sensors, etc. <p>Tip</p> <p>Check dsv hook to set the variable</p> <p>gazebo project</p>","tags":["ros","gazebo","harmonic","bridge","jazzy"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/#launch","title":"Launch","text":"","tags":["ros","gazebo","harmonic","bridge","jazzy"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/#yaml","title":"YAML","text":"<pre><code>launch:\n  - arg:\n      name: \"bridge_config_file\"\n      default: \"$(find-pkg-share bumperbot_bringup)/config/bridge.yaml\"\n\n    #gazebo simulation\n  - executable:\n      cmd: gz sim -v 4 -r world.sdf\n\n    #ros-gz bridge\n  - node:\n      pkg: \"ros_gz_bridge\"\n      exec: \"parameter_bridge\"\n      output: screen\n      args:\n          \"--ros-args -p config_file:=$(var bridge_config_file)\"\n</code></pre>","tags":["ros","gazebo","harmonic","bridge","jazzy"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/#python","title":"Python","text":"gazebo.launch.py<pre><code>import os\nfrom ament_index_python.packages import get_package_share_directory\nfrom launch import LaunchDescription\nfrom launch.actions import IncludeLaunchDescription, TimerAction\nfrom launch.launch_description_sources import PythonLaunchDescriptionSource\n\nWORLD_NAME=\"world.sdf\"\nROS_GZ_PKG = \"ros_gz_sim\"\n\ndef generate_launch_description():\n    ld = LaunchDescription()\n\n\n    gz_args = \" \".join([\n        \"-r\",\n        \"-v1\",\n        WORLD_NAME\n    ])\n\n    gazebo = IncludeLaunchDescription(\n                PythonLaunchDescriptionSource([os.path.join(\n                    get_package_share_directory(ROS_GZ_PKG), 'launch', 'gz_sim.launch.py')]),\n                    launch_arguments={\n                        'gz_args': gz_args,\n                        \"on_exit_shutdown\": \"true\"}.items()\n             )\n\n    ld.add_action(gazebo)\n\n    return ld\n</code></pre>","tags":["ros","gazebo","harmonic","bridge","jazzy"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/#bridge","title":"Bridge","text":"","tags":["ros","gazebo","harmonic","bridge","jazzy"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/#bridge-clock-from-gazebo","title":"Bridge clock from gazebo","text":"/clock topic<pre><code>ros2 run ros_gz_bridge parameter_bridge /clock@rosgraph_msgs/msg/Clock[gz.msgs.Clock\n</code></pre>","tags":["ros","gazebo","harmonic","bridge","jazzy"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/#using-launch-file","title":"Using launch file","text":"launch/bridge.launch.py<pre><code>from ament_index_python.packages import get_package_share_directory\nfrom launch import LaunchDescription\nfrom launch_ros.actions import Node\nfrom pathlib import Path\n\nPKG_BRINGUP = 'robot_loc_bringup'\nBRIDGE_CONFIG = \"bridge.yaml\"\nCONFIG_FOLDER = \"config\"\n\ndef generate_launch_description():\n    ld = LaunchDescription()\n\n\n\n    bridge_file = Path(get_package_share_directory(PKG_BRINGUP)) \\\n        .joinpath(CONFIG_FOLDER) \\\n        .joinpath(BRIDGE_CONFIG) \\\n        .as_posix()\n\n    ros_gz_bridge = Node(\n        package=\"ros_gz_bridge\",\n        executable=\"parameter_bridge\",\n        arguments=[\n            '--ros-args',\n            '-p',\n            f\"config_file:={bridge_file}\"\n        ],\n        parameters=[\n            {'use_sim_time': True},\n            {'qos_overrides./imu.publisher.reliability': 'best_effort'}\n        ],\n    )\n\n    ld.add_action(ros_gz_bridge)\n\n\n    return ld\n</code></pre> config/bridge.yaml<pre><code>- ros_topic_name: \"/clock\"\n  gz_topic_name: \"/clock\"\n  ros_type_name: \"rosgraph_msgs/msg/Clock\"\n  gz_type_name: \"gz.msgs.Clock\"\n  direction: GZ_TO_ROS\n</code></pre>","tags":["ros","gazebo","harmonic","bridge","jazzy"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/ros_humble_gazebo_bridge/","title":"Gazebo harmonic bridge","text":"<p>Connect Gazebo and ROS2 using the bridge</p> <p>Install gazebo harmonic on docker image more</p> humble bridge   Install bridge from osrf repository  set gazebo and bridge in dockerfile<pre><code>RUN curl https://packages.osrfoundation.org/gazebo.gpg --output /usr/share/keyrings/pkgs-osrf-archive-keyring.gpg \\\n  &amp;&amp; echo \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/pkgs-osrf-archive-keyring.gpg] http://packages.osrfoundation.org/gazebo/ubuntu-stable $(lsb_release -cs) main\" | sudo tee /etc/apt/sources.list.d/gazebo-stable.list &gt; /dev/null \\\n  &amp;&amp; apt-get update &amp;&amp; apt-get install -q -y --no-install-recommends \\\n  gz-harmonic \\\n  ros-humble-ros-gzharmonic \\\n  &amp;&amp; rm -rf /var/lib/apt/lists/*\n</code></pre> <pre><code>apt-get install ros-humble-ros-gzharmonic\n</code></pre>","tags":["gazebo","harmonic","gz","simulation","ros","bridge"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/ros_humble_gazebo_bridge/#install","title":"Install","text":"<p>camera_info <pre><code>Bridge send data from gz to ros one way\n\n\n\n\n\n```bash title=\"bridge\"\nros2 run ros_gz_bridge parameter_bridge /vehicle/camera@sensor_msgs/msg/Image[gz.msgs.Image\n</code></pre></p>","tags":["gazebo","harmonic","gz","simulation","ros","bridge"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/","title":"Gazebo bridge","text":"<p>Camera</p> <p>clock</p> <p>imu</p> more <p>lidar</p> <p>Diff drive</p> <p>joint state</p> <p>Odometry</p> <p>NavSat/GPS</p> <p>PosePublisher</p> <p>The bridge allows you to connect ROS 2 topics with Gazebo Harmonic topics so you can:</p> <ul> <li>Control simulation objects from ROS 2 (e.g., publish velocity commands).</li> <li>Get data from simulation (e.g., sensor readings, /clock).</li> <li>Sync time between ROS 2 and Gazebo.</li> </ul> <p>Tip</p> <pre><code>parameter_bridge &lt;topic@ROS2_type@gz_type&gt;\n</code></pre> <p>Tip</p> <ul> <li>@ : a bidirectional bridge, </li> <li>[ : a bridge from Gazebo to ROS,</li> <li>] : a bridge from ROS to Gazebo.</li> </ul>"},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/#bridge-yaml-config","title":"bridge yaml config","text":"<p>github config yaml and message type mapping table</p> <pre><code>ros2 run ros_gz_bridge parameter_bridge --ros-args -p config_file:=$WORKSPACE/test/config/full.yaml\n</code></pre>"},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/#clock","title":"Clock","text":"<ul> <li>Gazebo publishes a simulation clock internally.</li> <li>To share it with ROS, you need a bridge between Gazebo\u2019s <code>gz.msgs.Clock</code> and ROS 2\u2019s <code>rosgraph_msgs/msg/Clock</code>.</li> </ul> <pre><code>- ros_topic_name: \"/clock\"\n  gz_topic_name: \"/clock\"\n  ros_type_name: \"rosgraph_msgs/msg/Clock\"\n  gz_type_name: \"gz.msgs.Clock\"\n  direction: GZ_TO_ROS\n</code></pre>"},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/#demo","title":"Demo","text":"<p>Simulate using bridge, send message from side to side (no need to run gz sim for this check)</p> <p>send string message from gz to ros and from ros to gz using cli</p> <ul> <li>Run bridge</li> <li>Pub from GZ echo in ROS</li> <li>Pub from ROS echo in GZ</li> </ul> Terminal1: bridge<pre><code>ros2 run ros_gz_bridge parameter_bridge /chatter@std_msgs/msg/String@gz.msgs.StringMsg\n#\n[INFO] [1734974012.615668960] [ros_gz_bridge]: Creating GZ-&gt;ROS Bridge: [/chatter (gz.msgs.StringMsg) -&gt; /chatter (std_msgs/msg/String)] (Lazy 0)\n[INFO] [1734974012.616345817] [ros_gz_bridge]: Creating ROS-&gt;GZ Bridge: [/chatter (std_msgs/msg/String) -&gt; /chatter (gz.msgs.StringMsg)] (Lazy 0)\n</code></pre>"},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/#pub-data-from-gz-to-ros","title":"pub data from gz to ros","text":"Terminal2: ros subscribe<pre><code>ros2 topic echo /chatter\n</code></pre> Terminal3: gz pub<pre><code>gz topic -t /chatter -m gz.msgs.StringMsg -p 'data:\"Hello\"'\n</code></pre>"},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/#pub-data-from-ros-to-gz","title":"pub data from ros to gz","text":"Terminal2: ros pub<pre><code>ros2 topic pub /chatter std_msgs/msg/String \"data: 'Hi'\"\n</code></pre> Terminal3: gz sub<pre><code>gz topic -e -t /chatter\n</code></pre>"},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/#resources","title":"Resources","text":"<ul> <li>ROS gazebo message type mapping</li> <li>ROS + Gazebo Sim demos</li> </ul>"},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/PosePublisher/","title":"Gazebo PosePublisher Plugin","text":"","tags":["ros","gazebo","bridge","PosePublisher"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/PosePublisher/#plugin","title":"Plugin","text":"<p>Pose publisher system. Attach to an entity to publish the transform of its child entities in the form of gz::msgs::Pose messages, or a single gz::msgs::Pose_V message if \"use_pose_vector_msg\" is true. </p> <p>gz sim reference</p>","tags":["ros","gazebo","bridge","PosePublisher"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/PosePublisher/#urdf","title":"urdf","text":"<pre><code>&lt;gazebo&gt;\n   &lt;plugin\n        filename=\"gz-sim-pose-publisher-system\"\n        name=\"gz::sim::systems::PosePublisher\"&gt;\n        &lt;publish_model_pose&gt;true&lt;/publish_model_pose&gt;\n        &lt;publish_link_pose&gt;false&lt;/publish_link_pose&gt;\n        &lt;update_rate&gt;10&lt;/update_rate&gt;\n    &lt;/plugin&gt;\n&lt;/gazebo&gt;\n</code></pre>","tags":["ros","gazebo","bridge","PosePublisher"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/PosePublisher/#bridge","title":"bridge","text":"<pre><code>- ros_topic_name: \"/bumperbot/pose\"\n  gz_topic_name: \"/model/bumperbot/pose\"\n  ros_type_name: \"geometry_msgs/msg/PoseStamped\"\n  gz_type_name: \"gz.msgs.Pose\"\n  direction: GZ_TO_ROS\n</code></pre>","tags":["ros","gazebo","bridge","PosePublisher"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/camera/","title":"Camera","text":"<p>Bridge rgb camera between gazebo to ros</p> <p>Tip</p> <p>Check resource for detail gazebo ros bridge</p> <p>bridge</p> <p>image transport</p> <p>coordinate system</p>","tags":["ros","gazebo","bridge","jazzy","harmonic","camera"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/camera/#gazebo","title":"Gazebo","text":"<p>sdf specification</p> <p>Add sensor plugin to world</p> add sensor plugin to world<pre><code>&lt;plugin\n  filename=\"gz-sim-sensors-system\"\n  name=\"gz::sim::systems::Sensors\"&gt;\n  &lt;render_engine&gt;ogre2&lt;/render_engine&gt;\n&lt;/plugin&gt;\n</code></pre> RGB Camera<pre><code>  &lt;gazebo reference=\"camera_link\"&gt;\n    &lt;sensor name=\"camera\" type=\"camera\"&gt;\n      &lt;camera&gt;\n        &lt;horizontal_fov&gt;1.3962634&lt;/horizontal_fov&gt;\n        &lt;image&gt;\n          &lt;width&gt;640&lt;/width&gt;\n          &lt;height&gt;480&lt;/height&gt;\n          &lt;format&gt;R8G8B8&lt;/format&gt;\n        &lt;/image&gt;\n        &lt;clip&gt;\n          &lt;near&gt;0.1&lt;/near&gt;\n          &lt;far&gt;15&lt;/far&gt;\n        &lt;/clip&gt;\n        &lt;noise&gt;\n          &lt;type&gt;gaussian&lt;/type&gt;\n          &lt;!-- Noise is sampled independently per pixel on each frame.\n               That pixel's noise value is added to each of its color\n               channels, which at that point lie in the range [0,1]. --&gt;\n          &lt;mean&gt;0.0&lt;/mean&gt;\n          &lt;stddev&gt;0.007&lt;/stddev&gt;\n        &lt;/noise&gt;\n        &lt;optical_frame_id&gt;camera_link_optical&lt;/optical_frame_id&gt;\n        &lt;camera_info_topic&gt;camera/camera_info&lt;/camera_info_topic&gt;\n      &lt;/camera&gt;\n      &lt;always_on&gt;1&lt;/always_on&gt;\n      &lt;update_rate&gt;20&lt;/update_rate&gt;\n      &lt;visualize&gt;true&lt;/visualize&gt;\n      &lt;topic&gt;camera/image&lt;/topic&gt;\n    &lt;/sensor&gt;\n  &lt;/gazebo&gt;\n</code></pre>","tags":["ros","gazebo","bridge","jazzy","harmonic","camera"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/camera/#ros2","title":"ROS2","text":"<p>check ros gz sim demo</p>","tags":["ros","gazebo","bridge","jazzy","harmonic","camera"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/camera/#bridge","title":"Bridge","text":"<ul> <li>image_raw</li> <li>image_info</li> </ul> gz_bridge.yaml<pre><code>- ros_topic_name: \"/camera/image_raw\"\n  gz_topic_name: \"/camera/image_raw\"\n  ros_type_name: \"sensor_msgs/msg/Image\"\n  gz_type_name: \"gz.msgs.Image\"\n  direction: GZ_TO_ROS\n# camera info\n- ros_topic_name: \"/camera/image_info\"\n  gz_topic_name: \"/camera/image_info\"\n  ros_type_name: \"sensor_msgs/msg/CameraInfo\"\n  gz_type_name: \"gz.msgs.CameraInfo\"\n  direction: GZ_TO_ROS\n</code></pre>","tags":["ros","gazebo","bridge","jazzy","harmonic","camera"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/camera/#image-transport","title":"Image Transport","text":"<p>automatically compress the video stream in the background</p> <p>```yaml title=launch launch:   - arg:       name: use_sim_time       default: \"true\"       description: Use simulation (Gazebo) clock if true   - node:       pkg: \"ros_gz_image\"       exec: \"image_bridge\"       output: screen       args:           \"/camera/image\"       param:           - name: use_sim_time             value : true           - name: camera.image.compressed.jpeg_quality                     value: 75   # using topic_tools relay to republish camera_info topic   - node:       pkg: \"topic_tools\"       exec: \"relay\"       output: screen       args:           \"'camera/camera_info' 'camera/image/camera_info'\"       param:           - name: use_sim_time             value : $(var use_sim_time)</p>","tags":["ros","gazebo","bridge","jazzy","harmonic","camera"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/camera/#1-2-3-4-5-6-7-8-9-10-11-12-13-14-15-16-17-18-19-20-21-22-23-24-25-26-27-28-29-30-31-32-33-34-35-36-37-38-39-40-41-42-43-44-45-46-47-48-49-50-51-52-53-54-55-56-57-58-59todo-configure-and-more-alt-textros_gz_image_reconfigurepng-coordinate-system-camera-link-camera-optical-link-xml-joint-typefixed-namecamera_joint-origin-xyz0225-0-0075-rpy0-0-0-child-linkcamera_link-parent-linkbase_link-axis-xyz0-1-0-joint-link-namecamera_link-pose0-0-0-0-0-0pose-inertial-mass-value01-origin-xyz0-0-0-rpy0-0-0-inertia-ixx1e-6-ixy0-ixz0-iyy1e-6-iyz0-izz1e-6-inertial-collision-namecollision-origin-xyz0-0-0-rpy0-0-0-geometry-box-size03-03-03-geometry-collision-visual-namecamera_link_visual-origin-xyz0-0-0-rpy0-0-0-geometry-box-size03-03-03-geometry-visual-link-gazebo-referencecamera_link-materialgazeboredmaterial-gazebo-joint-typefixed-namecamera_optical_joint-origin-xyz0-0-0-rpy-15707-0-15707-child-linkcamera_link_optical-parent-linkcamera_link-joint-link-namecamera_link_optical-link","title":"<pre><code>TODO: configure and more\n\n![alt text](ros_gz_image_reconfigure.png)\n\n---\n\n## Coordinate system\n\n- camera link\n- camera optical link\n- \n```xml\n  &lt;joint type=\"fixed\" name=\"camera_joint\"&gt;\n    &lt;origin xyz=\"0.225 0 0.075\" rpy=\"0 0 0\"/&gt;\n    &lt;child link=\"camera_link\"/&gt;\n    &lt;parent link=\"base_link\"/&gt;\n    &lt;axis xyz=\"0 1 0\" /&gt;\n  &lt;/joint&gt;\n\n  &lt;link name='camera_link'&gt;\n    &lt;pose&gt;0 0 0 0 0 0&lt;/pose&gt;\n    &lt;inertial&gt;\n      &lt;mass value=\"0.1\"/&gt;\n      &lt;origin xyz=\"0 0 0\" rpy=\"0 0 0\"/&gt;\n      &lt;inertia\n          ixx=\"1e-6\" ixy=\"0\" ixz=\"0\"\n          iyy=\"1e-6\" iyz=\"0\"\n          izz=\"1e-6\"\n      /&gt;\n    &lt;/inertial&gt;\n\n    &lt;collision name='collision'&gt;\n      &lt;origin xyz=\"0 0 0\" rpy=\"0 0 0\"/&gt; \n      &lt;geometry&gt;\n        &lt;box size=\".03 .03 .03\"/&gt;\n      &lt;/geometry&gt;\n    &lt;/collision&gt;\n\n    &lt;visual name='camera_link_visual'&gt;\n      &lt;origin xyz=\"0 0 0\" rpy=\"0 0 0\"/&gt;\n      &lt;geometry&gt;\n        &lt;box size=\".03 .03 .03\"/&gt;\n      &lt;/geometry&gt;\n    &lt;/visual&gt;\n\n  &lt;/link&gt;\n\n  &lt;gazebo reference=\"camera_link\"&gt;\n    &lt;material&gt;Gazebo/Red&lt;/material&gt;\n  &lt;/gazebo&gt;\n\n  &lt;joint type=\"fixed\" name=\"camera_optical_joint\"&gt;\n    &lt;origin xyz=\"0 0 0\" rpy=\"-1.5707 0 -1.5707\"/&gt;\n    &lt;child link=\"camera_link_optical\"/&gt;\n    &lt;parent link=\"camera_link\"/&gt;\n  &lt;/joint&gt;\n\n  &lt;link name=\"camera_link_optical\"&gt;\n  &lt;/link&gt;\n</code></pre>","text":"","tags":["ros","gazebo","bridge","jazzy","harmonic","camera"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/camera/#ros_gz_image","title":"ros_gz_image","text":"<p>use image_transport</p> image transport bridge<pre><code>sudo apt install ros-jazzy-ros-gz-image\n</code></pre> <pre><code>ros2 run ros_gz_image image_bridge /camera/image_raw\n</code></pre>","tags":["ros","gazebo","bridge","jazzy","harmonic","camera"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/camera/#rqt","title":"rqt","text":"<pre><code>ros2 run rqt_image_view rqt_image_view /camera/image_raw\n</code></pre>","tags":["ros","gazebo","bridge","jazzy","harmonic","camera"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/clock/","title":"Gazebo ROS Clock Bridge","text":"","tags":["ros","gazebo","bridge","jazzy","harmonic","clock"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/clock/#cli","title":"cli","text":"<pre><code>ros2 run ros_gz_bridge parameter_bridge /clock@rosgraph_msgs/msg/Clock[gz.msgs.Clock\n#\n Creating GZ-&gt;ROS Bridge: [/clock (gz.msgs.Clock) -&gt; /clock (rosgraph_msgs/msg/Clock)] (Lazy 0)\n</code></pre>","tags":["ros","gazebo","bridge","jazzy","harmonic","clock"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/clock/#bridge-file","title":"bridge file","text":"bridge.yaml<pre><code>- ros_topic_name: \"/clock\"\n  gz_topic_name: \"/clock\"\n  ros_type_name: \"rosgraph_msgs/msg/Clock\"\n  gz_type_name: \"gz.msgs.Clock\"\n  direction: GZ_TO_ROS\n</code></pre>","tags":["ros","gazebo","bridge","jazzy","harmonic","clock"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/clock/#launch","title":"launch","text":"<pre><code>launch:\n\n  - arg:\n      name: \"bridge_config_file\"\n      default: \"$(find-pkg-share bumperbot_bringup)/config/bridge.yaml\"\n\n  - node:\n      pkg: \"ros_gz_bridge\"\n      exec: \"parameter_bridge\"\n      output: screen\n      args:\n          \"--ros-args -p config_file:=$(var bridge_config_file)\"\n</code></pre>","tags":["ros","gazebo","bridge","jazzy","harmonic","clock"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/diff-drive/","title":"DiffDrive","text":"<p>Differential drive controller which can be attached to a model with any number of left and right wheels. more</p>","tags":["ros","gazebo","bridge","jazzy","harmonic","diff drive"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/diff-drive/#gazebo","title":"Gazebo","text":"gazebo diff drive plugin<pre><code>&lt;plugin\n    filename=\"gz-sim-diff-drive-system\"\n    name=\"gz::sim::systems::DiffDrive\"&gt;\n    &lt;left_joint&gt;left_wheel_joint&lt;/left_joint&gt;\n    &lt;right_joint&gt;right_wheel_joint&lt;/right_joint&gt;\n    &lt;wheel_separation&gt;1.2&lt;/wheel_separation&gt;\n    &lt;wheel_radius&gt;0.4&lt;/wheel_radius&gt;\n    &lt;odom_publish_frequency&gt;1&lt;/odom_publish_frequency&gt;\n    &lt;topic&gt;cmd_vel&lt;/topic&gt;\n    &lt;odom_topic&gt;odom&lt;/odom_topic&gt;\n    &lt;frame_id&gt;odom&lt;/frame_id&gt;\n    &lt;child_frame_id&gt;base_footprint&lt;/child_frame_id&gt;\n&lt;/plugin&gt;\n</code></pre> <ul> <li>tf_topic: Custom topic on which this system will publish the transform from frame_id to child_frame_id. This element is optional, and the default value is /model/{name_of_model}/tf.</li> <li>frame_id: Custom frame_id field that this system will use as the origin of the odometry transform in both the  gz.msgs.Pose_V message and the  gz.msgs.Odometry message. This element if optional, and the default value is {name_of_model}/odom. child_frame_id: Custom child_frame_id that this system will use as the target of the odometry trasnform in both the  gz.msgs.Pose_V message and the  gz.msgs.Odometry message. This element if optional, and the default value is {name_of_model}/{name_of_link}. <p>child_frame_id</p> <p>According to REP-105 (coordinate frames for mobile platforms):</p> <ul> <li>header.frame_id = \"odom\" (or \"map\" if you have localization).</li> <li>child_frame_id = \"base_link\" (or base_footprint depending on your URDF).</li> </ul> <p>Rule of Thumb - header.frame_id = where the robot is located (world reference). - child_frame_id = what part of the robot is moving (usually base_link).</p>","tags":["ros","gazebo","bridge","jazzy","harmonic","diff drive"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/diff-drive/#twist-from-gazebo-cli","title":"Twist from gazebo cli","text":"<pre><code>gz topic -t \"/cmd_vel\" -m gz.msgs.Twist -p \"linear: {x: 0.5}, angular: {z: 0.05}\"\n</code></pre>","tags":["ros","gazebo","bridge","jazzy","harmonic","diff drive"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/diff-drive/#ros","title":"ROS","text":"","tags":["ros","gazebo","bridge","jazzy","harmonic","diff drive"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/diff-drive/#bridge-file","title":"bridge file","text":"<p>diff-drive tf topic name</p> <p>the default tf topic name is : /model/{name_of_model}/tf we control the tf name using <code>tf_topic</code> tag check the bride yaml tf part for correct mapping</p> bridge.yaml<pre><code>#sync sim and ros\n- ros_topic_name: \"/clock\"\n  gz_topic_name: \"/clock\"\n  ros_type_name: \"rosgraph_msgs/msg/Clock\"\n  gz_type_name: \"gz.msgs.Clock\"\n  direction: GZ_TO_ROS\n\n# gz topic published by DiffDrive plugin\n- ros_topic_name: \"odom\"\n  gz_topic_name: \"odom\"\n  ros_type_name: \"nav_msgs/msg/Odometry\"\n  gz_type_name: \"gz.msgs.Odometry\"\n  direction: GZ_TO_ROS\n\n# gz topic published by DiffDrive plugin\n- ros_topic_name: \"tf\"\n  gz_topic_name: \"tf\"\n  ros_type_name: \"tf2_msgs/msg/TFMessage\"\n  gz_type_name: \"gz.msgs.Pose_V\"\n  direction: GZ_TO_ROS\n\n# gz topic subscribed to by DiffDrive plugin\n- ros_topic_name: \"cmd_vel\"\n  gz_topic_name: \"cmd_vel\"\n  ros_type_name: \"geometry_msgs/msg/Twist\"\n  gz_type_name: \"gz.msgs.Twist\"\n  direction: ROS_TO_GZ\n</code></pre>","tags":["ros","gazebo","bridge","jazzy","harmonic","diff drive"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/diff-drive/#twist-from-ros","title":"Twist From ROS","text":"<pre><code>ros2 topic pub /cmd_vel geometry_msgs/msg/Twist \\\n\"{linear: {x: 2.0, y: 0.0, z: 0.0}, angular: {x: 0.0, y: 0.0, z: 0.0}}\"\n</code></pre>","tags":["ros","gazebo","bridge","jazzy","harmonic","diff drive"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/diff-drive/#rviz","title":"Rviz","text":"<ul> <li>The base of the red arrow mark the robot position</li> <li>The arrow direction display the robot heading</li> </ul>","tags":["ros","gazebo","bridge","jazzy","harmonic","diff drive"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/diff-drive/#tf-tree","title":"TF tree","text":"<p>The tf tree include tf from <code>joint_states</code></p> bridge mapping<pre><code>#joint state\n- ros_topic_name: \"joint_states\"\n  gz_topic_name: \"joint_states\"\n  ros_type_name: \"sensor_msgs/msg/JointState\"\n  gz_type_name: \"gz.msgs.Model\"\n  direction: GZ_TO_ROS\n</code></pre> <p></p>","tags":["ros","gazebo","bridge","jazzy","harmonic","diff drive"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/diff-drive/#usgae","title":"Usgae","text":"<p>Rqt has nice plugin <code>robot steering</code> to send Twist message</p> <pre><code>sudo apt install ros-jazzy-rqt-robot-steering\n</code></pre> <p></p> <p>The nav_msgs/Odometry message contains two main fields:</p> <ul> <li>pose: robot position + orientation in some reference frame (usually odom)</li> <li>twist: robot linear &amp; angular velocities in body reference frame</li> </ul> <p>The important detail is that the twist is expressed in the robot\u2019s local frame (the FRD/FLU convention,</p> <p>Twist</p> <p>The twist message expressed in the robot's local frame (FRD/FLU) REP-103 defines the reference frame for mobile base (differential drive) as FLU (Forward, Left, Up): </p> <ul> <li>x-axis: point forward</li> <li>y-axis: point left</li> <li>z-axis: point up</li> </ul>","tags":["ros","gazebo","bridge","jazzy","harmonic","diff drive"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/gps/","title":"Gazebo ROS GPS/NavSat Bridge","text":"<p>Bridge NavSat sensor</p> <ul> <li>Add <code>spherical_coordinates</code> to world</li> <li>Add model with <code>navsat</code> sensor</li> </ul> <p>Tip</p> <p>Version 1.9 include gps sdf for full tags and attributes     navsat sdf for full tags and attributes</p> <p>check type attribute The \"ray\", \"gpu_ray\", and \"gps\" types are equivalent to \"lidar\", \"gpu_lidar\", and \"navsat\",   respectively. It is preferred to use  \"lidar\", \"gpu_lidar\", and \"navsat\" since \"ray\",  \"gpu_ray\", and \"gps\" will be deprecated. The  \"ray\", \"gpu_ray\", and \"gps\" types are maintained  for legacy support.</p> spherical_coordinates<pre><code>&lt;spherical_coordinates&gt;\n    &lt;surface_model&gt;EARTH_WGS84&lt;/surface_model&gt;\n    &lt;world_frame_orientation&gt;ENU&lt;/world_frame_orientation&gt;\n    &lt;latitude_deg&gt;47.478950&lt;/latitude_deg&gt;\n    &lt;longitude_deg&gt;19.057785&lt;/longitude_deg&gt;\n    &lt;elevation&gt;0&lt;/elevation&gt;\n    &lt;heading_deg&gt;0&lt;/heading_deg&gt;\n&lt;/spherical_coordinates&gt;\n</code></pre> link model with navsat sensor<pre><code>&lt;model name=\"robot_with_gps\"&gt;\n    &lt;pose&gt;0 0 0.1 0 0 0&lt;/pose&gt;\n    &lt;static&gt;false&lt;/static&gt;\n\n    &lt;link name=\"base_link\"&gt;\n\n        &lt;!-- Visual marker --&gt;\n        &lt;visual name=\"visual\"&gt;\n            &lt;geometry&gt;\n                &lt;box&gt;\n                    &lt;size&gt;0.4 0.4 0.2&lt;/size&gt;\n                &lt;/box&gt;\n            &lt;/geometry&gt;\n            &lt;material&gt;\n                &lt;ambient&gt;0.2 0.2 0.8 1&lt;/ambient&gt;\n            &lt;/material&gt;\n        &lt;/visual&gt;\n\n            &lt;collision name=\"collision\"&gt;\n            &lt;geometry&gt;\n                &lt;box&gt;\n                    &lt;size&gt;0.4 0.4 0.2&lt;/size&gt;\n                &lt;/box&gt;\n            &lt;/geometry&gt;\n            &lt;/collision&gt;\n\n\n        &lt;!-- Inertial so physics works --&gt;\n        &lt;inertial&gt;\n            &lt;mass&gt;1.0&lt;/mass&gt;\n            &lt;inertia&gt;\n                &lt;ixx&gt;0.01&lt;/ixx&gt;\n                &lt;iyy&gt;0.01&lt;/iyy&gt;\n                &lt;izz&gt;0.01&lt;/izz&gt;\n            &lt;/inertia&gt;\n        &lt;/inertial&gt;\n\n        &lt;!-- GPS / NavSat sensor --&gt;\n        &lt;sensor name=\"gps\" type=\"navsat\"&gt;\n            &lt;pose&gt;0 0 0.2 0 0 0&lt;/pose&gt;\n            &lt;always_on&gt;1&lt;/always_on&gt;\n            &lt;update_rate&gt;5&lt;/update_rate&gt;\n            &lt;gps&gt;\n                &lt;position_sensing&gt;\n\n                &lt;/position_sensing&gt;\n            &lt;/gps&gt;\n        &lt;/sensor&gt;\n\n    &lt;/link&gt;\n&lt;/model&gt;\n</code></pre>","tags":["ros","gazebo","bridge","jazzy","harmonic","gps","navsat"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/gps/#view-sensor-data","title":"View sensor data","text":"<pre><code>gz topic -e -t /world/empty/model/robot_with_gps/link/base_link/sensor/gps/navsat\n\n#\nheader {\n  stamp {\n    sec: 58\n    nsec: 200000000\n  }\n  data {\n    key: \"seq\"\n    value: \"18\"\n  }\n}\nlatitude_deg: 47.47894999999999\nlongitude_deg: 19.057785\naltitude: 0.29999999981373549\nvelocity_east: -6.9698894381645786e-18\nvelocity_north: 1.3028327721371246e-18\nvelocity_up: -2.10442947790046e-12\nframe_id: \"robot_with_gps::base_link::gps\"\n</code></pre>","tags":["ros","gazebo","bridge","jazzy","harmonic","gps","navsat"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/gps/#ros","title":"ROS","text":"<p>Bridge communication between ROS and Gazebo</p>","tags":["ros","gazebo","bridge","jazzy","harmonic","gps","navsat"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/gps/#bridge-file","title":"Bridge file","text":"config/bridge.yaml<pre><code>- ros_topic_name: \"/gps\"\n  gz_topic_name: \"/world/empty/model/robot_with_gps/link/base_link/sensor/gps/navsat\"\n  ros_type_name: \"gps_msgs/msg/GPSFix\"\n  gz_type_name: \"gz.msgs.NavSat\"\n  direction: GZ_TO_ROS\n</code></pre>","tags":["ros","gazebo","bridge","jazzy","harmonic","gps","navsat"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/gps/#launch-bridge","title":"launch bridge","text":"<pre><code>launch:\n\n  - arg:\n      name: \"bridge_config_file\"\n      default: \"$(find-pkg-share bumperbot_bringup)/config/bridge.yaml\"\n\n  #ros-gz bridge\n  - node:\n      pkg: \"ros_gz_bridge\"\n      exec: \"parameter_bridge\"\n      output: screen\n      args:\n          \"--ros-args -p config_file:=$(var bridge_config_file)\"\n</code></pre>","tags":["ros","gazebo","bridge","jazzy","harmonic","gps","navsat"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/imu/","title":"Gazebo ROS IMU Bridge","text":"<p>ROS / ros eco / urdf xacro gz plugin / gazebo harmonic / jazzy bridge</p> <p>Bridge IMU sensor from gazebo to ros</p>","tags":["ros","gazebo","bridge","jazzy","harmonic","imu"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/imu/#gazebo","title":"Gazebo","text":"<p>Add imu plugin to world</p> add imu plugin to world<pre><code>&lt;plugin\n  filename=\"gz-sim-imu-system\"\n  name=\"gz::sim::systems::Imu\"&gt;\n&lt;/plugin&gt;\n</code></pre> <p>sdf imu</p> <p>SDF specification</p> sensor<pre><code>&lt;sensor name=\"imu\" type=\"imu\"&gt;\n    &lt;always_on&gt;1&lt;/always_on&gt;\n    &lt;update_rate&gt;50&lt;/update_rate&gt;\n    &lt;visualize&gt;true&lt;/visualize&gt;\n    &lt;topic&gt;imu&lt;/topic&gt;\n    &lt;enable_metrics&gt;true&lt;/enable_metrics&gt;\n    &lt;gz_frame_id&gt;imu_link&lt;/gz_frame_id&gt;\n&lt;/sensor&gt;\n</code></pre> <p>urdf</p> <p>Don't forget to shroud with <code>&lt;gazebo reference=\"link name\"&gt;</code> tag</p> <pre><code>&lt;!-- link --&gt;\n&lt;link name=\"imu_link\"/&gt;\n\n&lt;!-- plugin --&gt;\n&lt;gazebo reference=\"imu_link\"&gt;\n  &lt;sensor name=\"imu\" type=\"imu\"&gt;\n    &lt;always_on&gt;1&lt;/always_on&gt;\n    &lt;update_rate&gt;50&lt;/update_rate&gt;\n    &lt;visualize&gt;true&lt;/visualize&gt;\n    &lt;topic&gt;imu&lt;/topic&gt;\n    &lt;enable_metrics&gt;true&lt;/enable_metrics&gt;\n    &lt;gz_frame_id&gt;imu_link&lt;/gz_frame_id&gt;\n  &lt;/sensor&gt;\n&lt;/gazebo&gt;\n</code></pre> gz<pre><code>gz topic --echo -t /imu\n</code></pre>","tags":["ros","gazebo","bridge","jazzy","harmonic","imu"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/imu/#ros","title":"ROS","text":"","tags":["ros","gazebo","bridge","jazzy","harmonic","imu"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/imu/#cli","title":"cli","text":"<pre><code>ros2 run ros_gz_bridge parameter_bridge /imu@sensor_msgs/msg/Imu[gz.msgs.IMU\n#\n Creating GZ-&gt;ROS Bridge: [/imu (gz.msgs.IMU) -&gt; /imu (sensor_msgs/msg/Imu)] (Lazy 0)\n</code></pre>","tags":["ros","gazebo","bridge","jazzy","harmonic","imu"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/imu/#bridge-file","title":"bridge file","text":"<pre><code>- ros_topic_name: \"/imu\"\n  gz_topic_name: \"/imu\"\n  ros_type_name: \"sensor_msgs/msg/Imu\"\n  gz_type_name: \"gz.msgs.IMU\"\n  direction: GZ_TO_ROS\n</code></pre>","tags":["ros","gazebo","bridge","jazzy","harmonic","imu"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/imu/#launch","title":"launch","text":"<p>TODO: check this coda again</p> imu_bridge.launch.py<pre><code>from ament_index_python.packages import get_package_share_directory\nfrom launch import LaunchDescription\nfrom launch_ros.actions import Node\nfrom pathlib import Path\n\nPKG_BRINGUP = 'turtlebot_bringup'\nBRIDGE_CONFIG = \"gz_bridge.yaml\"\nCONFIG_FOLDER = \"config\"\n\ndef generate_launch_description():\n    ld = LaunchDescription()\n\n    bridge_file = Path(get_package_share_directory(PKG_BRINGUP)) \\\n        .joinpath(CONFIG_FOLDER) \\\n        .joinpath(BRIDGE_CONFIG) \\\n        .as_posix()\n\n    ros_gz_bridge = Node(\n        package=\"ros_gz_bridge\",\n        executable=\"parameter_bridge\",\n        arguments=[\n            '--ros-args',\n            '-p',\n            f\"config_file:={bridge_file}\"\n        ],\n        parameters=[\n            {'use_sim_time': True},\n            {'qos_overrides./imu.publisher.reliability': 'best_effort'}\n        ],\n    )\n\n    ld.add_action(ros_gz_bridge)\n\n\n    return ld\n</code></pre> <p>frame_id</p> <p>By default gazebo frame_id will be sensor link</p> <pre><code>header {\n  stamp {\n    sec: 901\n    nsec: 340000000\n  }\n  data {\n    key: \"frame_id\"\n    value: \"my_bot::base_footprint::imu\"\n  }\n  data {\n    key: \"seq\"\n    value: \"36688\"\n  }\n}\n</code></pre> <p>this map to in ros message</p> <pre><code>header:\n  stamp:\n    sec: 61\n    nanosec: 220000000\n  frame_id: my_bot::base_footprint::imu\n</code></pre> <p>using <code>&lt;gz_frame_id&gt;imu_link&lt;/gz_frame_id&gt;</code> to control frame_id value</p> <pre><code>ros2 topic echo --once /imu --field header\n\n#\n  stamp:\n    sec: 149\n    nanosec: 540000000\n  frame_id: imu_link\n</code></pre>","tags":["ros","gazebo","bridge","jazzy","harmonic","imu"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/joint_state/","title":"Joint state","text":"","tags":["ros","gazebo","bridge","jazzy","harmonic","joint state","pose"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/joint_state/#gazebo","title":"Gazebo","text":"<pre><code>&lt;plugin filename=\"gz-sim-joint-state-publisher-system\"\n    name=\"gz::sim::systems::JointStatePublisher\"&gt;\n    &lt;topic&gt;joint_states&lt;/topic&gt;\n    &lt;joint_name&gt;wheel_left_joint&lt;/joint_name&gt;\n    &lt;joint_name&gt;wheel_right_joint&lt;/joint_name&gt;\n&lt;/plugin&gt;\n</code></pre> Parameter Description topic Name of the topic to publish to. This parameter is optional; if not provided, the joint state will be published to <code>/world/&lt;world_name&gt;/model/&lt;model_name&gt;/joint_state</code> joint_name Name of a joint to publish. This parameter can be specified multiple times and is optional. If joint names are not specified, all joints in a model will","tags":["ros","gazebo","bridge","jazzy","harmonic","joint state","pose"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/joint_state/#messages","title":"messages","text":"gz topic gz message ros message /world//model//joint_state gz.msgs.Model sensor_msgs/msg/JointState","tags":["ros","gazebo","bridge","jazzy","harmonic","joint state","pose"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/joint_state/#bridge","title":"Bridge","text":"bridge<pre><code>- ros_topic_name: \"joint_states\"\n  gz_topic_name: \"joint_states\"\n  ros_type_name: \"sensor_msgs/msg/JointState\"\n  gz_type_name: \"gz.msgs.Model\"\n  direction: GZ_TO_ROS\n</code></pre>","tags":["ros","gazebo","bridge","jazzy","harmonic","joint state","pose"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/lidar/","title":"LIDAR","text":"<p>ROS / ros eco / urdf xacro gz plugin / gazebo harmonic / jazzy bridge</p> <p>Bridge lidar system between gazebo to ros lidar sensor send two topics</p> <ul> <li>/lidar (sensor_msgs/msg/LaserScan) use for 2D lidar</li> <li>/lidar/points (sensor_msgs/msg/PointCloud2) use for 3D lidar</li> </ul>","tags":["ros","gazebo","bridge","jazzy","harmonic","lidar","LaserScan"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/lidar/#gazebo","title":"Gazebo","text":"<p>Add sensor plugin to world</p> add sensor plugin to world<pre><code>&lt;plugin\n  filename=\"gz-sim-sensors-system\"\n  name=\"gz::sim::systems::Sensors\"&gt;\n  &lt;render_engine&gt;ogre2&lt;/render_engine&gt;\n&lt;/plugin&gt;\n</code></pre> sensor<pre><code>&lt;sensor name='gpu_lidar' type='gpu_lidar'&gt;\n    &lt;topic&gt;lidar&lt;/topic&gt;\n    &lt;update_rate&gt;10&lt;/update_rate&gt;\n    &lt;lidar&gt;\n    &lt;scan&gt;\n        &lt;horizontal&gt;\n        &lt;samples&gt;640&lt;/samples&gt;\n        &lt;resolution&gt;1&lt;/resolution&gt;\n        &lt;min_angle&gt;-1.396263&lt;/min_angle&gt;\n        &lt;max_angle&gt;1.396263&lt;/max_angle&gt;\n        &lt;/horizontal&gt;\n        &lt;vertical&gt;\n        &lt;samples&gt;16&lt;/samples&gt;\n        &lt;resolution&gt;1&lt;/resolution&gt;\n        &lt;min_angle&gt;-0.261799&lt;/min_angle&gt;\n        &lt;max_angle&gt;0.261799&lt;/max_angle&gt;\n        &lt;/vertical&gt;\n    &lt;/scan&gt;\n    &lt;range&gt;\n        &lt;min&gt;0.08&lt;/min&gt;\n        &lt;max&gt;10.0&lt;/max&gt;\n        &lt;resolution&gt;0.01&lt;/resolution&gt;\n    &lt;/range&gt;\n    &lt;/lidar&gt;\n    &lt;alwaysOn&gt;1&lt;/alwaysOn&gt;\n    &lt;visualize&gt;true&lt;/visualize&gt;\n&lt;/sensor&gt;\n</code></pre> gz<pre><code>gz topic --echo -t /lidar\n</code></pre> <p></p>","tags":["ros","gazebo","bridge","jazzy","harmonic","lidar","LaserScan"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/lidar/#ros","title":"ROS","text":"","tags":["ros","gazebo","bridge","jazzy","harmonic","lidar","LaserScan"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/lidar/#cli","title":"cli","text":"<pre><code>ros2 run ros_gz_bridge parameter_bridge /lidar@sensor_msgs/msg/LaserScan[gz.msgs.LaserScan\n#\n</code></pre>","tags":["ros","gazebo","bridge","jazzy","harmonic","lidar","LaserScan"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/lidar/#bridge-file","title":"bridge file","text":"<pre><code>- ros_topic_name: \"/lidar\"\n  gz_topic_name: \"/lidar\"\n  ros_type_name: \"sensor_msgs/msg/LaserScan\"\n  gz_type_name: \"gz.msgs.LaserScan\"\n  direction: GZ_TO_ROS\n</code></pre>","tags":["ros","gazebo","bridge","jazzy","harmonic","lidar","LaserScan"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/lidar/#launch","title":"launch","text":"imu_bridge.launch.py<pre><code>from ament_index_python.packages import get_package_share_directory\nfrom launch import LaunchDescription\nfrom launch_ros.actions import Node\nfrom pathlib import Path\n\nPKG_BRINGUP = 'turtlebot_bringup'\nBRIDGE_CONFIG = \"gz_bridge.yaml\"\nCONFIG_FOLDER = \"config\"\n\ndef generate_launch_description():\n    ld = LaunchDescription()\n\n    bridge_file = Path(get_package_share_directory(PKG_BRINGUP)) \\\n        .joinpath(CONFIG_FOLDER) \\\n        .joinpath(BRIDGE_CONFIG) \\\n        .as_posix()\n\n    ros_gz_bridge = Node(\n        package=\"ros_gz_bridge\",\n        executable=\"parameter_bridge\",\n        arguments=[\n            '--ros-args',\n            '-p',\n            f\"config_file:={bridge_file}\"\n        ],\n        parameters=[\n            {'use_sim_time': True},\n            {'qos_overrides./imu.publisher.reliability': 'best_effort'}\n        ],\n    )\n\n    ld.add_action(ros_gz_bridge)\n\n\n    return ld\n</code></pre>","tags":["ros","gazebo","bridge","jazzy","harmonic","lidar","LaserScan"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/odometry/","title":"Gazebo Odometry Plugin","text":"<p>ROS / ros eco / urdf xacro gz plugin / gazebo harmonic / jazzy bridge</p> <p>Odometry Publisher which can be attached to any entity in order to periodically publish 2D or 3D odometry data in the form of gz::msgs::Odometry messages.</p>","tags":["ros","gazebo","bridge","odometry"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/odometry/#gazebo","title":"Gazebo","text":"<p>more</p>","tags":["ros","gazebo","bridge","odometry"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/odometry/#messages","title":"messages","text":"gz topic gz message ros message <code>/model/&lt;name&gt;/Odometry</code> gz.msgs.Odometry nav_msgs/msg/Odometry <code>/model/&lt;name&gt;/odometry_with_covariance</code> gz.msgs.OdometryWithCovariance nav_msgs/msg/Odometry <code>/model/&lt;name&gt;/pose</code> gz.msgs.Pose_V tf2_msgs/msg/TFMessage","tags":["ros","gazebo","bridge","odometry"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_bridge/odometry/#bridge","title":"Bridge","text":"bridge<pre><code>- ros_topic_name: \"/model/my_bot/Odometry\"\n  gz_topic_name: \"/model/my_bot/odometry\"\n  ros_type_name: \"nav_msgs/msg/Odometry\"\n  gz_type_name: \"gz.msgs.Odometry\"\n  direction: GZ_TO_ROS\n- ros_topic_name: \"/model/my_bot/odometry_with_covariance\"\n  gz_topic_name: \"/model/my_bot/odometry_with_covariance\"\n  ros_type_name: \"nav_msgs/msg/Odometry\"\n  gz_type_name: \"gz.msgs.Odometry\"\n  direction: GZ_TO_ROS\n- ros_topic_name: \"/model/my_bot/pose\"\n  gz_topic_name: \"/model/my_bot/pose\"\n  ros_type_name: \"tf2_msgs/msg/TFMessage\"\n  gz_type_name: \"gz.msgs.Pose_V\"\n  direction: GZ_TO_ROS\n</code></pre>","tags":["ros","gazebo","bridge","odometry"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_interface/","title":"ROS GZ Interface","text":"<p>This package currently contains some Gazebo-specific ROS message and service data structures (.msg and .srv)</p> <p>Message and service data structures for interacting with Gazebo from ROS2</p>","tags":["tag"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_interface/#demo-set-entity-pose","title":"Demo: Set Entity POSE","text":"<p>Gazebo expose service to set entity position and orientation <code>/world/&lt;world name&gt;/set_pose</code></p>","tags":["tag"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_interface/#run-from-gazebo","title":"Run from gazebo","text":"gz set_pose service call<pre><code>gz service --timeout 10000 -s /world/my_world/set_pose \\\n--reptype gz.msgs.Boolean \\\n--reqtype gz.msgs.Pose \\\n--req 'name: \"box\" position {\n  x: 5\n  y: 0\n  z: 0.5\n}'\n</code></pre>","tags":["tag"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/jazzy_interface/#expose-the-service-via-ros","title":"Expose the service via ROS","text":"run bridge<pre><code>ros2 run ros_gz_bridge parameter_bridge \\\n    /world/my_world/set_pose@ros_gz_interfaces/srv/SetEntityPose\n</code></pre> query entity name<pre><code># or check the urdf\n# idea: wotk with grep\ngz topic -e -t /world/my_world/pose/info \n</code></pre> call full message<pre><code># call service set_pose on world name: my_world\n# entity name: \nros2 service call /world/my_world/set_pose ros_gz_interfaces/srv/SetEntityPose \\\n\"{entity: {name: 'box'}, \\\npose: {position: {x: 3.0, y: 3.0, z: 0.5}, \norientation: {x: 0.0, y: 0.0, z: 0.0, w: 1.0}}}\"\n</code></pre> <pre><code># send part of the message other argument get defaults\nros2 service call /world/my_world/set_pose ros_gz_interfaces/srv/SetEntityPose \\\n\"{entity: {name: 'box'}, \\\npose: {position: {x: 1.0 } } }\"\n</code></pre>","tags":["tag"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/project_template/","title":"ROS2 Gazebo Project","text":"","tags":["ros","gazebo","project","template"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/project_template/#resources","title":"Resources","text":"<ul> <li>Guide to ros_gz_project_template for ROS 2 and Gazebo Development</li> <li>github: ros_gz_project_template</li> </ul> <pre><code>\u251c\u2500\u2500 loc_bringup\n\u2502   \u251c\u2500\u2500 CMakeLists.txt\n\u2502   \u251c\u2500\u2500 launch\n\u2502   \u2502   \u2514\u2500\u2500 gazebo.launch.py\n\u2502   \u2514\u2500\u2500 package.xml\n\u2514\u2500\u2500 loc_gazebo\n    \u251c\u2500\u2500 CMakeLists.txt\n    \u251c\u2500\u2500 hooks\n    \u2502   \u251c\u2500\u2500 loc_gazebo.dsv.in\n    \u2502   \u2514\u2500\u2500 loc_gazebo.sh.in\n    \u251c\u2500\u2500 package.xml\n    \u2514\u2500\u2500 worlds\n        \u2514\u2500\u2500 world.sdf\n</code></pre>","tags":["ros","gazebo","project","template"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/project_template/#gazebo-package","title":"gazebo package","text":"loc_gazebo.dsv<pre><code>prepend-non-duplicate;GZ_SIM_RESOURCE_PATH;share;@CMAKE_INSTALL_PREFIX@/share/loc_gazebo/worlds\n</code></pre> loc_gazebo.sh<pre><code>ament_prepend_unique_value GZ_SIM_RESOURCE_PATH \"$AMENT_CURRENT_PREFIX/share/@PROJECT_NAME@/worlds\"\n</code></pre> CMakeLists.txt<pre><code>cmake_minimum_required(VERSION 3.8)\nproject(loc_gazebo)\n\nif(CMAKE_COMPILER_IS_GNUCXX OR CMAKE_CXX_COMPILER_ID MATCHES \"Clang\")\n  add_compile_options(-Wall -Wextra -Wpedantic)\nendif()\n\n# find dependencies\nfind_package(ament_cmake REQUIRED)\ninstall(\n  DIRECTORY\n    worlds/\n  DESTINATION share/${PROJECT_NAME}/worlds\n)\n\nament_environment_hooks(\"${CMAKE_CURRENT_SOURCE_DIR}/hooks/${PROJECT_NAME}.dsv.in\")\nament_environment_hooks(\"${CMAKE_CURRENT_SOURCE_DIR}/hooks/${PROJECT_NAME}.sh.in\")\n\nament_package()\n</code></pre>","tags":["ros","gazebo","project","template"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/gazebo_harmonic/project_template/#bringup-package","title":"Bringup package","text":"gazebo.launch.py<pre><code>import os\nfrom ament_index_python.packages import get_package_share_directory\nfrom launch import LaunchDescription\nfrom launch.actions import IncludeLaunchDescription, TimerAction\nfrom launch.launch_description_sources import PythonLaunchDescriptionSource\n\nWORLD_NAME=\"world.sdf\"\nROS_GZ_PKG = \"ros_gz_sim\"\n\ndef generate_launch_description():\n    ld = LaunchDescription()\n\n\n    gz_args = \" \".join([\n        \"-r\",\n        \"-v1\",\n        WORLD_NAME\n    ])\n\n    gazebo = IncludeLaunchDescription(\n                PythonLaunchDescriptionSource([os.path.join(\n                    get_package_share_directory(ROS_GZ_PKG), 'launch', 'gz_sim.launch.py')]),\n                    launch_arguments={\n                        'gz_args': gz_args,\n                        \"on_exit_shutdown\": \"true\"}.items()\n             )\n\n    ld.add_action(gazebo)\n\n    return ld\n</code></pre>","tags":["ros","gazebo","project","template"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/urdf/","title":"URDF","text":"<p>URDF is an xml file that describe the geometry of a robot. URDF is a tree structure with one root link. The measuring units are meters and radians.</p> robot<pre><code>&lt;robot name=\"robot_name\"&gt;\n  &lt;link&gt;  &lt;/link&gt;\n  &lt;link&gt;  &lt;/link&gt;\n\n  &lt;joint&gt;  &lt;/joint&gt;\n&lt;/robot&gt;\n</code></pre> <p>View urdf/xacro quickly</p> <p>Using <code>urdf-tutorial</code> package <pre><code>sudo apt install ros-humble-urdf-tutorial\n</code></pre></p> usage<pre><code>ros2 launch urdf_tutorial display.launch.py model:=&lt;urdf/xacro full path&gt;\n</code></pre>","tags":["urdf","ros"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/urdf/#link","title":"Link","text":"<p>The link element describes a rigid body with an inertia, visual features, and collision properties.</p> <p></p> <p>Tip</p> <p>The reference frame of the link is its joint</p> link<pre><code>&lt;link name=\"link_name\"&gt;\n\n  &lt;visual&gt;\n      &lt;origin xyz=\"0 0 0\" rpy=\"0 0 0\" /&gt;\n      &lt;geometry&gt;\n        &lt;cylinder length=\"0.6\" radius=\"0.2\"/&gt;\n      &lt;/geometry&gt;\n  &lt;/visual&gt;\n\n  &lt;collision&gt;\n      &lt;origin xyz=\"0 0 0\" rpy=\"0 0 0\" /&gt;\n      &lt;geometry&gt;\n          &lt;cylinder length=\"0.6\" radius=\"0.2\"/&gt;\n      &lt;/geometry&gt;\n  &lt;/collision&gt;\n\n  &lt;inertial&gt;\n      &lt;origin xyz=\"0 0 0\" rpy=\"0 0 0\"/&gt;\n      &lt;mass value=\"1\"/&gt;\n      &lt;inertia\n          ixx=\"1.0\" ixy=\"0.0\" ixz=\"0.0\"\n          iyy=\"1.0\" iyz=\"0.0\"\n          izz=\"1.0\"/&gt;\n  &lt;/inertial&gt;\n&lt;/link&gt;\n</code></pre>","tags":["urdf","ros"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/xacro/","title":"XACRO","text":"<p>Xacro (XML Macros) Xacro is an XML macro language. With xacro, you can construct shorter and more readable XML files by using macros that expand to larger XML expressions. more</p>","tags":["ros","xacro"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/xacro/#install-ros-support","title":"Install ROS support","text":"<pre><code>sudo apt install ros-humble-xacro\n</code></pre>","tags":["ros","xacro"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/xacro/#usage","title":"Usage","text":"","tags":["ros","xacro"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/xacro/#cli","title":"cli","text":"<pre><code>xacro hello.urdf.xacro &gt; hello.urdf\n</code></pre>","tags":["ros","xacro"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/xacro/#launch-file","title":"launch file","text":"<ul> <li>Load and procee xacro file</li> <li>Run <code>robot_state_publisher</code> to publish <code>robot_description</code> topic</li> <li>Run <code>joint_state_publisher_gui</code> to publish <code>TF's</code></li> <li>Run <code>rviz</code> to view the robot</li> </ul> load xacro and view in rviz<pre><code>import os\n\nfrom ament_index_python.packages import get_package_share_directory\nfrom launch import LaunchDescription\nfrom launch.substitutions import PathJoinSubstitution\nfrom launch_ros.actions import Node\nimport xacro\n\nPKG_BRINGUP = \"self_balancing_bringup\"\nPKG_DESCRIPTION = \"self_balancing_description\"\nROBOT = \"robot.urdf\"\n\nURDF = \"urdf\"\nCONFIG = \"config\"\n\n\ndef generate_launch_description():\n    ld = LaunchDescription()\n\n    pkg_path = os.path.join(get_package_share_directory(PKG_DESCRIPTION))\n    xacro_file = os.path.join(pkg_path, URDF, ROBOT)\n    robot_description_config = xacro.process_file(xacro_file).toxml()\n    params = {\"robot_description\": robot_description_config, \"use_sim_time\": True}\n\n    node_robot_state_publisher = Node(\n        package=\"robot_state_publisher\",\n        executable=\"robot_state_publisher\",\n        output=\"screen\",\n        parameters=[params],\n    )\n\n    node_state_publisher_gui = Node(\n        package=\"joint_state_publisher_gui\",\n        executable=\"joint_state_publisher_gui\",\n        output=\"screen\",\n    )\n\n    rviz_node = Node(\n        package=\"rviz2\",\n        executable=\"rviz2\",\n        name=\"rviz2\",\n        output=\"screen\",\n        arguments=[\n            \"-d\",\n            PathJoinSubstitution(\n                [get_package_share_directory(PKG_BRINGUP), CONFIG, \"display.rviz\"]\n            ),\n        ],\n    )\n\n    ld.add_action(node_robot_state_publisher)\n    ld.add_action(node_state_publisher_gui)\n    ld.add_action(rviz_node)\n    return ld\n</code></pre>","tags":["ros","xacro"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/xacro/#xacro-terms","title":"XACRO terms","text":"<ul> <li>match</li> <li>property</li> <li>arg</li> <li>include</li> <li>condition</li> <li>macro</li> <li>loops</li> </ul>","tags":["ros","xacro"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/xacro/#recommend-xacro-layout","title":"Recommend xacro layout","text":"<ul> <li>robot.urdf.xacro: main xacro file</li> <li>gazebo.xacro: all gazebo stuff</li> <li>control.xacro: ros2 control</li> <li>materials.xacro</li> <li>macros.xacro</li> <li>inertial.xacro</li> </ul> robot.urdf.xacro<pre><code>&lt;robot xmlns:xacro=\"http://www.ros.org/wiki/xacro\" name=\"my_robot\"&gt;\n  &lt;xacro:include filename=\"gazebo.xacro\"/&gt;\n  &lt;xacro:include filename=\"control.xacro\"/&gt;\n\n  &lt;xacro:property name=\"a\" value=\"0.1\" /&gt;\n&lt;/robot&gt;\n</code></pre> gazebo.xacro<pre><code>&lt;robot xmlns:xacro=\"http://www.ros.org/wiki/xacro\"&gt;\n  &lt;gazebo reference=\"imu_link\"&gt;\n        &lt;sensor name=\"link2_imu\" type=\"imu\"&gt;\n            &lt;always_on&gt;1&lt;/always_on&gt;\n            &lt;update_rate&gt;50&lt;/update_rate&gt;\n            &lt;visualize&gt;true&lt;/visualize&gt;\n            &lt;topic&gt;imu-control&lt;/topic&gt;\n            &lt;enable_metrics&gt;true&lt;/enable_metrics&gt;\n        &lt;/sensor&gt;\n    &lt;/gazebo&gt;\n\n\n&lt;/robot&gt;\n</code></pre> <p> tag materials.xacro<pre><code>&lt;robot xmlns:xacro=\"http://www.ros.org/wiki/xacro\"&gt;\n  &lt;material name=\"white\"&gt;\n        &lt;color rgba=\"1 1 1 1\"/&gt;\n    &lt;/material&gt;\n\n    &lt;material name=\"orange\"&gt;\n        &lt;color rgba=\"1 0.3 0.1 1\"/&gt;\n    &lt;/material&gt;\n\n    &lt;material name=\"blue\"&gt;\n        &lt;color rgba=\"0.2 0.2 1 1\"/&gt;\n    &lt;/material&gt;\n\n&lt;/robot&gt;\n</code></pre> inertial.xacro<pre><code>&lt;robot xmlns:xacro=\"http://www.ros.org/wiki/xacro\"&gt;\n  &lt;xacro:macro name=\"inertial_sphere\" params=\"mass radius *origin\"&gt;\n        &lt;inertial&gt;\n            &lt;xacro:insert_block name=\"origin\"/&gt;\n            &lt;mass value=\"${mass}\" /&gt;\n            &lt;inertia ixx=\"${(2/5) * mass * (radius*radius)}\" ixy=\"0.0\" ixz=\"0.0\"\n                    iyy=\"${(2/5) * mass * (radius*radius)}\" iyz=\"0.0\"\n                    izz=\"${(2/5) * mass * (radius*radius)}\" /&gt;\n        &lt;/inertial&gt;\n    &lt;/xacro:macro&gt;  \n\n\n    &lt;xacro:macro name=\"inertial_box\" params=\"mass x y z *origin\"&gt;\n        &lt;inertial&gt;\n            &lt;xacro:insert_block name=\"origin\"/&gt;\n            &lt;mass value=\"${mass}\" /&gt;\n            &lt;inertia ixx=\"${(1/12) * mass * (y*y+z*z)}\" ixy=\"0.0\" ixz=\"0.0\"\n                    iyy=\"${(1/12) * mass * (x*x+z*z)}\" iyz=\"0.0\"\n                    izz=\"${(1/12) * mass * (x*x+y*y)}\" /&gt;\n        &lt;/inertial&gt;\n    &lt;/xacro:macro&gt;\n\n\n    &lt;xacro:macro name=\"inertial_cylinder\" params=\"mass length radius *origin\"&gt;\n        &lt;inertial&gt;\n            &lt;xacro:insert_block name=\"origin\"/&gt;\n            &lt;mass value=\"${mass}\" /&gt;\n            &lt;inertia ixx=\"${(1/12) * mass * (3*radius*radius + length*length)}\" ixy=\"0.0\" ixz=\"0.0\"\n                    iyy=\"${(1/12) * mass * (3*radius*radius + length*length)}\" iyz=\"0.0\"\n                    izz=\"${(1/2) * mass * (radius*radius)}\" /&gt;\n        &lt;/inertial&gt;\n    &lt;/xacro:macro&gt;\n&lt;/robot&gt;\n</code></pre>","tags":["ros","xacro"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/xacro/#reference","title":"Reference","text":"<ul> <li>articulatedrobotics - Describing robots with URDF</li> </ul>","tags":["ros","xacro"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/xacro/xacro_arg_and_condition/","title":"XACRO arg and condition","text":"","tags":["xacro","arg","condition"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/xacro/xacro_arg_and_condition/#arg","title":"arg","text":"<p>Simple <code>xacro</code> file that get argument from outside. if no argument set it use the default. Using <code>xacro</code> command to substitute xacro sentence</p> simple.xacro<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;robot name=\"my_robot\" xmlns:xacro=\"http://www.ros.org/wiki/xacro\"&gt;\n     &lt;xacro:arg name=\"banner\" default=\"default banner\"/&gt;\n    &lt;tag&gt;$(arg banner)&lt;/tag&gt;\n&lt;/robot&gt;\n</code></pre> usage<pre><code># use default value\nxacro simple.xacro\n\n# set arg from cli\nxacro simple.xacro banner:=hello\n</code></pre>","tags":["xacro","arg","condition"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/xacro/xacro_arg_and_condition/#launch-file","title":"launch file","text":"","tags":["xacro","arg","condition"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/xacro/xacro_arg_and_condition/#yaml","title":"yaml","text":"<pre><code>launch:\n  - arg:\n      name: \"robot_description_file\"\n      default: \"$(find-pkg-share my_robot_description)/urdf/test.xacro\"\n  - arg:\n      name: banner\n      default: hello world\n\n  #xacro\n  - executable:\n      cmd: \"xacro $(var robot_description_file) banner:=$(var banner)\"\n      output: screen\n</code></pre>","tags":["xacro","arg","condition"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/xacro/xacro_arg_and_condition/#condition","title":"Condition","text":"simple xacro with condition and argument<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;robot xmlns:xacro=\"http://www.ros.org/wiki/xacro\" name=\"robot_name\"&gt;\n    &lt;xacro:arg name=\"use_ros2_control\" default=\"false\" /&gt;\n    &lt;xacro:if value=\"$(arg use_ros2_control)\"&gt;\n        control\n    &lt;/xacro:if&gt;\n    &lt;xacro:unless value=\"$(arg use_ros2_control)\"&gt;\n        simple\n    &lt;/xacro:unless&gt;\n&lt;/robot&gt;\n</code></pre>","tags":["xacro","arg","condition"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/xacro/xacro_arg_and_condition/#usage","title":"usage","text":"","tags":["xacro","arg","condition"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/xacro/xacro_arg_and_condition/#launch","title":"launch","text":"<pre><code>launch:\n  - arg:\n      name: \"robot_description_file\"\n      default: \"$(find-pkg-share my_robot_description)/urdf/test.xacro\"\n  - arg:\n      name: use_control\n      default: \"false\"\n\n  #xacro\n  - executable:\n      cmd: \"xacro $(var robot_description_file) use_ros2_control:=$(var use_control)\"\n      output: screen\n</code></pre>","tags":["xacro","arg","condition"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/xacro/xacro_arg_and_condition/#usage_1","title":"usage","text":"<pre><code>#default\nros2 launch my_robot_bringup test.launch.yaml\n# False\nros2 launch my_robot_bringup test.launch.yaml use_control:=false\n# True\nros2 launch my_robot_bringup test.launch.yaml use_control:=false\n</code></pre>","tags":["xacro","arg","condition"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/xacro/xacro_arg_and_condition/#demo-more-conditions","title":"Demo: more conditions","text":"<p>Use expression to evaluate condition</p> test.xacro<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;robot xmlns:xacro=\"http://www.ros.org/wiki/xacro\" name=\"robot_name\"&gt;\n    &lt;xacro:arg name=\"xxx\" default=\"2\" /&gt;\n    &lt;xacro:property name=\"xxx_value\" value=\"$(arg xxx)\" /&gt; \n\n    arg: $(arg xxx) , property: ${xxx_value} \n\n    &lt;xacro:if value=\"${'$(arg xxx)' == '1'}\"&gt;\n        arg condition 1\n    &lt;/xacro:if&gt;\n\n    &lt;xacro:if value=\"${xxx_value == 1}\"&gt;\n        property condition 1\n    &lt;/xacro:if&gt;\n\n&lt;/robot&gt;\n</code></pre>","tags":["xacro","arg","condition"]},{"location":"ROS/ros_eco/urdf_xacro_gz_plugin/xacro/xacro_arg_and_condition/#usage_2","title":"usage","text":"<pre><code>xacro test.xacro xxx:=1\nxacro test.xacro xxx:=2\n</code></pre>","tags":["xacro","arg","condition"]},{"location":"ROS/ros_world/","title":"ROS World","text":"<p>Navigation and Localization</p> <p>Perception</p> <p>DDS</p> <p>ROS Control</p> <p>TF</p> <p>Zenoh</p>"},{"location":"ROS/ros_world/#posts","title":"Posts","text":"<ul> <li>ROS2 Parameters</li> </ul>"},{"location":"ROS/ros_world/dds/","title":"DDS","text":"<p>Cyclone DDS</p> <p>TBD</p> <p>TBD</p>","tags":["dds"]},{"location":"ROS/ros_world/dds/#todo-dds-cyclondds-to-do","title":"TODO: dds cyclondds to do","text":"<ul> <li>dds tools</li> <li>ddperf</li> <li>cyclonedds</li> <li>shm</li> <li>zenoh with shm</li> <li>fastdds and zenoh</li> </ul>","tags":["dds"]},{"location":"ROS/ros_world/dds/cyclone_large_message_drop/","title":"Send image message across ROS using cyclonedds","text":"<ul> <li>Ubuntu 22.04</li> <li>Humble</li> <li>Cyclonedds</li> </ul>","tags":["ros","dds","cyclonedds","image","large message"]},{"location":"ROS/ros_world/dds/cyclone_large_message_drop/#demo","title":"Demo","text":"<p>publish Image </p> cyclonedds.xml<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;\n&lt;CycloneDDS xmlns=\"https://cdds.io/config\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"https://cdds.io/config https://raw.githubusercontent.com/eclipse-cyclonedds/cyclonedds/master/etc/cyclonedds.xsd\"&gt;\n    &lt;Domain Id=\"any\"&gt;\n        &lt;Internal&gt;\n            &lt;SocketReceiveBufferSize min=\"20MB\"&gt;&lt;/SocketReceiveBufferSize&gt;\n        &lt;/Internal&gt;\n    &lt;/Domain&gt;\n&lt;/CycloneDDS&gt;\n</code></pre> <p>Increased my <code>/proc/sys/net/core/rmem_max</code> to 30MB</p> <pre><code>echo 30000000 | sudo tee /proc/sys/net/core/rmem_max\n</code></pre>","tags":["ros","dds","cyclonedds","image","large message"]},{"location":"ROS/ros_world/dds/cyclone_large_message_drop/#use-cycloneddsxml","title":"use cyclonedds.xml","text":"<pre><code>export CYCLONEDDS_URI=file://$PWD/cyclonedds.xml\n</code></pre> publisher<pre><code>RMW_IMPLEMENTATION=rmw_cyclonedds_cpp ros2 run cpp_demos simple_img_pub\n</code></pre> subscriber<pre><code>RMW_IMPLEMENTATION=rmw_cyclonedds_cpp  ros2 run cpp_demos simple_img_sub \n</code></pre> simple_img_pub.cpp<pre><code>#include &lt;chrono&gt;\n#include &lt;functional&gt;\n#include &lt;memory&gt;\n#include &lt;string&gt;\n#include &lt;thread&gt;\n#include &lt;rclcpp/rclcpp.hpp&gt;\n#include &lt;rclcpp/clock.hpp&gt;\n#include &lt;opencv2/opencv.hpp&gt;\n#include &lt;rmw/qos_profiles.h&gt;\n#include &lt;rclcpp/qos.hpp&gt;\n#include &lt;rclcpp/time.hpp&gt;\n// #include &lt;std_msgs/msg/string.hpp&gt;\n// #include &lt;sensor_msgs/msg/image.hpp&gt;\n// #include &lt;cv_bridge/cv_bridge.h&gt;\n// #include &lt;std_msgs/msg/header.hpp&gt;\n#include \"custom_msg/msg/image.hpp\"\n\nusing namespace std::chrono_literals;\n\nvoid fill_loaned_message(\n  rclcpp::LoanedMessage&lt;custom_msg::msg::Image&gt; &amp; loanedMsg,\n  const cv::Mat &amp; frame, uint64_t timestamp,\n  uint64_t count)\n{\n  auto &amp;msg = loanedMsg.get();\n  auto size = frame.elemSize() * frame.total();\n  if (size &gt; custom_msg::msg::Image::MAX_SIZE) {\n    std::stringstream s;\n    s &lt;&lt; \"MAX_SIZE exceeded - message requires \" &lt;&lt; size &lt;&lt; \"bytes\\n\";\n    throw std::runtime_error(s.str());\n  }\n\n  msg.rows = frame.rows;\n  msg.cols = frame.cols;\n  msg.size = size;\n  msg.channels = frame.channels();\n  msg.type = frame.type();\n  msg.offset = 0;  // TODO(matthiaskillat) alignment?\n  msg.count = count;\n  msg.timestamp = timestamp;\n\n  // TODO(matthiaskillat): avoid if possible\n  std::memcpy(msg.data.data(), frame.data, size);\n}\n\nclass MinimalPublisher : public rclcpp::Node\n{\npublic:\n  MinimalPublisher()\n      : Node(\"minimal_publisher\")\n  {\n    // auto qos = rclcpp::SensorDataQoS();\n    auto qos = rclcpp::QoS(rclcpp::KeepLast(1), rmw_qos_profile_sensor_data);\n    // auto qos = rclcpp::QoS(rclcpp::KeepLast(1));\n    // publisher_ = this-&gt;create_publisher&lt;sensor_msgs::msg::Image&gt;(\"topic\", qos);\n    publisher_ = this-&gt;create_publisher&lt;custom_msg::msg::Image&gt;(\"topic\", qos);\n    timer_ = this-&gt;create_wall_timer(\n        1000ms, std::bind(&amp;MinimalPublisher::timer_callback, this));\n  }\n\nprivate:\n  void timer_callback()\n  {\n    cv::Mat img(cv::Size(640, 480), CV_8UC3);\n    auto size = img.elemSize()*img.total();\n    RCLCPP_INFO_STREAM(this-&gt;get_logger(), size);\n    cv::randu(img, cv::Scalar(0, 0, 0), cv::Scalar(255, 255, 255));\n    rclcpp::Time now = this-&gt;get_clock()-&gt;now();\n    // auto message = sensor_msgs::msg::Image();\n    // auto my_header = std_msgs::msg::Header();\n    // my_header.stamp = now;\n    auto sec_as_tin64 = static_cast&lt;int64&gt;(now.seconds() * 1e9);\n    RCLCPP_INFO_STREAM(this-&gt;get_logger(), sec_as_tin64);\n    auto msg = this-&gt;publisher_-&gt;borrow_loaned_message();\n    fill_loaned_message(msg,\n      img,\n      sec_as_tin64,\n      fid_++);\n    // auto msg = cv_bridge::CvImage(my_header, \"bgr8\", img).toImageMsg();\n    this-&gt;publisher_-&gt;publish(std::move(msg));\n\n    // RCLCPP_INFO_STREAM(this-&gt;get_logger(), \"\"&lt;&lt;(c-message.header.stamp).seconds());\n  }\n  rclcpp::TimerBase::SharedPtr timer_;\n  rclcpp::Publisher&lt;custom_msg::msg::Image&gt;::SharedPtr publisher_;\n  int fid_ = 0;\n};\n\nint main(int argc, char *argv[])\n{\n  rclcpp::init(argc, argv);\n  auto node = std::make_shared&lt;MinimalPublisher&gt;();\n  rclcpp::spin(node);\n  rclcpp::shutdown();\n  return 0;\n}\n</code></pre> simple_img_sub.cpp<pre><code>#include &lt;memory&gt;\n#include &lt;rclcpp/rclcpp.hpp&gt;\n// #include &lt;sensor_msgs/msg/image.hpp&gt;\n#include &lt;rclcpp/qos.hpp&gt;\n#include &lt;rclcpp/time.hpp&gt;\n#include &lt;rmw/qos_profiles.h&gt;\n// #include &lt;cv_bridge/cv_bridge.h&gt;\n#include &lt;opencv2/opencv.hpp&gt;\n#include \"custom_msg/msg/image.hpp\"\n\nvoid from_message(const custom_msg::msg::Image::SharedPtr &amp;msg, cv::Mat &amp;frame)\n{\n    void *buffer = msg-&gt;data.data();\n    frame = cv::Mat(msg-&gt;rows, msg-&gt;cols, msg-&gt;type, buffer);\n}\n\nclass MinimalSub : public rclcpp::Node\n{\npublic:\n    MinimalSub() : Node(\"minimal_img_sub\")\n    {\n        RCLCPP_INFO_STREAM(this-&gt;get_logger(), \"hello sub\");\n        // auto qos = rclcpp::QoS(rclcpp::KeepLast(1));\n        auto qos = rclcpp::QoS(rclcpp::KeepLast(1), rmw_qos_profile_sensor_data);\n        sub_ = this-&gt;create_subscription&lt;custom_msg::msg::Image&gt;(\"topic\", qos, std::bind(&amp;MinimalSub::img_handler, this, std::placeholders::_1));\n    }\n\nprivate:\n    void img_handler(custom_msg::msg::Image::SharedPtr msg)\n    {\n        cv::Mat frame;\n        from_message(msg, frame);\n\n        auto now = this-&gt;get_clock()-&gt;now();\n        auto sec_as_tin64 = static_cast&lt;int64&gt;(now.seconds() * 1e9);\n\n        // auto msg_time = rclcpp::Duration::from_seconds(msg-&gt;timestamp);\n        RCLCPP_INFO_STREAM(this-&gt;get_logger(), (sec_as_tin64 - msg-&gt;timestamp)/1e9);\n        cv::imshow(\"debug\", frame);\n        cv::waitKey(1);\n    }\n    rclcpp::Subscription&lt;custom_msg::msg::Image&gt;::SharedPtr sub_;\n};\n\nint main(int argc, char *argv[])\n{\n    rclcpp::init(argc, argv);\n    auto node = std::make_shared&lt;MinimalSub&gt;();\n    rclcpp::spin(node);\n    rclcpp::shutdown();\n    return 0;\n}\n</code></pre> Image.msg<pre><code>uint32 rows\nuint32 cols\nuint8 channels\nuint8 type\nuint32 offset\nuint32 size\nuint64 count\nuint64 timestamp\n\nuint32 MAX_SIZE=921600\nchar[921600] data\n</code></pre> CMakeLists.txt<pre><code>cmake_minimum_required(VERSION 3.8)\nproject(cpp_demos)\n\nif(CMAKE_COMPILER_IS_GNUCXX OR CMAKE_CXX_COMPILER_ID MATCHES \"Clang\")\n  add_compile_options(-Wall -Wextra -Wpedantic)\nendif()\n\n# find dependencies\nfind_package(ament_cmake REQUIRED)\nfind_package(rclpy REQUIRED)\nfind_package(rclcpp REQUIRED)\nfind_package(OpenCV REQUIRED)\nfind_package(custom_msg REQUIRED)\nfind_package(example_interfaces REQUIRED)\n\ninclude_directories(include ${OpenCV_INCLUDE_DIRS})\n\n\n\n# # img pub\nadd_executable(simple_img_pub src/simple_img_pub.cpp)\nament_target_dependencies(simple_img_pub rclcpp custom_msg OpenCV)\n\n# # img sub\nadd_executable(simple_img_sub src/simple_img_sub.cpp)\nament_target_dependencies(simple_img_sub rclcpp  OpenCV custom_msg)\n\ninstall(TARGETS\n  simple_img_pub\n  simple_img_sub\n  DESTINATION lib/${PROJECT_NAME})\n\n\nament_package()\n</code></pre>","tags":["ros","dds","cyclonedds","image","large message"]},{"location":"ROS/ros_world/dds/cyclone_large_message_drop/#reference","title":"Reference","text":"<ul> <li> Reduce how eager CycloneDDS is in retransmits #484 </li> </ul>","tags":["ros","dds","cyclonedds","image","large message"]},{"location":"ROS/ros_world/dds/cyclonedds/","title":"Cyclone DDS","text":"<p>CycloneDDS web site</p>","tags":["cyclonedds","dds"]},{"location":"ROS/ros_world/dds/cyclonedds/#install","title":"install","text":"<pre><code>sudo apt install ros-humble-rmw-cyclonedds-cpp\n</code></pre>","tags":["cyclonedds","dds"]},{"location":"ROS/ros_world/dds/cyclonedds/#cyclonedds-xml-configuration","title":"CycloneDDS XML configuration","text":"<pre><code>export CYCLONEDDS_URI=file://$PWD/cyclonedds.xml\nexport RMW_IMPLEMENTATION=rmw_cyclonedds_cpp\n</code></pre> <p>cyclonedds version</p> <p>CycloneDDS has xml configuration file for runtime configuration that changed between versions.</p> <pre><code>dpkg -s ros-humble-cyclonedds\n</code></pre> <p>ros humble ver(0.10.5)</p> <p>configuration</p> <p>tools</p> <p>tips / best practice</p>","tags":["cyclonedds","dds"]},{"location":"ROS/ros_world/dds/cyclonedds/#cyclonedds-protocols","title":"CycloneDDS protocols","text":"<p>SSPDP and SEDP are the two core discovery protocols that enable nodes to find and communicate with each other automatically.</p> Protocol Full Name Role SPDP Simple Participant Discovery Protocol Discovers other DDS participants (nodes) on the network SEDP Simple Endpoint Discovery Protocol Discovers the publishers and subscribers (topics, types, QoS) within each participant <p>SPDP (Simple Participant Discovery Protocol) is the first step in DDS discovery. It:</p> <pre><code>- Broadcasts participant info (GUID, capabilities) using multicast on UDP port 7400 (domain 0).\n- Helps nodes find each other without a centralized registry.\n- Uses periodic announcements.\n- In CycloneDDS:\n    - SPDP is what shows up in tcpdump as packets to 239.255.0.1:7400 (default multicast group).\n</code></pre> <p>SEDP (Simple Endpoint Discovery Protocol):</p> <p>Once SPDP discovers participants, SEDP kicks in to share:</p> <pre><code>- What topics each node publishes or subscribes to\n- Message types\n- QoS policies\n</code></pre>","tags":["cyclonedds","dds"]},{"location":"ROS/ros_world/dds/cyclonedds/#demo-cyclonedds-between-two-machines","title":"Demo: CycloneDDS between two machines","text":"<p>Ros humble cyclonedds version 0.10.5</p>","tags":["cyclonedds","dds"]},{"location":"ROS/ros_world/dds/cyclonedds/#machine-1","title":"machine 1","text":"cyclonedds.xml<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;CycloneDDS xmlns=\"https://cdds.io/config\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n  xsi:schemaLocation=\"https://cdds.io/config https://raw.githubusercontent.com/eclipse-cyclonedds/cyclonedds/master/etc/cyclonedds.xsd\"&gt;\n  &lt;Domain Id=\"any\"&gt;\n    &lt;General&gt;\n       &lt;AllowMulticast&gt;true&lt;/AllowMulticast&gt;\n       &lt;!-- &lt;AllowMulticast&gt;spdp&lt;/AllowMulticast&gt; --&gt;\n    &lt;/General&gt;\n  &lt;/Domain&gt;\n&lt;/CycloneDDS&gt;\n</code></pre> <p>AllowMulticast</p> <p>Both configurations are valid <code>true</code> and <code>spdp</code> .</p> <p>The  setting controls which parts of DDS discovery and communication are allowed to use multicast. <ul> <li><code>true</code>: allow all multicast traffic,</li> <li><code>spdp</code>: only discovery uses multicast, other communication is unicast</li> <li><code>false</code>: unicast only</li> </ul>","tags":["cyclonedds","dds"]},{"location":"ROS/ros_world/dds/cyclonedds/#machine-2","title":"machine 2","text":"cyclonedds.xml<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;CycloneDDS xmlns=\"https://cdds.io/config\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n  xsi:schemaLocation=\"https://cdds.io/config https://raw.githubusercontent.com/eclipse-cyclonedds/cyclonedds/master/etc/cyclonedds.xsd\"&gt;\n  &lt;Domain Id=\"any\"&gt;\n    &lt;General&gt;\n      &lt;!-- &lt;AllowMulticast&gt;true&lt;/AllowMulticast&gt; --&gt;\n        &lt;Interfaces&gt;\n          &lt;NetworkInterface autodetermine=\"false\" name=\"enx5c857e356893\"/&gt;\n        &lt;/Interfaces&gt;\n    &lt;/General&gt;\n\n  &lt;/Domain&gt;\n</code></pre> <p>NetworkInterface</p> <p>The <code>NetworkInterface</code> setting is used to specify which network interface to use for communication. </p> <ul> <li><code>autodetermine=\"false\"</code>: disables automatic detection of the network interface.</li> <li><code>name=\"enx5c857e356893\"</code>: specifies the name of the network interface to use.</li> </ul>","tags":["cyclonedds","dds"]},{"location":"ROS/ros_world/dds/cyclonedds/#test","title":"Test","text":"<pre><code># machine 1\nros2 topic pub xxx std_msgs/String \"data: hello world\" -r 1\n</code></pre> <pre><code># machine 2\nros2 topic echo xxx\n</code></pre>","tags":["cyclonedds","dds"]},{"location":"ROS/ros_world/dds/cyclonedds/#system-configuration-recommendation","title":"System configuration recommendation","text":"<p>ros2 rmw cyclone settings</p> <ul> <li>net.core.rmem_max</li> <li>net.core.rmem_default</li> </ul> <pre><code># Add settings to sysctl \necho \"net.core.rmem_max=8388608\\nnet.core.rmem_default=8388608\\n\" | sudo tee /etc/sysctl.d/60-cyclonedds.conf\n</code></pre>","tags":["cyclonedds","dds"]},{"location":"ROS/ros_world/dds/cyclonedds/#posts","title":"Posts","text":"<ul> <li>cyclonedds_multicast</li> <li>cyclone shm</li> </ul>","tags":["cyclonedds","dds"]},{"location":"ROS/ros_world/dds/cyclonedds/cyclinedds_shm/","title":"CycloneDDS with SHM","text":"<p>Using cycloneDDS using shm</p> <p>Note</p> <p>Cyclone DDS Shared Memory - Boost Data Transfer Speed and Maximize Efficiency</p> <pre><code>&lt;CycloneDDS xmlns=\"https://cdds.io/config\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"https://cdds.io/config https://raw.githubusercontent.com/eclipse-cyclonedds/cyclonedds/iceoryx/etc/cyclonedds.xsd\"&gt;\n    &lt;Domain id=\"any\"&gt;\n        &lt;SharedMemory&gt;\n            &lt;Enable&gt;true&lt;/Enable&gt;\n            &lt;LogLevel&gt;info&lt;/LogLevel&gt;\n        &lt;/SharedMemory&gt;\n    &lt;/Domain&gt;\n&lt;/CycloneDDS&gt;\n</code></pre>","tags":["dds","cyclonedds","shm"]},{"location":"ROS/ros_world/dds/cyclonedds/cyclinedds_shm/#iox-roudi","title":"iox-roudi","text":"<p>roudi config <pre><code>iox-roudi \n</code></pre></p>","tags":["dds","cyclonedds","shm"]},{"location":"ROS/ros_world/dds/cyclonedds/cyclinedds_shm/#demo","title":"Demo","text":"<p>Run tmuxp script that run <code>iox-roudi</code> server and publish image using gscam with two subscribers We can see using bmon or other network sniffer that is no traffic</p> environment variables<pre><code>export RMW_IMPLEMENTATION=rmw_cyclonedds_cpp\nexport CYCLONEDDS_URI=file:///cyclonedds.xml\n</code></pre> tmux script <pre><code>session_name: dds\nwindows:\n  - window_name: cyclone\n    layout: tiled\n    suppress_history: false\n    shell_command_before:\n      - source /opt/ros/humble/setup.bash\n      - export RMW_IMPLEMENTATION=rmw_cyclonedds_cpp\n      - export CYCLONEDDS_URI=file:///home/user/projects/blog/docs/ROS/ros_world/dds/cyclonedds/shm.xml\n    panes:\n      - shell_command:\n          - iox-roudi \n      - shell_command: #\n          - export GSCAM_CONFIG=\"videotestsrc pattern=snow ! video/x-raw,width=640,height=480,framerate=30/1 ! videoconvert\"\n          - ros2 run gscam gscam_node\n      - shell_command: #\n          - ros2 run rqt_image_view rqt_image_view\n\n      - shell_command:\n          - # ros2 topic echo /camera/image_raw\n        split: vertical\n</code></pre> <ul> <li>cyclonedd.xml</li> <li>tmuxp yaml to run the demo</li> </ul>","tags":["dds","cyclonedds","shm"]},{"location":"ROS/ros_world/dds/cyclonedds/cyclinedds_shm/#iceoryx-introspection","title":"iceoryx-introspection","text":"<pre><code>ros-humble-iceoryx-introspection\n</code></pre> <pre><code>iox-introspection-client --h\n</code></pre>","tags":["dds","cyclonedds","shm"]},{"location":"ROS/ros_world/dds/cyclonedds/cyclinedds_shm/#reference","title":"reference","text":"<ul> <li>Using Shared Memory with ROS 2</li> </ul>","tags":["dds","cyclonedds","shm"]},{"location":"ROS/ros_world/dds/cyclonedds/cyclonedds_multicast/","title":"CycloneDDS XML configuration","text":"<ul> <li>CycloneDDS config</li> <li>xml reference</li> </ul> <p>Default Multicast Behavior in CycloneDDS (ROS 2 Humble)</p> Settings Default Value Discovery (SPDP) Multicast Enabled User Data (Topic Data) Unicast Only Meta Traffic (SEDP, other discovery traffic) Unicast Only","tags":["dds","cyclonedds","multicast","xml"]},{"location":"ROS/ros_world/dds/cyclonedds/cyclonedds_multicast/#demo","title":"Demo","text":"<p>Send image data using gscam package and subscribe using rqt_image_viewer and ros2 topic echo measure/monitor the data using bmon tool</p> installation<pre><code>sudo apt install bmon\nsudo apt install ros-humble-gscam\n</code></pre> bmon<pre><code>bmon\n</code></pre> terminal1<pre><code>export GSCAM_CONFIG=\"videotestsrc pattern=snow ! video/x-raw,width=640,height=480,framerate=30/1 ! videoconvert\"\nros2 run gscam gscam_node\n</code></pre> <pre><code>ros2 run rqt_image_view rqt_image_view\n</code></pre> <p></p> <pre><code>ros2 topic echo /camera/image_raw\n</code></pre> <p></p>","tags":["dds","cyclonedds","multicast","xml"]},{"location":"ROS/ros_world/dds/cyclonedds/cyclonedds_multicast/#multicast","title":"Multicast","text":"<p>For easy of use , using tmuxp yaml file to run all the test together temp.xml<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;CycloneDDS xmlns=\"https://cdds.io/config\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n  xsi:schemaLocation=\"https://cdds.io/config https://raw.githubusercontent.com/eclipse-cyclonedds/cyclonedds/master/etc/cyclonedds.xsd\"&gt;\n  &lt;Domain Id=\"any\"&gt;\n    &lt;General&gt;\n      &lt;AllowMulticast&gt;true&lt;/AllowMulticast&gt;\n    &lt;/General&gt;\n  &lt;/Domain&gt;\n&lt;/CycloneDDS&gt;\n</code></pre></p>","tags":["dds","cyclonedds","multicast","xml"]},{"location":"ROS/ros_world/dds/cyclonedds/cyclonedds_multicast/#tmuxp-script","title":"tmuxp script","text":"tmuxp_demo_multicast.yaml<pre><code>session_name: dds\nwindows:\n  - window_name: cyclone\n    layout: tiled\n    suppress_history: false\n    shell_command_before:\n      - source /opt/ros/humble/setup.bash\n    panes:\n      - shell_command: #\n          - export GSCAM_CONFIG=\"videotestsrc pattern=snow ! video/x-raw,width=640,height=480,framerate=30/1 ! videoconvert\"\n          - export CYCLONEDDS_URI=file://$PWD/temp.xml\n          - ros2 run gscam gscam_node\n      - shell_command: #\n          - export CYCLONEDDS_URI=file://$PWD/temp.xml\n          - ros2 run rqt_image_view rqt_image_view\n\n      - shell_command:\n          - export CYCLONEDDS_URI=file://$PWD/temp.xml\n          -  # ros2 topic echo /camera/image_raw\n</code></pre> <pre><code>tmuxp load tmuxp_demo_multicast.yaml\n</code></pre>","tags":["dds","cyclonedds","multicast","xml"]},{"location":"ROS/ros_world/dds/cyclonedds/cyclonedds_multicast/#multicast-with-one-subscriber","title":"multicast with one subscriber","text":"<p>lo</p> <p>The communication use lo interface by default lo not support multicast</p> <p></p>","tags":["dds","cyclonedds","multicast","xml"]},{"location":"ROS/ros_world/dds/cyclonedds/cyclonedds_multicast/#multicast-with-two-or-more-subscriber","title":"multicast with two or more subscriber","text":"<p>wlo1</p> <p>The communication use the physical adapter (wlo1) support multicast</p> <p></p>","tags":["dds","cyclonedds","multicast","xml"]},{"location":"ROS/ros_world/dds/cyclonedds/cyclonedds_multicast/#reference","title":"Reference","text":"<ul> <li>Download tmuxp file</li> </ul>","tags":["dds","cyclonedds","multicast","xml"]},{"location":"ROS/ros_world/dds/cyclonedds/cyclonedds_config/","title":"CycloneDDS configuration","text":"<p>Control cyclonedds discovery, network and tracing settings using xml file more</p> <p>cyclone version</p> <p>Check to right documentation for installed version</p> usage<pre><code>export CYCLONEDDS_URI=\"file://$HOME/cyclonedds.xml\"\n</code></pre> <p>unicast</p> <p>TBD</p> <p>TBD</p> <p>Tracing</p> <p>shm</p> <p>large messages</p>","tags":["dds","cyclonedds","config","cyclonedds_uri"]},{"location":"ROS/ros_world/dds/cyclonedds/cyclonedds_config/#reporting-and-tracing","title":"Reporting and Tracing","text":"<p>doc</p>","tags":["dds","cyclonedds","config","cyclonedds_uri"]},{"location":"ROS/ros_world/dds/cyclonedds/cyclonedds_config/#demo-output-conf-to-log-file","title":"Demo: output conf to log file","text":"<p>create directory path before running</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;CycloneDDS\n   xmlns=\"https://cdds.io/config\"\n   xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n   xsi:schemaLocation=\"https://cdds.io/config https://raw.githubusercontent.com/eclipse-cyclonedds/cyclonedds/master/etc/cyclonedds.xsd\"\n &gt;\n   &lt;Domain Id=\"any\"&gt;\n    &lt;Tracing&gt;\n      &lt;Verbosity&gt;config&lt;/Verbosity&gt;\n      &lt;OutputFile&gt;\n        ${HOME}/dds/log/cdds.log.${CYCLONEDDS_PID}\n      &lt;/OutputFile&gt;\n    &lt;/Tracing&gt;\n  &lt;/Domain&gt;\n&lt;/CycloneDDS&gt;\n</code></pre>","tags":["dds","cyclonedds","config","cyclonedds_uri"]},{"location":"ROS/ros_world/dds/cyclonedds/cyclonedds_config/#shm","title":"SHM","text":"<p>Using Shared Memory with ROS 2</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;\n&lt;CycloneDDS xmlns=\"https://cdds.io/config\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"https://cdds.io/config https://raw.githubusercontent.com/eclipse-cyclonedds/cyclonedds/iceoryx/etc/cyclonedds.xsd\"&gt;\n    &lt;Domain id=\"any\"&gt;\n        &lt;SharedMemory&gt;\n            &lt;Enable&gt;true&lt;/Enable&gt;\n            &lt;LogLevel&gt;info&lt;/LogLevel&gt;\n        &lt;/SharedMemory&gt;\n    &lt;/Domain&gt;\n&lt;/CycloneDDS&gt;\n</code></pre> run rudi<pre><code>iox-roudi\n</code></pre>","tags":["dds","cyclonedds","config","cyclonedds_uri"]},{"location":"ROS/ros_world/dds/cyclonedds/cyclonedds_config/#large-message","title":"Large message","text":"<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;\n&lt;CycloneDDS xmlns=\"https://cdds.io/config\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"https://cdds.io/config https://raw.githubusercontent.com/eclipse-cyclonedds/cyclonedds/master/etc/cyclonedds.xsd\"&gt;\n  &lt;Domain Id=\"any\"&gt;\n    &lt;General&gt;\n      &lt;Interfaces&gt;\n        &lt;NetworkInterface autodetermine=\"true\" priority=\"default\" multicast=\"default\" /&gt;\n      &lt;/Interfaces&gt;\n      &lt;AllowMulticast&gt;default&lt;/AllowMulticast&gt;\n      &lt;MaxMessageSize&gt;65500B&lt;/MaxMessageSize&gt;\n    &lt;/General&gt;\n    &lt;Internal&gt;\n      &lt;SocketReceiveBufferSize min=\"10MB\"/&gt;\n      &lt;Watermarks&gt;\n        &lt;WhcHigh&gt;500kB&lt;/WhcHigh&gt;\n      &lt;/Watermarks&gt;\n    &lt;/Internal&gt;\n  &lt;/Domain&gt;\n&lt;/CycloneDDS&gt;\n</code></pre> /etc/sysctl.d/10-cyclone-max.conf<pre><code># IP fragmentation settings\nnet.ipv4.ipfrag_time=3  # in seconds, default is 30 s\nnet.ipv4.ipfrag_high_thresh=134217728  # 128 MiB, default is 256 KiB\n\n# Increase the maximum receive buffer size for network packets\nnet.core.rmem_max=2147483647  # 2 GiB, default is 208 KiB\n</code></pre>","tags":["dds","cyclonedds","config","cyclonedds_uri"]},{"location":"ROS/ros_world/dds/cyclonedds/cyclonedds_config/unicast/","title":"CycloneDDS unicast between machine","text":"<p>Disable multicast discovery and allow unicast traffic between two machines</p>","tags":["dds","cyclonedds","ros","unicast"]},{"location":"ROS/ros_world/dds/cyclonedds/cyclonedds_config/unicast/#demo","title":"Demo","text":"<pre><code>graph TD\n    subgraph MachineA [Machine A]\n        A1[eth0: 192.168.1.10]\n        A2[eth1: 10.0.0.1]\n    end\n\n    subgraph MachineB [Machine B]\n        B1[eth0: 10.0.0.4]\n    end\n\n    A2 --- B1\n</code></pre> Sender cyclondedds.xml<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;CycloneDDS xmlns=\"https://cdds.io/config\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" \nxsi:schemaLocation=\"https://cdds.io/config https://raw.githubusercontent.com/eclipse-cyclonedds/cyclonedds/master/etc/cyclonedds.xsd\"&gt;\n\n  &lt;Domain Id=\"any\"&gt;\n    &lt;General&gt;\n      &lt;AllowMulticast&gt;false&lt;/AllowMulticast&gt;\n\n    &lt;/General&gt;\n    &lt;Discovery&gt;\n      &lt;ParticipantIndex&gt;auto&lt;/ParticipantIndex&gt;\n      &lt;Peers&gt;\n        &lt;Peer Address=\"10.0.0.4\" /&gt;\n        &lt;Peer Address=\"127.0.0.1\" /&gt;\n      &lt;/Peers&gt;\n    &lt;/Discovery&gt;\n  &lt;/Domain&gt;\n&lt;/CycloneDDS&gt;\n</code></pre> Receiver cyclondedds.xml<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;CycloneDDS xmlns=\"https://cdds.io/config\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" \nxsi:schemaLocation=\"https://cdds.io/config https://raw.githubusercontent.com/eclipse-cyclonedds/cyclonedds/master/etc/cyclonedds.xsd\"&gt;\n\n  &lt;Domain Id=\"any\"&gt;\n    &lt;General&gt;\n        &lt;AllowMulticast&gt;false&lt;/AllowMulticast&gt;\n    &lt;/General&gt;\n    &lt;Discovery&gt;\n    &lt;ParticipantIndex&gt;auto&lt;/ParticipantIndex&gt;\n      &lt;Peers&gt;\n        &lt;Peer Address=\"10.0.0.1\" /&gt;\n        &lt;Peer Address=\"127.0.0.1\" /&gt;\n      &lt;/Peers&gt;\n    &lt;/Discovery&gt;\n  &lt;/Domain&gt;\n&lt;/CycloneDDS&gt;\n</code></pre> <p>peer localhost</p> <p><code>&lt;Peer Address=\"127.0.0.1\" /&gt;</code></p> <p>This is essential because Cyclone DDS does not automatically assume loopback (127.0.0.1) unless you\u2019re using multicast or explicitly list it.</p> env.sh<pre><code>export CYCLONEDDS_URI=file://$PWD/cyclonedds.xml\nsource /opt/ros/humble/setup.bash\nexport RMW_IMPLEMENTATION=rmw_cyclonedds_cpp\n</code></pre>","tags":["dds","cyclonedds","ros","unicast"]},{"location":"ROS/ros_world/dds/cyclonedds/cyclonedds_config/unicast/#usage","title":"usage","text":"<p>We can run the pub/sub on both side</p> pub<pre><code>source env.sh\nros2 topic pub xxx std_msgs/String \"data: hello world\" -r 1\n</code></pre> echo<pre><code>source env.sh\nros2 topic echo /xxx\n</code></pre> <p>ros2 daemon</p> <p>The ROS2 daemon is a background process that:</p> <ul> <li>Caches discovered ROS nodes and topics</li> <li>Improves discovery performance</li> <li>Manages node name resolution</li> </ul> <p>Some time we need to restart for refresh discovery when using ROS commands</p> <pre><code>ros2 daemon stop &amp;&amp; ros2 daemon start\n</code></pre>","tags":["dds","cyclonedds","ros","unicast"]},{"location":"ROS/ros_world/dds/cyclonedds/cyclonedds_tips/","title":"Cyclonedds","text":"","tags":["dds","cyclonedds","tips"]},{"location":"ROS/ros_world/dds/cyclonedds/cyclonedds_tips/#send-large-message-like-image","title":"Send large message like Image","text":"<p>stereolabs.com: DDS Middleware and Network tuning</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;CycloneDDS xmlns=\"https://cdds.io/config\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n  xsi:schemaLocation=\"https://cdds.io/config https://raw.githubusercontent.com/eclipse-cyclonedds/cyclonedds/master/etc/cyclonedds.xsd\"&gt;\n  &lt;Domain Id=\"any\"&gt;\n    &lt;Internal&gt;\n      &lt;SocketReceiveBufferSize min=\"20MB\"&gt;&lt;/SocketReceiveBufferSize&gt;\n    &lt;/Internal&gt;\n  &lt;/Domain&gt;\n&lt;/CycloneDDS&gt;\n</code></pre> <pre><code>sudo sysctl -w net.core.rmem_max=30000000\nsudo sysctl -w net.core.rmem_max=2147483647 \n</code></pre>","tags":["dds","cyclonedds","tips"]},{"location":"ROS/ros_world/dds/cyclonedds/cyclonedds_tools/","title":"Cyclonedds tools","text":"install<pre><code>sudo apt install cyclonedds-tools\n</code></pre>","tags":["dds","cyclonedds","tools"]},{"location":"ROS/ros_world/dds/cyclonedds/cyclonedds_tools/#ddsperf","title":"ddsperf","text":"<p>Measures primarily data throughput and latency of the cyclone-based applications within the network or within the same board,</p> <p>Benchmarking Tools</p> <p>Tip</p> <p>Network throughput is a measure of how much data is successfully transferred from one point to another in a given period of time across a network. It's typically expressed in bits per second (bps)</p> <p>Tip</p> <p>Latency is the time delay wheen the packet is send and when it is received.</p> <p>using ping whe measure to round trip latency for a packet </p> terminal 1<pre><code>ddsperf pub size 1k 1Hz\n</code></pre> terminal 2<pre><code>ddsperf sub\n#\n\n[15894] 1.000  size 1024 total 1 lost 0 delta 1 lost 0 rate 0.00 kS/s 0.01 Mb/s (0.00 kS/s 0.00 Mb/s)\n[15894] 2.000  size 1024 total 2 lost 0 delta 1 lost 0 rate 0.00 kS/s 0.01 Mb/s (0.00 kS/s 0.00 Mb/s)\n[15894] 3.000  size 1024 total 3 lost 0 delta 1 lost 0 rate 0.00 kS/s 0.01 Mb/s (0.00 kS/s 0.00 Mb/s)\n[15894] 4.000  size 1024 total 4 lost 0 delta 1 lost 0 rate 0.00 kS/s 0.01 Mb/s (0.00 kS/s 0.00 Mb/s)\n[15894] 4.000  rss:6.4MB vcsw:11 ivcsw:0 ddsperf:1%+0%\n</code></pre> <ul> <li>pid</li> <li>time</li> <li>size of the data involved in this test (For example, 1024 bytes, which is the \u201csize 1k\u201d defined in the pub command).</li> <li>total packets received .</li> <li>The total packets lost (For example, 0).</li> <li>delta: the packets received in a 1 second reporting </li> <li>The packets lost in a 1 second report period (For example, 0).</li> <li>The number of samples processed by the Sub application in 1s (unit KS/s is 1000 samples per second).</li> </ul> publisher<pre><code>ddsperf pub size 1k 10Hz\n</code></pre> <pre><code>ddsperf sub\n[15916] participant ubuntu:15916: new (self)\n[15916] participant dev:5138: new\n[15916] 1.001  size 1024 total 10 lost 0 delta 10 lost 0 rate 0.01 kS/s 0.08 Mb/s (0.00 kS/s 0.01 Mb/s)\n[15916] 2.000  size 1024 total 20 lost 0 delta 10 lost 0 rate 0.01 kS/s 0.08 Mb/s (0.00 kS/s 0.02 Mb/s)\n[15916] 3.000  size 1024 total 30 lost 0 delta 10 lost 0 rate 0.01 kS/s 0.08 Mb/s (0.00 kS/s 0.02 Mb/s)\n[15916] 4.000  size 1024 total 40 lost 0 delta 10 lost 0 rate 0.01 kS/s 0.08 Mb/s (0.00 kS/s 0.03 Mb/s)\n[15916] 4.000  rss:6.5MB vcsw:28 ivcsw:1 ddsperf:0%+1%\n</code></pre> <pre><code>[15916] 4.000  rss:6.5MB vcsw:28 ivcsw:1 ddsperf:0%+1%\n</code></pre> <ul> <li>rss: process memory usage</li> <li>vcsw: context switch (idle) </li> <li>ivcsw: context switch (block)</li> <li>ddsperf: cpu user space, cpu kernel space</li> </ul>","tags":["dds","cyclonedds","tools"]},{"location":"ROS/ros_world/dds/cyclonedds/cyclonedds_tools/#using-iperf3","title":"using iperf3","text":"<p>iperf (or more commonly iperf3) is a powerful network testing tool used to measure:</p> <ul> <li>Network throughput (bandwidth)</li> <li>Data transfer rate (in both directions)</li> <li>Packet loss (UDP mode)</li> <li>Jitter (UDP mode)</li> <li>Retransmissions (TCP mode)</li> </ul> install<pre><code>sudo apt install iperf3\n</code></pre> run server<pre><code>iperf3 -s\n</code></pre> run client<pre><code>iperf3 -c &lt;server-ip&gt;\n\n#\n# send udp packet at 10Mbps\niperf3 -c 192.168.1.100 -u -b 10M\n</code></pre> Measure Throughput<pre><code># run server\n\n# run client\niperf3 -c 192.168.1.100\n\n# result\n[ ID] Interval           Transfer     Bitrate         Retr  Cwnd\n[  5]   0.00-1.00   sec   113 MBytes   952 Mbits/sec    0    329 KBytes \n</code></pre> <ul> <li>Transfer: Total amount of data send during the duration</li> <li>Bitrate: average speed over the duration</li> </ul>","tags":["dds","cyclonedds","tools"]},{"location":"ROS/ros_world/navigation_and_localization/","title":"Index","text":"<p>Robot Localization</p> <p>NAV2</p> <p>tbd</p>"},{"location":"ROS/ros_world/navigation_and_localization/nav2/","title":"NAV2","text":"<p>Nav2</p>","tags":["ros","nav"]},{"location":"ROS/ros_world/navigation_and_localization/robot_localization/","title":"Robot localization","text":"<p>The robot_localization package is a collection of non-linear state estimators for robots moving in 3D (or 2D) space. more </p> <p>Each of the state estimators can fuse an arbitrary number of sensors (IMUs, odometers, indoor localization systems, GPS receivers\u2026) to track the 15 dimensional:</p> <ul> <li>position: x, y, z</li> <li>orientation: roll, pitch, yaw</li> <li>linear velocity: vx, vy, vz</li> <li>angular velocity:  roll_rate, pitch_rate, yaw_rate</li> <li>linear acceleration: ax, ay, az</li> </ul>","tags":["ros","localization"]},{"location":"ROS/ros_world/navigation_and_localization/robot_localization/#coordinate-systems","title":"Coordinate systems","text":"<p>REP 105 Coordinate Frames for Mobile Platforms which describe the coordinate system conventions used in ROS</p> <p>(earth) -&gt; map -&gt; odom -&gt; base_link</p> <p>base_link is rigidly attached to the mobile robot\u2019s base. The base_link frame can be attached in any arbitrary position or orientation, but REP 103 specifies the preferred orientation of the frame as X forward, Y left and Z up. (flu)</p> <p>odom frame is a local, drifting coordinate system used to track the robot's position relative to its starting point. - It starts at (0, 0, 0) when the robot boots up. - It moves with the robot as it drives around. - It is smooth and continuous, meaning it never jumps \u2014 ideal for control. - But it can drift over time due to sensor inaccuracies (e.g., wheel slippage, IMU noise).</p> <p>Odometry is the process of estimating the robot's pose (position + orientation) by integrating motion over time. odom -&gt; base_link transform (robot's motion relative to the start)</p> <p>Dead Reckoning</p> <p>Dead reckoning is the process of estimating your current position based on a previous position and motion measurements (like speed and direction).</p> <p>map frame is a fixed, global reference frame in ROS used for global localization \u2014 a known, non-drifting coordinate system representing the world.</p> <p>How to get the map frame</p> <p>To create the map \u2192 odom transform, you need absolute/global measurements. robot_localization has a node for that:</p> <ul> <li>navsat_transform_node (GPS integration).</li> <li>absolute pose measurements (e.g. fiducial markers, AMCL, SLAM outputs).</li> </ul> <p>When robot_localization gets absolute measurements, it computes the correction between your drifting odometry (odom) and the global reference (map). That correction is then published as the map \u2192 odom transform.</p>","tags":["ros","localization"]},{"location":"ROS/ros_world/navigation_and_localization/robot_localization/#how-its-work","title":"How it's work","text":"<p>The robot_localization state estimator nodes accept measurements from an arbitrary number of pose-related sensors:</p> <ul> <li>nav_msgs/Odometry: position, orientation, linear and angular velocity</li> <li>sensor_msgs/Imu: orientation, angular velocity and linear acceleration</li> <li>geometry_msgs/PoseWithCovarianceStamped: position and orientation</li> <li>geometry_msgs/TwistWithCovarianceStamped: linear and angular velocity</li> </ul> <p>Based on these measurements, the state estimators publish the filtered position, orientation and linear and angular velocity (nav_msgs/Odometry) on the /odometry/filtered topic and (if enabled) the filtered acceleration on the /accel/filtered topics.</p>","tags":["ros","localization"]},{"location":"ROS/ros_world/navigation_and_localization/robot_localization/#tf","title":"TF","text":"<p>robot_localization publish one of the tf's - odom -&gt; base_link - map -&gt; odom</p> <p>Usually we run two estimator</p> <ul> <li>odom \u2192 base_link transform, which gets all continuous inputs</li> <li>map \u2192 odom transform, which gets all (both continuous and non-continuous)</li> </ul>","tags":["ros","localization"]},{"location":"ROS/ros_world/navigation_and_localization/robot_localization/#sensor-flow","title":"Sensor flow","text":"<ul> <li>continuous sensors send data in high rate and regularly like imu and wheel odometry (&gt;10hz)</li> <li>none-continuous sensor send data in low rate like gps (&lt;10 hz) and can be expected non-regularly interval.</li> </ul> <p>This very important to the filter how much trust to put on prediction and how aggressively to correct on sensor update</p>","tags":["ros","localization"]},{"location":"ROS/ros_world/navigation_and_localization/robot_localization/#covariance","title":"Covariance","text":"<p>Covariance is the tendency for two variables to vary together, which is a way of being correlated!</p> <p>Variance</p> <p>Variance measures how much a single variable (e.g., sensor noise in one axis) fluctuates around its mean.</p> <p>Covariance quantifies uncertainty and correlation in sensor measurements. In robotics, every sensor reading is accompanied by a covariance matrix, and estimators (like EKF-SLAM, robot_localization) use that matrix to optimally combine noisy sensor data.</p> <p>more</p>","tags":["ros","localization"]},{"location":"ROS/ros_world/navigation_and_localization/robot_localization/#demo","title":"Demo","text":"<p>Use turtlesim to simulate robot_localization package usage The idea for the demo The Ros Robot_localization package</p> <p>Read more</p>","tags":["ros","localization"]},{"location":"ROS/ros_world/navigation_and_localization/robot_localization/#reference","title":"Reference","text":"<ul> <li>The Ros Robot_localization package</li> <li>Sensor Fusion in ROS good resource</li> </ul>","tags":["ros","localization"]},{"location":"ROS/ros_world/navigation_and_localization/robot_localization/covariance/","title":"Covariance","text":"<p>ROS / ros world / navigation and localization / robot localization</p> <ul> <li>Covariance: is the tendency for two variables to vary together, which is a way of being correlated!</li> <li>Variance: measures how much a single variable (e.g., sensor noise in one axis) fluctuates around its mean.</li> <li>Bias:  a systematic error, usually handled separately (e.g., calibration, bias states in the filter).</li> </ul>","tags":["fusing","sensor","covariance"]},{"location":"ROS/ros_world/navigation_and_localization/robot_localization/covariance/#reference","title":"Reference:","text":"","tags":["fusing","sensor","covariance"]},{"location":"ROS/ros_world/navigation_and_localization/robot_localization/covariance/#-the-covariance-matrix-data-science-basics","title":"- The Covariance Matrix : Data Science Basics","text":"","tags":["fusing","sensor","covariance"]},{"location":"ROS/ros_world/navigation_and_localization/robot_localization/covariance/#demo-calculate-the-covariance-for-optical-velocity-estimator","title":"Demo: Calculate the covariance for optical velocity estimator","text":"<p>build the covariance matrix \u03a3 that describes the uncertainty of (vx,vy)</p>","tags":["fusing","sensor","covariance"]},{"location":"ROS/ros_world/navigation_and_localization/robot_localization/covariance/#step1-collect-samples","title":"Step1: Collect samples","text":"<p>Collect estimate velocity for N frames</p>","tags":["fusing","sensor","covariance"]},{"location":"ROS/ros_world/navigation_and_localization/robot_localization/covariance/#step2-compute-the-mean-velocity","title":"Step2: Compute the mean velocity","text":"\\[ \\mu_v =  \\begin{bmatrix} \\mu_{v_x} \\\\ \\mu_{v_y} \\end{bmatrix}=\\frac{1}{N}\\sum_{i=1}^{N} v_i \\]","tags":["fusing","sensor","covariance"]},{"location":"ROS/ros_world/navigation_and_localization/robot_localization/covariance/#step3-compute-the-deviations","title":"Step3: Compute the deviations","text":"<p>For each measurement: \\(\\(d_i = v_i - \\mu_v\\)\\)</p> <p>This gives you how much each velocity reading deviates from the mean.</p>","tags":["fusing","sensor","covariance"]},{"location":"ROS/ros_world/navigation_and_localization/robot_localization/covariance/#step4-build-the-covariance-matrix","title":"Step4: Build the covariance matrix","text":"\\[\\Sigma = \\begin{bmatrix} \\text{Var}(v_x) &amp; \\text{Cov}(v_x,v_y) \\\\ \\text{Cov}(v_y,v_x) &amp; \\text{Var}(v_y) \\end{bmatrix}\\] \\(\\(\\text{Var}(v_x) = \\frac{1}{N-1}\\sum (v_{x,i} - \\mu_{v_x})^2\\)\\) \\(\\(\\text{Var}(v_y) = \\frac{1}{N-1}\\sum (v_{y,i} - \\mu_{v_y})^2\\)\\) \\(\\(\\text{Cov}(v_x,v_y) = \\frac{1}{N-1}\\sum (v_{x,i} - \\mu_{v_x})(v_{y,i} - \\mu_{v_y})\\)\\)","tags":["fusing","sensor","covariance"]},{"location":"ROS/ros_world/navigation_and_localization/robot_localization/covariance/#code-example","title":"Code example","text":"<pre><code>import numpy as np\n\nvelocities = np.array([\n    [1.0, 0.5],\n    [1.1, 0.4],\n    [0.9, 0.6],\n    [1.2, 0.5]\n])\n\n# covariance (rows=variables, cols=samples)\ncov_matrix = np.cov(velocities.T, bias=False)\nprint(cov_matrix)\n</code></pre>","tags":["fusing","sensor","covariance"]},{"location":"ROS/ros_world/navigation_and_localization/robot_localization/localization_demo/","title":"Robot localization using pose and twist messages","text":"<p>Using turtlesim read turtle odometry and create two sensors</p> <p>Both sensors add random noise and set sensor covariance</p> <ul> <li>Position: publish PoseWithCovarianceStamped message</li> <li>Velocity: publish TwistWithCovarianceStamped message</li> </ul> <p>Run two robot_localization nodes:</p> <ul> <li>odom -&gt; base_link (config/ekf_odom.yaml)</li> <li>map -&gt; odom (config/ekf_map.yaml)</li> </ul> <pre><code>turtlesim_loc\n\u251c\u2500\u2500 CMakeLists.txt\n\u251c\u2500\u2500 config\n\u2502   \u251c\u2500\u2500 ekf_map.yaml\n\u2502   \u2514\u2500\u2500 ekf_odom.yaml\n\u251c\u2500\u2500 launch\n\u2502   \u2514\u2500\u2500 loc_sim.launch.py\n\u251c\u2500\u2500 package.xml\n\u251c\u2500\u2500 tmux\n\u2502   \u2514\u2500\u2500 sim.yaml\n\u2514\u2500\u2500 turtlesim_loc\n    \u251c\u2500\u2500 __init__.py\n    \u251c\u2500\u2500 pose_sim.py\n    \u251c\u2500\u2500 sensors\n    \u2502   \u251c\u2500\u2500 __init__.py\n    \u2502   \u251c\u2500\u2500 position.py\n    \u2502   \u2514\u2500\u2500 twist.py\n    \u2514\u2500\u2500 transforms\n        \u251c\u2500\u2500 __init__.py\n        \u2514\u2500\u2500 tf_visual.py\n</code></pre>","tags":["ros","robot localization"]},{"location":"ROS/ros_world/navigation_and_localization/robot_localization/localization_demo/#config","title":"config","text":"map -&gt; odom estimator <pre><code>ekf_filter_node:\n  ros__parameters:\n    use_sim_time: false\n\n    # Sensor topic names\n    twist0: odom_turtle/sensor/twist\n    pose0: pose_turtle/sensor/pose\n\n    # Configuration: which variables to fuse (15 booleans for each topic)\n    # x, y, z, roll, pitch, yaw, vx, vy, vz, vroll, vpitch, vyaw, ax, ay, az\n    twist0_config: [false, false, false,\n                       false, false, false,\n                       true,  true, false,\n                       false, false, true,\n                       false, false, false]\n\n    pose0_config: [true,  true,  false,\n                   false, false, true,\n                   false, false, false,\n                   false, false, false,\n                   false, false, false]\n\n    # Frame settings\n    base_link_frame: base_link\n    odom_frame: odom\n    world_frame: map\n    map_frame: map\n\n    # Output\n    publish_tf: true\n    publish_acceleration: false\n\n    # Frequency\n    frequency: 30.0\n\n    two_d_mode: true\n</code></pre> odom -&gt; base_link estimator <pre><code>ekf_filter_node:\n  ros__parameters:\n    use_sim_time: false\n\n    # Sensor topic names\n    twist0: odom_turtle/sensor/twist\n\n    # Configuration: which variables to fuse (15 booleans for each topic)\n    # x, y, z, roll, pitch, yaw, vx, vy, vz, vroll, vpitch, vyaw, ax, ay, az\n    twist0_config: [false, false, false,\n                       false, false, false,\n                       true,  true, false,\n                       false, false, true,\n                       false, false, false]\n\n\n    # Frame settings\n    base_link_frame: base_link\n    odom_frame: odom\n    world_frame: odom\n    map_frame: map\n\n    # Output\n    publish_tf: true\n    publish_acceleration: false\n\n    # Frequency\n    frequency: 10.0\n\n    two_d_mode: true\n</code></pre> <p>The two `robot_localization\" publish TF</p> <ul> <li>map-&gt; odom</li> <li>odom -&gt; base_link</li> </ul> <p>We use the TF to draw/simulate the fuse turtle</p> fuse turtle visual <pre><code>#!/usr/bin/env python3\n# https://github.com/Kapernikov/ros_robot_localization_tutorial/blob/master/ros-ws/src/robot_localization_demo/src/transforms/transformation_visualization_node.cpp\n\nimport rclpy\nfrom rclpy.node import Node\nfrom turtlesim.srv import Spawn, SetPen, TeleportAbsolute\nfrom tf2_ros import TransformListener, Buffer\nimport tf2_ros\nfrom rclpy.time import Time\nfrom rclpy.duration import Duration\nfrom tf2_geometry_msgs import do_transform_pose\nfrom geometry_msgs.msg import Pose\n\nSRV_SPAWN = \"/spawn\"\nROBOT_NAME = \"filter_turtle\"\nSRV_TELEPORT = f\"/{ROBOT_NAME}/teleport_absolute\"\n\nclass MyNode(Node):\n    def __init__(self):\n        node_name=\"minimal\"\n        super().__init__(node_name)\n        self.__last_call = 0\n        self.__update_counter = 0\n        self.__spawn_client = self.create_client(Spawn, SRV_SPAWN)\n        while not self.__spawn_client.wait_for_service(timeout_sec=1.0):\n            self.get_logger().warn(f\"Service not available. Retrying... \")\n\n        self.__spawn()\n        self.__teleport_client = self.create_client(TeleportAbsolute, SRV_TELEPORT)\n        while not self.__teleport_client.wait_for_service(timeout_sec=3.0):\n            self.get_logger().warn(f\"Service teleport not available. Retrying... \")\n\n        # Create a buffer and a listener\n        self.tf_buffer = Buffer()\n        self.tf_listener = TransformListener(self.tf_buffer, self)\n\n        # Timer to periodically lookup transform\n        self.timer = self.create_timer(1.0, self.__timer_callback)\n\n    def __spawn(self):\n        request = Spawn.Request()\n        request.name = ROBOT_NAME\n        request.x = 5.55\n        request.y = 5.55\n        future = self.__spawn_client.call_async(request)\n        rclpy.spin_until_future_complete(self, future)\n        if future.result() is not None:\n            self.get_logger().info(f\"Turtle spawned successfully: {future.result()}\")\n        else:\n            self.get_logger().error(f\"Failed to spawn turtle: {future.exception()}\")\n\n        SRV_SET_PEN = f\"/{ROBOT_NAME}/set_pen\"\n        set_pen_client = self.create_client(SetPen, SRV_SET_PEN)\n        while not set_pen_client.wait_for_service(timeout_sec=1.0):\n            self.get_logger().warn(f\"Service set_pen not available. Retrying... \")\n\n        request = SetPen.Request()\n        request.r = 0\n        request.g = 255 \n        request.b = 0\n        request.width = 3\n        request.off = 0\n        future = set_pen_client.call_async(request)\n        rclpy.spin_until_future_complete(self, future)\n        if future.result() is not None:\n            self.get_logger().info(f\"Turtle 'set pen' successfully: {future.result()}\")\n        else:\n            self.get_logger().error(f\"Failed to 'set pen' turtle: {future.exception()}\")\n\n\n    def __timer_callback(self):\n        try:\n            trans = self.tf_buffer.lookup_transform(\n                target_frame='map',\n                source_frame='base_link',\n                time=Time(),  # \"now\"\n                timeout=Duration(seconds=1.0)\n            )\n            self.get_logger().info(\n                f\"Transform: Translation = ({trans.transform.translation.x:.2f}, {trans.transform.translation.y:.2f}, {trans.transform.translation.z:.2f})\"\n            )\n        except (tf2_ros.LookupException, tf2_ros.ConnectivityException, tf2_ros.ExtrapolationException) as e:\n            self.get_logger().warn(f'Could not transform: {e}')\n\n\n        pose = Pose()\n        new_pose = do_transform_pose(pose, trans)\n        request = TeleportAbsolute.Request()\n        request.x = new_pose.position.x\n        request.y = new_pose.position.y\n        request.theta = 0.0\n        future = self.__teleport_client.call_async(request)\n        future.add_done_callback(self.__teleport_response_handler)\n\n    def __teleport_response_handler(self, future):\n        pass\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = MyNode()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n</code></pre>","tags":["ros","robot localization"]},{"location":"ROS/ros_world/navigation_and_localization/robot_localization/localization_demo/#launch-demo","title":"Launch demo","text":"<ul> <li>terminal 1: launch localization and all sensors</li> <li>terminal 2: run teleoop</li> <li>termianl 3: run fuse turtle visual</li> </ul> launch  <pre><code>import os\n\nfrom ament_index_python.packages import get_package_share_directory\nfrom launch import LaunchDescription\nfrom launch.actions import DeclareLaunchArgument\nfrom launch.actions import IncludeLaunchDescription\nfrom launch.launch_description_sources import PythonLaunchDescriptionSource\nfrom launch.substitutions import LaunchConfiguration\nfrom launch_ros.actions import Node\nfrom launch.substitutions import PathJoinSubstitution\n\nPKG = \"turtlesim_loc\"\n\ndef generate_launch_description():\n    ld = LaunchDescription()\n\n    ekf_config_odom = PathJoinSubstitution([\n        get_package_share_directory(PKG),\n        'config',\n        'ekf_odom.yaml'\n    ])\n\n    ekf_config_map = PathJoinSubstitution([\n        get_package_share_directory(PKG),\n        'config',\n        'ekf_map.yaml'\n    ])\n\n    turtle = Node(\n        package='turtlesim',\n        executable='turtlesim_node',\n        output='screen')\n\n    position_sensor_emulation = Node(\n        package='turtlesim_loc',\n        executable='position.py',\n        output='screen')\n\n    twist_sensor_emulation = Node(\n        package='turtlesim_loc',\n        executable='twist.py',\n        output='screen')\n\n    teleop = Node(\n        package='turtlesim',\n        executable='turtle_teleop_key',\n        output='screen')\n    # ros2 run robot_localization ekf_node --ros-args --params-file /workspace/src/localiztion_demo/turtlesim_loc/config/ekf.yaml --log-level info\n    ekf_node_odom = Node(\n            package='robot_localization',\n            executable='ekf_node',\n            name='ekf_filter_node',\n            output='screen',\n            parameters=[ekf_config_odom],\n            remappings=[\n                ('odometry/filtered', 'odometry/filtered_odom')\n            ]\n        )\n\n    ekf_node_map = Node(\n            package='robot_localization',\n            executable='ekf_node',\n            name='ekf_filter_node',\n            output='screen',\n            parameters=[ekf_config_map],\n            remappings=[\n                ('odometry/filtered', 'odometry/filtered_map')\n            ]\n        )\n\n    ld.add_action(turtle)\n    ld.add_action(position_sensor_emulation)\n    ld.add_action(twist_sensor_emulation)\n    # ld.add_action(teleop)\n    ld.add_action(ekf_node_map)\n    ld.add_action(ekf_node_odom)\n    return ld\n</code></pre> terminal 1<pre><code>\n</code></pre> terminal 2<pre><code>\n</code></pre> terminal 3<pre><code>\n</code></pre>","tags":["ros","robot localization"]},{"location":"ROS/ros_world/parameters/","title":"ROS2 Parameters","text":"<p>ROS / ros world</p> <p>Using ROS2 parameter file from cli and launch file Use multiple parameters files to demonstrate parameter override</p>","tags":["ros2","parameters"]},{"location":"ROS/ros_world/parameters/#parameter-file","title":"parameter file","text":"","tags":["ros2","parameters"]},{"location":"ROS/ros_world/parameters/#demo","title":"Demo:","text":"<p>Simple python Node with multiple parameters</p> Node <pre><code>import rclpy\nfrom rclpy.node import Node\n\nPARAM1 = \"param1\"\nPARAM2 = \"param2\"\n\nclass MyNode(Node):\n    def __init__(self):\n        node_name=\"minimal\"\n        super().__init__(node_name)\n        p1 = self.declare_parameter(PARAM1, 1)\n        p2 = self.declare_parameter(PARAM2, 2)\n        self.get_logger().info(f\"P1: {p1.value}\")\n        self.get_logger().info(f\"P1: {p2.value}\")\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = MyNode()\n    rclpy.spin_once(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n</code></pre>","tags":["ros2","parameters"]},{"location":"ROS/ros_world/parameters/#param-files","title":"Param files","text":"params1.yaml<pre><code>minimal:\n  ros__parameters:\n    param1: 10\n    param2: 20\n</code></pre> params2.yaml<pre><code>/**:\n  ros__parameters:\n    param1: 100\n    param2: 200\n</code></pre> <p>wildcard</p> <p>The <code>params2.yaml</code> use wildcard as node name matching</p>","tags":["ros2","parameters"]},{"location":"ROS/ros_world/parameters/#usage","title":"usage","text":"<p>wildcard</p> <p>Wildcards can be used for node names and namespaces. - <code>*</code>  matches a single token delimited by slashes (/).  - <code>**</code> matches zero or more tokens delimited by slashes.  - Partial matches are not allowed (e.g. foo*).</p> <pre><code>/**:\n    ros__parameters:\n        wildcard_full: \"Full wildcard for any namespaces and any node names\"\n\n/**/parameter_blackboard:\n    ros__parameters:\n        wildcard_namespace: \"Wildcard for a specific node name under any namespace\"\n\n/*:\n    ros__parameters:\n        wildcard_nodename_root_namespace: \"Wildcard for any node names, but only in root namespace\"\n</code></pre> use default params value declare in code<pre><code># run node without load any parameter file\nros2 run ros_py param_demo.py \n[INFO] [1740517785.377374134] [minimal]: P1: 1\n[INFO] [1740517785.377601145] [minimal]: P1: 2\n</code></pre> load params from file<pre><code># Run node with parameter file\nros2 run ros_py param_demo.py --ros-args --params-file params1.yaml\n[INFO] [1740517874.809880531] [minimal]: P1: 10\n[INFO] [1740517874.810112715] [minimal]: P1: 20\n</code></pre>","tags":["ros2","parameters"]},{"location":"ROS/ros_world/parameters/#load-multiple-params-file","title":"load multiple params file","text":"<p>wildcard matching</p> <p>params2.yaml has global match <code>/**</code></p> load params from multiple files<pre><code>ros2 run ros_py param_demo.py \\\n--ros-args \\\n--params-file params1.yaml \\\n--params-file params2.yaml\n[INFO] [1740518709.532923265] [minimal]: P1: 100\n[INFO] [1740518709.533163666] [minimal]: P1: 200\n</code></pre>","tags":["ros2","parameters"]},{"location":"ROS/ros_world/parameters/#load-multi-parameter-file-from-launch-file","title":"Load multi parameter file from launch file","text":"<pre><code>from launch import LaunchDescription\nfrom launch_ros.actions import Node\nfrom ament_index_python.packages import get_package_share_directory\nfrom pathlib import Path\n\ndef generate_launch_description():\n\n    param_file = Path(get_package_share_directory('ros_py')).joinpath('config', 'param_demo.yaml')\n    param_file_arm = Path(get_package_share_directory('ros_py')).joinpath('config', 'param_demo.arm.yaml')\n\n    param_files = [param_file, param_file_arm]\n\n    return LaunchDescription([\n        Node(\n            package='ros_py',\n            executable='param_demo.py',\n            name='param_demo',\n            parameters=param_files,\n        )\n    ])\n</code></pre> <pre><code>from launch import LaunchDescription\nfrom launch_ros.actions import Node\nfrom ament_index_python.packages import get_package_share_directory\nfrom pathlib import Path\nimport os\n\ndef generate_launch_description():\n\n    use_arm_config = os.environ.get('USE_ARM_CONFIG', 'false').lower() == 'true'\n    param_file = Path(get_package_share_directory('ros_py')).joinpath('config', 'param_demo.yaml')\n    param_file_arm = Path(get_package_share_directory('ros_py')).joinpath('config', 'param_demo.arm.yaml')\n\n    param_files = [param_file]\n    if use_arm_config:\n        param_files.append(param_file_arm)\n\n    return LaunchDescription([\n        Node(\n            package='ros_py',\n            executable='param_demo.py',\n            name='param_demo',\n            parameters=param_files,\n        )\n    ])\n</code></pre> usage<pre><code>USE_ARM_CONFIG=true ros2 launch ros_py param_demo_simple.launch.py\nUSE_ARM_CONFIG=false ros2 launch ros_py param_demo_simple.launch.py\n\n# or using export\n</code></pre>","tags":["ros2","parameters"]},{"location":"ROS/ros_world/parameters/#reference","title":"Reference","text":"<ul> <li>Passing ROS arguments to nodes via the command-line</li> <li>Using the ros2 param command-line tool</li> </ul>","tags":["ros2","parameters"]},{"location":"ROS/ros_world/perception/","title":"Perception","text":"<p>CV-Bridge</p> <p>TBD</p> <p>TBD</p> <p></p> <p></p> <p>\\( R_{\\mathbf{C}\\leftarrow\\mathbf{G}} = \\begin{bmatrix} 0 &amp; -1 &amp; 0\\\\ 0 &amp; 0 &amp; -1\\\\ 1 &amp; 0 &amp; 0 \\end{bmatrix} \\)</p>","tags":["ros","cvbridge","cv-bridge"]},{"location":"ROS/ros_world/perception/#intrinsic-matrix","title":"intrinsic matrix","text":"<p>The intrinsic matrix K converts normalized camera coordinates (xn,yn) (where xn=X/Z,\u2005\u200ayn=Y/Zxn\u200b=X/Z,yn\u200b=Y/Z) into pixel coordinates (u,v):</p> <p>World frame: a global fixed reference (e.g., origin at some arbitrary place in the scene). Camera frame: origin is at the camera center, axes aligned with the camera\u2019s orientation.</p> <p></p> <pre><code>Pcamera\u200b=Rcw\u200b\u22c5Pworld\u200b+tcw\n</code></pre>","tags":["ros","cvbridge","cv-bridge"]},{"location":"ROS/ros_world/perception/#camera-pose-in-world-coordinate","title":"Camera Pose in world Coordinate","text":"<p>Suppose we know the camera pose in the world frame as:</p> <p>Rwc: rotation from camera to world (33 rotation matrix) twc: translation camera origin position in world coordinates (31 translation vector)</p>","tags":["ros","cvbridge","cv-bridge"]},{"location":"ROS/ros_world/perception/#invert-the-pose","title":"Invert the Pose","text":"<p>We want world \u2192 camera, so we take the inverse of the camera pose:</p> <p>$ R_{cw} = R_{wc}^T $</p> <p>because rotation matrices are orthogonal: \\(R^{-1}=R^{T}\\)</p>","tags":["ros","cvbridge","cv-bridge"]},{"location":"ROS/ros_world/perception/#apply-the-transformation","title":"Apply the Transformation","text":"<p>Given a point in world coordinate $\\mathbf{P}_w = \\begin{bmatrix} X_w \\ Y_w \\ Z_w \\end{bmatrix} $</p> <p>Translate: subtract the camera\u2019s world position</p> <p>Translate</p> <p>negative camera to world \\(- t_{wc}\\)</p> <p>$ P_{\\text{shifted}} = P_{w} - t_{wc} $</p> <p>Rotate: apply the inverse rotation to align axes with camera frame</p> <p>The point in camera frame</p> <p>$ P_c = R_{wc}^T \\cdot P_{\\text{shifted}} $</p>","tags":["ros","cvbridge","cv-bridge"]},{"location":"ROS/ros_world/perception/cv_bridge/","title":"Index","text":"","tags":["cv_bridge","ros","opencv"]},{"location":"ROS/ros_world/perception/cv_bridge/#cv-bridge","title":"cv bridge","text":"<p>Build</p> <p>TBD</p> <p>TBD</p> install<pre><code>sudo apt install ros-jazzy-cv-bridge ros-jazzy-image-transport python3-opencv\n</code></pre> simple demo<pre><code>import rclpy\nfrom rclpy.node import Node\n\nfrom sensor_msgs.msg import Image\nfrom cv_bridge import CvBridge\nimport cv2\n\nclass ImageViewerNode(Node):\n    def __init__(self):\n        super().__init__('image_viewer_node')\n\n        self.bridge = CvBridge()\n\n        self.subscription = self.create_subscription(\n            Image,\n            '/camera/image_raw',  # Change to your actual image topic\n            self.image_callback,\n            10\n        )\n\n    def image_callback(self, msg):\n        try:\n            # Convert to OpenCV image\n            cv_image = self.bridge.imgmsg_to_cv2(msg, desired_encoding='bgr8')\n\n            # Show image using OpenCV\n            cv2.imshow('Camera Image', cv_image)\n            cv2.waitKey(1)\n        except Exception as e:\n            self.get_logger().error(f'Failed to convert image: {e}')\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = ImageViewerNode()\n\n    try:\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        node.destroy_node()\n        rclpy.shutdown()\n        cv2.destroyAllWindows()\n\nif __name__ == '__main__':\n    main()\n</code></pre>","tags":["cv_bridge","ros","opencv"]},{"location":"ROS/ros_world/perception/cv_bridge/cv_bridge_build/","title":"Build CV_Bridge for custom opencv build","text":"<p>Build opencv 4.10 with cuda support Use Docker to create build image</p> <ul> <li>clone github</li> </ul>","tags":["opencv","cv_bridge","ros","custom build"]},{"location":"ROS/ros_world/perception/cv_bridge/cv_bridge_build/#build-on-docker","title":"Build on docker","text":"<ul> <li>docker base cuda devel with cudnn <code>FROM nvidia/cuda:12.6.0-cudnn-devel-ubuntu22.04</code> </li> <li>Install dependencies</li> <li>Run colcon</li> </ul> <pre><code>sudo apt install\n    libboost-all-dev \\\n    libboost-python-dev \\\n    python3-dev\n</code></pre> colcon<pre><code>colcon build --packages-up-to cv_bridge \\\n--cmake-args \\\n  -DCUDA_TOOLKIT_ROOT_DIR=/usr/local/cuda \\\n  -DCMAKE_INCLUDE_PATH=/usr/include/opencv4/\n</code></pre>","tags":["opencv","cv_bridge","ros","custom build"]},{"location":"ROS/ros_world/perception/cv_bridge/cv_bridge_build/#pack-to-debian","title":"Pack to debian","text":"","tags":["opencv","cv_bridge","ros","custom build"]},{"location":"ROS/ros_world/perception/cv_bridge/cv_bridge_build/#patch-files","title":"patch files","text":"patch_package.xml<pre><code>#/bin/bash\n\n# comment libopencv-dev, python3-opencv\nsed -i 's|^\\([[:space:]]*\\)&lt;depend&gt;libopencv-dev&lt;/depend&gt;|\\1&lt;!-- &lt;depend&gt;libopencv-dev&lt;/depend&gt; --&gt;|' package.xml\nsed -i 's|^\\([[:space:]]*\\)&lt;depend&gt;python3-opencv&lt;/depend&gt;|\\1&lt;!-- &lt;depend&gt;python3-opencv&lt;/depend&gt; --&gt;|' package.xml\n</code></pre> patch_rules.sh<pre><code>#!/bin/bash\nset -e\n# remove current override_dh_shlibdeps\nsed -i '/^override_dh_shlibdeps:/,/^$/d' /workspace/cv_bridge/debian/rules\n\n\n\ncat &lt;&lt;'EOF' &gt;&gt; debian/rules\n\noverride_dh_shlibdeps:\n    dh_shlibdeps --dpkg-shlibdeps-params=--ignore-missing-info\n\n\noverride_dh_builddeb:\n    dh_builddeb --destdir=/workspace/debs\nEOF\n\necho \"[\u2705] Successfully patched debian/rules\"\n</code></pre> patch_compat<pre><code>cat &lt;&lt;'EOF' &gt; debian/compat\n10\nEOF\n</code></pre> add entry to changelog<pre><code>DEBEMAIL=\"you@example.com\" DEBFULLNAME=\"Your Name\" dch \\\n  --newversion 3.2.1-1jammy-cv410 \\\n  --distribution jammy \\\n  --urgency high \\\n  \"build against opencv4.10\"\n</code></pre> <p>dch command</p> <pre><code>sudo apt install devscripts\n</code></pre>","tags":["opencv","cv_bridge","ros","custom build"]},{"location":"ROS/ros_world/ros_control/","title":"ROS2_Control","text":"<p>ros2_control is a framework for robot hardware abstraction and controller management </p> <p>Hardware interface Abstracts real or simulated robot hardware and expose hardware functionality in a standard way:</p> <ul> <li>state interface (read-only) feedback from hardware</li> <li>command interface (Read/Write) : command to the hardware</li> </ul> <p>ros2 control tutorials</p> <p>TBD</p> <p>GPIO</p>","tags":["ros","control","ros2_control"]},{"location":"ROS/ros_world/ros_control/#install","title":"Install","text":"<pre><code>sudo apt install ros-humble-ros2-control\nsudo apt install ros-humble-ros2-controllers\nsudo apt install ros-humble-control-msgs\n# gazebo classic \nsudo apt install ros-humble-gazebo-ros2-control\n</code></pre> <p>ROS2_control abstract controller from hardware interfaces Hardware interface expose hardware functionality in a standard way: - state interface (read-only) feedback from hardware - command interface (Read/Write) : command to the hardware</p> <p>ros2_control Concepts &amp; Simulation</p>","tags":["ros","control","ros2_control"]},{"location":"ROS/ros_world/ros_control/#controller-manager","title":"Controller Manager","text":"","tags":["ros","control","ros2_control"]},{"location":"ROS/ros_world/ros_control/#resource-manager","title":"Resource Manager","text":"","tags":["ros","control","ros2_control"]},{"location":"ROS/ros_world/ros_control/#hardware-interface","title":"Hardware interface","text":"","tags":["ros","control","ros2_control"]},{"location":"ROS/ros_world/ros_control/#lifecycle-state","title":"Lifecycle State","text":"<p><pre><code>stateDiagram-v2\n    [*] --&gt; Unconfigured: on_init\n    Unconfigured --&gt; Inactive: on_configure\n    Inactive --&gt; Active: on_activate()\n    Active --&gt; Inactive: on_deactivate()\n    Inactive --&gt; Unconfigured: on_cleanup()\n    Unconfigured --&gt; [*]: on_shutdown()\n\n    Active --&gt; Active: read()      write()\n\n</code></pre> on_init: read parameters on_configure: establish comms on_activate: engage actuators on_deactivate: disengage actuators on_cleanup: disconnect comms on_shutdown: graceful shutdown</p>","tags":["ros","control","ros2_control"]},{"location":"ROS/ros_world/ros_control/#to-read-and-watch","title":"To Read and Watch","text":"<ul> <li>must watch</li> <li>The construct - ROS2 Control Framework </li> <li>You can use ANY hardware with ros2_control </li> <li>ros2_control Concepts &amp; Simulation</li> <li>ros2_control_custom_hardware_interface</li> <li>Using I2C to control PWM | ROS Control with the JetBot Part 1 <ul> <li>ROS2 Control with the JetBot Part 1: Using I2C to control PWM</li> </ul> </li> </ul>","tags":["ros","control","ros2_control"]},{"location":"ROS/ros_world/ros_control/gpio/","title":"GPIO Controllers","text":"<p>This is a collection of controllers for hardware interfaces of type GPIO more</p>","tags":["ros","gpio"]},{"location":"ROS/ros_world/ros_control/gpio/rpi/","title":"Using GPIO with ros2_control","text":"","tags":["ros2","ros_control","raspberry pi","rpi"]},{"location":"ROS/ros_world/ros_control/gpio/rpi/#lab","title":"LAB","text":"<ul> <li>RPI 5</li> <li>ubuntu 24.04</li> <li>ROS Jazzy</li> <li>VSCode remote</li> </ul>","tags":["ros2","ros_control","raspberry pi","rpi"]},{"location":"ROS/ros_world/ros_control/gpio/rpi/#gpiod","title":"gpiod","text":"<pre><code>sudo apt install gpiod\n</code></pre> <p>gpiod api changed</p> <p>From version 2.x the api changed</p> <p>my rpi prompt</p> <pre><code>if [ -n \"$SSH_CONNECTION\" ]; then\n    if [ \"$EUID\" -eq 0 ]; then\n        PS1='\ud83c\udf53\\[\\e[1;41m\\][ROOT SSH \\u@\\h]\\[\\e[0m\\] \\w # '\n    else\n        PS1='\ud83c\udf53\\[\\e[1;31m\\][SSH \\u@\\h]\\[\\e[0m\\] \\w \\$ '\n    fi\nfi\n</code></pre>","tags":["ros2","ros_control","raspberry pi","rpi"]},{"location":"ROS/ros_world/ros_control/gpio/rpi/#gpiodetect","title":"gpiodetect","text":"","tags":["ros2","ros_control","raspberry pi","rpi"]},{"location":"ROS/ros_world/ros_control/gpio/rpi/#gpioinfo","title":"gpioinfo","text":"<pre><code># v2\ngpioinfo -c gpiochip0\n#v1\ngpioinfo gpiochip4\n</code></pre>","tags":["ros2","ros_control","raspberry pi","rpi"]},{"location":"ROS/ros_world/ros_control/gpio/rpi/#gpioset-gpioget","title":"gpioset/ gpioget","text":"<pre><code>#v2\ngpioset -c gpiochip0 GPIO17=1\ngpioset -c gpiochip0 17=1\n#v1\n# offset only\ngpioset gpiochip4 17=1\n\n#v2\ngpioget -c gpiochip0 GPIO17\ngpioget -c gpiochip0 17\n#v1\ngpioget gpiochip4 17\n</code></pre>","tags":["ros2","ros_control","raspberry pi","rpi"]},{"location":"ROS/ros_world/ros_control/gpio/rpi/#ros2","title":"ROS2","text":"<p>official install doc</p>","tags":["ros2","ros_control","raspberry pi","rpi"]},{"location":"ROS/ros_world/ros_control/gpio/rpi/#ros2_control","title":"ROS2_control","text":"<pre><code>sudo apt install ros-jazzy-ros2-control\nsudo apt install ros-jazzy-ros2-controllers\n</code></pre>","tags":["ros2","ros_control","raspberry pi","rpi"]},{"location":"ROS/ros_world/ros_control/tutorials/","title":"ros2 control tutorials","text":"<p>Using Gazebo to simulate type of control on one joint simple robot. Show yaml control configuration and ros2_control tag for each type.</p> <p>The ros2_control declare what the robot can do, and expose it as command and state The Controller YAML declare which controller to load and use by the controller_manager The controller expose ROS messages to command and get states</p> <p>position controller</p> <p>velocity controller</p> <p>Effort Control</p> <p>imu broadcaster</p> <ul> <li>ros2_control guide</li> <li>ROS2 Jazzy Tutorial: ros2_control in Gazebo - Control Simulation from Scratch in Gazebo!</li> </ul>","tags":["ros","ros2_control","tutorial"]},{"location":"ROS/ros_world/ros_control/tutorials/effort_control/","title":"ROS2 Control: effort control","text":"<p>In ROS 2 Control, the effort_controllers/JointGroupEffortController is used to send effort (torque/force) commands to joints</p>","tags":["ros","control","ros2_control","effort"]},{"location":"ROS/ros_world/ros_control/tutorials/effort_control/#gazebo-simulation","title":"Gazebo simulation","text":"xacro load gazebo control plugin and set ros2_control tag<pre><code>&lt;robot xmlns:xacro=\"http://www.ros.org/wiki/xacro\" &gt;\n    &lt;gazebo&gt;\n        &lt;plugin filename=\"gz_ros2_control-system\" name=\"gz_ros2_control::GazeboSimROS2ControlPlugin\"&gt;\n            &lt;parameters&gt;\n                $(find tutorial_bringup)/config/effort_controllers.yaml\n            &lt;/parameters&gt;\n        &lt;/plugin&gt;\n\n    &lt;/gazebo&gt;\n\n    &lt;ros2_control name=\"robot\" type=\"system\"&gt;\n        &lt;hardware&gt;\n            &lt;plugin&gt;gz_ros2_control/GazeboSimSystem&lt;/plugin&gt;\n        &lt;/hardware&gt;\n\n        &lt;joint name=\"first_joint\"&gt;\n            &lt;command_interface name=\"effort\"&gt;\n                &lt;param name=\"min\"&gt;-10&lt;/param&gt;\n                &lt;param name=\"max\"&gt;10&lt;/param&gt;\n            &lt;/command_interface&gt;\n\n            &lt;state_interface name=\"position\" /&gt;\n            &lt;state_interface name=\"velocity\" /&gt;\n        &lt;/joint&gt;\n\n    &lt;/ros2_control&gt;\n&lt;/robot&gt;\n</code></pre> controllers yaml file <pre><code>controller_manager:\n  ros__parameters:\n    update_rate: 10\n\n\n    joint_state_broadcaster:\n      type: joint_state_broadcaster/JointStateBroadcaster\n\n    effort_controller:\n      type: effort_controllers/JointGroupEffortController\n\n\neffort_controller:\n  ros__parameters:\n    joints:\n      - first_joint\n</code></pre> launch file <pre><code>import os\n\nfrom ament_index_python.packages import get_package_share_directory\nfrom launch import LaunchDescription\nfrom launch.actions import IncludeLaunchDescription\nfrom launch.substitutions import PathJoinSubstitution\nfrom launch.launch_description_sources import PythonLaunchDescriptionSource\nfrom launch_ros.actions import Node\nimport xacro\n\nPKG_BRINGUP = \"tutorial_bringup\"\nPKG_DESCRIPTION = \"tutorial_description\"\nROBOT = \"robot.xacro\"\nCONFIG = \"config\"\nURDF = \"urdf\"\nBRIDGE_CONFIG = \"gz_bridge.yaml\"\n\ndef generate_launch_description():\n    ld = LaunchDescription()\n\n    pkg_path = os.path.join(get_package_share_directory(PKG_DESCRIPTION))\n    xacro_file = os.path.join(pkg_path, URDF, ROBOT)\n    robot_description = xacro.process_file(xacro_file).toxml()\n\n    node_robot_state_publisher = Node(\n        package=\"robot_state_publisher\",\n        executable=\"robot_state_publisher\",\n        output=\"screen\",\n        parameters=[{\"robot_description\": robot_description, \"use_sim_time\": True}],\n    )\n\n    gazebo = IncludeLaunchDescription(\n        PythonLaunchDescriptionSource(\n            [\n                PathJoinSubstitution(\n                    [\n                        get_package_share_directory(\"ros_gz_sim\"),\n                        \"launch\",\n                        \"gz_sim.launch.py\",\n                    ]\n                )\n            ]\n        ),\n        launch_arguments=[(\"gz_args\", \" -r -v 3 my_world.sdf\")],\n    )\n\n    gz_spawn_entity = Node(\n        package=\"ros_gz_sim\",\n        executable=\"create\",\n        output=\"screen\",\n        arguments=[\"-name\", \"robot\", \"-topic\", \"/robot_description\"],\n    )\n\n\n    joint_state_broadcaster_spawner = Node(\n        package=\"controller_manager\",\n        executable=\"spawner\",\n        arguments=[\"joint_state_broadcaster\"],\n        output=\"screen\",\n    )\n\n    control_spawner = Node(\n        package=\"controller_manager\",\n        executable=\"spawner\",\n        arguments=[\"effort_controller\"],\n        output=\"screen\",\n    )\n\n    gazebo_bridge = Node(\n        package=\"ros_gz_bridge\",\n        executable=\"parameter_bridge\",\n        name=\"parameter_bridge\",\n        output=\"screen\",\n        arguments=[\"/clock@rosgraph_msgs/msg/Clock[gz.msgs.Clock\"],\n    )\n\n\n    ld.add_action(node_robot_state_publisher)\n    ld.add_action(gazebo)\n    ld.add_action(gz_spawn_entity)\n    ld.add_action(gazebo_bridge)\n    ld.add_action(control_spawner)\n    ld.add_action(joint_state_broadcaster_spawner)\n\n    return ld\n</code></pre>","tags":["ros","control","ros2_control","effort"]},{"location":"ROS/ros_world/ros_control/tutorials/effort_control/#usage","title":"Usage","text":"<pre><code>ros2 topic pub -1 /effort_controller/commands std_msgs/msg/Float64MultiArray \"{ data: [-2.0] }\"\n</code></pre>","tags":["ros","control","ros2_control","effort"]},{"location":"ROS/ros_world/ros_control/tutorials/imu_broadcaster/","title":"ROS2 Control imu broadcaster","text":"<p>ROS / ros world / ros control / tutorials</p> <p>Use ros2_control to broadcast imu sensor</p>","tags":["ros","ros2_control","imu","imu_broadcaster"]},{"location":"ROS/ros_world/ros_control/tutorials/imu_broadcaster/#gazebo-simulation","title":"Gazebo simulation","text":"urdf/gazebo.xacro<pre><code>&lt;robot xmlns:xacro=\"http://www.ros.org/wiki/xacro\"&gt;\n    &lt;gazebo&gt;\n        &lt;plugin filename=\"gz_ros2_control-system\" name=\"gz_ros2_control::GazeboSimROS2ControlPlugin\"&gt;\n            &lt;parameters&gt;\n                $(find tutorial_bringup)/config/robot_controller.yaml\n            &lt;/parameters&gt;\n        &lt;/plugin&gt;\n\n    &lt;/gazebo&gt;\n\n    &lt;gazebo reference=\"second_link\"&gt;\n        &lt;sensor name=\"link2_imu\" type=\"imu\"&gt;\n            &lt;always_on&gt;1&lt;/always_on&gt;\n            &lt;update_rate&gt;50&lt;/update_rate&gt;\n            &lt;visualize&gt;true&lt;/visualize&gt;\n            &lt;topic&gt;imu-control&lt;/topic&gt;\n            &lt;enable_metrics&gt;true&lt;/enable_metrics&gt;\n        &lt;/sensor&gt;\n    &lt;/gazebo&gt;\n&lt;/robot&gt;\n</code></pre> config/controllers.yaml<pre><code>controller_manager:\n  ros__parameters:\n    update_rate: 10\n\n    imu_broadcaster:\n      type: imu_sensor_broadcaster/IMUSensorBroadcaster\n\nimu_broadcaster:\n  ros__parameters:\n\n    sensor_name: link2_imu\n    frame_id: second_link\n</code></pre> load controller<pre><code>ros2 control load_controller --set-state active imu_broadcaster\n</code></pre> launch<pre><code>imu_broadcaster_spawner = Node(\n        package=\"controller_manager\",\n        executable=\"spawner\",\n        arguments=[\"imu_broadcaster\"],\n        output=\"screen\",\n    )\n</code></pre>","tags":["ros","ros2_control","imu","imu_broadcaster"]},{"location":"ROS/ros_world/ros_control/tutorials/imu_broadcaster/#reference","title":"Reference","text":"<ul> <li>mpu6050-ros2-control</li> </ul>","tags":["ros","ros2_control","imu","imu_broadcaster"]},{"location":"ROS/ros_world/ros_control/tutorials/position_control/","title":"ROS2 Control: Position control","text":"<p>ROS2 control docs</p>","tags":["ros","control","ros2_control","position"]},{"location":"ROS/ros_world/ros_control/tutorials/position_control/#gazebo-simulation","title":"Gazebo simulation","text":"<p>controller manager</p> <p>The controller manager loaded by gazebo</p> urdf/xacro<pre><code>&lt;robot xmlns:xacro=\"http://www.ros.org/wiki/xacro\"&gt;\n    &lt;gazebo&gt;\n        &lt;plugin filename=\"gz_ros2_control-system\" name=\"gz_ros2_control::GazeboSimROS2ControlPlugin\"&gt;\n            &lt;parameters&gt;\n                $(find tutorial_bringup)/config/robot_controller.yaml\n            &lt;/parameters&gt;\n        &lt;/plugin&gt;\n    &lt;/gazebo&gt;\n&lt;/robot&gt;\n</code></pre> <p>Once gazebo launch it's load the control plugin and parse the <code>&lt;ros2_control&gt;</code> block.</p> <ul> <li>Init the hardware interface</li> <li>Launch the controller manager</li> </ul> xacro load gazebo control plugin and set ros2_control tag<pre><code>&lt;robot xmlns:xacro=\"http://www.ros.org/wiki/xacro\" &gt;\n    &lt;gazebo&gt;\n        &lt;plugin filename=\"gz_ros2_control-system\" name=\"gz_ros2_control::GazeboSimROS2ControlPlugin\"&gt;\n            &lt;parameters&gt;\n                $(find tutorial_bringup)/config/position_controllers.yaml\n            &lt;/parameters&gt;\n        &lt;/plugin&gt;\n\n    &lt;/gazebo&gt;\n\n    &lt;ros2_control name=\"robot\" type=\"system\"&gt;\n        &lt;hardware&gt;\n            &lt;plugin&gt;gz_ros2_control/GazeboSimSystem&lt;/plugin&gt;\n        &lt;/hardware&gt;\n\n        &lt;joint name=\"first_joint\"&gt;\n            &lt;command_interface name=\"position\"&gt;\n                &lt;param name=\"min\"&gt;-1.571&lt;/param&gt;\n                &lt;param name=\"max\"&gt;1.571&lt;/param&gt;\n            &lt;/command_interface&gt;\n\n            &lt;state_interface name=\"position\" /&gt;\n        &lt;/joint&gt;\n\n    &lt;/ros2_control&gt;\n&lt;/robot&gt;\n</code></pre> controllers yaml file <pre><code>controller_manager:\n  ros__parameters:\n    update_rate: 10\n\n\n    joint_state_broadcaster:\n      type: joint_state_broadcaster/JointStateBroadcaster\n\n    position_controller:\n      type: position_controllers/JointGroupPositionController\n\n\nposition_controller:\n  ros__parameters:\n    joints:\n      - first_joint\n</code></pre> launch file <pre><code>import os\n\nfrom ament_index_python.packages import get_package_share_directory\nfrom launch import LaunchDescription\nfrom launch.actions import DeclareLaunchArgument, IncludeLaunchDescription\nfrom launch.substitutions import PathJoinSubstitution\nfrom launch.launch_description_sources import PythonLaunchDescriptionSource\nfrom launch_ros.actions import Node\nfrom launch.substitutions import LaunchConfiguration, Command\nfrom launch_ros.parameter_descriptions import ParameterValue\nimport xacro\nfrom pathlib import Path\n\nPKG_BRINGUP = \"tutorial_bringup\"\nPKG_DESCRIPTION = \"tutorial_description\"\nROBOT = \"robot.xacro\"\nCONFIG = \"config\"\nURDF = \"urdf\"\nBRIDGE_CONFIG = \"gz_bridge.yaml\"\n\ndef generate_launch_description():\n    ld = LaunchDescription()\n\n    pkg_path = os.path.join(get_package_share_directory(PKG_DESCRIPTION))\n    xacro_file = os.path.join(pkg_path, URDF, ROBOT)\n    robot_description = xacro.process_file(xacro_file).toxml()\n\n    node_robot_state_publisher = Node(\n        package=\"robot_state_publisher\",\n        executable=\"robot_state_publisher\",\n        output=\"screen\",\n        parameters=[{\"robot_description\": robot_description, \"use_sim_time\": True}],\n    )\n\n    gazebo = IncludeLaunchDescription(\n        PythonLaunchDescriptionSource(\n            [\n                PathJoinSubstitution(\n                    [\n                        get_package_share_directory(\"ros_gz_sim\"),\n                        \"launch\",\n                        \"gz_sim.launch.py\",\n                    ]\n                )\n            ]\n        ),\n        launch_arguments=[(\"gz_args\", \" -r -v 3 my_world.sdf\")],\n    )\n\n    gz_spawn_entity = Node(\n        package=\"ros_gz_sim\",\n        executable=\"create\",\n        output=\"screen\",\n        arguments=[\"-name\", \"robot\", \"-topic\", \"/robot_description\"],\n    )\n\n\n    joint_state_broadcaster_spawner = Node(\n        package=\"controller_manager\",\n        executable=\"spawner\",\n        arguments=[\"joint_state_broadcaster\"],\n        output=\"screen\",\n    )\n\n    control_spawner = Node(\n        package=\"controller_manager\",\n        executable=\"spawner\",\n        arguments=[\"position_controller\"],\n        output=\"screen\",\n    )\n\n    gazebo_bridge = Node(\n        package=\"ros_gz_bridge\",\n        executable=\"parameter_bridge\",\n        name=\"parameter_bridge\",\n        output=\"screen\",\n        arguments=[\"/clock@rosgraph_msgs/msg/Clock[gz.msgs.Clock\"],\n    )\n\n\n    ld.add_action(node_robot_state_publisher)\n    ld.add_action(gazebo)\n    ld.add_action(gz_spawn_entity)\n    ld.add_action(gazebo_bridge)\n    ld.add_action(control_spawner)\n    ld.add_action(joint_state_broadcaster_spawner)\n\n    return ld\n</code></pre>","tags":["ros","control","ros2_control","position"]},{"location":"ROS/ros_world/ros_control/tutorials/position_control/#usage","title":"usage","text":"send command<pre><code>ros2 topic pub -1 /position_controller/commands std_msgs/msg/Float64MultiArray \"{ data: [1.0] }\"\n</code></pre>","tags":["ros","control","ros2_control","position"]},{"location":"ROS/ros_world/ros_control/tutorials/position_control/#state","title":"State","text":"<p>State define in ros2_control</p> <pre><code>&lt;state_interface name=\"position\" /&gt;\n</code></pre> echo state<pre><code>ros2 topic echo /dynamic_joint_states\n#\n---\nheader:\n  stamp:\n    sec: 167\n    nanosec: 299000000\n  frame_id: ''\njoint_names:\n- first_joint\ninterface_values:\n- interface_names:\n  - position\n  values:\n  - 1.000000000000095\n---\n</code></pre> <p>Extent the state interface</p> <p>Add state to <code>ros2_control</code> section <pre><code>&lt;state_interface name=\"position\" /&gt;\n&lt;state_interface name=\"velocity\" /&gt;\n</code></pre></p> <pre><code>header:\nstamp:\n    sec: 85\n    nanosec: 799000000\nframe_id: ''\njoint_names:\n- first_joint\ninterface_values:\n- interface_names:\n- position\n- velocity\nvalues:\n- 1.00\n- 0\n</code></pre>","tags":["ros","control","ros2_control","position"]},{"location":"ROS/ros_world/ros_control/tutorials/velocity_control/","title":"ROS2 Control: velocity control","text":"","tags":["ros","control","ros2_control","velocity"]},{"location":"ROS/ros_world/ros_control/tutorials/velocity_control/#gazebo-simulation","title":"Gazebo simulation","text":"xacro loaf gazebo control plugin and set ros2_control tag<pre><code>&lt;robot xmlns:xacro=\"http://www.ros.org/wiki/xacro\" &gt;\n    &lt;gazebo&gt;\n        &lt;plugin filename=\"gz_ros2_control-system\" name=\"gz_ros2_control::GazeboSimROS2ControlPlugin\"&gt;\n            &lt;parameters&gt;\n                $(find tutorial_bringup)/config/velocity_controllers.yaml\n            &lt;/parameters&gt;\n        &lt;/plugin&gt;\n\n    &lt;/gazebo&gt;\n\n    &lt;ros2_control name=\"robot\" type=\"system\"&gt;\n        &lt;hardware&gt;\n            &lt;plugin&gt;gz_ros2_control/GazeboSimSystem&lt;/plugin&gt;\n        &lt;/hardware&gt;\n\n        &lt;joint name=\"first_joint\"&gt;\n            &lt;command_interface name=\"velocity\"&gt;\n                &lt;param name=\"min\"&gt;-0.5&lt;/param&gt;\n                &lt;param name=\"max\"&gt;0.5&lt;/param&gt;\n            &lt;/command_interface&gt;\n\n            &lt;state_interface name=\"position\" /&gt;\n            &lt;state_interface name=\"velocity\" /&gt;\n        &lt;/joint&gt;\n\n    &lt;/ros2_control&gt;\n&lt;/robot&gt;\n</code></pre> controllers yaml file <pre><code>controller_manager:\n  ros__parameters:\n    update_rate: 10\n\n\n    joint_state_broadcaster:\n      type: joint_state_broadcaster/JointStateBroadcaster\n\n    velocity_controller:\n      type: velocity_controllers/JointGroupVelocityController\n\n\nvelocity_controller:\n  ros__parameters:\n    joints:\n      - first_joint\n</code></pre> launch file <pre><code>import os\n\nfrom ament_index_python.packages import get_package_share_directory\nfrom launch import LaunchDescription\nfrom launch.actions import IncludeLaunchDescription\nfrom launch.substitutions import PathJoinSubstitution\nfrom launch.launch_description_sources import PythonLaunchDescriptionSource\nfrom launch_ros.actions import Node\nimport xacro\n\nPKG_BRINGUP = \"tutorial_bringup\"\nPKG_DESCRIPTION = \"tutorial_description\"\nROBOT = \"robot.xacro\"\nCONFIG = \"config\"\nURDF = \"urdf\"\nBRIDGE_CONFIG = \"gz_bridge.yaml\"\n\ndef generate_launch_description():\n    ld = LaunchDescription()\n\n    pkg_path = os.path.join(get_package_share_directory(PKG_DESCRIPTION))\n    xacro_file = os.path.join(pkg_path, URDF, ROBOT)\n    robot_description = xacro.process_file(xacro_file).toxml()\n\n    node_robot_state_publisher = Node(\n        package=\"robot_state_publisher\",\n        executable=\"robot_state_publisher\",\n        output=\"screen\",\n        parameters=[{\"robot_description\": robot_description, \"use_sim_time\": True}],\n    )\n\n    gazebo = IncludeLaunchDescription(\n        PythonLaunchDescriptionSource(\n            [\n                PathJoinSubstitution(\n                    [\n                        get_package_share_directory(\"ros_gz_sim\"),\n                        \"launch\",\n                        \"gz_sim.launch.py\",\n                    ]\n                )\n            ]\n        ),\n        launch_arguments=[(\"gz_args\", \" -r -v 3 my_world.sdf\")],\n    )\n\n    gz_spawn_entity = Node(\n        package=\"ros_gz_sim\",\n        executable=\"create\",\n        output=\"screen\",\n        arguments=[\"-name\", \"robot\", \"-topic\", \"/robot_description\"],\n    )\n\n\n    joint_state_broadcaster_spawner = Node(\n        package=\"controller_manager\",\n        executable=\"spawner\",\n        arguments=[\"joint_state_broadcaster\"],\n        output=\"screen\",\n    )\n\n    control_spawner = Node(\n        package=\"controller_manager\",\n        executable=\"spawner\",\n        arguments=[\"velocity_controller\"],\n        output=\"screen\",\n    )\n\n    gazebo_bridge = Node(\n        package=\"ros_gz_bridge\",\n        executable=\"parameter_bridge\",\n        name=\"parameter_bridge\",\n        output=\"screen\",\n        arguments=[\"/clock@rosgraph_msgs/msg/Clock[gz.msgs.Clock\"],\n    )\n\n\n    ld.add_action(node_robot_state_publisher)\n    ld.add_action(gazebo)\n    ld.add_action(gz_spawn_entity)\n    ld.add_action(gazebo_bridge)\n    ld.add_action(control_spawner)\n    ld.add_action(joint_state_broadcaster_spawner)\n\n    return ld\n</code></pre>","tags":["ros","control","ros2_control","velocity"]},{"location":"ROS/ros_world/ros_control/tutorials/velocity_control/#usage","title":"usage","text":"send command<pre><code>ros2 topic pub -1 /velocity_controller/commands std_msgs/msg/Float64MultiArray \"{ data: [1.0] }\"\n</code></pre> <pre><code>ros2 topic echo /dynamic_joint_states\n#\nheader:\nstamp:\n    sec: 85\n    nanosec: 799000000\nframe_id: ''\njoint_names:\n- first_joint\ninterface_values:\n- interface_names:\n- position\n- velocity\nvalues:\n- 1.00\n- 0\n</code></pre>","tags":["ros","control","ros2_control","velocity"]},{"location":"ROS/ros_world/ros_tf/","title":"TF2","text":"<p>tf2  provides a coordinate transformation framework, allowing nodes to track and transform data between different coordinate frames over time</p> <p>Euler RPY</p> <p>Quaternion</p> <p>Linear algebra</p> <p>tf transformations</p>","tags":["ros","tf","quaternion","tf2"]},{"location":"ROS/ros_world/ros_tf/#rotation-and-translation-matrix","title":"Rotation and Translation Matrix","text":"<ul> <li>Translation: Shifts a point in space (represented as a vector [x, y, z]).</li> <li>Rotation: Rotates a point around an axis (using quaternions or rotation matrices).</li> </ul> <p>A transformation matrix combines rotation and translation</p> \\[ T=\\begin{bmatrix} R &amp; t \\\\ 0 &amp; 1 \\end{bmatrix} \\] \\[ T = \\begin{bmatrix} r_{11} &amp; r_{12} &amp; r_{13} &amp; x \\\\ r_{21} &amp; r_{22} &amp; r_{23} &amp; y \\\\ r_{31} &amp; r_{32} &amp; r_{33} &amp; z \\\\ 0 &amp; 0 &amp; 0 &amp; 1 \\end{bmatrix} \\]","tags":["ros","tf","quaternion","tf2"]},{"location":"ROS/ros_world/ros_tf/#install-ros-tf-support-packages","title":"Install ROS tf support packages","text":"install<pre><code>sudo apt-get install \\\nros-humble-tf2-tools \\\nros-humble-tf-transformations \\\nros-humble-rqt-tf-tree\n</code></pre>","tags":["ros","tf","quaternion","tf2"]},{"location":"ROS/ros_world/ros_tf/#static-and-dynamic-tf","title":"Static and Dynamic TF","text":"","tags":["ros","tf","quaternion","tf2"]},{"location":"ROS/ros_world/ros_tf/#static-tf","title":"Static TF","text":"<p>Use to publish fix coordinate relation (coordinate that not change in time) it publish to <code>tf_static</code> topic </p>","tags":["ros","tf","quaternion","tf2"]},{"location":"ROS/ros_world/ros_tf/#demo","title":"Demo","text":"<p>Publish the relation between world to robot_1</p> publish static tf<pre><code># new style quaternion\nros2 run tf2_ros static_transform_publisher --x 2 --y 1 --z 0 --qx 0 --qy 0 --qz 0 --qw 1 --frame-id world --child-frame-id robot_1\n\n# new style euler\nros2 run tf2_ros static_transform_publisher --x 2 --y 1 --z 0 --roll 0 --pitch 0 --yaw 0 --frame-id world --child-frame-id robot_1\n\n#\ntranslation: ('2.000000', '1.000000', '0.000000')\nrotation: ('0.000000', '0.000000', '0.000000', '1.000000')\nfrom 'world' to 'robot_1'\n</code></pre> echo topic<pre><code>ros2 topic echo /tf_static\ntransforms:\n- header:\n    stamp:\n      sec: 1742018434\n      nanosec: 760327680\n    frame_id: world\n  child_frame_id: robot_1\n  transform:\n    translation:\n      x: 2.0\n      y: 1.0\n      z: 0.0\n    rotation:\n      x: 0.0\n      y: 0.0\n      z: 0.0\n      w: 1.0\n---\n</code></pre> <p></p> <p></p> <p>coordinate</p> <ul> <li>X: red</li> <li>Y: green</li> <li>Z: blue</li> </ul>","tags":["ros","tf","quaternion","tf2"]},{"location":"ROS/ros_world/ros_tf/#resolve-code","title":"Resolve code","text":"<p>ROS node that resolve the translation and Rotation between two coordinate, in the example is to resolve between robot_1 to world, </p> tf resolve code <pre><code>#!/bin/usr/env python\n\nimport rclpy\nfrom rclpy.node import Node\nimport tf2_ros\nfrom geometry_msgs.msg import TransformStamped\n\nclass TFResolver(Node):\n    def __init__(self):\n        super().__init__('tf_resolver')\n\n        # Create TF buffer and listener\n        self.tf_buffer = tf2_ros.Buffer()\n        self.tf_listener = tf2_ros.TransformListener(self.tf_buffer, self)\n\n        # Timer to check TF every 1 second\n        self.timer = self.create_timer(1.0, self.lookup_transform)\n\n    def lookup_transform(self):\n        from_frame = 'robot_1'\n        to_frame = 'world'\n\n        try:\n            # Lookup transform from 'world' to 'robot_1'\n            transform: TransformStamped = self.tf_buffer.lookup_transform(from_frame, to_frame, rclpy.time.Time())\n\n            # Extract translation\n            translation = transform.transform.translation\n            self.get_logger().info(f\"Translation: x={translation.x}, y={translation.y}, z={translation.z}\")\n\n            # Extract rotation (quaternion)\n            rotation = transform.transform.rotation\n            self.get_logger().info(f\"Rotation (quaternion): x={rotation.x}, y={rotation.y}, z={rotation.z}, w={rotation.w}\")\n\n        except tf2_ros.LookupException:\n            self.get_logger().warn(f\"Transform from {from_frame} to {to_frame} not found!\")\n        except tf2_ros.ConnectivityException:\n            self.get_logger().warn(\"Connectivity issue!\")\n        except tf2_ros.ExtrapolationException:\n            self.get_logger().warn(\"Extrapolation error!\")\n\ndef main():\n    rclpy.init()\n    node = TFResolver()\n    rclpy.spin(node)\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n</code></pre> <pre><code>python /home/user/projects/blog/docs/ROS/ros_world/ros_tf/code/demo1_reslove.py\n[INFO] [1742019661.607132099] [tf_resolver]: Translation: x=-2.0, y=-1.0, z=0.0\n[INFO] [1742019661.607396088] [tf_resolver]: Rotation (quaternion): x=0.0, y=0.0, z=0.0, w=1.0\n</code></pre> <p>The <code>robot_1</code> need to move back 2m in X and 1m back in Y to return to the word coordinate frame</p>","tags":["ros","tf","quaternion","tf2"]},{"location":"ROS/ros_world/ros_tf/#demo2-send-static-transformation-from-code","title":"Demo2: Send static transformation from code","text":"<p>Send <code>static tf</code> from code</p> static tf StaticTransformBroadcaster<pre><code>#!/bin/usr/env python\n\nimport rclpy\nfrom rclpy.node import Node\nfrom tf2_ros import StaticTransformBroadcaster\nfrom geometry_msgs.msg import TransformStamped\n\nclass StaticTFPublisher(Node):\n    def __init__(self):\n        super().__init__('static_tf_publisher')\n        self.tf_broadcaster = StaticTransformBroadcaster(self)\n        self.publish_static_transform()\n\n    def publish_static_transform(self):\n        t = TransformStamped()\n        t.header.stamp = self.get_clock().now().to_msg()\n        t.header.frame_id = 'robot_1'\n        t.child_frame_id = 'world'\n        t.transform.translation.x = 2.0\n        t.transform.translation.y = 1.0\n        t.transform.translation.z = 0.0\n\n        # Set Rotation (Quaternion)\n        t.transform.rotation.x = 0.0\n        t.transform.rotation.y = 0.0\n        t.transform.rotation.z = 0.7071  # 90\u00b0 rotation around Z\n        t.transform.rotation.w = 0.7071\n\n        self.tf_broadcaster.sendTransform(t)\n        self.get_logger().info(\"Published static transform\")\n\nrclpy.init()\nnode = StaticTFPublisher()\nrclpy.spin(node)\nrclpy.shutdown()\n</code></pre> <p></p>","tags":["ros","tf","quaternion","tf2"]},{"location":"ROS/ros_world/ros_tf/#dynamic-tf","title":"Dynamic TF","text":"","tags":["ros","tf","quaternion","tf2"]},{"location":"ROS/ros_world/ros_tf/#demo-dynamic-tf","title":"Demo: Dynamic TF","text":"<p>Publish <code>tf</code> in 10 HZ, (change robot orientation)</p> dynamic tf broadcaster <pre><code>#!/usr/bin/env python\n\nimport rclpy\nfrom rclpy.node import Node\nfrom tf2_ros import TransformBroadcaster\nfrom geometry_msgs.msg import TransformStamped\nimport math\n\nHZ = 0.1\n\nclass MovingTFPublisher(Node):\n    def __init__(self):\n        super().__init__('moving_tf_publisher')\n        self.tf_broadcaster = TransformBroadcaster(self)\n        self.timer = self.create_timer(HZ, self.publish_transform)\n        self.t = 0  # Time step\n\n    def publish_transform(self):\n        t = TransformStamped()\n        t.header.stamp = self.get_clock().now().to_msg()\n        t.header.frame_id = 'robot_1'\n        t.child_frame_id = 'world'\n\n        # Simulate movement: circular motion\n        t.transform.translation.x = 2.0 * math.cos(self.t)\n        t.transform.translation.y = 2.0 * math.sin(self.t)\n        t.transform.translation.z = 0.0\n\n        # Quaternion Rotation (yaw only)\n        qz = math.sin(self.t / 2)\n        qw = math.cos(self.t / 2)\n        t.transform.rotation.z = qz\n        t.transform.rotation.w = qw\n\n        self.tf_broadcaster.sendTransform(t)\n        self.t += 0.1  # Increment time step\n        self.get_logger().info(\"Publish tf\")\n\nrclpy.init()\nnode = MovingTFPublisher()\nrclpy.spin(node)\nrclpy.shutdown()\n</code></pre> <p></p> tf resolver <pre><code>#!/usr/bin/env python\n\nimport rclpy\nfrom rclpy.node import Node\nimport tf2_ros\nfrom geometry_msgs.msg import TransformStamped\n\nRESOLVE_HZ = 0.5\n\nclass TFResolver(Node):\n    def __init__(self):\n        super().__init__('tf_resolver')\n\n        # Create TF buffer and listener\n        self.tf_buffer = tf2_ros.Buffer(cache_time=rclpy.duration.Duration(seconds=0.1))\n        self.tf_listener = tf2_ros.TransformListener(self.tf_buffer, self)\n\n        # Timer to check TF every 1 second\n        self.timer = self.create_timer(RESOLVE_HZ, self.lookup_transform)\n\n    def lookup_transform(self):\n        from_frame = 'robot_1'\n        to_frame = 'world'\n\n        try:\n            # Lookup transform from 'world' to 'robot_1'\n            transform: TransformStamped = self.tf_buffer.lookup_transform(from_frame, to_frame, rclpy.time.Time())\n\n            # Extract translation\n            translation = transform.transform.translation\n            self.get_logger().info(f\"Translation: x={translation.x}, y={translation.y}, z={translation.z}\")\n\n            # Extract rotation (quaternion)\n            rotation = transform.transform.rotation\n            self.get_logger().info(f\"Rotation (quaternion): x={rotation.x}, y={rotation.y}, z={rotation.z}, w={rotation.w}\")\n\n        except tf2_ros.LookupException:\n            self.get_logger().warn(f\"Transform from {from_frame} to {to_frame} not found!\")\n        except tf2_ros.ConnectivityException:\n            self.get_logger().warn(\"Connectivity issue!\")\n        except tf2_ros.ExtrapolationException:\n            self.get_logger().warn(\"Extrapolation error!\")\n\ndef main():\n    rclpy.init()\n    node = TFResolver()\n    rclpy.spin(node)\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n</code></pre>","tags":["ros","tf","quaternion","tf2"]},{"location":"ROS/ros_world/ros_tf/#tf-performance","title":"TF Performance","text":"<ul> <li>Qos</li> <li>Buffer duration (size)</li> </ul>","tags":["ros","tf","quaternion","tf2"]},{"location":"ROS/ros_world/ros_tf/#qos","title":"QOS","text":"<p>Change listener QOS</p>","tags":["ros","tf","quaternion","tf2"]},{"location":"ROS/ros_world/ros_tf/#listener-qos","title":"Listener QoS","text":"default tf QOS<pre><code>ros2 topic info --verbose /tf\nType: tf2_msgs/msg/TFMessage\n\nPublisher count: 1\n\nNode name: moving_tf_publisher\nNode namespace: /\nTopic type: tf2_msgs/msg/TFMessage\nEndpoint type: PUBLISHER\nGID: 01.10.75.c8.eb.03.e1.a2.15.e9.45.5c.00.00.14.03.00.00.00.00.00.00.00.00\nQoS profile:\n  Reliability: RELIABLE\n  History (Depth): KEEP_LAST (100)\n  Durability: VOLATILE\n  Lifespan: Infinite\n  Deadline: Infinite\n  Liveliness: AUTOMATIC\n  Liveliness lease duration: Infinite\n\nSubscription count: 1\n\nNode name: tf_resolver\nNode namespace: /\nTopic type: tf2_msgs/msg/TFMessage\nEndpoint type: SUBSCRIPTION\nGID: 01.10.e4.9b.73.91.d0.2b.17.52.17.b6.00.00.14.04.00.00.00.00.00.00.00.00\nQoS profile:\n  Reliability: RELIABLE\n  History (Depth): KEEP_LAST (100)\n  Durability: VOLATILE\n  Lifespan: Infinite\n  Deadline: Infinite\n  Liveliness: AUTOMATIC\n  Liveliness lease duration: Infinite\n</code></pre> tf listener with best effort qos <pre><code>#!/bin/usr/env python\n\nimport rclpy\nfrom rclpy.node import Node\nimport tf2_ros\nfrom geometry_msgs.msg import TransformStamped\nfrom rclpy.qos import QoSProfile, QoSReliabilityPolicy, QoSHistoryPolicy, QoSDurabilityPolicy\n\nRESOLVE_HZ = 0.5\n\nclass TFResolver(Node):\n    def __init__(self):\n        super().__init__('tf_resolver')\n\n        qos = QoSProfile(\n            reliability=QoSReliabilityPolicy.BEST_EFFORT,  # RELIABLE is default\n            history=QoSHistoryPolicy.KEEP_LAST,\n            depth=10,                                     # Adjust buffer size\n            durability=QoSDurabilityPolicy.VOLATILE       # TRANSIENT_LOCAL is default for TF\n        )          \n\n        # Create TF buffer and listener\n        self.tf_buffer = tf2_ros.Buffer(cache_time=rclpy.duration.Duration(seconds=0.1))\n        self.tf_listener = tf2_ros.TransformListener(self.tf_buffer, self, qos=qos)\n\n        # Timer to check TF every 1 second\n        self.timer = self.create_timer(RESOLVE_HZ, self.lookup_transform)\n\n    def lookup_transform(self):\n        from_frame = 'robot_1'\n        to_frame = 'world'\n\n        try:\n            # Lookup transform from 'world' to 'robot_1'\n            transform: TransformStamped = self.tf_buffer.lookup_transform(from_frame, to_frame, rclpy.time.Time())\n\n            # Extract translation\n            translation = transform.transform.translation\n            self.get_logger().info(f\"Translation: x={translation.x}, y={translation.y}, z={translation.z}\")\n\n            # Extract rotation (quaternion)\n            rotation = transform.transform.rotation\n            self.get_logger().info(f\"Rotation (quaternion): x={rotation.x}, y={rotation.y}, z={rotation.z}, w={rotation.w}\")\n\n        except tf2_ros.LookupException:\n            self.get_logger().warn(f\"Transform from {from_frame} to {to_frame} not found!\")\n        except tf2_ros.ConnectivityException:\n            self.get_logger().warn(\"Connectivity issue!\")\n        except tf2_ros.ExtrapolationException:\n            self.get_logger().warn(\"Extrapolation error!\")\n\ndef main():\n    rclpy.init()\n    node = TFResolver()\n    rclpy.spin(node)\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n</code></pre>","tags":["ros","tf","quaternion","tf2"]},{"location":"ROS/ros_world/ros_tf/#reference","title":"Reference","text":"<ul> <li>Articulated Robotics - The Transform System (tf2)</li> <li>Coordinate Transforms For Robotics</li> </ul>","tags":["ros","tf","quaternion","tf2"]},{"location":"ROS/ros_world/ros_tf/euler/","title":"Euler","text":"","tags":["euler","RPY"]},{"location":"ROS/ros_world/ros_tf/euler/#gimbal-lock","title":"Gimbal lock","text":"<p>Gimbal lock is a loss of one degree of freedom (DOF) in a 3D rotation system due to the alignment of two rotational axes. For example when <code>PITCH</code> is \u00b190\u00b0 the <code>YAW</code> and <code>ROLL</code> axes rotate around the <code>YAW</code> and we loss on degree of freedom</p> <p>Euler Angles Gimbal Visualization</p> <p></p> <p>colors</p> <p>roll (x) - blue pitch (y) - green yaw (z) - green</p> <p>rotate pitch 90 degree make roll and yaw rotation to the same direction</p>","tags":["euler","RPY"]},{"location":"ROS/ros_world/ros_tf/euler/#rotation-order","title":"Rotation Order","text":"","tags":["euler","RPY"]},{"location":"ROS/ros_world/ros_tf/euler/#euler-xyz","title":"Euler (XYZ)","text":"<p>RPY</p>","tags":["euler","RPY"]},{"location":"ROS/ros_world/ros_tf/linear_algebra/","title":"Linear algebra","text":"","tags":["linear algebra"]},{"location":"ROS/ros_world/ros_tf/quaternion/","title":"Quaternion","text":"<p>ROS / ros world / ros tf</p> <p>A quaternion is a way to represent rotation in 3D</p>","tags":["quaternion","tf_transformations","quaternion_from_euler"]},{"location":"ROS/ros_world/ros_tf/quaternion/#demo","title":"Demo","text":"<p>Using Pose (PoseStamped) message and rviz to show coordinate rotation. using <code>quaternion_from_euler</code> to convert euler angle to quaternion</p> Figure 1: Show axis. code: Publish pose message node <pre><code>#!/usr/bin/env python3\n\nimport rclpy\nfrom rclpy.node import Node\nfrom geometry_msgs.msg import PoseStamped\nfrom tf_transformations import quaternion_from_euler\nfrom math import pi\n\nclass MyNode(Node):\n    def __init__(self):\n        node_name=\"pose_demo\"\n        super().__init__(node_name)\n        self.pub = self.create_publisher(PoseStamped, \"/my_topic\", 10)\n        self.my_timer = self.create_timer(1.0, self.__timer_handler)\n\n        self.get_logger().info(\"Hello ROS2\")\n\n    def __timer_handler(self):\n        msg = PoseStamped()\n        msg.header.frame_id = \"map\"\n        msg.header.stamp = self.get_clock().now().to_msg()\n        msg.pose.position.x = 0.0\n        msg.pose.position.y = 0.0\n        msg.pose.position.z = 0.0\n\n        q = quaternion_from_euler(0.0, pi/2, pi/2)\n        msg.pose.orientation.x = q[0]\n        msg.pose.orientation.y = q[1]\n        msg.pose.orientation.z = q[2]\n        msg.pose.orientation.w = q[3]\n\n        self.pub.publish(msg)\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = MyNode()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n</code></pre> <p>PoseStamped</p> <p>For rviz to shown the pose topic it need to be publish as <code>PoseStamped</code> for the frame_id field</p> Figure 2: Add Pose message Figure 3: Show Pose message (my_topic) (r=0,p=0,y=90) <p>The Axis is rotate 90 degree CCW (right hand rule)</p> Figure 4: Show Pose message rotate (r=0,p=90,y=90)","tags":["quaternion","tf_transformations","quaternion_from_euler"]},{"location":"ROS/ros_world/ros_tf/tf_transformations/","title":"tf_transformations library","text":"<p>ROS / ros world / ros tf</p> <p>tf_transformations is a Python utility library in ROS that provides functions for working with 3D rotations and transformations. converting between different orientation formats like Euler angles, quaternions, and transformation matrices.</p> install<pre><code>sudo apt install ros-$ROS_DISTRO-tf-transformations\n</code></pre>","tags":["ros","tf","tf_transformations"]},{"location":"ROS/ros_world/ros_tf/tf_transformations/#quaternion-euler","title":"Quaternion &lt;-&gt; Euler","text":"<ul> <li>quaternion_from_euler</li> <li>euler_from_quaternion</li> </ul> <pre><code>from tf_transformations import quaternion_from_euler, euler_from_quaternion\nimport math\n\n# euler default axis rpy (\"sxyz\")\n# quaternion [x, y, z, w]\nq = quaternion_from_euler(0, 0, math.pi/2)\nroll, pitch, yaw = euler_from_quaternion([x, y, z, w])\n</code></pre>","tags":["ros","tf","tf_transformations"]},{"location":"ROS/ros_world/ros_tf/tf_transformations/#rotation-axes","title":"Rotation Axes","text":"<p>Euler angles describe a 3D rotation as a sequence of three rotations around three orthogonal axes.  the axes parameter is 4 character string, defines the specific convention of Euler angles you are using.</p>","tags":["ros","tf","tf_transformations"]},{"location":"ROS/ros_world/ros_tf/tf_transformations/#static-extrinsic-rotations","title":"Static (Extrinsic) Rotations","text":"<ul> <li>Character: The axes string starts with 's'.</li> <li>Description: Each rotation is performed about a fixed, global coordinate system's axes. The axes do not move with the object.</li> </ul>","tags":["ros","tf","tf_transformations"]},{"location":"ROS/ros_world/ros_tf/tf_transformations/#rotating-intrinsic-rotations","title":"Rotating (Intrinsic) Rotations","text":"<ul> <li>Character: The axes string starts with 'r'.</li> <li>Description: Each rotation is performed about the object's own moving coordinate system's axes. The axes change their orientation after each preceding rotation.</li> </ul>","tags":["ros","tf","tf_transformations"]},{"location":"ROS/ros_world/ros_tf/tf_transformations/#common-conventions","title":"Common Conventions","text":"<p>Roll-Pith-Yaw (RPY)</p> <ul> <li>Roll: Rotation around the X-axis</li> <li>Pitch: Rotation around the Y-axis</li> <li>Yaw: Rotation around the Z-axis</li> </ul> Extrinsic Rotating sxyz rxyz quaternion = quaternion_from_euler(yaw_rad, pitch_rad, roll_rad, axes='sxyz') quaternion = quaternion_from_euler(yaw_rad, pitch_rad, roll_rad, axes='rxyz')","tags":["ros","tf","tf_transformations"]},{"location":"ROS/ros_world/ros_tf/tf_transformations/#quaternion_about_axis","title":"quaternion_about_axis","text":"<p>This function creates a quaternion that represents a rotation around a single axis by a given angle.</p>","tags":["ros","tf","tf_transformations"]},{"location":"ROS/ros_world/ros_tf/tf_transformations/#1-2-3-4-5-6-7-8import-tf_transformations-import-numpy-as-np-angle-npradians90-axis-1-0-0-x-axis-q-tf_transformationsquaternion_about_axisangle-axis-printquaternion-q","title":"<pre><code>import tf_transformations\nimport numpy as np\n\nangle = np.radians(90)\naxis = [1, 0, 0]  # X axis\n\nq = tf_transformations.quaternion_about_axis(angle, axis)\nprint(\"Quaternion:\", q)\n</code></pre>","text":"","tags":["ros","tf","tf_transformations"]},{"location":"ROS/ros_world/ros_tf/tf_transformations/#_1","title":"tf_transformations library","text":"","tags":["ros","tf","tf_transformations"]},{"location":"ROS/ros_world/zenoh/","title":"Zenoh networking","text":"<p>Zenoh networking is a unified data-centric communication protocol A unified data-centric communication protocol is a networking model where:</p> <p>Applications communicate by sharing data, not by talking to specific endpoints \u2014 and the same protocol supports multiple communication patterns.</p>","tags":["zenoh"]},{"location":"ROS/ros_world/zenoh/#unified","title":"Unified","text":"<p>A single protocol supports:</p> <ul> <li>Publish / Subscribe \u2192 streaming data</li> <li>Request / Reply (Query) \u2192 asking for data or computation</li> <li>Storage / Replay \u2192 retrieving past data</li> </ul> <p></p>","tags":["zenoh"]},{"location":"ROS/ros_world/zenoh/#demo-minimal-pubsub-using-python-binding","title":"Demo: Minimal pub/sub using python binding","text":"<p>minimal Pub/Sub example the zenoh default config, </p> <pre><code>import zenoh\nimport time\nimport multiprocessing\n\nzenoh.init_log_from_env_or(\"DEBUG\")\n\nKEY_EXPRESSION = \"demo/example\"\n\ndef publisher():\n    config = zenoh.Config()\n    session = zenoh.open(config)\n    pub = session.declare_publisher(KEY_EXPRESSION)\n    while True:\n        pub.put('Hello, Zenoh!')\n        time.sleep(1)\n\ndef subscriber():\n    config = zenoh.Config()\n    session = zenoh.open(config)\n    sub = session.declare_subscriber(KEY_EXPRESSION, lambda sample: print(f'Received: {sample.payload.to_string()}'))\n    while True:\n        time.sleep(1)\n\nif __name__ == '__main__':\n    pub_process = multiprocessing.Process(target=publisher)\n    sub_process = multiprocessing.Process(target=subscriber)\n\n    pub_process.start()\n    sub_process.start()\n\n    pub_process.join()\n    sub_process.join()\n</code></pre> <p><code>bash output zenoh::net::runtime: Using ZID: 5c878ff12d11c0d9330259f34cd29fac zenoh::net::runtime: Using ZID: 42209fd2b31a654f83739cebf2e2b000 zenoh::net::runtime::orchestrator: Zenoh can be reached at: tcp/[fe80::b022:f1eb:e86:2654]:37185 zenoh::net::runtime::orchestrator: Zenoh can be reached at: tcp/[fe80::b022:f1eb:e86:2654]:45353 zenoh::net::runtime::orchestrator: Zenoh can be reached at: tcp/10.100.102.15:37185 zenoh::net::runtime::orchestrator: Zenoh can be reached at: tcp/10.100.102.15:45353 zenoh::net::runtime::orchestrator: zenohd listening scout messages on 224.0.0.224:7446 zenoh::net::runtime::orchestrator: zenohd listening scout messages on 224.0.0.224:7446</code></p> <ul> <li>each of the zenoh process listen to multicast on ``</li> <li>the transport between the peer node base on tcp</li> <li></li> </ul> <p>ROS Bridge</p> <p>Python bindings</p> <p>Zenoh pico</p> <p>ROS RMW</p> <p>CPP bindings</p>","tags":["zenoh"]},{"location":"ROS/ros_world/zenoh/#resource","title":"Resource","text":"<ul> <li>Zenoh Tutorial \u2013 Part I</li> <li>TO READ</li> </ul> <ul> <li>zenoh json5 configuration schema</li> <li>build zenoh bridge with shm support </li> </ul>","tags":["zenoh"]},{"location":"ROS/ros_world/zenoh/#to-read","title":"To Read","text":"<ul> <li>Zenoh</li> <li>Zenoh ROSCon 2024 Workshop</li> </ul>","tags":["zenoh"]},{"location":"ROS/ros_world/zenoh/zenoh/","title":"Zenoh","text":"<p>ROS / ros world</p> <ul> <li>Resource: A named data. (key, value) for example (home/sensor/temp, 21.5) , value if a blob of data, zenoh not enforce serialization format</li> <li>Key expression: Identify a set of keys , for example (home/sensor/*)</li> <li>Selector: Identify a set of resource</li> </ul> <p>Zenoh not enforce serialization format</p> <ul> <li>Publisher: Source if values for key expression</li> <li>Subscriber: Sink of values for key expression</li> <li>Queryable: query for values</li> </ul>","tags":["zenoh","tutorial"]},{"location":"ROS/ros_world/zenoh/zenoh/#resource","title":"Resource","text":"<ul> <li>zettascale tech</li> <li>github zettascale labs</li> </ul>","tags":["zenoh","tutorial"]},{"location":"ROS/ros_world/zenoh/cpp_bindings/","title":"Zenoh cpp bindings","text":"<p>ROS / ros world / zenoh</p>","tags":["zenoh","cpp","bindings"]},{"location":"ROS/ros_world/zenoh/cpp_bindings/#install","title":"Install","text":"<p>Download deb's file from github release page</p> <p>Note</p> <p>zeboh cpp binding depend in zeno_pico or zeno_c</p> <ul> <li>Zenoh Pico</li> <li>Zenoh cpp bindings</li> </ul> <p>Code from Zenoh tutorial</p> session<pre><code>#include &lt;zenoh.hxx&gt;\n\nint main(){\n    zenoh:config c;\n    auto z = zenoh::expect&lt;zenoh::Session&gt;(zenoh::open(std::move(c)));\n\n\n    return 0;\n}\n</code></pre> put<pre><code>//primitive value\nz.put(\"my/expression\", \"value\");\n</code></pre> publisher<pre><code>auto p = zeno::expect(z.declare_publisher(\"my/expression\"));\np.put(my_data);\n</code></pre> <p>zeno encoding</p> <ul> <li>json</li> <li>png</li> <li>and more</li> </ul> <p>todo:// 42:36</p> subscriber<pre><code>auto s = zenoh::expect&lt;zenoh::Subscriber&gt;(\n    z.declare_subscriber(\"key\", callback)\n);\n</code></pre> <p>subscriber to multi</p> <p>\"key/**\"</p>","tags":["zenoh","cpp","bindings"]},{"location":"ROS/ros_world/zenoh/cpp_bindings/#qos","title":"QoS","text":"<p>todo: 44:47 todo: 46:26 (opts)</p>","tags":["zenoh","cpp","bindings"]},{"location":"ROS/ros_world/zenoh/cpp_bindings/#build","title":"Build","text":"<p>todo: 47:33</p>","tags":["zenoh","cpp","bindings"]},{"location":"ROS/ros_world/zenoh/cpp_bindings/#demo-pub-sub","title":"Demo: pub / sub","text":"<p>Pub Sub data using zenoh</p> pub_sub.cpp <pre><code>#include &lt;iostream&gt;\n#include &lt;thread&gt;\n#include \"zenoh.hxx\"\n\nusing namespace zenoh;\nvoid task1()\n{\n    Config config = Config::create_default();\n    auto session = Session::open(std::move(config));\n    // auto publisher = session.declare_publisher(KeyExpr(\"demo/example/simple\"));\n\n    for (int i = 0; i &lt; 5; ++i) {\n        // Publish using session.put\n        session.put(KeyExpr(\"demo/example/simple\"), Bytes(\"Simple from session.put! i=\" + std::to_string(i)));\n\n        // Publish using publisher.put\n        // publisher.put(\"Simple from publisher.put!\");\n\n        std::this_thread::sleep_for(std::chrono::seconds(1));\n    }\n}\n\n\n\nint main()\n{\n    std::thread t1(task1);\n    Config config = Config::create_default();\n    auto session = Session::open(std::move(config));\n    auto subscriber = session.declare_subscriber(\n        KeyExpr(\"demo/example/simple\"),\n        [](const Sample &amp;sample)\n        {\n            std::cout &lt;&lt; \"Received: \" &lt;&lt; sample.get_payload().as_string() &lt;&lt; std::endl;\n        },\n        closures::none);\n\n    t1.join(); // Wait for task1 to finish\n\n    std::cout &lt;&lt; \"Demo completed.\\n\";\n    return 0;\n}\n</code></pre> CMakeLists.txt <pre><code>cmake_minimum_required(VERSION 3.10)\nproject(zenoh_ws)\n\nset(CMAKE_CXX_STANDARD 17)\nset(CMAKE_CXX_STANDARD_REQUIRED ON)\n\nfind_package(zenohpico) \nfind_package(zenohcxx REQUIRED)\n\nadd_executable(pub_sub pub_sub.cpp)\n\ntarget_link_libraries(pub_sub\n    zenohcxx::zenohpico)\n</code></pre>","tags":["zenoh","cpp","bindings"]},{"location":"ROS/ros_world/zenoh/cpp_bindings/#demo-pub-sub-with-ros-message-serialization","title":"Demo: pub / sub with ROS message serialization","text":"pub_sub.cpp <pre><code>#include &lt;iostream&gt;\n#include &lt;thread&gt;\n#include \"zenoh.hxx\"\n#include &lt;rclcpp/rclcpp.hpp&gt;\n#include &lt;std_msgs/msg/int32.hpp&gt;\n#include &lt;rclcpp/serialization.hpp&gt;\n#include &lt;rclcpp/serialized_message.hpp&gt;\n\nusing namespace zenoh;\n\nstd::vector&lt;uint8_t&gt; serialize_ros_message(const std_msgs::msg::Int32 &amp; msg)\n{\n    rclcpp::Serialization&lt;std_msgs::msg::Int32&gt; serializer;\n    rclcpp::SerializedMessage serialized_msg;\n\n    serializer.serialize_message(&amp;msg, &amp;serialized_msg);\n\n    // Copy message block of memory to std::vector\n    std::vector&lt;uint8_t&gt; buffer(\n        serialized_msg.get_rcl_serialized_message().buffer,\n        serialized_msg.get_rcl_serialized_message().buffer +\n        serialized_msg.get_rcl_serialized_message().buffer_length);\n\n    return buffer;\n}\n\nstd_msgs::msg::Int32 deserialize_ros_message(const std::vector&lt;uint8_t&gt; &amp;buffer)\n{\n    rclcpp::SerializedMessage serialized_msg;\n\n    // Resize internal buffer and copy\n    serialized_msg.get_rcl_serialized_message().buffer_capacity = buffer.size();\n    serialized_msg.get_rcl_serialized_message().buffer_length = buffer.size();\n    serialized_msg.get_rcl_serialized_message().buffer = reinterpret_cast&lt;uint8_t *&gt;(malloc(buffer.size()));\n    std::memcpy(serialized_msg.get_rcl_serialized_message().buffer, buffer.data(), buffer.size());\n\n    rclcpp::Serialization&lt;std_msgs::msg::Int32&gt; serializer;\n    std_msgs::msg::Int32 msg;\n    serializer.deserialize_message(&amp;serialized_msg, &amp;msg);\n\n\n\n    return msg;\n}\n\nvoid task1()\n{\n    Config config = Config::create_default();\n    auto session = Session::open(std::move(config));\n    // auto publisher = session.declare_publisher(KeyExpr(\"demo/example/simple\"));\n\n    for (int i = 0; i &lt; 5; ++i) {\n        std_msgs::msg::Int32 msg;\n        msg.data = i;\n        auto buffer = serialize_ros_message(msg);\n\n        // Publish using session.put\n        session.put(KeyExpr(\"demo/example/simple\"), buffer);\n\n        // Publish using publisher.put\n        // publisher.put(\"Simple from publisher.put!\");\n\n        std::this_thread::sleep_for(std::chrono::seconds(1));\n    }\n}\n\n\n\nint main()\n{\n    std::thread t1(task1);\n    Config config = Config::create_default();\n    auto session = Session::open(std::move(config));\n    auto subscriber = session.declare_subscriber(\n        KeyExpr(\"demo/example/simple\"),\n        [](const Sample &amp;sample)\n        {\n            auto buffer = sample.get_payload().as_vector();\n            auto msg = deserialize_ros_message(buffer);\n            std::cout &lt;&lt; \"Received: \" &lt;&lt; msg.data &lt;&lt; std::endl;\n        },\n        closures::none);\n\n    t1.join(); // Wait for task1 to finish\n\n    std::cout &lt;&lt; \"Both tasks completed.\\n\";\n    return 0;\n}\n</code></pre> CMakeLists.txt <pre><code>set(CMAKE_CXX_STANDARD 17)\nset(CMAKE_CXX_STANDARD_REQUIRED ON)\n\nfind_package(zenohpico) \nfind_package(zenohcxx REQUIRED)\nfind_package(std_msgs REQUIRED)\nfind_package(rclcpp REQUIRED)\n\nadd_executable(pub_sub_cdr pub_sub.cpp)\n\ntarget_link_libraries(pub_sub_cdr\n    zenohcxx::zenohpico\n)\n\nament_target_dependencies(pub_sub_cdr rclcpp std_msgs)\n</code></pre>","tags":["zenoh","cpp","bindings"]},{"location":"ROS/ros_world/zenoh/cpp_bindings/#demo-subscribe-to-ros-message-with-zenoh-bridge","title":"Demo: Subscribe to ros message with zenoh bridge","text":"terminal 1<pre><code># Public message using ros\nros2 topic pub my_int32_topic std_msgs/msg/Int32 \"{data: 10}\"\n</code></pre> terminal 2<pre><code># Run zenoh bridge\nzenoh-bridge-ros2dds\n</code></pre> terminal 3<pre><code># Run subscriber\n./sub\n</code></pre> sub.cpp <pre><code>#include &lt;iostream&gt;\n#include &lt;thread&gt;\n#include \"zenoh.hxx\"\n#include &lt;rclcpp/rclcpp.hpp&gt;\n#include &lt;std_msgs/msg/int32.hpp&gt;\n#include &lt;rclcpp/serialization.hpp&gt;\n#include &lt;rclcpp/serialized_message.hpp&gt;\n// sudo apt install libfastcdr-dev\n\n\nusing namespace zenoh;\n\nstd_msgs::msg::Int32 deserialize_ros_message(const std::vector&lt;uint8_t&gt; &amp;buffer)\n{\n    rclcpp::SerializedMessage serialized_msg;\n\n    // Resize internal buffer and copy\n    serialized_msg.get_rcl_serialized_message().buffer_capacity = buffer.size();\n    serialized_msg.get_rcl_serialized_message().buffer_length = buffer.size();\n    serialized_msg.get_rcl_serialized_message().buffer = reinterpret_cast&lt;uint8_t *&gt;(malloc(buffer.size()));\n    std::memcpy(serialized_msg.get_rcl_serialized_message().buffer, buffer.data(), buffer.size());\n\n    rclcpp::Serialization&lt;std_msgs::msg::Int32&gt; serializer;\n    std_msgs::msg::Int32 msg;\n    serializer.deserialize_message(&amp;serialized_msg, &amp;msg);\n\n\n\n    return msg;\n}\n\nint main(int argc, char **argv) {\n   Config config = Config::create_default();\n   auto session = Session::open(std::move(config));\n   auto subscriber = session.declare_subscriber(\n      KeyExpr(\"my_int32_topic\"),\n      [](const Sample&amp; sample) {\n        auto buffer = sample.get_payload().as_vector();\n            auto msg = deserialize_ros_message(buffer);\n            std::cout &lt;&lt; \"Received: \" &lt;&lt; msg.data &lt;&lt; std::endl;\n\n      },\n      closures::none\n   );\n   // Wait for a key press to exit\n   char c = getchar();\n}\n</code></pre> CMakeLists.txt <pre><code>set(CMAKE_CXX_STANDARD 17)\nset(CMAKE_CXX_STANDARD_REQUIRED ON)\n\nfind_package(zenohpico) \nfind_package(zenohcxx REQUIRED)\nfind_package(std_msgs REQUIRED)\nfind_package(rclcpp REQUIRED)\n\n\nadd_executable(sub sub.cpp)\n\ntarget_link_libraries(sub\n    zenohcxx::zenohpico\n)\n\nament_target_dependencies(sub rclcpp std_msgs)\n</code></pre>","tags":["zenoh","cpp","bindings"]},{"location":"ROS/ros_world/zenoh/cpp_bindings/#resource","title":"Resource","text":"<ul> <li>read the doc (1.4)</li> </ul>","tags":["zenoh","cpp","bindings"]},{"location":"ROS/ros_world/zenoh/python_bindings/","title":"Zenoh Python bindings","text":"<pre><code>pip install eclipse-zenoh\n</code></pre>","tags":["zenoh","python"]},{"location":"ROS/ros_world/zenoh/python_bindings/#examples","title":"Examples","text":"","tags":["zenoh","python"]},{"location":"ROS/ros_world/zenoh/python_bindings/#pubsub","title":"Pub/Sub","text":"<p>Simple pub sub</p> <pre><code>import zenoh\nimport time\nimport multiprocessing\n\nKEY_EXPRESSION = \"demo/example\"\n\ndef publisher():\n    config = zenoh.Config()\n    session = zenoh.open(config)\n    pub = session.declare_publisher(KEY_EXPRESSION)\n    while True:\n        pub.put('Hello, Zenoh!')\n        time.sleep(1)\n\ndef subscriber():\n    config = zenoh.Config()\n    session = zenoh.open(config)\n    sub = session.declare_subscriber(KEY_EXPRESSION, lambda sample: print(f'Received: {sample.payload.to_string()}'))\n    while True:\n        time.sleep(1)\n\nif __name__ == '__main__':\n    pub_process = multiprocessing.Process(target=publisher)\n    sub_process = multiprocessing.Process(target=subscriber)\n\n    pub_process.start()\n    sub_process.start()\n\n    pub_process.join()\n    sub_process.join()\n</code></pre>","tags":["zenoh","python"]},{"location":"ROS/ros_world/zenoh/rmw/","title":"RMW Zenoh","text":"","tags":["ros","zenoh","rmw"]},{"location":"ROS/ros_world/zenoh/rmw/#reference","title":"Reference","text":"<ul> <li>No more broken comms! (ROS 2 + rmw_zenoh) </li> <li>Zenoh ROSCon 2024 Workshop</li> </ul>","tags":["ros","zenoh","rmw"]},{"location":"ROS/ros_world/zenoh/ros_bridge/","title":"Zenoh Bridge and ROS","text":"<p>ROS and zenoh bridge</p> <p>ROS Bridge and python</p> <p>TBD</p>","tags":["zenoh","ros","bridge"]},{"location":"ROS/ros_world/zenoh/ros_bridge/zenoh_bridge_build_with_shm/","title":"Zenoh Bridge with SHM support","text":"","tags":["zenoh","bridge","ros","shm"]},{"location":"ROS/ros_world/zenoh/ros_bridge/zenoh_bridge_build_with_shm/#under-construction","title":"under construction","text":"<ul> <li>zenoh-plugin-ros2dds</li> </ul>","tags":["zenoh","bridge","ros","shm"]},{"location":"ROS/ros_world/zenoh/ros_bridge/zenoh_bridge_build_with_shm/#build-with-shm","title":"build with SHM","text":"<ul> <li>Download source (v 1.2.0) download</li> <li>Extract and run:</li> </ul> <pre><code>cargo build --release --features dds_shm\n</code></pre> <p>binary locate at <code>target/release</code> folder</p>","tags":["zenoh","bridge","ros","shm"]},{"location":"ROS/ros_world/zenoh/ros_bridge/zenoh_bridge_build_with_shm/#usage","title":"Usage","text":"<ul> <li>Run with shm flag</li> <li>Set cyclondds.xml for shm</li> </ul> <pre><code>./zenoh-bridge-ros2dds --dds-enable-shm\n</code></pre> cyclondds.xml<pre><code>\n</code></pre>","tags":["zenoh","bridge","ros","shm"]},{"location":"ROS/ros_world/zenoh/ros_bridge/zenoh_bridge_build_with_shm/#tmux-script","title":"tmux script","text":"","tags":["zenoh","bridge","ros","shm"]},{"location":"ROS/ros_world/zenoh/ros_bridge/zenoh_bridge_build_with_shm/#reference","title":"Reference","text":"<ul> <li>combine zenoh-plugin-dds with cyclone iceoryx shared memory #50</li> </ul>","tags":["zenoh","bridge","ros","shm"]},{"location":"ROS/ros_world/zenoh/ros_bridge/zenoh_bridge_ros_python/","title":"Connect ROS via zenoh bridge with python","text":"<p>Using zenoh bridge to pub/sub and message call from python script to ROS2 and vice versa.</p> <p>versions</p> <ul> <li>ubuntu 22.04</li> <li>ROS humble</li> <li>cycloneDDS</li> <li>zenoh 1.2.0</li> <li>zenoh-plugin-ros2dds 1.2.0</li> <li>pycdr2 1.0.0</li> </ul>","tags":["zenoh","bridge","python"]},{"location":"ROS/ros_world/zenoh/ros_bridge/zenoh_bridge_ros_python/#install-zenoh-plugin-ros2dds","title":"Install zenoh-plugin-ros2dds","text":"<p>Download and extract , bridge standalone executable </p> <p>zenoh-plugin-ros2dds-1.2.0-x86_64-unknown-linux-gnu-standalone.zip </p>","tags":["zenoh","bridge","python"]},{"location":"ROS/ros_world/zenoh/ros_bridge/zenoh_bridge_ros_python/#install","title":"Install","text":"<p>The IDL part of the CycloneDDS package as standalone version, to support packages that need CDR (de)serialisation without the Cyclone DDS API.</p> <pre><code>pip install pycdr2\npip install eclipse-zenoh==1.2.0\n</code></pre>","tags":["zenoh","bridge","python"]},{"location":"ROS/ros_world/zenoh/ros_bridge/zenoh_bridge_ros_python/#sub-demo","title":"Sub Demo","text":"<p>Send ROS2 messages to zenoh and receive it using python script</p> Terminal 1<pre><code>export ROS_DISTRO=humble\n./zenoh-bridge-ros2dds\n</code></pre> Terminal 2<pre><code>ros2 topic pub /my_int32_topic std_msgs/msg/Int32 \"{data: 10}\" --rate 1\n</code></pre> <pre><code>import zenoh\nfrom dataclasses import dataclass\nfrom pycdr2 import IdlStruct \nfrom pycdr2.types import int32\nimport time\n\n@dataclass\nclass Int32(IdlStruct, typename=\"Int32\"):\n    data: int32\n\n\ndef callback(sample):\n    msg = Int32.deserialize(bytes(sample.payload))\n    print(f\"Received: {msg.data}\")\n\n\nconf = zenoh.Config()    \nsession = zenoh.open(conf)\nsub = session.declare_subscriber('my_int32_topic', callback)\n\nwhile True:\n    time.sleep(1)\n</code></pre>","tags":["zenoh","bridge","python"]},{"location":"ROS/ros_world/zenoh/ros_bridge/zenoh_bridge_ros_python/#pub-demo","title":"Pub Demo","text":"<p>Pub ROS2 messages to zenoh and subscribe using ROS</p> <p>subscriber</p> <p>For this demo to work there must be running subscriber ROS node for this topic.</p> Terminal 1<pre><code>export ROS_DISTRO=humble\n./zenoh-bridge-ros2dds\n</code></pre> zenoh pub<pre><code>import zenoh\nfrom dataclasses import dataclass\nfrom pycdr2 import IdlStruct \nfrom pycdr2.types import int32\nimport time\n\n@dataclass\nclass Int32(IdlStruct, typename=\"Int32\"):\n    data: int32\n\nconf = zenoh.Config()    \nsession = zenoh.open(conf)\ncounter = 0\nwhile True:\n    time.sleep(1)\n    session.put('my_int32_topic', Int32(data=counter).serialize())\n    counter += 1\n    print(f\"Published: {counter}\")\n</code></pre> subscriber node<pre><code>import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import Int32\n\nTOPIC = \"my_int32_topic\"\n\nclass MyNode(Node):\n    def __init__(self):\n        node_name=\"minimal\"\n        super().__init__(node_name)\n        self.create_subscription(Int32, TOPIC, self.callback, 10)\n        self.get_logger().info(\"Hello ROS2\")\n\n    def callback(self, msg):\n        self.get_logger().info(f\"Received: {msg.data}\")\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = MyNode()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n</code></pre>","tags":["zenoh","bridge","python"]},{"location":"ROS/ros_world/zenoh/ros_bridge/zenoh_bridge_ros_python/#service-demo","title":"Service Demo","text":"<p>Call ROS2 service from zenoh python </p>","tags":["zenoh","bridge","python"]},{"location":"ROS/ros_world/zenoh/ros_bridge/zenoh_bridge_ros_python/#demo","title":"Demo","text":"<ul> <li>Service node with message type <code>std_srv.srv.Trigger</code></li> <li>zenoh ros bridge</li> <li>zenoh service client (get)</li> </ul>","tags":["zenoh","bridge","python"]},{"location":"ROS/ros_world/zenoh/ros_bridge/zenoh_bridge_ros_python/#ros-service-node","title":"ROS Service Node","text":"<p>ROS node that run service with nessage <code>std_srv.srv.Trigger</code></p> demo_service.py<pre><code>#!/usr/bin/env python3\n\n\nimport rclpy\nfrom rclpy.node import Node\nfrom std_srvs.srv import Trigger\nfrom rclpy.qos import qos_profile_services_default\n\nTOPIC = \"trigger_srv\"\n\nclass MyNode(Node):\n    def __init__(self):\n        node_name=\"minimal_srv\"\n        super().__init__(node_name)\n        self.srv = self.create_service(Trigger, TOPIC, self.handler, qos_profile=qos_profile_services_default)\n        self.get_logger().info(\"Hello ROS2\")\n\n    def handler(self, request: Trigger.Request, response: Trigger.Response):\n        self.get_logger().info(\"Trigger service called\")\n        response.success = True\n        response.message = \"success\"\n        print(response)\n        return response\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = MyNode()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n</code></pre>","tags":["zenoh","bridge","python"]},{"location":"ROS/ros_world/zenoh/ros_bridge/zenoh_bridge_ros_python/#zenoh-client","title":"Zenoh client","text":"zenoh get<pre><code>import zenoh\n\nfrom dataclasses import dataclass\nfrom pycdr2 import IdlStruct\nfrom zenoh import Reply\nimport time\n\n# ros2 service call /trigger_srv std_srvs/srv/Trigger\n\nTOPIC = \"trigger_srv\"\n\n@dataclass\nclass TriggerRequest(IdlStruct):\n   pass\n\n\n@dataclass\nclass TriggerResponse(IdlStruct):\n   success: bool\n   message: str\n\n\n\ndef handle_replay(reply: Reply):\n    try:\n        print(reply.ok)\n        message = TriggerResponse.deserialize(reply.ok.payload.to_bytes())\n\n        print(f\"&gt;&gt; Received {message}\")\n    except Exception as e:\n        print(e)\n        print(\"&gt;&gt; Received ERROR\")\n\nconf = zenoh.Config()    \nsession = zenoh.open(conf)\n\nreq = TriggerRequest().serialize()\nreplies = session.get(TOPIC, payload=req, handler=handle_replay)\n\ntime.sleep(2)\nsession.close()\n</code></pre>","tags":["zenoh","bridge","python"]},{"location":"ROS/ros_world/zenoh/ros_bridge/zenoh_bridge_ros_python/#usage","title":"usage","text":"Terminal 1<pre><code>export ROS_DISTRO=humble\n./zenoh-bridge-ros2dds\n</code></pre> terminal 2<pre><code># run ros service\n</code></pre> check service<pre><code># using ros2 cli\n\nros2 service call /trigger_srv std_srvs/srv/Trigger\n</code></pre> zeno client<pre><code># run zeno client\npython3 ros_srv_call.py \n\n\n&gt;&gt; Received TriggerResponse(success=True, message='success')\n</code></pre>","tags":["zenoh","bridge","python"]},{"location":"ROS/ros_world/zenoh/ros_bridge/zenoh_bridge_two_computers/","title":"ROS Zenoh Bridge","text":"<p>Connect two ROS machine via zenoh bridge just read the readme</p> <p>versions</p> <ul> <li>ubuntu 22.04</li> <li>ROS humble</li> <li>cycloneDDS</li> <li>zenoh 1.2.0</li> <li>zenoh-plugin-ros2dds 1.2.0</li> </ul>","tags":["zenoh","ros","bridge","router"]},{"location":"ROS/ros_world/zenoh/ros_bridge/zenoh_bridge_two_computers/#ros-test","title":"ROS test","text":"<p>Run pub/sub without any restriction between the machine</p>","tags":["zenoh","ros","bridge","router"]},{"location":"ROS/ros_world/zenoh/ros_bridge/zenoh_bridge_two_computers/#remote-machine","title":"Remote machine","text":"<pre><code>RMW_IMPLEMENTATION=rmw_cyclonedds_cpp ros2 topic pub /my_int32_topic std_msgs/msg/Int32 \"{ data: 10 }\n</code></pre>","tags":["zenoh","ros","bridge","router"]},{"location":"ROS/ros_world/zenoh/ros_bridge/zenoh_bridge_two_computers/#local-machine","title":"Local machine","text":"<pre><code>ros2 topic echo /my_int32_topic\n</code></pre>","tags":["zenoh","ros","bridge","router"]},{"location":"ROS/ros_world/zenoh/ros_bridge/zenoh_bridge_two_computers/#using-zenoh","title":"Using Zenoh","text":"<p>Close/ restrict the DDS traffic between machine Config remote machine as another domain <code>ROS_DOMAIN_ID=2</code> or set it <code>ROS_LOCALHOST_ONLY=1</code></p> <p>Run zenoh bridge in <code>router</code> mode (default)</p> <p> </p>","tags":["zenoh","ros","bridge","router"]},{"location":"ROS/ros_world/zenoh/ros_bridge/zenoh_bridge_two_computers/#remote-machine_1","title":"Remote machine","text":"publisher<pre><code>ROS_DOMAIN_ID=2 RMW_IMPLEMENTATION=rmw_cyclonedds_cpp ros2 topic pub /my_int32_topic std_msgs/msg/Int32 \"{ data: 10 }\"\n# OR\nROS_LOCALHOST_ONLY=1 RMW_IMPLEMENTATION=rmw_cyclonedds_cpp ros2 topic pub /my_int32_topic std_msgs/msg/Int32 \"{ data: 10 }\"\n</code></pre> zenoh bridge<pre><code>ROS_DOMAIN_ID=2 ROS_DISTRO=humble ./zenoh-bridge-ros2dds\n# OR\nROS_LOCALHOST_ONLY=1  ROS_DISTRO=humble ./zenoh-bridge-ros2dds\n</code></pre> <p>using ROS_LOCALHOST_ONLY</p> <p>ROS humble with cyclone dds it work without multicast enabling  (zenoh bridge has info message tokio-runt: selected interface \"lo\" is not multicast-capable: disabling multicast)</p> <p>Enable multicast on <code>lo</code> using</p> <pre><code>sudo ip link set lo multicast on\n</code></pre>","tags":["zenoh","ros","bridge","router"]},{"location":"ROS/ros_world/zenoh/ros_bridge/zenoh_bridge_two_computers/#local-machine_1","title":"Local machine","text":"zenoh bridge<pre><code>ROS_DISTRO=humble ./zenoh-bridge-ros2dds -e tcp/10.0.0.10:7447\n</code></pre> subscriber<pre><code>ros2 topic echo /my_int32_topic\n</code></pre> <p>client bridge connect to remote bridge</p> <p>The zenoh-bridge-ros2dds is by default started in router mode This means it's listening for incoming TCP connections by remote bridges or any Zenoh application on port 7447 via any network interface.  It does perform discovery via scouting over UDP multicast or gossip protocol, but doesn't auto-connect to anything.</p>","tags":["zenoh","ros","bridge","router"]},{"location":"ROS/ros_world/zenoh/ros_bridge/zenoh_bridge_two_computers/#autoconnect","title":"autoconnect","text":"autoconnect.json5<pre><code>{\n  scouting: {\n    multicast: {\n      enabled: true,\n      autoconnect: { router: [\"router\"] }, \n      listen: true,\n    },\n  },\n}\n</code></pre> <p>Warning</p> <p>l.o multicast disabled by default don't work with environment variable <code>ROS_LOCALHOST_ONLY=1</code></p>","tags":["zenoh","ros","bridge","router"]},{"location":"ROS/ros_world/zenoh/ros_bridge/zenoh_bridge_two_computers/#remote-machine_2","title":"Remote machine","text":"publisher<pre><code>ROS_DOMAIN_ID=2 RMW_IMPLEMENTATION=rmw_cyclonedds_cpp ros2 topic pub /my_int32_topic std_msgs/msg/Int32 \"{ data: 10 }\"\n</code></pre> zenoh bridge<pre><code>ROS_DOMAIN_ID=2 ROS_DISTRO=humble ./zenoh-bridge-ros2dds --config autoconnect.json5\n</code></pre>","tags":["zenoh","ros","bridge","router"]},{"location":"ROS/ros_world/zenoh/ros_bridge/zenoh_bridge_two_computers/#local-machine_2","title":"Local machine","text":"zenoh bridge<pre><code>ROS_DISTRO=humble ./zenoh-bridge-ros2dds --config autoconnect.json5\n</code></pre> subscriber<pre><code>ros2 topic echo /my_int32_topic\n</code></pre>","tags":["zenoh","ros","bridge","router"]},{"location":"ROS/ros_world/zenoh/ros_bridge/zenoh_bridge_two_computers/#bridge-admin","title":"Bridge Admin","text":"<p>Running Bridge with <code>--rest-http-port 8000</code> expose web interface to query bridge state</p> Description http://\\&lt;bridge-IP&gt;:8000/@/local/ros2/node/** ROS nodes with their interfaces discovered by the bridge http://\\&lt;bridge-IP&gt;:8000/@//ros2/node/* ROS nodes discovered by all bridges http://\\&lt;bridge-IP&gt;:8000/@/local/ros2/route/** All routes between ROS interfaces and Zenoh established by the bridge more http://localhost:8001/@/*/ros2/node/**<pre><code>@/e25ed72d391828f7b6fbf87c5ea6e947/ros2/node/01102f4fbeea030c1eaab469000001c1/_ros2cli_daemon_0_ee39487b11b244b5b78a51b784d6e0ea\n    {\"action_clients\":[],\"action_servers\":[],\"publishers\":[{\"name\":\"/parameter_events\",\"type\":\"rcl_interfaces/msg/ParameterEvent\"},{\"name\":\"/rosout\",\"type\":\"rcl_interfaces/msg/Log\"}],\"service_clients\":[],\"service_servers\":[],\"subscribers\":[]}\n@/e25ed72d391828f7b6fbf87c5ea6e947/ros2/node/01100c7dd6bcb38d4918646d000001c1/_ros2cli_1340499\n    {\"action_clients\":[],\"action_servers\":[],\"publishers\":[{\"name\":\"/rosout\",\"type\":\"rcl_interfaces/msg/Log\"},{\"name\":\"/parameter_events\",\"type\":\"rcl_interfaces/msg/ParameterEvent\"}],\"service_clients\":[],\"service_servers\":[],\n    \"subscribers\":[{\"name\":\"/my_int32_topic\",\"type\":\"std_msgs/msg/Int32\"}]}\n@/5d61a72ea243edb2653eecef8632fee8/ros2/node/01100e33ce14108eacd1a16c000001c1/_ros2cli_4554\n    {\"action_clients\":[],\"action_servers\":[],\n    \"publishers\":[{\"name\":\"/my_int32_topic\",\"type\":\"std_msgs/msg/Int32\"},\n        {\"name\":\"/rosout\",\"type\":\"rcl_interfaces/msg/Log\"},\n        {\"name\":\"/parameter_events\",\"type\":\"rcl_interfaces/msg/ParameterEvent\"}],\n    \"service_clients\":[],\"service_servers\":[],\"subscribers\":[]} \n</code></pre>","tags":["zenoh","ros","bridge","router"]},{"location":"ROS/ros_world/zenoh/ros_bridge/zenoh_bridge_two_computers/#config","title":"Config","text":"<p>zenoh config from github</p> <ul> <li>Allow/Deny topics</li> <li>Max rate</li> </ul>","tags":["zenoh","ros","bridge","router"]},{"location":"ROS/ros_world/zenoh/ros_bridge/zenoh_bridge_two_computers/#allow-deny","title":"Allow /Deny","text":"<p>Allow / Deny</p> <p>In the config we set Allow key or Deny key Both of them not work</p> allow.json5<pre><code>{\n  plugins: {\n    ros2dds: {\n      pub_max_frequencies: {\n        publishers: [\"/my_int32_topic\"],\n        subscribers: [],\n        service_servers: [],\n        service_clients: [],\n        action_servers: [],\n        action_clients: [],\n      },\n    },\n    scouting: {\n      multicast: {\n        enabled: true,\n        autoconnect: { router: [\"router\"] },\n        listen: true,\n      },\n    },\n  },\n}\n</code></pre> bridge log<pre><code>INFO tokio-runtime-worker ThreadId(04) zenoh_plugin_ros2dds: Node /_ros2cli_5087 declares Publisher /my_int32_topic: std_msgs/msg/Int32 - Allowed\nINFO tokio-runtime-worker ThreadId(04) zenoh_plugin_ros2dds::routes_mgr: Route Publisher (ROS:/my_int32_topic -&gt; Zenoh:my_int32_topic) created\n</code></pre>","tags":["zenoh","ros","bridge","router"]},{"location":"ROS/ros_world/zenoh/ros_bridge/zenoh_bridge_two_computers/#pub_max_frequencies","title":"pub_max_frequencies","text":"<p>Config maximum publish rate for topic </p> allow.json5<pre><code>{\n   plugins: {\n\n    ros2dds: {\n\n       pub_max_frequencies: [\n        \"/my_int32_topic=0.5\" # hz\n      ]\n  },\n     scouting: {\n    multicast: {\n      enabled: true,\n      autoconnect: { router: [\"router\"] }, \n      listen: true,\n    },\n  },\n}\n}\n</code></pre> <pre><code>ros2 topic hz /my_int32_topic \naverage rate: 0.500\n    min: 2.001s max: 2.001s std dev: 0.00019s window: 2\naverage rate: 0.500\n    min: 2.001s max: 2.001s std dev: 0.00017s window: 3\n</code></pre>","tags":["zenoh","ros","bridge","router"]},{"location":"ROS/ros_world/zenoh/zenoh_pico/","title":"Zenoh pico","text":"","tags":["zenoh","pico","ros"]},{"location":"ROS/ros_world/zenoh/zenoh_pico/#reference","title":"Reference","text":"<ul> <li>ROS 2 and microcontrollers integration via Zenoh-pico</li> </ul>","tags":["zenoh","pico","ros"]},{"location":"Robotics/","title":"Robotics","text":"<p>sensors</p> <p>Math</p> <p>SLAM</p> <p>UxV Control</p> <p>Control</p> <p>Filters and Estimators</p>"},{"location":"Robotics/algorithms/","title":"Index","text":"<p>Robotics</p> <p>Bug 0,1,2</p>","tags":["robotics","algorithms"]},{"location":"Robotics/control/","title":"Control, main","text":"<p>Robotics</p> <p>PID</p> <p>MPC</p> <p>Geometric control</p> <p>LQR</p> <p>State Space Model</p>","tags":["control"]},{"location":"Robotics/control/#resource","title":"Resource","text":"<ul> <li>MATLAB Tech Talks: Explore the Control Systems Video Series</li> <li>System Identification and MPC Design using a Low-Cost Bi-Copter Hardware</li> </ul>","tags":["control"]},{"location":"Robotics/control/#learn","title":"Learn","text":"<ul> <li>Differential Equations and Dynamical Systems</li> <li>Control Bootcamp</li> <li>Master linear algebra: theory and implementation in code</li> <li>INTUITION MATTERS! Applied Calculus in Engineering: Complete</li> <li></li> <li>Engineering Mechanics: Dynamics 1 (Intuition + Application)</li> <li>Applied Control Systems 1: autonomous cars: Math + PID + MPC</li> </ul>","tags":["control"]},{"location":"Robotics/control/#to-read","title":"TO READ","text":"<ul> <li>How To Derive the State Space Model for a Mobile Robot</li> </ul>","tags":["control"]},{"location":"Robotics/control/geometric_control/","title":"Geometric Control of a Quadrotor UAV on SE(3)","text":"<ul> <li>geometric controller github</li> <li>uav simulator</li> <li>kv_mav_control</li> <li>RPG Quadrotor Control</li> <li>mpc</li> </ul>","tags":["geometric","controller","SE3","uav"]},{"location":"Robotics/control/lqr/","title":"LQR","text":"<p>Robotics / control</p>","tags":["lqr","control"]},{"location":"Robotics/control/lqr/#resource","title":"Resource","text":"<ul> <li>Compute and Simulate Linear Quadratic Regulator (LQR) in MATLAB for Set Point Tracking</li> <li>Linear Quadratic Regulator (LQR) With Python Code Example</li> </ul>","tags":["lqr","control"]},{"location":"Robotics/control/mpc/","title":"Model Predictive Control","text":"<p>Robotics / control</p>","tags":["control","mpc"]},{"location":"Robotics/control/mpc/#reference","title":"Reference","text":"<ul> <li>MATLAB: Understanding Model Predictive Control In this series, you'll learn how model predictive control (MPC) works, and you\u2019ll discover the benefits of this multivariable control technique</li> <li>Model Predictive Control for Dummies</li> <li>Data-Driven MPC for Quadrotors</li> </ul>","tags":["control","mpc"]},{"location":"Robotics/control/pid/","title":"PID Control","text":"<p>Robotics / control</p>","tags":["control","pid"]},{"location":"Robotics/control/pid/#reference","title":"Reference","text":"<ul> <li>Understanding PID Control</li> </ul>","tags":["control","pid"]},{"location":"Robotics/control/projects/inverse_pendulum/","title":"Inverse pendulum control","text":"<p>Robotics / control / projects</p>","tags":["inverse pendulum","control"]},{"location":"Robotics/control/projects/inverse_pendulum/#resource","title":"Resource","text":"<ul> <li>Cart pole simulation in Gazebo (PID control implementation and tuning using genetic algorithm)</li> <li>Two alternative methods of solving the cart pole problem (LQR and Q-learning)</li> </ul>","tags":["inverse pendulum","control"]},{"location":"Robotics/control/state_space_model/","title":"State Space Model","text":"<p>Robotics / control</p>","tags":["control","state space"]},{"location":"Robotics/control/state_space_model/#reference","title":"Reference","text":"<ul> <li>Introduction to State-Space Equations | State Space, Part 1</li> <li>How To Derive A State Space Model For A Mobile Robot</li> </ul>","tags":["control","state space"]},{"location":"Robotics/filter_and_estimator/","title":"filter and estimator","text":"<p>Robotics</p> <p>Kalman Filter</p> <p>Filters</p>","tags":["control","filter","estimator"]},{"location":"Robotics/filter_and_estimator/filters/","title":"Index","text":"<p>Robotics / filter and estimator</p>","tags":["filters"]},{"location":"Robotics/filter_and_estimator/filters/#iir-low-past-filter","title":"IIR low past filter","text":"<p>first-order IIR low-pass filter, also called an exponential moving average It keeps mostly the slow trend (low frequencies) and suppresses fast changes (high frequencies).</p> \\[y[n] = (1 - \\alpha) \\cdot x[n] + \\alpha \\cdot y[n-1]\\] <ul> <li>x[n] \u2192 new input sample</li> <li>y[n] \u2192 filtered output</li> <li>y[n\u22121] is the previous output</li> <li>\u03b1 \u2192 smoothing factor (0\u20131)</li> </ul>","tags":["filters"]},{"location":"Robotics/filter_and_estimator/filters/#alfa","title":"alfa","text":"<p>smoothing factor between (0\u20131)</p> <ul> <li>If \u03b1 is small (e.g. 0.1), the filter reacts quickly to new changes (less smoothing).</li> <li>If \u03b1 is large (e.g. 0.9), the filter reacts slowly, producing a smoother result.</li> </ul>","tags":["filters"]},{"location":"Robotics/filter_and_estimator/filters/#demo","title":"Demo","text":"<pre><code>import numpy as np\nimport matplotlib.pyplot as plt\n\n# Simulated noisy signal\nt = np.linspace(0, 2*np.pi, 200)\nx = np.sin(t) + 0.5*np.random.randn(len(t))\n\n# Exponential Moving Average (IIR LPF)\nalpha = 0.9\ny = np.zeros_like(x)\nfor i in range(1, len(x)):\n    y[i] = (1 - alpha) * x[i] + alpha * y[i-1]\n\nplt.figure(figsize=(10,5))\nplt.plot(t, x, label=\"Noisy Signal\")\nplt.plot(t, y, label=f\"IIR Low-pass (alpha={alpha})\", linewidth=2)\nplt.legend()\nplt.show()\n</code></pre>","tags":["filters"]},{"location":"Robotics/filter_and_estimator/filters/#simple-moving-average","title":"Simple moving average","text":"<p>It smooths a signal by taking the average of the last N samples:</p> \\[y[n] = \\frac{1}{N} \\sum_{k=0}^{N-1} x[n-k]\\] <p>SMA is great for smoothing sensor readings like distance sensors or temperature, but not ideal for real-time fast response (since it introduces delay).</p>","tags":["filters"]},{"location":"Robotics/filter_and_estimator/filters/#demo_1","title":"Demo","text":"<pre><code>import numpy as np\nimport matplotlib.pyplot as plt\nfrom collections import deque\n\nclass MovingAverage:\n    def __init__(self, window_size):\n        self.window_size = window_size\n        self.buffer = deque(maxlen=window_size)\n        self.sum = 0.0\n\n    def update(self, new_value):\n        if len(self.buffer) == self.window_size:\n            self.sum -= self.buffer[0]\n        self.buffer.append(new_value)\n        self.sum += new_value\n        return self.sum / len(self.buffer)\n\n\n# Generate noisy signal (simulate stream)\nt = np.linspace(0, 4*np.pi, 200)\nsignal = np.sin(t) + 0.5*np.random.randn(len(t))\n\n# Apply streaming moving average\nma = MovingAverage(window_size=5)\nma_15 = MovingAverage(window_size=15)\nfiltered = []\nfiltered2 = []\n\nfor x in signal:\n    y = ma.update(x)\n    filtered.append(y)\n    y2 = ma_15.update(x)\n    filtered2.append(y2)\n\n# Plot results\nplt.figure(figsize=(10,5))\nplt.plot(t, signal, label=\"Noisy Signal\", alpha=0.6)\nplt.plot(t, filtered, label=\"Streaming SMA (window=5)\", linewidth=2)\nplt.plot(t, filtered2, label=\"Streaming SMA (window=15)\", linewidth=2)\nplt.legend()\nplt.show()\n</code></pre> <p>The code implementation return the average event if the window buffer not full</p>","tags":["filters"]},{"location":"Robotics/filter_and_estimator/filters/#resource","title":"Resource","text":"<ul> <li>An Introduction to Digital Filters, without the mathematics</li> </ul>","tags":["filters"]},{"location":"Robotics/filter_and_estimator/kalman_filter/","title":"Kalman filter","text":"<p>Robotics / filter and estimator</p>","tags":["kalman","filter","control"]},{"location":"Robotics/filter_and_estimator/kalman_filter/#reference","title":"Reference","text":"<ul> <li>Why Use Kalman Filters? | Understanding Kalman Filters, Part 1</li> </ul>","tags":["kalman","filter","control"]},{"location":"Robotics/kinematics/","title":"Robot Kinematics","text":"<p>Robot kinematics is the study of how a robot moves, focusing on the geometry of motion\u2014positions, orientations, and velocities\u2014without considering forces or masses.</p>","tags":["diff-drive","ackermann","forward","reverse"]},{"location":"Robotics/kinematics/mobile_robot/","title":"Mobile Robot Kinematics","text":"","tags":["diff-drive","ackermann"]},{"location":"Robotics/kinematics/mobile_robot/#reference","title":"Reference","text":"<ul> <li>Robot Kinematics Part 01: Introduction</li> <li>mobile-robot-kinematics-equations</li> </ul>","tags":["diff-drive","ackermann"]},{"location":"Robotics/math/","title":"Math","text":"<p>linear algebra</p> <p>Coordinate systems</p> <p>quaternion</p>","tags":["robotics","math"]},{"location":"Robotics/math/#good-resources","title":"Good resources","text":"<ul> <li>Mr P , Primarily python coding tutorials with a physics/math focus</li> <li>How To Interpolate Data In Python</li> <li>ROB 101: Computational Linear Algebra</li> <li>Probability Primer for Probabilistic Robotics (Cyrill Stachniss) </li> </ul>","tags":["robotics","math"]},{"location":"Robotics/math/coordinate_system/","title":"Coordinate systems","text":"<p>Robotics / math</p>","tags":["coordinate","euler","tait-bryan"]},{"location":"Robotics/math/coordinate_system/#taitbryan","title":"Tait\u2013Bryan","text":"<p>Tait\u2013Bryan angles are a way to describe orientation in 3D space using three rotations about three different axes.</p> <p></p> <ul> <li>Roll (\u03c6) \u2192 rotation about the X-axis</li> <li>Pitch (\u03b8) \u2192 rotation about the Y-axis</li> <li>Yaw (\u03c8) \u2192 rotation about the Z-axis</li> </ul>","tags":["coordinate","euler","tait-bryan"]},{"location":"Robotics/math/coordinate_system/#intrinsic-and-extrinsic","title":"Intrinsic and Extrinsic","text":"<ul> <li>Intrinsic: The rotation relative to current body axes , it's use in robotics and ROS</li> <li>Extrinsic: The rotation always relative to the fixed world axes</li> </ul>","tags":["coordinate","euler","tait-bryan"]},{"location":"Robotics/math/coordinate_system/#intrinsic","title":"Intrinsic","text":"<p>rotations are about the body axes. \\(\\(R_{\\text{intrinsic}} = R_z(\\text{yaw}) \\cdot R_y(\\text{pitch}) \\cdot R_x(\\text{roll})\\)\\)</p> code <pre><code>import numpy as np\nimport matplotlib.pyplot as plt\n\n# --- Rotation Matrices ---\ndef Rx(theta):\n    return np.array([[1, 0, 0],\n                     [0, np.cos(theta), -np.sin(theta)],\n                     [0, np.sin(theta),  np.cos(theta)]])\n\ndef Ry(theta):\n    return np.array([[np.cos(theta), 0, np.sin(theta)],\n                     [0, 1, 0],\n                     [-np.sin(theta), 0, np.cos(theta)]])\n\ndef Rz(theta):\n    return np.array([[np.cos(theta), -np.sin(theta), 0],\n                     [np.sin(theta),  np.cos(theta), 0],\n                     [0, 0, 1]])\n\n# --- Plot Function ---\ndef plot_axes(R, ax, title):\n    origin = np.zeros(3)\n    x_axis = R @ np.array([1, 0, 0])\n    y_axis = R @ np.array([0, 1, 0])\n    z_axis = R @ np.array([0, 0, 1])\n\n    ax.quiver(*origin, *x_axis, color=\"r\")\n    ax.quiver(*origin, *y_axis, color=\"g\")\n    ax.quiver(*origin, *z_axis, color=\"b\")\n\n    ax.set_xlim([-1.5, 1.5])\n    ax.set_ylim([-1.5, 1.5])\n    ax.set_zlim([-1.5, 1.5])\n    ax.set_title(title)\n\n# --- Angles ---\nroll = np.deg2rad(90)\npitch = np.deg2rad(45)\nyaw = np.deg2rad(180)\n\n# --- Intrinsic sequence ---\nR0 = np.eye(3)\nR1 = R0 @ Rx(roll)      # roll about body X\nR2 = R1 @ Ry(pitch)     # then pitch about new Y\nR3 = R2 @ Rz(yaw)       # then yaw about new Z\n\n# --- Plot ---\nfig = plt.figure(figsize=(10,10))\nplot_axes(R0, fig.add_subplot(221, projection=\"3d\"), \"Step 1: Rest\")\nplot_axes(R1, fig.add_subplot(222, projection=\"3d\"), \"Step 2: Roll 90\u00b0 (body X)\")\nplot_axes(R2, fig.add_subplot(223, projection=\"3d\"), \"Step 3: + Pitch 45\u00b0 (body Y)\")\nplot_axes(R3, fig.add_subplot(224, projection=\"3d\"), \"Step 4: + Yaw 180\u00b0 (body Z)\")\nplt.tight_layout()\nplt.show()\n</code></pre> <p></p>","tags":["coordinate","euler","tait-bryan"]},{"location":"Robotics/math/coordinate_system/#extrinsic","title":"Extrinsic","text":"<p>rotations are about the fixed world axes.</p> \\[R_{\\text{extrinsic}} = R_x(\\text{roll}) \\cdot R_y(\\text{pitch}) \\cdot R_z(\\text{yaw})\\] code <pre><code>import numpy as np\nimport matplotlib.pyplot as plt\n\n# --- Rotation Matrices ---\ndef Rx(theta):\n    return np.array([[1, 0, 0],\n                     [0, np.cos(theta), -np.sin(theta)],\n                     [0, np.sin(theta),  np.cos(theta)]])\n\ndef Ry(theta):\n    return np.array([[np.cos(theta), 0, np.sin(theta)],\n                     [0, 1, 0],\n                     [-np.sin(theta), 0, np.cos(theta)]])\n\ndef Rz(theta):\n    return np.array([[np.cos(theta), -np.sin(theta), 0],\n                     [np.sin(theta),  np.cos(theta), 0],\n                     [0, 0, 1]])\n\n# --- Plot Function ---\ndef plot_axes(R, ax, title):\n    origin = np.zeros(3)\n    x_axis = R @ np.array([1, 0, 0])\n    y_axis = R @ np.array([0, 1, 0])\n    z_axis = R @ np.array([0, 0, 1])\n\n    ax.quiver(*origin, *x_axis, color=\"r\")\n    ax.quiver(*origin, *y_axis, color=\"g\")\n    ax.quiver(*origin, *z_axis, color=\"b\")\n\n    ax.set_xlim([-1.5, 1.5])\n    ax.set_ylim([-1.5, 1.5])\n    ax.set_zlim([-1.5, 1.5])\n    ax.set_title(title)\n\n# --- Angles ---\nroll = np.deg2rad(90)\npitch = np.deg2rad(45)\nyaw = np.deg2rad(180)\n\n# --- Extrinsic sequence ---\nR0 = np.eye(3)\nR1 = Rx(roll) @ R0      # roll about world X\nR2 = Ry(pitch) @ R1     # then pitch about world Y\nR3 = Rz(yaw) @ R2       # then yaw about world Z\n\n# --- Plot ---\nfig = plt.figure(figsize=(10,10))\nplot_axes(R0, fig.add_subplot(221, projection=\"3d\"), \"Step 1: Rest\")\nplot_axes(R1, fig.add_subplot(222, projection=\"3d\"), \"Step 2: Roll 90\u00b0 (world X)\")\nplot_axes(R2, fig.add_subplot(223, projection=\"3d\"), \"Step 3: + Pitch 45\u00b0 (world Y)\")\nplot_axes(R3, fig.add_subplot(224, projection=\"3d\"), \"Step 4: + Yaw 180\u00b0 (world Z)\")\nplt.tight_layout()\nplt.show()\n</code></pre> <p></p>","tags":["coordinate","euler","tait-bryan"]},{"location":"Robotics/math/coordinate_system/#rotate-using-scipy","title":"Rotate using scipy","text":"<ul> <li>Lowercase (\"xyz\") = intrinsic (body-fixed).</li> <li>Uppercase (\"XYZ\") = extrinsic (world-fixed).</li> </ul> code <pre><code>import numpy as np\nimport matplotlib.pyplot as plt\nfrom scipy.spatial.transform import Rotation as R\n\n# --- Angles (degrees) ---\nroll, pitch, yaw = 90, 45, 180\n\n# --- Intrinsic rotation (body axes: roll -&gt; pitch -&gt; yaw) ---\nrot_intrinsic = R.from_euler(\"zyx\", [yaw, pitch, roll], degrees=True)\nzyx_intrinsic = rot_intrinsic.as_matrix()\n\nrot_intrinsic2 = R.from_euler(\"xyz\", [roll, pitch, yaw], degrees=True)\nxyz_intrinsic = rot_intrinsic2.as_matrix()\n\n# --- Extrinsic rotation (world axes: roll -&gt; pitch -&gt; yaw) ---\nrot_extrinsic = R.from_euler(\"ZYX\", [yaw, pitch, roll], degrees=True)\nZYX_extrinsic = rot_extrinsic.as_matrix()\n\nrot_extrinsic2 = R.from_euler(\"XYZ\", [roll, pitch, yaw], degrees=True)\nXYZ_extrinsic = rot_extrinsic2.as_matrix()\n\n# --- Helper plot function ---\ndef plot_axes(R, ax, title):\n    origin = np.zeros(3)\n    x_axis = R @ np.array([1, 0, 0])\n    y_axis = R @ np.array([0, 1, 0])\n    z_axis = R @ np.array([0, 0, 1])\n\n    ax.quiver(*origin, *x_axis, color=\"r\", label=\"X\")\n    ax.quiver(*origin, *y_axis, color=\"g\", label=\"Y\")\n    ax.quiver(*origin, *z_axis, color=\"b\", label=\"Z\")\n\n    ax.set_xlim([-1.5, 1.5])\n    ax.set_ylim([-1.5, 1.5])\n    ax.set_zlim([-1.5, 1.5])\n    ax.set_xlabel(\"X\")\n    ax.set_ylabel(\"Y\")\n    ax.set_zlabel(\"Z\")\n    ax.set_title(title)\n    ax.legend()\n\n# --- Plot both ---\nfig = plt.figure(figsize=(12,6))\n\n# Vector\nR0 = np.eye(3)\n\n# Rotate vector\nv_intrinsic = zyx_intrinsic @ R0\nv_extrinsic = ZYX_extrinsic @ R0\n\nax1 = fig.add_subplot(221, projection=\"3d\")\nplot_axes(v_intrinsic, ax1, \"zyx (body frame)\")\nax1.get_legend().remove() \n\nax1 = fig.add_subplot(223, projection=\"3d\")\nplot_axes(xyz_intrinsic, ax1, \"xyz\")\nax1.get_legend().remove() \n\nax2 = fig.add_subplot(222, projection=\"3d\")\nplot_axes(v_extrinsic, ax2, \"ZYX\")\nax2.get_legend().remove()\n\nax2 = fig.add_subplot(224, projection=\"3d\")\nplot_axes(XYZ_extrinsic, ax2, \"XYZ ()\")\nax2.get_legend().remove()\n# plt.tight_layout()\nplt.show()\n\n# --- Print matrices ---\nnp.set_printoptions(precision=4, suppress=True)\nprint(\"Intrinsic Rotation Matrix:\\n\", zyx_intrinsic)\nprint(\"\\nExtrinsic Rotation Matrix:\\n\", ZYX_extrinsic)\n</code></pre> Intrinsic (body axes, lowercase) Equivalent Extrinsic (world axes, uppercase reversed) <code>\"xyz\"</code> \u2192 roll-pitch-yaw (body x\u2192y\u2192z) <code>\"ZYX\"</code> \u2192 yaw-pitch-roll (world z\u2192y\u2192x) <code>\"xzy\"</code> <code>\"YZX\"</code> <code>\"yxz\"</code> <code>\"ZXY\"</code> <code>\"yzx\"</code> <code>\"XZY\"</code> <code>\"zxy\"</code> <code>\"YXZ\"</code> <code>\"zyx\"</code> <code>\"XYZ\"</code>","tags":["coordinate","euler","tait-bryan"]},{"location":"Robotics/math/coordinate_system/#reference","title":"Reference","text":"<ul> <li>Correct Explanation of Yaw, Pitch, and Roll Euler Angles with Rotation Matrices and Python Code </li> </ul>","tags":["coordinate","euler","tait-bryan"]},{"location":"Robotics/math/linear_algebra/","title":"Index","text":"<p>Robotics / math</p>","tags":["math","linear algebra"]},{"location":"Robotics/math/linear_algebra/#unit-vector","title":"Unit vector","text":"<p>Any vector with magnitude of length 1 is considered a unit vector.</p>","tags":["math","linear algebra"]},{"location":"Robotics/math/linear_algebra/#normalize","title":"Normalize","text":"<p>scale down a vector to magnitude of 1, while preserving the direction</p> \\[ \\left\\| v \\right\\| = \\sqrt{x^{2}+y^{2}+z^{2}} \\] \\[ u=\\frac{v}{\\left\\| v \\right\\|} \\] <pre><code>import numpy as np\n\nv = np.array([1,1])\nmagnitude = np.linalg.norm(v)\nnormalize_v = v / magnitude\nprint(normalize_v)\n</code></pre>","tags":["math","linear algebra"]},{"location":"Robotics/math/linear_algebra/#dot-product","title":"Dot product","text":"<p>stackoverflow godot vector math The dot product takes two vectors and returns a scalar:</p> <pre><code>var s = a.x*b.x + a.y*b.y + a.z*b.z\n</code></pre> <pre><code>var s = a.dot(b)\n</code></pre> <p></p> <ul> <li>If the number is greater than zero, both are looking towards the same direction (the angle between them is &lt; 90\u00b0 degrees). </li> <li>If the number is less than zero, both are looking towards opposite direction (the angle between them is &gt; 90\u00b0 degrees). </li> <li>If the number is zero, vectors are shaped in L (the angle between them is 90\u00b0 degrees).</li> </ul>","tags":["math","linear algebra"]},{"location":"Robotics/math/linear_algebra/#dot-product-on-unit-vector","title":"dot product on unit vector","text":"<ul> <li>If both vectors are facing towards the exact same direction (parallel to each other, angle between them is 0\u00b0), the resulting scalar is 1. </li> <li>If both vectors are facing towards the exact opposite direction (parallel to each other, but angle between them is 180\u00b0), the resulting scalar is -1. </li> <li>If their angle is 90\u00b0, then dot product is 0</li> </ul> <p>This means that dot product between unit vectors is always between the range of 1 and -1</p> <p></p> <p>The dot product between two unit vectors is the cosine of the angle between those two vectors. So, to obtain the angle between two vectors.</p> <pre><code>angle_in_radians = acos( a.dot(b) )\n# a and b are unit vector\n</code></pre>","tags":["math","linear algebra"]},{"location":"Robotics/math/quaternion/","title":"Quaternion","text":"<p>Robotics / math</p> <p>Quaternions are an alternate way to describe orientation or rotations in 3D space using an ordered set of four numbers. They have the ability to uniquely describe any three-dimensional rotation about an arbitrary axis and do not suffer from gimbal lock</p> <p>Quaternions without math </p>","tags":["math","quaternion"]},{"location":"Robotics/math/quaternion/#unit-quaternion","title":"Unit quaternion","text":"<p>A unit quaternion like unit vector is simply a vector with length (magnitude) equal to 1, but pointing in the same direction as the original vector.</p> <p>quaternion: \\(\\(q = w + xi + yj + zk\\)\\)</p> <p>as a vector \\(\\(q = (w, x, y, z)\\)\\)</p> <p>calc the norm \\(\\(\\|q\\| = \\sqrt{w^2 + x^2 + y^2 + z^2}\\)\\)</p> <p>calc unit quaternion \\(\\(q_{unit} = \\frac{q}{\\|q\\|} = \\left(\\frac{w}{\\|q\\|}, \\frac{x}{\\|q\\|}, \\frac{y}{\\|q\\|}, \\frac{z}{\\|q\\|}\\right)\\)\\)</p> code example","tags":["math","quaternion"]},{"location":"Robotics/math/quaternion/#conjugate","title":"Conjugate","text":"<p>A quaternion is: \\(\\(q = (x, y, z, w)\\)\\)</p> <p>The conjugate is: \\(\\(q^* = (-x, -y, -z, w)\\)\\)</p> <p>flip the signs of x, y, z, keep w the same.</p>","tags":["math","quaternion"]},{"location":"Robotics/math/quaternion/#slerp","title":"Slerp","text":"<p>Spherical Linear intERPolation (SLERP) is a method to smoothly interpolate between two orientations (unit quaternions). - SLERP traces the shortest arc along that sphere between them</p> \\[SLERP(q_0, q_1, t) = \\frac{\\sin((1-t)\\theta)}{\\sin(\\theta)} q_0 + \\frac{\\sin(t\\theta)}{\\sin(\\theta)} q_1\\] <ul> <li>At t=0 \u2192 result = q0</li> <li>At t=1 \u2192 result = q1</li> <li>At t=0.5 \u2192 halfway rotation between them.</li> </ul> Demo: using scipy","tags":["math","quaternion"]},{"location":"Robotics/math/quaternion/#inverse","title":"Inverse","text":"<p>unit quaternion</p> <p>If q is a unit quaternion (\u2225q\u2225=1), then the conjugate is also the inverse.</p> <p>when not unit length</p> \\[q^{-1} = \\frac{q^*}{\\|q\\|^2}\\] \\[q \\cdot q^{-1} = 1\\]","tags":["math","quaternion"]},{"location":"Robotics/math/quaternion/#multiple","title":"Multiple","text":"","tags":["math","quaternion"]},{"location":"Robotics/math/quaternion/#by-vector","title":"by vector","text":"\\[\\mathbf{v}' = q \\, \\mathbf{v} \\, q^{-1}\\] <p>we treat the vector as pure quaternion</p> \\[\\mathbf{v} = (v_x, v_y, v_z, 0)\\] Numpy Example","tags":["math","quaternion"]},{"location":"Robotics/math/quaternion/#by-quaternion","title":"by quaternion","text":"<p>Quaternion multiplication is used to combine rotations in 3D space</p> \\[q_1 = (w_1, x_1, y_1, z_1), \\quad q_2 = (w_2, x_2, y_2, z_2)\\] \\[q = q_2 \\cdot q_1 =  \\Big(  w_2 w_1 - x_2 x_1 - y_2 y_1 - z_2 z_1, \\; w_2 x_1 + x_2 w_1 + y_2 z_1 - z_2 y_1, \\; w_2 y_1 - x_2 z_1 + y_2 w_1 + z_2 x_1, \\; w_2 z_1 + x_2 y_1 - y_2 x_1 + z_2 w_1 \\Big)\\] <p>Warning</p> \\[q_2 q_1 \\neq q_1 q_2\\]","tags":["math","quaternion"]},{"location":"Robotics/math/quaternion/#reference","title":"Reference","text":"<p>watch again</p>","tags":["math","quaternion"]},{"location":"Robotics/sensors/","title":"Index","text":"<p>Robotics</p> <p>Camera</p> <p>Event Camera</p> <p>IMU</p> <p>--</p> <p>--</p> <p>--</p> <p></p>","tags":["sensors"]},{"location":"Robotics/sensors/camera/","title":"Camera sensor","text":"<p>Robotics / sensors</p>","tags":["camera","sensor"]},{"location":"Robotics/sensors/camera/#focal-length-f_x-f_y","title":"focal length $ f_{x}, f_{y}$","text":"<p>Focal length is the distance from the lens\u2019s optical center (or principal point) to the image sensor when the subject is in focus. in true pinhole camera \\(f_{x} = f_{y}\\)</p> <p>$ f_{x} = \\frac{\\frac{W}{2}}{tan(\\frac{hfov}{2})} $</p> <p>$ f_{y} = \\frac{\\frac{H}{2}}{tan(\\frac{vfov}{2})} $</p>","tags":["camera","sensor"]},{"location":"Robotics/sensors/camera/#principal-point-c_x-c_y","title":"Principal Point $ c_{x}, c_{y}$","text":"<p>pixel location where the optical axis hits the sensor. Often close to the image center, but not necessarily exactly , \\(\\frac{W}{2}, \\frac{H}{2}\\)</p>","tags":["camera","sensor"]},{"location":"Robotics/sensors/camera/#intrinsic","title":"Intrinsic","text":"<p>Camera internal parameters</p>","tags":["camera","sensor"]},{"location":"Robotics/sensors/camera/#minimal","title":"Minimal","text":"<p>$ k=\\begin{bmatrix}  f &amp; 0 &amp; c_{x} \\  0 &amp; f &amp; c_{y} \\  0 &amp; 0 &amp; 1 \\ \\end{bmatrix} $</p>","tags":["camera","sensor"]},{"location":"Robotics/sensors/camera/#general","title":"General","text":"<p>$ k=\\begin{bmatrix}  f_{x} &amp; s &amp; c_{x} \\  0 &amp; f_{y} &amp; c_{y} \\  0 &amp; 0 &amp; 1 \\ \\end{bmatrix} $</p>","tags":["camera","sensor"]},{"location":"Robotics/sensors/camera/#fov-field-of-view","title":"FOV (Field Of View)","text":"<p>The angular extent of the scene captured by the lens</p>","tags":["camera","sensor"]},{"location":"Robotics/sensors/encoder/","title":"Index","text":"","tags":["sensor","encoder","AS5048"]},{"location":"Robotics/sensors/encoder/#wiring","title":"Wiring","text":"<p> | color  | desc                       | uno pin        | | ------ | -------------------------- | -------------- | | black  | CSN  (chip select)         | D10 (any gpio) | | purple | CLK                        | D13 (SCK)      | | yellow | MOSI (master out slave in) | D11 (COPI)     | | green  | MISO (master in slave out) | D12 (CIPO)     | | red    | 5/3.3                      |                | | white  | GND                        |                |</p> <p>white = purple red = green green = yellow yellow = black purple = red black = white</p> <p></p>","tags":["sensor","encoder","AS5048"]},{"location":"Robotics/sensors/encoder/#code","title":"Code","text":"<pre><code>#include &lt;SPI.h&gt;\n\n// Define the AS5048A SPI settings\nSPISettings AS5048ASettings(1000000, MSBFIRST, SPI_MODE1);\n\n// Define the chip select pin\nconst int CSPin = 10;\n\nvoid setup() {\n  // Set the chip select pin as an output\n  pinMode(CSPin, OUTPUT);\n  // Begin SPI communication\n  SPI.begin();\n  // Pull the chip select pin high to deselect the sensor\n  digitalWrite(CSPin, HIGH);\n}\n\nvoid loop() {\n  // Read the angle from the sensor\n  unsigned int angle = readAS5048A();\n  // Print the angle to the Serial Monitor\n  Serial.println(angle);\n  delay(1000); // Wait for 1 second\n}\n\nunsigned int readAS5048A() {\n  // Variable to store the angle\n  unsigned int angle = 0;\n  // Pull the chip select pin low to select the sensor\n  digitalWrite(CSPin, LOW);\n  // Start SPI transaction with the defined settings\n  SPI.beginTransaction(AS5048ASettings);\n  // Send the command to read the angle\n  SPI.transfer(0xFF);\n  // Read the high byte of the angle\n  angle = SPI.transfer(0x00);\n  // Shift the high byte and read the low byte\n  angle = (angle &lt;&lt; 8) | SPI.transfer(0x00);\n  // End the SPI transaction\n  SPI.endTransaction();\n  // Pull the chip select pin high to deselect the sensor\n  digitalWrite(CSPin, HIGH);\n  // Return the angle\n  return angle;\n}\n</code></pre>","tags":["sensor","encoder","AS5048"]},{"location":"Robotics/sensors/encoder/#reference","title":"Reference","text":"<ul> <li>How to Use AS5048 Magnetic Encoder Position Sensor: Examples, Pinouts, and Specs </li> </ul>","tags":["sensor","encoder","AS5048"]},{"location":"Robotics/sensors/event_camera/","title":"Event Camera","text":"<p>Robotics / sensors</p>","tags":["event camera"]},{"location":"Robotics/sensors/event_camera/#resources","title":"Resources","text":"<ul> <li>Secrets of Event-Based Optical Flow (T-PAMI 2024, ECCV 2022)<ul> <li>The MVSEC Dataset </li> </ul> </li> </ul>","tags":["event camera"]},{"location":"Robotics/sensors/event_camera/#dataset-mvsec","title":"Dataset MVSEC","text":"<p>Download</p> <pre><code>pip install h5py\n</code></pre> <pre><code>import h5py\n\ndef print_hdf5_structure(g, indent=0):\n    \"\"\"Recursively print the structure of an HDF5 file/group.\"\"\"\n    spacing = \"  \" * indent\n    if isinstance(g, h5py.Dataset):\n        print(f\"{spacing}- Dataset: {g.name}, shape={g.shape}, dtype={g.dtype}\")\n    elif isinstance(g, h5py.Group):\n        print(f\"{spacing}+ Group: {g.name}\")\n        for key in g.keys():\n            print_hdf5_structure(g[key], indent + 1)\n\n# Open MVSEC file (replace with your file path)\nfile_path = \"/home/user/Downloads/outdoor_day1_gt-001.hdf5\"\nwith h5py.File(file_path, \"r\") as f:\n    print(\"Top-level groups:\", list(f.keys()))\n    print(\"\\nFull structure:\\n\")\n    print_hdf5_structure(f)\n</code></pre> <ol> <li> <p>*_data.hdf5 This is the raw sensor data:</p> </li> <li> <p>*_gt.hdf5 This is the ground truth file:</p> </li> </ol>","tags":["event camera"]},{"location":"Robotics/sensors/event_camera/#view-image-from-file","title":"View image from file","text":"<pre><code>import h5py\nimport cv2\nimport numpy as np\n\n# Path to your MVSEC dataset file (data file, not gt)\nfile_path = \"/home/user/Downloads/outdoor_day1_data-004.hdf5\"\n\n# Open HDF5 file\nwith h5py.File(file_path, \"r\") as f:\n    # Explore groups\n    print(\"Top-level groups:\", list(f.keys()))\n\n    # APS frames are typically under: /davis/left/images/data\n    images = f[\"davis\"][\"left\"][\"image_raw\"]\n\n\n    print(\"Number of images:\", images.shape[0])\n    print(\"Image shape:\", images.shape[1:])  # (height, width)\n\n    # Extract the first image\n    first_img = images[0]  # shape (H, W), dtype=uint8\n\n    # Show with OpenCV\n    cv2.imshow(\"First APS Image\", first_img)\n    cv2.waitKey(0)\n    cv2.destroyAllWindows()\n</code></pre>","tags":["event camera"]},{"location":"Robotics/sensors/event_camera/#resources_1","title":"Resources","text":"<ul> <li>\"Event-based Robot Vision\" Course taught at TU Berlin, Germany, during Spring 2020.</li> </ul>","tags":["event camera"]},{"location":"Robotics/sensors/gpio/mcp23017_gpio_i2c_extension_interface/","title":"MCP23017 gpio i2c extension","text":"","tags":["tag"]},{"location":"Robotics/sensors/gpio/mcp23017_gpio_i2c_extension_interface/#connect-to-rpi","title":"Connect to RPi","text":"","tags":["tag"]},{"location":"Robotics/sensors/gpio/mcp23017_gpio_i2c_extension_interface/#pinout","title":"Pinout","text":"","tags":["tag"]},{"location":"Robotics/sensors/gpio/mcp23017_gpio_i2c_extension_interface/#wiring","title":"Wiring","text":"MCP23017 RPi note VCC 1 3.3v GND 6 SDA 3 SCL 5 RESET 1 3.3v","tags":["tag"]},{"location":"Robotics/sensors/gpio/mcp23017_gpio_i2c_extension_interface/#i2c","title":"i2c","text":"install<pre><code>sudo apt install i2c-tools\n</code></pre>","tags":["tag"]},{"location":"Robotics/sensors/gpio/mcp23017_gpio_i2c_extension_interface/#detect","title":"detect","text":"<pre><code>sudo i2cdetect -y 1\n     0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f\n00:                         -- -- -- -- -- -- -- -- \n10: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- \n20: 20 -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- \n30: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- \n40: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- \n50: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- \n60: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- \n</code></pre>","tags":["tag"]},{"location":"Robotics/sensors/gpio/mcp23017_gpio_i2c_extension_interface/#demo","title":"Demo","text":"<p>Connect LED to port PA0</p> <pre><code># set all portA pin as output\nsudo i2cset -y 1 0x20 0x00 0x00 \n\n# set gister 0x0c\nsudo i2cset -y 1 0x20 0x14 0x01\nsudo i2cset -y 1 0x20 0x14 0x00\n</code></pre>","tags":["tag"]},{"location":"Robotics/sensors/gpio/mcp23017_gpio_i2c_extension_interface/#registers","title":"Registers","text":"<p>The MCP23017 supports two register addressing modes:</p> <pre><code>Bank 0 (Sequential Addressing - Default Mode)\nBank 1 (Split Addressing Mode)\n</code></pre> <p></p> <p>demo</p> <p>The demo above use register</p> <ul> <li>register 0x00(IODIRA) as set portA all pin to output</li> <li>register 0x14(OLATA) set as 0x00/0x01 to set port <code>PA0</code> low/high</li> </ul>","tags":["tag"]},{"location":"Robotics/sensors/gpio/mcp23017_gpio_i2c_extension_interface/#datasheet","title":"Datasheet","text":"","tags":["tag"]},{"location":"Robotics/sensors/gpio/mcp23017_gpio_i2c_extension_interface/#351-io-direction-register","title":"3.5.1 I/O DIRECTION REGISTER","text":"<p>Controls the direction of the data I/O. When a bit is set, the corresponding pin becomes an input. When a bit is clear, the corresponding pin becomes an output.</p> <p></p>","tags":["tag"]},{"location":"Robotics/sensors/gpio/mcp23017_gpio_i2c_extension_interface/#3511-output-latch-register-olat","title":"3.5.11 OUTPUT LATCH REGISTER (OLAT)","text":"<p>The OLAT register provides access to the output latches. A read from this register results in a read of the OLAT and not the port itself. A write to this register modifies the output latches that modifies the pins configured as outputs.</p> <p></p> <p>register address</p> <p>The data sheet use bank1 address mode The address is 0x14 for OLATA register in bank0 mode</p>","tags":["tag"]},{"location":"Robotics/sensors/gpio/mcp23017_gpio_i2c_extension_interface/#permission","title":"Permission","text":"<p>Check file owner and add you'r user to file group</p> <pre><code>sudo usermod -aG i2c $USER\n</code></pre>","tags":["tag"]},{"location":"Robotics/sensors/gpio/mcp23017_gpio_i2c_extension_interface/#cpp-demo","title":"CPP Demo","text":"<p>Toggle PA0 on/off</p> <pre><code>#include &lt;iostream&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;linux/i2c-dev.h&gt;\n#include &lt;sys/ioctl.h&gt;\n#include &lt;chrono&gt;\n#include &lt;thread&gt;\n#include &lt;cstdint&gt;  // For fixed-width integers\n\nint main() {\n    int file;\n    const char *i2cBus = \"/dev/i2c-1\"; // I2C bus\n    const int deviceAddress = 0x20;    // MCP23017 I2C address\n\n    // Open the I2C bus\n    file = open(i2cBus, O_RDWR);\n    if (file &lt; 0) {\n        std::cerr &lt;&lt; \"Failed to open I2C bus\\n\";\n        return -1;\n    }\n\n    // Connect to the MCP23017 device\n    if (ioctl(file, I2C_SLAVE, deviceAddress) &lt; 0) {\n        std::cerr &lt;&lt; \"Failed to connect to I2C device\\n\";\n        close(file);\n        return -1;\n    }\n\n    // Set IODIRA register (0x00) to 0x00 (all output)\n    uint8_t config[2] = {0x00, 0x00};\n    if (write(file, config, 2) != 2) {\n        std::cerr &lt;&lt; \"Failed to write to I2C device\\n\";\n    }\n\n    // Toggle PA0 port using GPIOA (0x14)\n    for (int i=0; i&lt;10; i++)\n    {\n        uint8_t state = i%2;\n        uint8_t output[2] = {0x14, state};\n        if (write(file, output, 2) != 2) {\n            std::cerr &lt;&lt; \"Failed to write GPIOA\\n\";\n        }\n        std::this_thread::sleep_for(std::chrono::seconds(1));\n    }\n\n    // // Read GPIOA (0x12)\n    // uint8_t reg = 0x12;\n    // if (write(file, &amp;reg, 1) != 1) {\n    //     std::cerr &lt;&lt; \"Failed to set register address\\n\";\n    // }\n\n    // uint8_t data;\n    // if (read(file, &amp;data, 1) != 1) {\n    //     std::cerr &lt;&lt; \"Failed to read from I2C device\\n\";\n    // } else {\n    //     std::cout &lt;&lt; \"GPIOA Data: 0x\" &lt;&lt; std::hex &lt;&lt; (int)data &lt;&lt; std::dec &lt;&lt; std::endl;\n    // }\n\n    close(file);\n    return 0;\n}\n</code></pre>","tags":["tag"]},{"location":"Robotics/sensors/gpio/mcp23017_gpio_i2c_extension_interface/#python-demo","title":"Python Demo","text":"<pre><code>pip3 install smbus2\n</code></pre> <p>Toggle PA0 on/off</p> <pre><code>from smbus2 import SMBus\nimport time\n\nI2C_BUS = 1         # Raspberry Pi uses I2C bus 1\nI2C_ADDR = 0x20     # MCP23017 I2C address\n\n# MCP23017 Register Addresses\nIODIRA = 0x00       # I/O direction register for GPIOA\nGPIOA = 0x12        # Register to read/write GPIOA\nOLATA = 0x14        # Output latch register for GPIOA\n\nwith SMBus(I2C_BUS) as bus:\n    # Set all GPIOA pins as output (0x00 means all pins are outputs)\n    bus.write_byte_data(I2C_ADDR, IODIRA, 0x00)\n\n    while True:\n        # Turn PA0 ON (set bit 0 to 1)\n        bus.write_byte_data(I2C_ADDR, OLATA, 0x01)\n        print(\"PA0 ON\")\n        time.sleep(1)\n\n        # Turn PA0 OFF (set bit 0 to 0)\n        bus.write_byte_data(I2C_ADDR, OLATA, 0x00)\n        print(\"PA0 OFF\")\n        time.sleep(1)\n</code></pre>","tags":["tag"]},{"location":"Robotics/sensors/gpio/mcp23017_gpio_i2c_extension_interface/#reference","title":"Reference","text":"<ul> <li>Datasheet</li> </ul>","tags":["tag"]},{"location":"Robotics/sensors/i2c/","title":"Using CP2112 to connect i2c device over USB","text":"<p>The CP2112 USB-to-I2C Bridge is a device from Silicon Labs designed to facilitate communication between a USB host (like a PC) and I2C devices</p> <p></p>","tags":["i2c","cp2112","usb"]},{"location":"Robotics/sensors/i2c/#i2c-tools","title":"i2c-tools","text":"<pre><code>sudo apt install i2c-tools\n</code></pre> <pre><code>i2cdetect -l\n#\n...\ni2c-16  unknown         CP2112 SMBus Bridge on hidraw5          N/A\n</code></pre>","tags":["i2c","cp2112","usb"]},{"location":"Robotics/sensors/i2c/#connect-i2c-sensor-at-address-0x18","title":"connect i2c sensor at address 0x18","text":"<pre><code>sudo i2cdetect -y -r 16\n[sudo] password for user: \n     0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f\n00:                         -- -- -- -- -- -- -- -- \n10: -- -- -- -- -- -- -- -- 18 -- -- -- -- -- -- -- \n20: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- \n30: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- \n40: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- \n50: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- \n60: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- \n70: -- -- -- -- -- -- -- --                         \n</code></pre>","tags":["i2c","cp2112","usb"]},{"location":"Robotics/sensors/i2c/#udev-rule","title":"udev rule","text":"<p>Add udev rule to add permission <code>rw</code> for all</p> <pre><code>ll /dev/i2c-16\n#\ncrw-rw---- 1 root i2c 89, 16 Nov  1 07:10 /dev/i2c-16\n</code></pre> <pre><code>udevadm info -a -p  $(udevadm info -q path -n /dev/i2c-16)\n#\n\n  looking at device '/devices/pci0000:00/0000:00:14.0/usb3/3-4/3-4.2/3-4.2.4/3-4.2.4:1.0/0003:10C4:EA90.0011/i2c-16/i2c-dev/i2c-16':\n    KERNEL==\"i2c-16\"\n    SUBSYSTEM==\"i2c-dev\"\n    DRIVER==\"\"\n    ATTR{name}==\"CP2112 SMBus Bridge on hidraw5\"\n    ATTR{power/async}==\"disabled\"\n    ATTR{power/control}==\"auto\"\n    ATTR{power/runtime_active_kids}==\"0\"\n    ATTR{power/runtime_active_time}==\"0\"\n    ATTR{power/runtime_enabled}==\"disabled\"\n    ATTR{power/runtime_status}==\"unsupported\"\n    ATTR{power/runtime_suspended_time}==\"0\"\n    ATTR{power/runtime_usage}==\"0\"\n</code></pre> udev rule<pre><code>echo 'SUBSYSTEMS==\"i2c-dev\", ATTRS{name}==\"CP2112 SMBus Bridge on hidraw5\", MODE=\"0666\"' | sudo tee /etc/udev/rules.d/90-i2c-usb.rules\n</code></pre> check rule<pre><code>sudo udevadm control --reload\n# plug out/ in\n# check device permission\nll /dev/i2c-16\ncrw-rw-rw- 1 root i2c 89, 16 Nov  1 08:05 /dev/i2c-16\n#know we can run i2cdetect without sudo\ni2cdetect -y -r 16\n</code></pre>","tags":["i2c","cp2112","usb"]},{"location":"Robotics/sensors/imu/","title":"IMU Sensor","text":"<p>Robotics / sensors</p> <p>An IMU sensor (Inertial Measurement Unit) is a device that measures a robot or object's motion and orientation using:</p> Sensor Measures Unit Accelerometer Linear acceleration m/s\u00b2 Gyroscope Angular velocity (rotational speed) rad/s Magnetometer (optional) Magnetic field for heading (compass) \u00b5T <ul> <li>6 DOF IMU, combining a 3-axis accelerometer and a 3-axis gyroscope.</li> <li>9 DOF IMU, adding a 3-axis magnetic compass.</li> <li>10 DOF IMU, which adds a barometer for estimating the sensor\u2019s altitude.</li> </ul>","tags":["imu","robotics","sensors"]},{"location":"Robotics/sensors/imu/#to-read-and-watch","title":"To read and watch","text":"<ul> <li>complementary filter</li> <li>madgwick_py: A Python implementation of Madgwick's IMU and AHRS algorithm.</li> <li>madgwick algorithm</li> <li>Kalman Filter for 6DOF IMU Implementation</li> </ul>","tags":["imu","robotics","sensors"]},{"location":"Robotics/slam/","title":"SLAM (Simultaneous Localization and Mapping)","text":"<p>SLAM (Simultaneous Localization and Mapping) is a technique used in robotics and computer vision to create a map of an unknown environment while simultaneously keeping track of the robot's location within that environment. It is a fundamental problem in robotics, particularly for autonomous vehicles, drones, and mobile robots. SLAM algorithms typically use sensor data (such as LiDAR, cameras, or IMU) to build a map of the environment and estimate the robot's position. The process involves two main components: 1. Mapping: Creating a representation of the environment, which can be a 2D or 3D map, depending on the application. 2. Localization: Determining the robot's position and orientation within the created map.</p>","tags":["robotics","slam","mapping","localization","navigation"]},{"location":"Robotics/slam/#key-concepts-in-slam","title":"Key Concepts in SLAM","text":"<ul> <li>Sensor Fusion: Combining data from multiple sensors to improve the accuracy and robustness of the SLAM system.</li> <li>Feature Extraction: Identifying and extracting key features from the sensor data that can be used for mapping and localization.</li> <li>Data Association: Matching observed features with previously mapped features to maintain consistency in the map and the robot's position.</li> <li>Loop Closure: Recognizing when the robot has returned to a previously visited location, which helps to correct drift in the map and improve accuracy.</li> <li>Graph-Based SLAM: A popular approach that represents the SLAM problem as a graph, where nodes represent poses (robot positions) and edges represent constraints (observations or measurements).</li> <li>Particle Filters: A probabilistic approach to SLAM that uses a set of particles to represent the robot's belief about its position and the map.</li> <li>Kalman Filters: A mathematical approach to estimate the state of a dynamic system, often used in SLAM for linear systems.</li> <li>Extended Kalman Filter (EKF): An extension of the Kalman filter that can handle non-linear systems, commonly used in SLAM.</li> <li>Visual SLAM (V-SLAM): A specific type of SLAM that uses visual data from cameras to perform mapping and localization.</li> <li>LiDAR SLAM: A type of SLAM that uses LiDAR sensors to create high-resolution maps of the environment.</li> </ul>","tags":["robotics","slam","mapping","localization","navigation"]},{"location":"Robotics/slam/#resources","title":"Resources","text":"<ul> <li>Claus Brenner SLAM lectures</li> <li>Overview of SLAM</li> <li>Implement SLAM from scratch</li> </ul>","tags":["robotics","slam","mapping","localization","navigation"]},{"location":"Robotics/uav/","title":"uXv","text":"<p>QGroundControl</p> <p>PX4</p> <p>Ardupilot</p> <p>betaflight</p> <p>FPV</p> <p>Mavlink</p>","tags":["uav","ugv","ardupilot","mavlink"]},{"location":"Robotics/uav/#to-read-and-watch","title":"To read and watch","text":"<ul> <li>Building a sub 250g Autonomous Drone with Ardupilot and ExpressLRS AirPort Telemetry<ul> <li>part list</li> </ul> </li> <li> <p>BETAFLIGHT Tutorial for Beginners!!! - Updated &amp; Step by Step</p> </li> <li> <p>fpv simulators</p> </li> <li>expresslrs</li> </ul>","tags":["uav","ugv","ardupilot","mavlink"]},{"location":"Robotics/uav/ardupilot/","title":"Ardupilot","text":"<p>Robotics / uav</p> <p>SITL and Simulation</p> <p>EKF3</p> <p>mavlink</p> <p>debug</p> <p>SYSID/GCS config </p> <p>Optical flow </p>","tags":["ardupilot","apm"]},{"location":"Robotics/uav/ardupilot/#arducopter-modes","title":"ArduCopter Modes","text":"Mode Desc Notes LOITER Vehicle to hold its current position using a position source such as GPS or visual odometry. - Allows pilot to nudge position with the RC sticks; vehicle holds new position. GUIDED autonomous mode where the vehicle accepts real-time movement commands from a mavlink messages like go to GPS coordinate , velocity or attitude commands AUTO AUTO mode is a fully autonomous flight mode where the vehicle executes a predefined mission composed of waypoints and commands STABILIZE manual flight mode in which the pilot has direct control over the roll, pitch, and yaw of the vehicle, while ArduPilot automatically keeps the vehicle level and stable using data from the IMU - throttle: direct motor control (no stick to power ?) ALT_HOLD automatically maintains altitude, while the pilot retains full control over pitch, roll, and yaw. - control vertical speed GUIDED_NOGPS Guided mode does not require a GPS but it only accepts attitude targets","tags":["ardupilot","apm"]},{"location":"Robotics/uav/ardupilot/ahrs/","title":"Ardupilot ahrs","text":"<ul> <li>AHRS: EKF (control by <code>AHRS_EKF_TYPE</code>)</li> <li>AHRS2: DCM (need to validate)</li> <li>AHRS3</li> </ul> <p>Robotics / uav / ardupilot</p>","tags":["ahrs","ardupilot"]},{"location":"Robotics/uav/ardupilot/debug/","title":"Debug SITL","text":"<p>Robotics / uav / ardupilot</p> <p>Debug ardupilot SITL using vscode</p> <p>Debugging with GDB using VSCode</p>","tags":["ardupilot","debug"]},{"location":"Robotics/uav/ardupilot/debug/#debug-steps","title":"Debug steps","text":"<ul> <li>Build SITL with debug symbols</li> </ul> <pre><code>./waf configure --debug\n</code></pre> <p>or</p> <pre><code>sim_vehicle.py -v ArduCopter -f quad --console --map -D\n</code></pre> check if build with debug symbols<pre><code># with\nfile arducopter \n#\narducopter: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=9d5c29c3cd71ea0de53ee3585adc661d1650e8f8, for GNU/Linux 3.2.0, with debug_info, not stripped\n\n# without (download precompiled from firmware.ardupilot.org)\nfile arducopter \n#\narducopter: ELF 64-bit LSB executable, x86-64, version 1 (GNU/Linux), statically linked, BuildID[sha1]=2a762be075efcc4fe2b39bf1ce56873b3aa33a6d, for GNU/Linux 3.2.0, not stripped\n</code></pre>","tags":["ardupilot","debug"]},{"location":"Robotics/uav/ardupilot/ekf3/","title":"Ardupilot ekf3","text":"<p>Robotics / uav / ardupilot</p> <p>An Extended Kalman Filter (EKF) algorithm is used to estimate vehicle position, velocity and angular orientation based on rate gyroscopes, accelerometer, compass, GPS, airspeed and barometric pressure measurements.</p> Parameter value Desc EK3_ENABLE 1 AHRS_EKF_TYPE 3 EK3_IMU_MASK EK3_PRIMARY EK3_ALT_M_NSE Lower number reduces reliance on accelerometers, increases reliance on barometer. EK3_GPS_TYPE Controls how GPS is used. EK3_YAW_M_NSE Controls the weighting between GPS and Compass when calculating the heading <p>The EKF instantiates multiple instances of the filter called \u2018lanes\u2019. The primary lane is the one that provides state estimates, rest are updated in the background and available for switching to. The number of possible lanes is exactly equal to the number of IMUs enabled for use. Affinity is a way for the EKF lanes to use non-primary sensors within any running lane.</p>","tags":["ardupilot","ekf3"]},{"location":"Robotics/uav/ardupilot/ekf3/#ek3_imu_mask-and-ekf3-instance","title":"EK3_IMU_MASK and EKF3 instance","text":"<p>EK3_IMU_MASK 1 byte bitmap of IMUs to use in EKF3. A separate instance of EKF3 will be started for each IMU selected.</p> Bit IMU Binary Meaning 0 1 1 Use IMU 1 1 2 2 Use IMU 2 2 3 4 Use IMU 3 <p>Version 4.6 EKF deprecated parameters</p>","tags":["ardupilot","ekf3"]},{"location":"Robotics/uav/ardupilot/ekf3/#configuration","title":"Configuration","text":"<pre><code>EK3_IMU_MASK = 2\nEK3_PRIMARY = 0   # Because only one EKF instance will run, and it's at index 0\n</code></pre> <pre><code>EK3_IMU_MASK = 3 # IMU1 and IMU2 working and create two EKF instance\nEK3_PRIMARY = 1   # To use the instance assigned to IMU2\n</code></pre>","tags":["ardupilot","ekf3"]},{"location":"Robotics/uav/ardupilot/ekf3/#sensor-affinity","title":"Sensor affinity","text":"<p>ArduPilot EKF3 allows you to assign specific sensors (e.g., IMUs, GPS, barometers) to particular EKF \"lanes\" (instances). Each EKF lane can run in parallel, using different sensor combinations for redundancy and robustness.</p>","tags":["ardupilot","ekf3"]},{"location":"Robotics/uav/ardupilot/ekf3/#mavlink-estimation","title":"Mavlink estimation","text":"Feature <code>VISION_POSITION_ESTIMATE</code> <code>GLOBAL_VISION_POSITION_ESTIMATE</code> MAVLink ID <code>102</code> <code>101</code> Frame of Reference Local frame (e.g., body or map-local) Global frame aligned to NED from origin Position Fields <code>x, y, z</code> \u2192 meters <code>x, y, z</code> \u2192 meters Orientation <code>roll, pitch, yaw</code> in radians <code>roll, pitch, yaw</code> in radians Origin Definition Arbitrary local frame Aligned to a global origin (NED or ENU) Units All in SI (meters, radians) All in SI (meters, radians) Usage VIO, MoCap in local environments Global alignment (with known origin)","tags":["ardupilot","ekf3"]},{"location":"Robotics/uav/ardupilot/ekf3/#todoparse-flag-from-command-193","title":"TODO:Parse flag from command 193","text":"<p>Switch ekf3 sources</p> <p></p> <p> </p>","tags":["ardupilot","ekf3"]},{"location":"Robotics/uav/ardupilot/ekf3/#reference","title":"Reference","text":"<ul> <li>Extended Kalman Filter (EKF)</li> <li>EKF3 Affinity and Lane Switching</li> <li>EKF Source Selection and Switching</li> <li>EKF2 Affinity and Lane switching</li> <li>Non-GPS Position Estimation</li> <li>Extended Kalman Filter Navigation Overview and Tuning</li> <li>GPS / Non-GPS Transitions</li> </ul>","tags":["ardupilot","ekf3"]},{"location":"Robotics/uav/ardupilot/ekf3/gps_no_gps/","title":"Ardupilot simulation to learn ekf3 gps none gps switch using vicon simulation","text":"<p>Robotics / uav / ardupilot / ekf3</p> <p>Simulate using ardupilot SITL gps and none gps environment using vicon and switch between ekf sources The simulate generate VISION_POSITION_ESTIMATE and VISION_VELOCITY_ESTIMATE</p> run sitl with vicon simulation<pre><code>Tools/autotest/sim_vehicle.py -v ArduCopter --map --console -A \"--serial5=sim:vicon:\"\n</code></pre> <p>Ena/Dis sim GPS</p> <p>SIM_GPS1_ENABLE 0: Disabled 1: Enabled</p>","tags":["ardupilot","ekf3","none_gps"]},{"location":"Robotics/uav/ardupilot/ekf3/gps_no_gps/#parameters","title":"Parameters","text":"name value VISO_TYPE 2 (intelT265) SERIAL5_PROTOCOL2 2 (mavlink2) EK3_SRC1 EK3_SRC1_POSXY 3 (GPS) EK3_SRC1_POSZ baro EK3_SRC1_VELXY 3 EK3_SRC1_VELZ 3 EK3_SRC1_YAW 1 (Compass) EK3_SRC2 EK3_SRC2_POSXY 6 (ExternalNav) EK3_SRC2_POSZ baro EK3_SRC2_VELXY 6 (ExternalNav) EK3_SRC2_VELZ 6 EK3_SRC2_YAW 1 (Compass) <p>switch sources</p> <p>MAV_CMD_SET_EKF_SOURCE_SET (42007)</p> <p></p> <p>set param</p> <pre><code># enabled\nparam set SIM_GPS1_ENABLE 1\n# disabled\nparam set SIM_GPS1_ENABLE 0\n</code></pre> <p></p> <p></p>","tags":["ardupilot","ekf3","none_gps"]},{"location":"Robotics/uav/ardupilot/ekf3/gps_no_gps/#ekf","title":"EKF","text":"","tags":["ardupilot","ekf3","none_gps"]},{"location":"Robotics/uav/ardupilot/ekf3/gps_no_gps/#ardupilot","title":"Ardupilot","text":"<p>EKF_STATUS_REPORT (193) </p> <p>ESTIMATOR_STATUS (230)</p> <p>Ardupilot not implement this message</p>","tags":["ardupilot","ekf3","none_gps"]},{"location":"Robotics/uav/ardupilot/ekf3/gps_no_gps/#switch-source","title":"Switch source","text":"<p>Mavlink command MAV_CMD_SET_EKF_SOURCE_SET from ardupilot dialect</p> using mavros to switch<pre><code># param1: 1-3\nros2 service call /mavros/cmd/command mavros_msgs/srv/CommandLong \\\n\"{command: 42007, param1: 2}\"\n</code></pre>","tags":["ardupilot","ekf3","none_gps"]},{"location":"Robotics/uav/ardupilot/gcs/","title":"Index","text":"<p>Robotics / uav / ardupilot</p> Parameter Role <code>SYSID_MYGCS</code> Defines the expected GCS <code>SYSID</code> (default: <code>255</code>) <code>SYSID_ENFORCE</code> If <code>1</code>, only MAVLink msgs from <code>SYSID_MYGCS</code> will be accepted <code>SYSID_THISMAV</code> The autopilot\u2019s own system ID (default: <code>1</code>) <p></p> <p>SYSID_ENFORCE</p> <p>If SYSID_ENFORCE=1 the SYSID_MYGCS and  Ground Station System ID must be the same to allow this station send command to FCU</p>","tags":["ardupilot","SYSID_MYGCS","SYSID_ENFORCE","SYSID_THISMAV"]},{"location":"Robotics/uav/ardupilot/gimbal/","title":"Index","text":"<p>Robotics / uav / ardupilot</p> <p>Servo Gimbal</p>","tags":["ardupilot","gimbal"]},{"location":"Robotics/uav/ardupilot/gimbal/servo/","title":"Ardupilot Servo GIMBAL","text":"<p>Robotics / uav / ardupilot / gimbal</p> Param Value Description SERVO9_FUNCTION 8 (1-roll) SERVO10_FUNCTION 7 (1-pitch) SERVO11_FUNCTION 6 (1-yaw)","tags":["ardupilot","gimbal","servo"]},{"location":"Robotics/uav/ardupilot/mavlink/","title":"Ardupilot mavlink","text":"<p>Pymavlink</p>","tags":["mavlink"]},{"location":"Robotics/uav/ardupilot/mavlink/pymavlink/","title":"Ardupilot mavlink with pymavlink","text":"","tags":["ardupilot","pymavlink"]},{"location":"Robotics/uav/ardupilot/mavlink/pymavlink/#sitl","title":"SITL","text":"<pre><code># ver 4.6.1\n./arducopter --model copter --defaults params/basic.param -I0\n</code></pre> basic.param <pre><code>FRAME_CLASS 1\nFRAME_TYPE 1\n\nSIM_GPS_DISABLE 0\nAHRS_EKF_TYPE 2\nINS_ACCOFFS_X 0.001\nINS_ACCOFFS_Y 0.001\nINS_ACCOFFS_Z 0.001\nINS_ACCSCAL_X 1.001\nINS_ACCSCAL_Y 1.001\nINS_ACCSCAL_Z 1.001\nINS_ACC2OFFS_X 0.001\nINS_ACC2OFFS_Y 0.001\nINS_ACC2OFFS_Z 0.001\nINS_ACC2SCAL_X 1.001\nINS_ACC2SCAL_Y 1.001\nINS_ACC2SCAL_Z 1.001\nINS_GYR_CAL 0\n\nRNGFND1_TYPE 100        # 100 = simulated\nRNGFND1_ORIENT 25     # 25 = Downward (typical for landing)\nRNGFND1_MIN_CM 20     # 20 cm minimum range\nRNGFND1_MAX_CM 400    # 400 cm max range\nSIM_SONAR_SCALE 100   # Scaling for simulated range data\nRNGFND1_SCALING 1     # Optional: default scaling\n</code></pre> <p>Hello</p> <p>Set message interval</p> <p>Send message to GCS</p> <p>Send other location</p>","tags":["ardupilot","pymavlink"]},{"location":"Robotics/uav/ardupilot/mavlink/pymavlink/#hello","title":"Hello","text":"<p>Connect to SITL and print out every mavlink received typically only heartbeat and timesync received on no one request other messages</p> <pre><code>from pymavlink import mavutil\n# cast helpers\nfrom typing import cast\nfrom pymavlink.dialects.v20.common import MAVLink_message\nfrom pymavlink.mavutil import mavtcp\n\n\nconn = mavutil.mavlink_connection('tcp:127.0.0.1:5760')\nconn = cast(mavtcp, conn)\n# Make sure the connection is valid\nconn.wait_heartbeat()\n\n# Get some information !\nwhile True:\n    try:\n        msg = conn.recv_match(blocking=True)\n        msg = cast(MAVLink_message, msg)\n        if msg:\n            print(msg.get_type(), msg.to_dict())\n    except Exception as _:\n        pass\n</code></pre>","tags":["ardupilot","pymavlink"]},{"location":"Robotics/uav/ardupilot/mavlink/pymavlink/#send-command-long-to-set-message-interval","title":"Send command long to set message interval","text":"<pre><code>from pymavlink import mavutil\n# cast helpers\nfrom typing import cast\nfrom pymavlink.dialects.v20.common import MAVLink_message\nfrom pymavlink.dialects.v20.ardupilotmega import MAVLink\nfrom pymavlink.dialects.v20 import common\nfrom pymavlink.mavutil import mavtcp\n\nconn = mavutil.mavlink_connection('tcp:127.0.0.1:5760')\nconn = cast(mavtcp, conn)\n\ndef request_message_interval(conn: mavtcp, message_id: int, frequency_hz: float):\n    \"\"\"\n    Request MAVLink message in a desired frequency,\n    documentation for SET_MESSAGE_INTERVAL:\n        https://mavlink.io/en/messages/common.html#MAV_CMD_SET_MESSAGE_INTERVAL\n\n    Args:\n        message_id (int): MAVLink message ID\n        frequency_hz (float): Desired frequency in Hz\n    \"\"\"\n\n\n    conn.mav.command_long_send(\n        conn.target_system, conn.target_component,\n        common.MAV_CMD_SET_MESSAGE_INTERVAL, 0,\n        message_id, # The MAVLink message ID\n        1e6 / frequency_hz, # The interval between two messages in microseconds. Set to -1 to disable and 0 to request default rate.\n        0, 0, 0, 0, # Unused parameters\n        0, # Target address of message stream (if message has target address fields). 0: Flight-stack default (recommended), 1: address of requestor, 2: broadcast.\n    )\n\n\n# Make sure the connection is valid\nconn.wait_heartbeat()\n\nrequest_message_interval(conn, common.MAVLINK_MSG_ID_GPS_RAW_INT, 1)\n\n# Get some information !\nwhile True:\n    try:\n        msg = conn.recv_match(blocking=True)\n        msg = cast(MAVLink_message, msg)\n        if msg:\n            print(msg.get_type(), msg.to_dict())\n    except Exception as _:\n        pass\n</code></pre>","tags":["ardupilot","pymavlink"]},{"location":"Robotics/uav/ardupilot/mavlink/pymavlink/#send-message-to-gcs","title":"Send message to gcs","text":"<ul> <li>Send message to GCS using STATUSTEXT</li> <li>Mavlink info</li> <li>Severity</li> </ul> <pre><code>from pymavlink import mavutil\nimport time\nfrom pymavlink.dialects.v20 import common\n\n# Create the connection to the top-side computer as companion computer/autopilot\nmaster = mavutil.mavlink_connection(\n    \"udpout:localhost:14550\", source_system=1, source_component=190\n)\n\nwhile True:\n\n    master.mav.statustext_send(\n        common.MAV_SEVERITY_INFO, \"QGC will read this\".encode()\n    )\n    time.sleep(1)\n</code></pre> <p>udpout</p> <p>Send mavlink stream over udp</p>","tags":["ardupilot","pymavlink"]},{"location":"Robotics/uav/ardupilot/mavlink/pymavlink/#send-other-location-using-adsb","title":"Send other location using ADSB","text":"<p>Send other location information using ADSB check mavlink message ADSB_VEHICLE (246) </p> <pre><code>from pymavlink import mavutil\nimport time\nfrom pymavlink.dialects.v20 import common\n\n\nconn = mavutil.mavlink_connection(\"udpout:127.0.0.1:14550\", source_system=0)\n\nICAO_ADDR = 0xABCDEF  # must be unique per vehicle\n\nwhile True:\n    conn.mav.adsb_vehicle_send(\n        ICAO_ADDR,                 # ICAO address (unique ID)\n        int(-35.362160 *1e7),        # lat (deg * 1e7)\n        int(149.164975 * 1e7),        # lon (deg * 1e7)\n        common.ADSB_ALTITUDE_TYPE_PRESSURE_QNH,\n        100 * 1000,                # altitude (mm)\n        0,                          # heading (cdeg)\n        0,                          # horizontal velocity (cm/s)\n        0,                          # vertical velocity (cm/s)\n        b\"OTHER_VEHICLE\",            # callsign\n        mavutil.mavlink.ADSB_EMITTER_TYPE_UAV,                          # emitter_type\n        0,                          # tslc\n        mavutil.mavlink.ADSB_FLAGS_VALID_COORDS,                           # flags\n        0\n    )\n    time.sleep(1)\n</code></pre> <p></p>","tags":["ardupilot","pymavlink"]},{"location":"Robotics/uav/ardupilot/optical_flow/","title":"Index","text":"<p>Robotics / uav / ardupilot</p> <p>ekf3-optical-flow-and-gps-behavior</p>","tags":["ardupilot","optical flow"]},{"location":"Robotics/uav/ardupilot/sitl/","title":"Ardupilot SITL with gazebo and mavros","text":"<p>Robotics / uav / ardupilot</p> <p>Run Ardupilot SITL (ver 4.6.1) with mavros and gazebo simulation (harmonic)</p> <p>Gimbal</p> <p>pymavlink</p>","tags":["ardupilot","sitl","simulation","gazebo","mavros","harmonic"]},{"location":"Robotics/uav/ardupilot/sitl/#sitl","title":"SITL","text":"<ul> <li>Ardupilot firmware download</li> <li>Download Copter 4.6.1 SITL </li> </ul>","tags":["ardupilot","sitl","simulation","gazebo","mavros","harmonic"]},{"location":"Robotics/uav/ardupilot/sitl/#run-without-gazebo","title":"Run without gazebo","text":"run sitl<pre><code>./arducopter --model copter --defaults copter.parm  -I0\n</code></pre> copter.param<pre><code>FRAME_CLASS 1\nFRAME_TYPE 1\n\nSIM_GPS_DISABLE 0\nAHRS_EKF_TYPE 2\nINS_ACCOFFS_X 0.001\nINS_ACCOFFS_Y 0.001\nINS_ACCOFFS_Z 0.001\nINS_ACCSCAL_X 1.001\nINS_ACCSCAL_Y 1.001\nINS_ACCSCAL_Z 1.001\nINS_ACC2OFFS_X 0.001\nINS_ACC2OFFS_Y 0.001\nINS_ACC2OFFS_Z 0.001\nINS_ACC2SCAL_X 1.001\nINS_ACC2SCAL_Y 1.001\nINS_ACC2SCAL_Z 1.001\nINS_GYR_CAL 0\n\nRNGFND1_TYPE 100        # 100 = simulated\nRNGFND1_ORIENT 25     # 25 = Downward (typical for landing)\nRNGFND1_MIN_CM 20     # 20 cm minimum range\nRNGFND1_MAX_CM 400    # 400 cm max range\nSIM_SONAR_SCALE 100   # Scaling for simulated range data\nRNGFND1_SCALING 1     # Optional: default scaling\n</code></pre> <p>INS_XXX</p> <p>Set INS_XXX for skip the accelerometer calibration </p>","tags":["ardupilot","sitl","simulation","gazebo","mavros","harmonic"]},{"location":"Robotics/uav/ardupilot/sitl/#mavros","title":"Mavros","text":"mavros docker snippet<pre><code># region install mavros\nRUN apt-get update \\\n&amp;&amp; apt-get -y install --no-install-recommends \\\n    ros-jazzy-mavros \\\n    ros-jazzy-mavros-extras \\\n&amp;&amp; apt-get clean -y \\\n&amp;&amp; rm -rf /var/lib/apt/lists/*\n\nRUN ros2 run mavros install_geographiclib_datasets.sh\n\n# endregion install mavros\n</code></pre> <pre><code>ros2 launch mavros apm.launch fcu_url:=tcp://:5760@\n\n# forward\nros2 launch mavros apm.launch \\\nfcu_url:=tcp://localhost:5760 \\\ngcs_url:=udp://@localhost:14550\n</code></pre>","tags":["ardupilot","sitl","simulation","gazebo","mavros","harmonic"]},{"location":"Robotics/uav/ardupilot/sitl/#gazebo-harmonic","title":"Gazebo (harmonic)","text":"<p>Clone ardupilot_gazebo into workspace,  - install dependencies  - build with colcon - source  - and run </p> dependencies<pre><code>sudo apt update\nsudo apt install libgz-sim8-dev rapidjson-dev\nsudo apt install libopencv-dev libgstreamer1.0-dev libgstreamer-plugins-base1.0-dev gstreamer1.0-plugins-bad gstreamer1.0-libav gstreamer1.0-gl\n</code></pre> <p></p> <p>simulation RTF</p> <p>The simulation real time factor Usually fix after connect with mavros or other GCS to sitl</p>","tags":["ardupilot","sitl","simulation","gazebo","mavros","harmonic"]},{"location":"Robotics/uav/ardupilot/sitl/#usage","title":"Usage","text":"copter-gz.param<pre><code>FRAME_CLASS 1\nFRAME_TYPE 1\n</code></pre> terminal 1<pre><code>./arducopter --model JSON  --defaults copter-gz.param -I0\n</code></pre> terminal 2<pre><code>gz sim -v4 -r iris_runway.sdf\n</code></pre> terminal 3<pre><code>ros2 launch mavros apm.launch fcu_url:=tcp://localhost:5760 gcs_url:=udp://@localhost:14550\n</code></pre>","tags":["ardupilot","sitl","simulation","gazebo","mavros","harmonic"]},{"location":"Robotics/uav/ardupilot/sitl/#guide-arm-and-takeoff","title":"Guide ARM and takeoff","text":"set mode<pre><code>ros2 service call /mavros/set_mode mavros_msgs/srv/SetMode \"{base_mode: 0, custom_mode: 'GUIDED'}\"\n</code></pre> arm<pre><code>ros2 service call /mavros/cmd/arming mavros_msgs/srv/CommandBool \"{value: True}\"\n</code></pre> take off<pre><code> ros2 service call /mavros/cmd/takeoff mavros_msgs/srv/CommandTOL \"{\n  min_pitch: 0.0,\n  yaw: 0.0,\n  latitude: 0.0,\n  longitude: 0.0,\n  altitude: 5.0\n}\"\n</code></pre>","tags":["ardupilot","sitl","simulation","gazebo","mavros","harmonic"]},{"location":"Robotics/uav/ardupilot/sitl/#reference","title":"Reference","text":"<ul> <li>Debugging with GDB using VSCode</li> <li>ardupilot-devenv</li> </ul>","tags":["ardupilot","sitl","simulation","gazebo","mavros","harmonic"]},{"location":"Robotics/uav/ardupilot/sitl/gimbal/","title":"Simulation GIMBAL using Ardupilot and Gazebo","text":"<p>Robotics / uav / ardupilot / sitl</p>","tags":["ardupilot","sitl","gimbal","gazebo","ros","mavros"]},{"location":"Robotics/uav/ardupilot/sitl/gimbal/#gazebo","title":"Gazebo","text":"","tags":["ardupilot","sitl","gimbal","gazebo","ros","mavros"]},{"location":"Robotics/uav/ardupilot/sitl/gimbal/#topics","title":"topics","text":"<ul> <li>/gimbal/cmd_roll</li> <li>/gimbal/cmd_pitch</li> <li>/gimbal/cmd_yaw</li> </ul>","tags":["ardupilot","sitl","gimbal","gazebo","ros","mavros"]},{"location":"Robotics/uav/ardupilot/sitl/gimbal/#pub-example","title":"pub example","text":"pitch/tilt 90 degree down<pre><code>gz topic -t /gimbal/cmd_pitch -m gz.msgs.Double -p 'data: 1.575'\n</code></pre> pitch/tilt horizon<pre><code>gz topic -t /gimbal/cmd_pitch -m gz.msgs.Double -p 'data: 0'\n\ngz topic -t /gimbal/cmd_pitch -m gz.msgs.Double -p 'data: -0.2'\n</code></pre> yaw<pre><code># flu position ccw\ngz topic -t /gimbal/cmd_yaw -m gz.msgs.Double -p 'data: 1.0'\ngz topic -t /gimbal/cmd_yaw -m gz.msgs.Double -p 'data: 0'\ngz topic -t /gimbal/cmd_yaw -m gz.msgs.Double -p 'data: -1.0'\n</code></pre> roll<pre><code>gz topic -t /gimbal/cmd_roll -m gz.msgs.Double -p 'data: 1.0'\ngz topic -t /gimbal/cmd_roll -m gz.msgs.Double -p 'data: 0'\ngz topic -t /gimbal/cmd_roll -m gz.msgs.Double -p 'data: -1.0'\n</code></pre>","tags":["ardupilot","sitl","gimbal","gazebo","ros","mavros"]},{"location":"Robotics/uav/ardupilot/sitl/gimbal/#ardupilot-plugin","title":"Ardupilot plugin","text":"<p>Convert Ardupilot channel to gazebo command</p> <pre><code>&lt;control channel=\"8\"&gt;\n    &lt;jointName&gt;gimbal::roll_joint&lt;/jointName&gt;\n    &lt;multiplier&gt;1.047197551196&lt;/multiplier&gt;\n    &lt;offset&gt;-0.5&lt;/offset&gt;\n    &lt;servo_min&gt;1100&lt;/servo_min&gt;\n    &lt;servo_max&gt;1900&lt;/servo_max&gt;\n    &lt;type&gt;COMMAND&lt;/type&gt;\n    &lt;cmd_topic&gt;/gimbal/cmd_roll&lt;/cmd_topic&gt;\n    &lt;p_gain&gt;2&lt;/p_gain&gt;\n&lt;/control&gt;\n</code></pre> <p>raw_cmd = (pwn-pwn_min) / (pwm_max-pwm_min) raw_cmd -&gt; [0, 1]</p> <p>cmd = multiplier * (raw_cmd+offset)</p>","tags":["ardupilot","sitl","gimbal","gazebo","ros","mavros"]},{"location":"Robotics/uav/ardupilot/sitl/gimbal/#roll","title":"roll","text":"<ul> <li>multiplier = \u03c0 \u2248 3.14159</li> <li>offset = -0.5</li> </ul> cmd -pi/2 0 0 0.5 pi/2 1","tags":["ardupilot","sitl","gimbal","gazebo","ros","mavros"]},{"location":"Robotics/uav/ardupilot/sitl/gimbal/#pitch","title":"pitch","text":"<ul> <li>multiplier    \u2248 1.7708</li> <li>offset    \u2248 -0.11296</li> </ul> cmd -0.2 0 pi/2 1","tags":["ardupilot","sitl","gimbal","gazebo","ros","mavros"]},{"location":"Robotics/uav/ardupilot/sitl/gimbal/#yaw","title":"yaw","text":"<ul> <li>multiplier = \u03c0 \u2248 3.14159</li> <li>offset = -0.5</li> </ul> cmd -pi/2 0 0 0.5 pi/2 1","tags":["ardupilot","sitl","gimbal","gazebo","ros","mavros"]},{"location":"Robotics/uav/ardupilot/sitl/gimbal/#ardupilot","title":"Ardupilot","text":"","tags":["ardupilot","sitl","gimbal","gazebo","ros","mavros"]},{"location":"Robotics/uav/ardupilot/sitl/gimbal/#ardupilot-plugin-channels","title":"Ardupilot plugin channels","text":"GZ_CH (0) 8 ROLL servo_9 9 PITCH servo_10 10 YAW servo_11","tags":["ardupilot","sitl","gimbal","gazebo","ros","mavros"]},{"location":"Robotics/uav/ardupilot/sitl/gimbal/#ardupilot-param","title":"Ardupilot param","text":"SERVO9_FUNCTION 8 (1-roll) SERVO10_FUNCTION 7 (1-pitch) SERVO11_FUNCTION 6 (1-yaw) <p><code>bash   ros2 service call /mavros/set_message_interval mavros_msgs/srv/MessageInterval \"{\\\"message_id\\\": 285, \\\"message_rate\\\": 2 }\"</code></p>","tags":["ardupilot","sitl","gimbal","gazebo","ros","mavros"]},{"location":"Robotics/uav/ardupilot/sync_time/","title":"Clock/Time Synchronisation","text":"<p>Robotics / uav / ardupilot</p> <p>Ardupilot</p>","tags":["ardupilot","apm","time","sync"]},{"location":"Robotics/uav/betaflight/","title":"Index","text":"<p>Robotics / uav</p>","tags":["betaflight"]},{"location":"Robotics/uav/betaflight/#betaflight-sitl","title":"betaflight sitl","text":"<pre><code>sudo apt update &amp;&amp; sudo apt upgrade\nsudo apt -y install build-essential git curl clang-18 python3 python-is-python3\ngit clone https://github.com/betaflight/betaflight.git\ncd betaflight\nmake arm_sdk_install\nmake configs\nmake TARGET=SITL\n</code></pre>","tags":["betaflight"]},{"location":"Robotics/uav/betaflight/#betaflight-web-app","title":"betaflight web app","text":"<p>betaflight documentation </p> <pre><code>git clone git@github.com:novnc/websockify-other.git\ncd websockify-other/c\nmake\n</code></pre> run proxy<pre><code>./websockify 127.0.0.1:6761 127.0.0.1:5761\n</code></pre> run sitl<pre><code>./obj/betaflight_2025.12.0-beta_SITL\n</code></pre>","tags":["betaflight"]},{"location":"Robotics/uav/betaflight/#config-web-app-to-manual-connection","title":"config web app to manual connection","text":"<p>work only with chrome base</p> <p></p> <p>Then establish a connection by using address ws://127.0.0.1:6761 in the Port field and clicking Connect.</p> <p></p>","tags":["betaflight"]},{"location":"Robotics/uav/betaflight/#vehicle_gateway","title":"vehicle_gateway","text":"<p>github</p> <ul> <li>betaflight_gazebo: gazebo plugin</li> <li>betaflight_sim: Gazebo worlds and iris model config with betaflight plugin</li> <li>betaflight_demo: using vehicle_gateway to control to quadcopter</li> <li>betaflight_controller: using port 9004 to control the quadcopter, translate joy message to motors channel control</li> </ul> <p></p>","tags":["betaflight"]},{"location":"Robotics/uav/betaflight/#resources","title":"Resources","text":"<ul> <li>SimITL - Sim In the Loop</li> <li>pr0p is a quadcopter racing simulator</li> <li>FPV autonomous operation with Betaflight and Raspberry Pi</li> <li>Autopilot for FPV Combat Drone on Betaflight (Empty version)</li> </ul>","tags":["betaflight"]},{"location":"Robotics/uav/datasets/","title":"Index","text":"<p>Robotics / uav</p> <ul> <li>Multi-modal UAV Dataset for Low Altitude Traffic Surveillance</li> <li>HIT-UAV: A high-altitude infrared thermal dataset for Unmanned Aerial Vehicle-based object detection</li> </ul>","tags":["drone","dataset","annotation"]},{"location":"Robotics/uav/fpv/","title":"Build FPV","text":"<p>Robotics / uav</p>","tags":["drone","fpv"]},{"location":"Robotics/uav/fpv/#reference","title":"Reference","text":"<ul> <li>Building a GOOD Micro FPV Drone for $65 (Beginners Guide)</li> </ul>","tags":["drone","fpv"]},{"location":"Robotics/uav/mavlink/","title":"Mavlink","text":"<p>MAVLink (Micro Air Vehicle Link) is a lightweight communication protocol used to exchange messages between drones (UAVs), their autopilots, ground control stations, and companion computers</p> <p>In MAVLink, every message is tagged with two identifiers so the network knows who sent the message and which part of the system it came from:</p> <p>pymavlink</p> <p>wireshark and network debug tools</p> <p>mavlink-router</p>","tags":["mavlink","pymavlink"]},{"location":"Robotics/uav/mavlink/#mavlink","title":"Mavlink","text":"<p>MAVLink has been deployed in a number of versions:</p> <ul> <li>MAVLink 1: 0xFE</li> <li>MAVLink 2: 0xFD</li> </ul> <p> more</p>","tags":["mavlink","pymavlink"]},{"location":"Robotics/uav/mavlink/#sysid-system-id","title":"SYSID (System ID)","text":"<p>A number that identifies the vehicle/system. (1-255) Distinguishes different vehicles on the same MAVLink network (Vehicle ID)</p> <p>Examples:</p> <ul> <li>Drone #1 \u2192 SYSID = 1</li> <li>Drone #2 \u2192 SYSID = 2</li> <li>Simulator (SITL) \u2192 often SYSID = 1 (configurable)</li> <li>GCS () = 255</li> </ul>","tags":["mavlink","pymavlink"]},{"location":"Robotics/uav/mavlink/#compid-component-id","title":"COMPID (Component ID)","text":"<p>A number that identifies a component inside a system. (1-255) Distinguishes subsystems within the same vehicle</p> <p>Think of it as the process/module ID</p> <p>Common COMPIDs: - 1 \u2192 Autopilot (flight controller) - 190 \u2192 Companion computer - 191 \u2192 GCS (ground control station) - 200+ \u2192 Custom components</p>","tags":["mavlink","pymavlink"]},{"location":"Robotics/uav/mavlink/#source-target-broadcast","title":"Source / Target / Broadcast","text":"<p>In MAVLink, every message has two layers of identity:</p> <p>1\ufe0f\u20e3 Message header \u2192 SOURCE - These are set automatically by your MAVLink connection: - source_system (your SYSID) - source_component (your COMPID)</p> <p>\ud83d\udc49 Identifies who is sending the message.</p> <p>2\ufe0f\u20e3 Command fields \u2192 TARGET - Certain messages (especially commands) include explicit target fields inside the payload: - target_system - target_component</p> <p>\ud83d\udc49 Identifies who should execute the command.</p>","tags":["mavlink","pymavlink"]},{"location":"Robotics/uav/mavlink/#example-command_long76","title":"Example: COMMAND_LONG(76)","text":"","tags":["mavlink","pymavlink"]},{"location":"Robotics/uav/mavlink/#broadcast","title":"Broadcast","text":"<pre><code>target_system    = 0\ntarget_component = 0\n</code></pre> <ul> <li>Telemetry \u2192 always broadcast</li> <li>Queries \u2192 sometimes broadcast</li> <li>Control commands \u2192 never broadcast unless you are 100% sure</li> </ul>","tags":["mavlink","pymavlink"]},{"location":"Robotics/uav/mavlink/#mavlink-network","title":"Mavlink network","text":"<p>MAVLink \u201cstream\u201d is usually one physical link to connect multiple customer we use tool like mavlink-router</p>","tags":["mavlink","pymavlink"]},{"location":"Robotics/uav/mavlink/mavlink_router/","title":"Mavlink router","text":"<p>github</p> route SITL to udp<pre><code>./mavlink-routerd-glibc-x86_64 -e 127.0.0.1:14550  -p 127.0.0.1:5760\n</code></pre>","tags":["mavlink","router"]},{"location":"Robotics/uav/mavlink/network_tools/","title":"Mavlink network tools","text":"","tags":["wireshark","scapy","pcap"]},{"location":"Robotics/uav/mavlink/network_tools/#wireshark","title":"Wireshark","text":"<p>Add mavlink parser to wireshark as LUA plugin read more</p>","tags":["wireshark","scapy","pcap"]},{"location":"Robotics/uav/mavlink/network_tools/#create-lua-plugin","title":"Create lua plugin","text":"<pre><code>.venv/bin/mavgen.py \\\n    --lang=WLua \\\n    --wire-protocol=2.0 \\\n    --output=mavlink_2_common \\\n    .venv/lib/python3.11/site-packages/pymavlink/dialects/v20/common.xml \n</code></pre>","tags":["wireshark","scapy","pcap"]},{"location":"Robotics/uav/mavlink/network_tools/#install-the-plugin","title":"Install the plugin","text":"<p>TODO: run wireshark with user permission, install the lua plugin in user <code>.local</code> folder</p> <pre><code>sudo cp mavlink_2_common.lua /usr/lib/x86_64-linux-gnu/wireshark/plugins\n</code></pre> <p></p> line to fix<pre><code>f.CAMERA_IMAGE_CAPTURED_capture_result = ProtoField.new(\"capture_result (MAV_BOOL)\", \"mavlink_proto.CAMERA_IMAGE_CAPTURED_capture_result\", ftypes.INT8, nil, base.DEC)\n</code></pre> <p></p>","tags":["wireshark","scapy","pcap"]},{"location":"Robotics/uav/mavlink/network_tools/#capture-mavlink-traffic","title":"Capture mavlink traffic","text":"","tags":["wireshark","scapy","pcap"]},{"location":"Robotics/uav/mavlink/network_tools/#play-mavlink-pcap-files","title":"Play mavlink pcap files","text":"<p>tcpreplay</p> <p>I try this tool without success</p> <pre><code>sudo apt install tcpreplay\n</code></pre> <pre><code>sudo tcpreplay -i eth0 capture.pcap\n</code></pre>","tags":["wireshark","scapy","pcap"]},{"location":"Robotics/uav/mavlink/network_tools/#play-pcap-using-scapy-script","title":"Play pcap using scapy script","text":"<pre><code>from scapy.all import rdpcap, IP, UDP, send\nimport time\nPCAP = \"mavlink.pcap\"\npkts = rdpcap(PCAP)\n\nt0 = None\nstart = None\n\nfor p in pkts:\n    if IP in p and UDP in p:\n        if t0 is None:\n            t0 = float(p.time)\n            start = time.time()\n\n        pkt_time = float(p.time)\n        delay = (pkt_time - t0) - (time.time() - start)\n\n        if delay &gt; 0:\n            time.sleep(delay)\n\n        del p[IP].len\n        del p[IP].chksum\n        del p[UDP].len\n        del p[UDP].chksum\n\n        send(p[IP], verbose=False)\n</code></pre>","tags":["wireshark","scapy","pcap"]},{"location":"Robotics/uav/mavlink/pymavlink/","title":"Pymavlink","text":"","tags":["pymavlink"]},{"location":"Robotics/uav/mavlink/pymavlink/#demos","title":"Demos","text":"<p>talker listener</p> <p>custom message</p> <p>V2_EXTENSION</p>","tags":["pymavlink"]},{"location":"Robotics/uav/mavlink/pymavlink/custom_message/","title":"Mavlink custom message","text":"<p>Create custom dialect and use it with pymavlink</p> <pre><code>&lt;mavlink&gt;\n  &lt;include&gt;common.xml&lt;/include&gt;\n\n  &lt;messages&gt;\n    &lt;message id=\"42000\" name=\"MY_CUSTOM_MSG\"&gt;\n      &lt;description&gt;Example custom message&lt;/description&gt;\n      &lt;field type=\"uint32_t\" name=\"foo\"&gt;Foo counter&lt;/field&gt;\n      &lt;field type=\"float\" name=\"bar\"&gt;Bar value&lt;/field&gt;\n    &lt;/message&gt;\n  &lt;/messages&gt;\n&lt;/mavlink&gt;\n</code></pre>","tags":["mavlink","custom","pymavlink"]},{"location":"Robotics/uav/mavlink/pymavlink/custom_message/#generate","title":"Generate","text":"<p>Generate python model using <code>mavgen.py</code> installed by <code>pymavlink</code> package</p> <p>copy <code>common.xml</code>, <code>minimal.xml</code> and <code>standard.xml</code> to folder that contain our custom message</p> <pre><code>mavgen.py   \\\n    --lang Python \\\n    --wire-protocol 2.0 \\\n    --output mydialect.py \\\n    mydialect.xml\n</code></pre> <p>Copy the generate python module to pymavlink dialect v20 subfolder</p>","tags":["mavlink","custom","pymavlink"]},{"location":"Robotics/uav/mavlink/pymavlink/custom_message/#demo-send-the-receive-the-custom-message","title":"Demo: Send the Receive the custom message","text":"<pre><code>from pymavlink import mavutil\nimport time\nfrom pymavlink.dialects.v20.common import MAVLink_message\nfrom pymavlink.dialects.v20 import mydialect\nfrom typing import cast\nfrom multiprocessing import Process as mp\n\nimport os\n\nos.environ[\"MAVLINK20\"] = \"1\"\nprint(os.getenv(\"MAVLINK20\"))\n\n\ndef sender():\n    mavutil.set_dialect(\"mydialect\")\n\n    conn = mavutil.mavlink_connection(\"udpout:127.0.0.1:14550\")\n    conn = cast(mavutil.mavudp, conn)\n    mav = cast(mydialect.MAVLink, conn.mav)\n    i = 0\n    while True:\n        mav.my_custom_msg_send(i, 1.23)  # function name is lowercase\n        i += 1\n        time.sleep(1)\n\n\ndef listener():\n    mavutil.set_dialect(\"mydialect\")\n    conn = mavutil.mavlink_connection(\n        \"udp:0.0.0.0:14550\", source_system=42, source_component=200\n    )\n\n    print(\"Listening on udp:0.0.0.0:14550\")\n\n    while True:\n        msg = conn.recv_match(blocking=True)\n        msg = cast(MAVLink_message, msg)\n        if msg:\n            print(msg.get_type(), msg.to_dict())\n\n\nif __name__ == \"__main__\":\n    talker = mp(target=sender)\n    listen = mp(target=listener)\n\n    listen.start()\n    time.sleep(1)  # Ensure listener starts before talker\n    talker.start()\n    talker.join()\n    listen.join()\n</code></pre>","tags":["mavlink","custom","pymavlink"]},{"location":"Robotics/uav/mavlink/pymavlink/talker_listener/","title":"pymavlink send message between two process","text":"","tags":["pymavlink"]},{"location":"Robotics/uav/mavlink/pymavlink/talker_listener/#send-mavlink-message-between-two-process","title":"Send mavlink message between two process","text":"<pre><code>from pymavlink import mavutil\nimport time\nfrom pymavlink.dialects.v20.common import MAVLink_message\nfrom pymavlink.dialects.v20 import common\nfrom typing import cast\nfrom multiprocessing import Process as mp\n\n\ndef sender():\n    conn = mavutil.mavlink_connection(\n    \"udpout:127.0.0.1:14550\",\n    source_system=43,\n    source_component=201\n    )\n    conn = cast(mavutil.mavudp, conn)\n    mav = cast(common.MAVLink, conn.mav)\n\n    while True:\n        mav.heartbeat_send(\n            common.MAV_TYPE_GENERIC,\n            common.MAV_AUTOPILOT_INVALID,\n            0, 0, 0\n        )\n        time.sleep(1)\n\ndef listener():\n    conn = mavutil.mavlink_connection(\n    \"udp:0.0.0.0:14550\",\n    source_system=42,\n    source_component=200\n)\n\n    print(\"Listening on udp:0.0.0.0:14550\")\n\n    while True:\n        msg = conn.recv_match(blocking=True)\n        msg = cast(MAVLink_message, msg)\n        if msg:\n            print(msg.get_type(), msg.to_dict())\n\nif __name__ == \"__main__\":\n\n    talker = mp(target=sender)\n    listen = mp(target=listener)\n\n    listen.start()\n    time.sleep(1)  # Ensure listener starts before talker\n    talker.start()\n    talker.join()\n    listen.join()\n</code></pre>","tags":["pymavlink"]},{"location":"Robotics/uav/mavlink/pymavlink/v2_extension/","title":"Mavlink V2_EXTENSION message","text":"<p>In MAVLink v2, devices sometimes need to send data that the receiver does not have a dialect for. Wrap an unknown/custom message inside a standard MAVLink v2 message so that all routers and tools can forward it safely.</p> <p>There no define pattern but there are strong conventions </p> <ul> <li>Use little-endian</li> <li>Same field ordering as .xml</li> <li>No MAVLink header or CRC</li> <li>message_type = original MAVLink msg ID</li> </ul> <pre><code>import struct\n\n# version=1, counter=42, value=3.14\npayload = struct.pack(\"&lt;BIf\", 1, 42, 3.14)\npayload = payload.ljust(249, b\"\\x00\")\n</code></pre>","tags":["mavlink"]},{"location":"Robotics/uav/mavlink/pymavlink/v2_extension/#demo","title":"Demo","text":"<pre><code>from __future__ import annotations\n\nimport struct\nimport time\nfrom multiprocessing import Process as mp\nfrom typing import cast\n\nfrom pymavlink import mavutil\nfrom pymavlink.dialects.v20 import common\nfrom pymavlink.dialects.v20.common import MAVLink_message\n\n\n# ---- Custom V2_EXTENSION payload spec (example) ----\n# payload layout (little-endian):\n#   uint8   version\n#   uint32  counter\n#   float32 value\n#\n# total used bytes: 1 + 4 + 4 = 9\n# remaining bytes padded with 0 up to 249\n\n\nCUSTOM_MESSAGE_TYPE = 42000  # your private \"embedded message id\"\nPAYLOAD_VERSION = 1\n\n\ndef pack_custom_payload(counter: int, value: float) -&gt; bytes:\n    raw = struct.pack(\"&lt;BIf\", PAYLOAD_VERSION, counter, value)  # 9 bytes\n    if len(raw) &gt; 249:\n        raise ValueError(\"Payload too large\")\n    return raw.ljust(249, b\"\\x00\")\n\n\ndef unpack_custom_payload(payload: bytes) -&gt; tuple[int, int, float]:\n    # payload can be longer; we only care about first 9 bytes\n    version, counter, value = struct.unpack(\"&lt;BIf\", payload[:9])\n    return version, counter, value\n\n\ndef sender() -&gt; None:\n    conn = mavutil.mavlink_connection(\n        \"udpout:127.0.0.1:14550\",\n        source_system=43,\n        source_component=201,\n        force_mavlink1=False,  # force MAVLink v2\n    )\n    conn = cast(mavutil.mavudp, conn)\n    mav = cast(common.MAVLink, conn.mav)\n\n    counter = 0\n    while True:\n        payload = pack_custom_payload(counter, value=3.14)\n\n        # V2_EXTENSION is in the common dialect\n        mav.v2_extension_send(\n            target_network=0,          # commonly 0 (used for routing in some stacks)\n            target_system=0,           # 0 = broadcast, or set to specific sysid\n            target_component=0,        # 0 = broadcast, or set to specific compid\n            message_type=CUSTOM_MESSAGE_TYPE,\n            payload=payload,\n        )\n\n        counter += 1\n        time.sleep(1)\n\n\ndef listener() -&gt; None:\n    conn = mavutil.mavlink_connection(\n        \"udp:0.0.0.0:14550\",\n        source_system=42,\n        source_component=200,\n        force_mavlink1=False,  # accept v2 (and don't force v1)\n    )\n\n    print(\"Listening on udp:0.0.0.0:14550\")\n\n    while True:\n        msg = conn.recv_match(blocking=True)\n        if not msg:\n            continue\n\n        msg = cast(MAVLink_message, msg)\n\n        if msg.get_type() == \"V2_EXTENSION\":\n            # msg.payload is typically a bytes-like object (may be list/bytearray in some builds)\n            payload_bytes = bytes(getattr(msg, \"payload\", b\"\"))\n            mtype = getattr(msg, \"message_type\", None)\n\n            if mtype == CUSTOM_MESSAGE_TYPE:\n                version, counter, value = unpack_custom_payload(payload_bytes)\n                print(f\"V2_EXTENSION custom: type={mtype} v={version} counter={counter} value={value}\")\n            else:\n                print(f\"V2_EXTENSION other: type={mtype}\")\n        else:\n            # still print other messages if any\n            print(msg.get_type(), msg.to_dict())\n\n\nif __name__ == \"__main__\":\n    talker = mp(target=sender)\n    listen = mp(target=listener)\n\n    listen.start()\n    time.sleep(1)  # Ensure listener starts before talker\n    talker.start()\n\n    talker.join()\n    listen.join()\n</code></pre>","tags":["mavlink"]},{"location":"Robotics/uav/px4/","title":"PX4","text":"<p>Robotics / uav</p>","tags":["px4"]},{"location":"Robotics/uav/px4/#to-read-and-watch","title":"TO-Read and watch","text":"<ul> <li>mavros_controllers: Controllers for controlling MAVs using the mavros package in OFFBOARD mode.</li> <li>quad_controller_SE3: quadrotor controller based on PX4/mavros and SE3 geometric control</li> <li>px4-offboard: This repository contains a python examples for offboard control on ROS2 with PX4</li> </ul> <pre><code>make px4_sitl gz_x500_gimbal\n#\nSIM_MODEL=gz_x500 GZ_IP=127.0.0.1 /home/user/git/PX4-Autopilot/build/px4_sitl_default/bin/px4\n</code></pre>","tags":["px4"]},{"location":"Robotics/uav/px4/#wayland","title":"wayland","text":"<pre><code>     QT_QPA_PLATFORM=xcb make px4_sitl gz_x500 \n</code></pre> <pre><code>| Command                  | Description                |\n| ------------------------ | -------------------------- |\n| `uorb top`               | List active uORB topics    |\n| `uorb list`              | List all registered topics |\n| `listener &lt;topic&gt;`       | Print current message      |\n| `listener &lt;topic&gt; -r 10` | Print at 10 Hz             |\n| `uorb status`            | Show uORB system stats     |\n</code></pre>","tags":["px4"]},{"location":"Robotics/uav/px4/#resource","title":"Resource","text":"<ul> <li>PX4-ROS2-Gazebo Drone Simulation Template</li> <li>bebop_ros</li> <li>Aerial vehicle gazebo</li> </ul>","tags":["px4"]},{"location":"Robotics/uav/qgc/","title":"QGroundControl","text":"<p>Robotics / uav</p>","tags":["qgc"]},{"location":"Robotics/uav/qgc/#customization","title":"Customization","text":"","tags":["qgc"]},{"location":"Robotics/uav/qgc/#sending-custom-mavlink-commands","title":"Sending custom mavlink commands","text":"<p>Sending custom mavlink commands</p> <p></p> <p>Custom Mavlink Action json file <pre><code>{\n    \"version\":    1,\n    \"fileType\":   \"MavlinkActions\",\n    \"actions\": [\n        {\n            \"label\":        \"First Mavlink Command\",\n            \"description\":  \"This is the first command\",\n            \"mavCmd\":       10,\n            \"compId\":       100,\n            \"param1\":       1,\n            \"param2\":       2,\n        },\n        {\n            \"label\":        \"Second Mavlink Command\",\n            \"description\":  \"This is the second command\",\n            \"mavCmd\":       20,\n        }\n    ]\n}\n</code></pre></p>","tags":["qgc"]},{"location":"Simulation/","title":"Simulation","text":"<p>Gazebo Classic</p> <p>Gazebo Harmonic</p> <p>Gazebo ionic</p> <p>PyBullet</p> <p>AirSim</p>"},{"location":"Simulation/#resources","title":"Resources","text":"<ul> <li>best-of-robot-simulators</li> <li>Gazebo meeting</li> </ul>"},{"location":"Simulation/Gazebo/","title":"Gazebo harmonic","text":"<p>VSCode dev</p> <p>SDF Format</p> <p>Custom plugins</p> <p>Gazebo Worlds</p> <ul> <li>Tutorials</li> <li>ROS2 Bridge</li> <li>Sensors</li> <li>Plugins</li> </ul>","tags":["gazebo","gz","harmonic"]},{"location":"Simulation/Gazebo/#environment-variables","title":"Environment Variables","text":"<p>migration from ign</p> <p>IGNITION_GAZEBO -&gt; GZ_SIM</p> Name Description SIM GZ_SIM_RESOURCE_PATH GZ_SIM_SYSTEM_PLUGIN_PATH TRANSPORT GZ_TRANSPORT_IP GZ_DISCOVERY_SERVER GZ_PARTITION <p></p>","tags":["gazebo","gz","harmonic"]},{"location":"Simulation/Gazebo/custom_plugins/","title":"Gazebo harmonic custom plugin","text":"","tags":["harmonic","custom","plugin"]},{"location":"Simulation/Gazebo/gazebo_worlds/","title":"Gazebo worlds","text":"<p>The  element defines the global environment, which includes: <ul> <li>Physics engine configuration</li> <li>Global plugins</li> <li>Time stepping</li> <li>Gravity</li> <li>Magnetic field</li> <li>Global lighting</li> <li>Scene / rendering settings</li> <li>Spherical coordinates (for GPS)</li> <li>Atmosphere model</li> <li>Global contact / sensor processing systems</li> </ul>","tags":["gazebo","gz","harmonic","world"]},{"location":"Simulation/Gazebo/gazebo_worlds/#physics-engine","title":"Physics engine","text":"<p>The default engine is DART but gazebo can run <code>ode</code> and <code>bullet</code></p> <p>Tip</p> <p>To support back capability we set the type to ignore , if we set tag that not supported by the engine gazebo ignore them and use <code>DART</code> engine</p> <pre><code>&lt;physics name=\"1ms\" type=\"ignored\"&gt;\n    &lt;max_step_size&gt;0.001&lt;/max_step_size&gt;\n    &lt;real_time_factor&gt;1.0&lt;/real_time_factor&gt;\n&lt;/physics&gt;\n</code></pre>","tags":["gazebo","gz","harmonic","world"]},{"location":"Simulation/Gazebo/plugins/","title":"Gazebo plugins","text":"<p>gazebo classic feature compression</p> <p>Differential drive</p> <p>Pose Publisher</p> <p>Odometry</p> <p>Joint state</p> <p>Check gazebo API gz::sim::systems Namespace for a list of system plugins</p>","tags":["gazebo","harmonic","plugin"]},{"location":"Simulation/Gazebo/plugins/#to-read","title":"To-read","text":"<ul> <li>Gazebo Sim (Harmonic) Plugins and Sensors for ROS2</li> </ul>","tags":["gazebo","harmonic","plugin"]},{"location":"Simulation/Gazebo/plugins/diff_drive/","title":"Gazebo differential driver","text":"<p>Simulation / Gazebo / plugins</p> <p>Differential drive controller which can be attached to a model with any number of left and right wheels.  more</p>","tags":["gazebo","plugins","diff drive"]},{"location":"Simulation/Gazebo/plugins/diff_drive/#simple-gazebo-declaration","title":"simple gazebo declaration","text":"<pre><code>&lt;plugin name=\"gz::sim::systems::DiffDrive\" filename=\"gz-sim-diff-drive-system\"&gt;\n\n    &lt;left_joint&gt;wheel_left_joint&lt;/left_joint&gt;\n    &lt;right_joint&gt;wheel_right_joint&lt;/right_joint&gt;\n    &lt;wheel_separation&gt;0.3&lt;/wheel_separation&gt;\n    &lt;wheel_radius&gt;0.1&lt;/wheel_radius&gt;\n\n\n    &lt;max_linear_acceleration&gt;0.33&lt;/max_linear_acceleration&gt;\n\n    &lt;topic&gt;cmd_vel&lt;/topic&gt;\n\n\n    &lt;frame_id&gt;odom&lt;/frame_id&gt;\n    &lt;child_frame_id&gt;base_link&lt;/child_frame_id&gt;\n    &lt;odom_topic&gt;odom&lt;/odom_topic&gt;\n    &lt;odom_publish_frequency&gt;30&lt;/odom_publish_frequency&gt;\n\n    &lt;tf_topic&gt;/tf&lt;/tf_topic&gt;\n\n  &lt;/plugin&gt;\n</code></pre>","tags":["gazebo","plugins","diff drive"]},{"location":"Simulation/Gazebo/plugins/diff_drive/#config","title":"Config","text":"Parameter Description left_joint Name of a joint that controls a left wheel. This element can appear multiple times, and must appear at least once. right_joint Name of a joint that controls a right wheel. This element can appear multiple times, and must appear at least once. wheel_separation Distance between wheels, in meters. Optional, default is 1.0\u202fm. wheel_radius Wheel radius in meters. Optional, default is 0.2\u202fm. odom_publish_frequency Odometry publication frequency. Optional, default is 50\u202fHz. topic Custom topic this system subscribes to for command velocity messages. Optional, default is <code>/model/{name_of_model}/cmd_vel</code>. odom_topic Custom topic for publishing odometry messages. Optional, default is <code>/model/{name_of_model}/odometry</code>. tf_topic Custom topic for publishing transform from <code>frame_id</code> to <code>child_frame_id</code>. Optional, default is <code>/model/{name_of_model}/tf</code>. frame_id Frame used as the origin in the odometry transform (<code>tf_topic</code> and <code>odom_topic</code>). Optional, default is <code>{name_of_model}/odom</code>. child_frame_id Frame used as the target in the odometry transform. Optional, default is <code>{name_of_model}/{name_of_link}</code>. min_velocity Minimum linear and angular velocity. max_velocity Maximum linear and angular velocity. min_acceleration Minimum linear and angular acceleration. max_acceleration Maximum linear and angular acceleration. min_jerk Minimum linear and angular jerk. max_jerk Maximum linear and angular jerk. min_linear_velocity Minimum linear velocity. Overrides <code>min_velocity</code> if set. max_linear_velocity Maximum linear velocity. Overrides <code>max_velocity</code> if set. min_angular_velocity Minimum angular velocity. Overrides <code>min_velocity</code> if set. max_angular_velocity Maximum angular velocity. Overrides <code>max_velocity</code> if set. min_linear_acceleration Minimum linear acceleration. Overrides <code>min_acceleration</code> if set. max_linear_acceleration Maximum linear acceleration. Overrides <code>max_acceleration</code> if set. min_angular_acceleration Minimum angular acceleration. Overrides <code>min_acceleration</code> if set. max_angular_acceleration Maximum angular acceleration. Overrides <code>max_acceleration</code> if set. min_linear_jerk Minimum linear jerk. Overrides <code>min_jerk</code> if set. max_linear_jerk Maximum linear jerk. Overrides <code>max_jerk</code> if set. min_angular_jerk Minimum angular jerk. Overrides <code>min_jerk</code> if set. max_angular_jerk Maximum angular jerk. Overrides <code>max_jerk</code> if set.","tags":["gazebo","plugins","diff drive"]},{"location":"Simulation/Gazebo/plugins/diff_drive/#usage","title":"usage","text":"<p>moving robot tutorial</p> gz topic publish<pre><code>gz topic -t \"/cmd_vel\" -m gz.msgs.Twist -p \"linear: {x: 0.5}, angular: {z: 0.0}\"\n</code></pre>","tags":["gazebo","plugins","diff drive"]},{"location":"Simulation/Gazebo/plugins/joint_state/","title":"Joint State Publisher","text":"<p>Simulation / Gazebo / plugins</p> <p>The JointStatePublisher system publishes joint state information for a model. more</p> <pre><code>&lt;plugin\n    filename=\"gz-sim-joint-state-publisher-system\"\n    name=\"gz::sim::systems::JointStatePublisher\"&gt;\n    &lt;joint_name&gt;joint_right_wheel&lt;/joint_name&gt;\n    &lt;joint_name&gt;joint_left_wheel&lt;/joint_name&gt;\n&lt;/plugin&gt;\n</code></pre>","tags":["gazebo","plugin","joints"]},{"location":"Simulation/Gazebo/plugins/joint_state/#reference","title":"Reference","text":"","tags":["gazebo","plugin","joints"]},{"location":"Simulation/Gazebo/plugins/odometry/","title":"Gazebo OdometryPublisher","text":"<p>Simulation / Gazebo / plugins</p> <p>Odometry Publisher which can be attached to any entity in order to periodically publish 2D or 3D odometry data in the form of gz::msgs::Odometry messages. more</p> <pre><code>&lt;!-- add to model --&gt;\n&lt;plugin\n    filename=\"gz-sim-odometry-publisher-system\"\n    name=\"gz::sim::systems::OdometryPublisher\"&gt;\n    &lt;odom_frame&gt;vehicle/odom&lt;/odom_frame&gt;\n    &lt;robot_base_frame&gt;base_link&lt;/robot_base_frame&gt;\n&lt;/plugin&gt;\n</code></pre> <p>model plugin</p> <p>Add 3 topics</p> <ul> <li>/model/my_bot/odometry (gz.msgs.Odometry)</li> <li>/model/my_bot/odometry_with_covariance (gz.msgs.OdometryWithCovariance)</li> <li>/model/my_bot/pose (gz.msgs.Pose_V)</li> </ul>","tags":["gazebo","plugin","odometry"]},{"location":"Simulation/Gazebo/plugins/odometry/#config","title":"Config","text":"odom_frame xyz_offset rpy_offset gaussian_noise robot_base_frame odom_publish_frequency odom_topic odom_covariance_topic tf_topic","tags":["gazebo","plugin","odometry"]},{"location":"Simulation/Gazebo/plugins/odometry/#add-noise-and-covariance","title":"Add noise and covariance","text":"<p>The plugin attaches a covariance matrix to pose.covariance and twist.covariance using stddev\u00b2 (noise variance).</p> <pre><code>&lt;plugin\n  filename=\"gz-sim-odometry-publisher-system\"\n  name=\"gz::sim::systems::OdometryPublisher\"&gt;\n  &lt;!-- Use 3D odometry --&gt;\n  &lt;dimensions&gt;3&lt;/dimensions&gt;\n\n  &lt;!-- Publishing frequency --&gt;\n  &lt;odom_publish_frequency&gt;50&lt;/odom_publish_frequency&gt;\n\n  &lt;!-- Optional custom topics --&gt;\n  &lt;!--\n  &lt;odom_topic&gt;/my_robot/odom&lt;/odom_topic&gt;\n  &lt;odom_covariance_topic&gt;/my_robot/odom_with_covariance&lt;/odom_covariance_topic&gt;\n  --&gt;\n\n  &lt;!-- Add Gaussian noise: standard deviation in meters/rad --&gt;\n  &lt;gaussian_noise&gt;0.05&lt;/gaussian_noise&gt;\n&lt;/plugin&gt;\n</code></pre> <pre><code>gz topic --echo -t /model/my_bot/odometry_with_covariance\n\n# just the covariance part 6*6 matrix only the diagonal file with \u03c3\u00b2\ncovariance {\n    data: 0.0025\n    data: 0\n    data: 0\n    data: 0\n    data: 0\n    data: 0\n    data: 0\n    data: 0.0025\n    data: 0\n    data: 0\n    data: 0\n    data: 0\n    data: 0\n    data: 0\n    data: 0.0025\n    data: 0\n    data: 0\n    data: 0\n    data: 0\n    data: 0\n    data: 0\n    data: 0.0025\n    data: 0\n    data: 0\n    data: 0\n    data: 0\n    data: 0\n    data: 0\n    data: 0.0025\n    data: 0\n    data: 0\n    data: 0\n    data: 0\n    data: 0\n    data: 0\n    data: 0.0025\n  }\n</code></pre>","tags":["gazebo","plugin","odometry"]},{"location":"Simulation/Gazebo/plugins/odometry/#usage","title":"Usage","text":"<ul> <li>Publish Ground truth</li> </ul>","tags":["gazebo","plugin","odometry"]},{"location":"Simulation/Gazebo/plugins/pose_publisher/","title":"Gazebo PosePublisher","text":"<p>Simulation / Gazebo / plugins</p> <p>Pose publisher system. Attach to an entity to publish the transform of its child entities in the form of gz::msgs::Pose messages, or a single gz::msgs::Pose_V message if \"use_pose_vector_msg\" is true. </p>","tags":["gazebo","plugin"]},{"location":"Simulation/Gazebo/plugins/pose_publisher/#add-plugin-to-my-robot-model","title":"Add plugin to my robot model","text":"add to my urdf<pre><code>&lt;gazebo&gt;\n    &lt;plugin\n        filename=\"gz-sim-pose-publisher-system\"\n        name=\"gz::sim::systems::PosePublisher\"&gt;\n        &lt;publish_model_pose&gt;false&lt;/publish_model_pose&gt;\n        &lt;publish_link_pose&gt;true&lt;/publish_link_pose&gt;\n        &lt;use_pose_vector_msg&gt;false&lt;/use_pose_vector_msg&gt;\n        &lt;update_frequency&gt;10&lt;/update_frequency&gt;\n    &lt;/plugin&gt;\n&lt;/gazebo&gt;\n</code></pre>","tags":["gazebo","plugin"]},{"location":"Simulation/Gazebo/plugins/pose_publisher/#gz-topics","title":"Gz topics","text":"<pre><code>gz topic --info -t  /model/my_bot/pose\n#\nPublishers [Address, Message Type]:\n  tcp://172.19.0.1:37695, gz.msgs.Pose\n</code></pre>","tags":["gazebo","plugin"]},{"location":"Simulation/Gazebo/plugins/pose_publisher/#config","title":"Config","text":"Parameter Description publish_link_pose Set to <code>true</code> to publish link pose. publish_visual_pose Set to <code>true</code> to publish visual pose. publish_collision_pose Set to <code>true</code> to publish collision pose. publish_sensor_pose Set to <code>true</code> to publish sensor pose. publish_model_pose Set to <code>true</code> to publish model pose. publish_nested_model_pose Set to <code>true</code> to publish nested model pose. The pose of the model that contains this system is also published unless <code>publish_model_pose</code> is set to <code>false</code>. use_pose_vector_msg Set to <code>true</code> to publish a <code>gz::msgs::Pose_V</code> message instead of multiple <code>gz::msgs::Pose</code> messages. update_frequency Frequency of pose publications in Hz. A negative frequency publishes as fast as possible (i.e., at the rate of the simulation step). static_publisher Set to <code>true</code> to publish static poses on a \"<code>&lt;scoped_entity_name&gt;/pose_static</code>\" topic. This will cause only dynamic poses to be published on the \"<code>&lt;scoped_entity_name&gt;/pose</code>\" topic. static_update_frequency Frequency of static pose publications in Hz. A negative frequency publishes as fast as possible (i.e., at the rate of the simulation step).","tags":["gazebo","plugin"]},{"location":"Simulation/Gazebo/sdf_format/","title":"SDF/ SDFormat","text":"<p>SDFormat (Simulation Description Format), sometimes abbreviated as SDF, is an XML format that describes objects and environments for robot simulators, visualization, and control more. </p>","tags":["sdf","gazebo"]},{"location":"Simulation/Gazebo/sensors/","title":"Sensors","text":"<ul> <li>Gazebo harmonic docs</li> <li>Gazebo sensor list</li> </ul> <ul> <li>Camera</li> <li>IMU</li> </ul>","tags":["gazebo","harmonic","sensors"]},{"location":"Simulation/Gazebo/sensors/camera/","title":"Camera Sensor","text":"<p>Don't forget</p> add sensor plugin to world<pre><code>&lt;plugin\n  filename=\"gz-sim-sensors-system\"\n  name=\"gz::sim::systems::Sensors\"&gt;\n  &lt;render_engine&gt;ogre2&lt;/render_engine&gt;\n&lt;/plugin&gt;\n</code></pre>","tags":["gazebo","harmonic","sensors","camera"]},{"location":"Simulation/Gazebo/sensors/camera/#rgb-camera","title":"RGB Camera","text":"<pre><code>&lt;sensor name=\"camera\" type=\"camera\"&gt;\n    &lt;pose&gt; 0 0 0 0 0 0 &lt;/pose&gt;\n    &lt;visualize&gt;true&lt;/visualize&gt;\n    &lt;update_rate&gt;10&lt;/update_rate&gt;\n    &lt;camera&gt;\n        &lt;camera_info_topic&gt;camera/camera_info&lt;/camera_info_topic&gt;\n        &lt;horizontal_fov&gt;1.089&lt;/horizontal_fov&gt;\n        &lt;image&gt;\n            &lt;format&gt;R8G8B8&lt;/format&gt;\n            &lt;width&gt;640&lt;/width&gt;\n            &lt;height&gt;480&lt;/height&gt;\n        &lt;/image&gt;\n        &lt;clip&gt;\n            &lt;near&gt;0.05&lt;/near&gt;\n            &lt;far&gt;8.0&lt;/far&gt;\n        &lt;/clip&gt;\n    &lt;/camera&gt;\n    &lt;topic&gt;camera/image_raw&lt;/topic&gt;\n    &lt;gz_frame_id&gt;camera_link_optical&lt;/gz_frame_id&gt;\n&lt;/sensor&gt;\n</code></pre>","tags":["gazebo","harmonic","sensors","camera"]},{"location":"Simulation/Gazebo/sensors/imu/","title":"Gazebo IMU Sensor","text":"<p>Simulation / Gazebo</p> <p>The Gazebo IMU sensor simulates an Inertial Measurement Unit (IMU), providing virtual measurements of:</p> <ul> <li>Angular velocity rad/s (gyroscope)</li> <li>Linear acceleration m/s<sup>2</sup> (accelerometer)</li> <li>Orientation (quaternion)</li> </ul>","tags":["gazebo","harmonic","sensors","imu"]},{"location":"Simulation/Gazebo/sensors/imu/#coordinate-system","title":"Coordinate system","text":"<p>Gazebo use ENU and body (FLU) coordinate (REP-103)</p> Field Frame Note Orientation ENU (Global) Quaternion angular velocity FLU (Body) rad/s linear acceleration FLU (Body) rad/s<sup>2</sup> <p>FLU</p> <p>Express in body frame</p> Axis Direction X Forward Y Left Z Up","tags":["gazebo","harmonic","sensors","imu"]},{"location":"Simulation/Gazebo/sensors/imu/#message","title":"message","text":"<p>imu protobuf message struct </p>","tags":["gazebo","harmonic","sensors","imu"]},{"location":"Simulation/Gazebo/sensors/imu/#usage","title":"usage","text":"<ul> <li>Add imu plugin in to world scope</li> <li>Add Sensor to link</li> </ul> imu plugin<pre><code>&lt;plugin\n    filename=\"gz-sim-imu-system\"\n    name=\"gz::sim::systems::Imu\"&gt;\n&lt;/plugin&gt;\n</code></pre> imu sensor<pre><code>&lt;link&gt;\n    ...\n    &lt;sensor name=\"imu\" type=\"imu\"&gt;\n        &lt;always_on&gt;1&lt;/always_on&gt;\n        &lt;update_rate&gt;50&lt;/update_rate&gt;\n        &lt;visualize&gt;true&lt;/visualize&gt;\n        &lt;topic&gt;imu&lt;/topic&gt;\n    &lt;/sensor&gt;\n&lt;/link&gt;\n</code></pre> sensor with noise<pre><code>&lt;sensor name=\"imu\" type=\"imu\"&gt;\n    &lt;always_on&gt;1&lt;/always_on&gt;\n    &lt;update_rate&gt;50&lt;/update_rate&gt;\n    &lt;visualize&gt;true&lt;/visualize&gt;\n    &lt;topic&gt;imu&lt;/topic&gt;\n    &lt;enable_metrics&gt;true&lt;/enable_metrics&gt;\n\n    &lt;imu&gt;\n        &lt;angular_velocity&gt;\n            &lt;x&gt;\n                &lt;noise type=\"gaussian\"&gt;\n                    &lt;mean&gt;0.0&lt;/mean&gt;\n                    &lt;stddev&gt;2e-4&lt;/stddev&gt;\n                    &lt;bias_mean&gt;0.0000075&lt;/bias_mean&gt;\n                    &lt;bias_stddev&gt;0.0000008&lt;/bias_stddev&gt;\n                &lt;/noise&gt;\n            &lt;/x&gt;\n            &lt;y&gt;\n                &lt;noise type=\"gaussian\"&gt;\n                    &lt;mean&gt;0.0&lt;/mean&gt;\n                    &lt;stddev&gt;2e-4&lt;/stddev&gt;\n                    &lt;bias_mean&gt;0.0000075&lt;/bias_mean&gt;\n                    &lt;bias_stddev&gt;0.0000008&lt;/bias_stddev&gt;\n                &lt;/noise&gt;\n            &lt;/y&gt;\n            &lt;z&gt;\n                &lt;noise type=\"gaussian\"&gt;\n                    &lt;mean&gt;0.0&lt;/mean&gt;\n                    &lt;stddev&gt;2e-4&lt;/stddev&gt;\n                    &lt;bias_mean&gt;0.0000075&lt;/bias_mean&gt;\n                    &lt;bias_stddev&gt;0.0000008&lt;/bias_stddev&gt;\n                &lt;/noise&gt;\n            &lt;/z&gt;\n        &lt;/angular_velocity&gt;\n        &lt;linear_acceleration&gt;\n            &lt;x&gt;\n                &lt;noise type=\"gaussian\"&gt;\n                    &lt;mean&gt;0.0&lt;/mean&gt;\n                    &lt;stddev&gt;1.7e-2&lt;/stddev&gt;\n                    &lt;bias_mean&gt;0.1&lt;/bias_mean&gt;\n                    &lt;bias_stddev&gt;0.001&lt;/bias_stddev&gt;\n                &lt;/noise&gt;\n            &lt;/x&gt;\n            &lt;y&gt;\n                &lt;noise type=\"gaussian\"&gt;\n                    &lt;mean&gt;0.0&lt;/mean&gt;\n                    &lt;stddev&gt;1.7e-2&lt;/stddev&gt;\n                    &lt;bias_mean&gt;0.1&lt;/bias_mean&gt;\n                    &lt;bias_stddev&gt;0.001&lt;/bias_stddev&gt;\n                &lt;/noise&gt;\n            &lt;/y&gt;\n            &lt;z&gt;\n                &lt;noise type=\"gaussian\"&gt;\n                    &lt;mean&gt;0.0&lt;/mean&gt;\n                    &lt;stddev&gt;1.7e-2&lt;/stddev&gt;\n                    &lt;bias_mean&gt;0.1&lt;/bias_mean&gt;\n                    &lt;bias_stddev&gt;0.001&lt;/bias_stddev&gt;\n                &lt;/noise&gt;\n            &lt;/z&gt;\n        &lt;/linear_acceleration&gt;\n    &lt;/imu&gt;\n&lt;/sensor&gt;\n</code></pre>","tags":["gazebo","harmonic","sensors","imu"]},{"location":"Simulation/Gazebo/sensors/imu/#imu-sensor","title":"imu sensor","text":"<p>imu sensor</p> world with imu <pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;sdf version=\"1.6\"&gt;\n  &lt;world name=\"default\"&gt;\n    &lt;physics name=\"1ms\" type=\"ignored\"&gt;\n      &lt;max_step_size&gt;0.001&lt;/max_step_size&gt;\n      &lt;real_time_factor&gt;1.0&lt;/real_time_factor&gt;\n    &lt;/physics&gt;\n    &lt;plugin\n      filename=\"gz-sim-physics-system\"\n      name=\"gz::sim::systems::Physics\"&gt;\n    &lt;/plugin&gt;\n    &lt;plugin\n      filename=\"gz-sim-user-commands-system\"\n      name=\"gz::sim::systems::UserCommands\"&gt;\n    &lt;/plugin&gt;\n    &lt;plugin\n      filename=\"gz-sim-scene-broadcaster-system\"\n      name=\"gz::sim::systems::SceneBroadcaster\"&gt;\n    &lt;/plugin&gt;\n    &lt;plugin\n      filename=\"gz-sim-contact-system\"\n      name=\"gz::sim::systems::Contact\"&gt;\n    &lt;/plugin&gt;\n    &lt;plugin\n      filename=\"gz-sim-imu-system\"\n      name=\"gz::sim::systems::Imu\"&gt;\n    &lt;/plugin&gt;\n\n    &lt;light type=\"directional\" name=\"sun\"&gt;\n      &lt;cast_shadows&gt;true&lt;/cast_shadows&gt;\n      &lt;pose&gt;0 0 10 0 0 0&lt;/pose&gt;\n      &lt;diffuse&gt;1 1 1 1&lt;/diffuse&gt;\n      &lt;specular&gt;0.5 0.5 0.5 1&lt;/specular&gt;\n      &lt;attenuation&gt;\n        &lt;range&gt;1000&lt;/range&gt;\n        &lt;constant&gt;0.9&lt;/constant&gt;\n        &lt;linear&gt;0.01&lt;/linear&gt;\n        &lt;quadratic&gt;0.001&lt;/quadratic&gt;\n      &lt;/attenuation&gt;\n      &lt;direction&gt;-0.5 0.1 -0.9&lt;/direction&gt;\n    &lt;/light&gt;\n\n    &lt;model name=\"ground_plane\"&gt;\n      &lt;static&gt;true&lt;/static&gt;\n      &lt;link name=\"link\"&gt;\n        &lt;collision name=\"collision\"&gt;\n          &lt;geometry&gt;\n            &lt;plane&gt;\n              &lt;normal&gt;0 0 1&lt;/normal&gt;\n              &lt;size&gt;100 100&lt;/size&gt;\n            &lt;/plane&gt;\n          &lt;/geometry&gt;\n        &lt;/collision&gt;\n        &lt;visual name=\"visual\"&gt;\n          &lt;geometry&gt;\n            &lt;plane&gt;\n              &lt;normal&gt;0 0 1&lt;/normal&gt;\n              &lt;size&gt;100 100&lt;/size&gt;\n            &lt;/plane&gt;\n          &lt;/geometry&gt;\n          &lt;material&gt;\n            &lt;ambient&gt;0.8 0.8 0.8 1&lt;/ambient&gt;\n            &lt;diffuse&gt;0.8 0.8 0.8 1&lt;/diffuse&gt;\n            &lt;specular&gt;0.8 0.8 0.8 1&lt;/specular&gt;\n          &lt;/material&gt;\n        &lt;/visual&gt;\n      &lt;/link&gt;\n    &lt;/model&gt;\n\n    &lt;model name=\"my_box\"&gt;\n      &lt;pose&gt;1 2 0.5 0 0 0&lt;/pose&gt; &lt;!-- x y z roll pitch yaw --&gt;\n      &lt;static&gt;false&lt;/static&gt;\n\n      &lt;link name=\"box_link\"&gt;\n        &lt;collision name=\"box_collision\"&gt;\n          &lt;geometry&gt;\n            &lt;box&gt;\n              &lt;size&gt;1 1 1&lt;/size&gt; &lt;!-- x y z dimensions --&gt;\n            &lt;/box&gt;\n          &lt;/geometry&gt;\n        &lt;/collision&gt;\n\n        &lt;visual name=\"box_visual\"&gt;\n          &lt;geometry&gt;\n            &lt;box&gt;\n              &lt;size&gt;1 1 1&lt;/size&gt;\n            &lt;/box&gt;\n          &lt;/geometry&gt;\n          &lt;material&gt;\n            &lt;ambient&gt;0.1 0.3 0.8 1&lt;/ambient&gt;\n            &lt;diffuse&gt;0.1 0.3 0.8 1&lt;/diffuse&gt;\n          &lt;/material&gt;\n        &lt;/visual&gt;\n\n        &lt;sensor name=\"imu\" type=\"imu\"&gt;\n          &lt;always_on&gt;1&lt;/always_on&gt;\n          &lt;update_rate&gt;50&lt;/update_rate&gt;\n          &lt;visualize&gt;true&lt;/visualize&gt;\n          &lt;topic&gt;imu&lt;/topic&gt;\n          &lt;enable_metrics&gt;true&lt;/enable_metrics&gt;\n        &lt;/sensor&gt;\n      &lt;/link&gt;\n\n    &lt;/model&gt;\n  &lt;/world&gt;\n&lt;/sdf&gt;\n</code></pre>","tags":["gazebo","harmonic","sensors","imu"]},{"location":"Simulation/Gazebo/sensors/ray_ultrasonic/","title":"Gazebo Ray / LIDAR / Ultrasonic sensor","text":"<p>Simulation / Gazebo</p> <p>ray sensor</p> <p>For the current state gazebo not support ray and ultrasonic sensor when we declare ray sensor we got the following error <pre><code>[Wrn] [SdfEntityCreator.cc:1097] Sensor type LIDAR not supported yet. Try using a GPU LIDAR instead.\n</code></pre></p> <p>use <code>&lt;sensor name=\"ultrasonic\" type=\"gpu_ray\"&gt;</code> and not <code>&lt;sensor name=\"ultrasonic\" type=\"ray\"&gt;</code></p> plugin<pre><code>&lt;plugin\n    filename=\"gz-sim-sensors-system\"\n    name=\"gz::sim::systems::Sensors\"&gt;\n    &lt;render_engine&gt;ogre2&lt;/render_engine&gt;\n&lt;/plugin&gt;\n</code></pre>","tags":["gazebo","ray","ultrasonic","sensor"]},{"location":"Simulation/Gazebo/sensors/ray_ultrasonic/#sensor-definition","title":"Sensor definition","text":"<p>Sdf specification</p> gpu_ray sensor<pre><code>&lt;sensor name=\"ultrasonic\" type=\"gpu_ray\"&gt;\n    &lt;pose&gt;0 0 0.1 0 0 0&lt;/pose&gt;\n    &lt;always_on&gt;true&lt;/always_on&gt;\n    &lt;update_rate&gt;10&lt;/update_rate&gt;\n    &lt;visualize&gt;true&lt;/visualize&gt;\n    &lt;topic&gt;ultrasonic_range&lt;/topic&gt;\n\n    &lt;ray&gt;\n        &lt;scan&gt;\n            &lt;horizontal&gt;\n                &lt;samples&gt;1&lt;/samples&gt;\n                &lt;resolution&gt;1&lt;/resolution&gt;\n                &lt;min_angle&gt;0.0&lt;/min_angle&gt;\n                &lt;max_angle&gt;0.0&lt;/max_angle&gt;\n            &lt;/horizontal&gt;\n        &lt;/scan&gt;\n        &lt;range&gt;\n            &lt;min&gt;0.02&lt;/min&gt;      &lt;!-- 2 cm --&gt;\n            &lt;max&gt;4.0&lt;/max&gt;       &lt;!-- 4 meters --&gt;\n            &lt;resolution&gt;0.001&lt;/resolution&gt;\n        &lt;/range&gt;\n    &lt;/ray&gt;\n&lt;/sensor&gt;\n</code></pre>","tags":["gazebo","ray","ultrasonic","sensor"]},{"location":"Simulation/Gazebo/sensors/ray_ultrasonic/#add-noise","title":"Add noise","text":"sensor with noise<pre><code>&lt;sensor name=\"ultrasonic\" type=\"gpu_ray\"&gt;\n  &lt;pose&gt;0.5 0 0.5 0 0 0&lt;/pose&gt;\n  &lt;always_on&gt;true&lt;/always_on&gt;\n  &lt;update_rate&gt;10&lt;/update_rate&gt;\n  &lt;visualize&gt;true&lt;/visualize&gt;\n  &lt;topic&gt;ultrasonic_range&lt;/topic&gt;\n\n  &lt;ray&gt;\n      &lt;scan&gt;\n          &lt;horizontal&gt;\n              &lt;samples&gt;1&lt;/samples&gt;\n              &lt;resolution&gt;1&lt;/resolution&gt;\n              &lt;min_angle&gt;0.0&lt;/min_angle&gt;\n              &lt;max_angle&gt;0.0&lt;/max_angle&gt;\n          &lt;/horizontal&gt;\n      &lt;/scan&gt;\n      &lt;range&gt;\n          &lt;min&gt;0.02&lt;/min&gt;      &lt;!-- 2 cm --&gt;\n          &lt;max&gt;4.0&lt;/max&gt;       &lt;!-- 4 meters --&gt;\n          &lt;resolution&gt;0.001&lt;/resolution&gt;\n\n      &lt;/range&gt;\n      &lt;noise&gt;\n          &lt;type&gt;gaussian&lt;/type&gt;\n          &lt;mean&gt;0.0&lt;/mean&gt;\n          &lt;stddev&gt;0.30&lt;/stddev&gt;  &lt;!-- 30cm noise --&gt;\n      &lt;/noise&gt;\n  &lt;/ray&gt;\n&lt;/sensor&gt;\n</code></pre>","tags":["gazebo","ray","ultrasonic","sensor"]},{"location":"Simulation/Gazebo/sensors/ray_ultrasonic/#noise-explain","title":"Noise explain","text":"<ul> <li> <p>The mean (red dashed line at 0.0) is the average noise, meaning most measurements will center around the true value.</p> </li> <li> <p>The standard deviation (\u03c3 = 0.30 m) controls the spread:</p> </li> <li>~68% of readings fall between \u22120.30 m and +0.30 m (green dashed lines).</li> <li>Occasionally, the noise will be larger, simulating sensor error or measurement variation.</li> </ul>","tags":["gazebo","ray","ultrasonic","sensor"]},{"location":"Simulation/Gazebo/sensors/ray_ultrasonic/#message","title":"message","text":"<ul> <li>laserscan.proto</li> </ul> <pre><code>header {\n  stamp {\n    sec: 20\n    nsec: 200000000\n  }\n  data {\n    key: \"frame_id\"\n    value: \"my_box::box_link::ultrasonic\"\n  }\n  data {\n    key: \"seq\"\n    value: \"202\"\n  }\n}\nframe: \"my_box::box_link::ultrasonic\"\nworld_pose {\n  position {\n    x: 0.5\n    z: 0.5\n  }\n  orientation {\n    w: 1\n  }\n}\nangle_step: nan\nrange_min: 0.02\nrange_max: 4\ncount: 1\nvertical_angle_step: nan\nvertical_count: 1\nranges: 1.0000607967376709\nintensities: 0\n</code></pre> <p>world_pose</p> <p>The sensor position and orientation inside the container link</p> <p>Range</p> <p><code>ranges</code> field contain reading for each ray in our case just one reading</p> world with ray sensor <pre><code>\n</code></pre>","tags":["gazebo","ray","ultrasonic","sensor"]},{"location":"Simulation/Gazebo/tutorials/","title":"Gazebo Harmonic Tutorials","text":"<ul> <li>empty world</li> <li>joint controllers</li> <li>read IMU data</li> </ul>","tags":["gazebo","simulation","tutorials"]},{"location":"Simulation/Gazebo/tutorials/control_entity_position/","title":"Control element position using set_pose service","text":"<pre><code> gz topic -e -t /world/my_world/pose/info\n</code></pre> <pre><code>gz service --timeout 10000 -s /world/my_world/set_pose \\\n--reptype gz.msgs.Boolean \\\n--reqtype gz.msgs.Pose \\\n--req 'name: \"green_simple_box\" position {\n  x: 5\n  y: 0\n  z: 0.5\n}'\n</code></pre> <pre><code>ros2 interface show ros_gz_interfaces/srv/SetEntityPose \n</code></pre> run bridge for service<pre><code># gz name: /world/my_world/set_pose\n# ros2 service: ros_gz_interfaces/srv/SetEntityPose\nros2 run ros_gz_bridge parameter_bridge /world/my_world/set_pose@ros_gz_interfaces/srv/SetEntityPose\n</code></pre> call service from ROS<pre><code>ros2 service call /world/my_world/set_pose ros_gz_interfaces/srv/SetEntityPose \\\n\"{entity: {name: 'green_simple_box'}, \\\npose: {position: {x: 10.0, y: 0.0, z: 0.5}, \norientation: {x: 0.0, y: 0.0, z: 0.0, w: 1.0}}}\"\n</code></pre> call service from ROS<pre><code>ros2 service call /world/my_world/set_pose ros_gz_interfaces/srv/SetEntityPose \\\n\"{entity: {name: 'green_simple_box'}, \\\npose: {position: {x: 5.0} \n}}\"\n</code></pre>","tags":["gazebo","service","topics","position","set_pose","ros_gz_interfaces"]},{"location":"Simulation/Gazebo/tutorials/empty_world/","title":"Gazebo empty world in details","text":"empty_world.sdf <pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;sdf version=\"1.6\"&gt;\n  &lt;world name=\"default\"&gt;\n    &lt;physics name=\"1ms\" type=\"ignored\"&gt;\n      &lt;max_step_size&gt;0.001&lt;/max_step_size&gt;\n      &lt;real_time_factor&gt;1.0&lt;/real_time_factor&gt;\n    &lt;/physics&gt;\n    &lt;plugin\n      filename=\"gz-sim-physics-system\"\n      name=\"gz::sim::systems::Physics\"&gt;\n    &lt;/plugin&gt;\n    &lt;plugin\n      filename=\"gz-sim-user-commands-system\"\n      name=\"gz::sim::systems::UserCommands\"&gt;\n    &lt;/plugin&gt;\n    &lt;plugin\n      filename=\"gz-sim-scene-broadcaster-system\"\n      name=\"gz::sim::systems::SceneBroadcaster\"&gt;\n    &lt;/plugin&gt;\n    &lt;plugin\n      filename=\"gz-sim-contact-system\"\n      name=\"gz::sim::systems::Contact\"&gt;\n    &lt;/plugin&gt;\n\n    &lt;light type=\"directional\" name=\"sun\"&gt;\n      &lt;cast_shadows&gt;true&lt;/cast_shadows&gt;\n      &lt;pose&gt;0 0 10 0 0 0&lt;/pose&gt;\n      &lt;diffuse&gt;1 1 1 1&lt;/diffuse&gt;\n      &lt;specular&gt;0.5 0.5 0.5 1&lt;/specular&gt;\n      &lt;attenuation&gt;\n        &lt;range&gt;1000&lt;/range&gt;\n        &lt;constant&gt;0.9&lt;/constant&gt;\n        &lt;linear&gt;0.01&lt;/linear&gt;\n        &lt;quadratic&gt;0.001&lt;/quadratic&gt;\n      &lt;/attenuation&gt;\n      &lt;direction&gt;-0.5 0.1 -0.9&lt;/direction&gt;\n    &lt;/light&gt;\n\n    &lt;model name=\"ground_plane\"&gt;\n      &lt;static&gt;true&lt;/static&gt;\n      &lt;link name=\"link\"&gt;\n        &lt;collision name=\"collision\"&gt;\n          &lt;geometry&gt;\n            &lt;plane&gt;\n              &lt;normal&gt;0 0 1&lt;/normal&gt;\n              &lt;size&gt;100 100&lt;/size&gt;\n            &lt;/plane&gt;\n          &lt;/geometry&gt;\n        &lt;/collision&gt;\n        &lt;visual name=\"visual\"&gt;\n          &lt;geometry&gt;\n            &lt;plane&gt;\n              &lt;normal&gt;0 0 1&lt;/normal&gt;\n              &lt;size&gt;100 100&lt;/size&gt;\n            &lt;/plane&gt;\n          &lt;/geometry&gt;\n          &lt;material&gt;\n            &lt;ambient&gt;0.8 0.8 0.8 1&lt;/ambient&gt;\n            &lt;diffuse&gt;0.8 0.8 0.8 1&lt;/diffuse&gt;\n            &lt;specular&gt;0.8 0.8 0.8 1&lt;/specular&gt;\n          &lt;/material&gt;\n        &lt;/visual&gt;\n      &lt;/link&gt;\n    &lt;/model&gt;\n\n  &lt;/world&gt;\n&lt;/sdf&gt;\n</code></pre>","tags":["gazebo","harmonic","worlds","empty"]},{"location":"Simulation/Gazebo/tutorials/joint_control/","title":"Gazebo Joint Control","text":"<p>joint controllers from gazebo sim  api reference tutorials</p> <p>Gazebo provides three joint controller plugins which are JointController, JointPositionController, and JointTrajectoryController.</p>","tags":["gazebo","joint","control"]},{"location":"Simulation/Gazebo/tutorials/joint_control/#jointcontroller","title":"JointController","text":"<ul> <li>Velocity mode: This mode lets the user control the desired joint velocity directly.</li> <li>Force mode: A user who wants to control joint velocity using a PID controller can use this mode.</li> </ul> <p>All the parameters related to this controller can be found here.</p>","tags":["gazebo","joint","control"]},{"location":"Simulation/Gazebo/tutorials/joint_control/#velocity-mode","title":"Velocity mode","text":"joint velocity with initial velocity and topic<pre><code>&lt;plugin\n filename=\"gz-sim-joint-controller-system\"\n name=\"gz::sim::systems::JointController\"&gt;\n &lt;joint_name&gt;j1&lt;/joint_name&gt;\n &lt;initial_velocity&gt;1.0&lt;/initial_velocity&gt;\n &lt;topic&gt;velocity_topic&lt;/topic&gt;\n&lt;/plugin&gt;\n</code></pre> control velocity speed<pre><code>gz topic -t \"/topic_name\" -m gz.msgs.Double -p \"data: 10.0\"\n</code></pre>","tags":["gazebo","joint","control"]},{"location":"Simulation/Gazebo/tutorials/joint_control/#force-mode","title":"Force mode","text":"joint force mode<pre><code>&lt;plugin\n filename=\"gz-sim-joint-controller-system\"\n name=\"gz::sim::systems::JointController\"&gt;\n &lt;joint_name&gt;j1&lt;/joint_name&gt;\n &lt;use_force_commands&gt;true&lt;/use_force_commands&gt;\n &lt;p_gain&gt;0.2&lt;/p_gain&gt;\n &lt;i_gain&gt;0.01&lt;/i_gain&gt;\n&lt;/plugin&gt;\n</code></pre> <p>joint state</p> <pre><code>&lt;plugin\n    filename=\"gz-sim-joint-state-publisher-system\"\n    name=\"gz::sim::systems::JointStatePublisher\"&gt;\n    &lt;joint_name&gt;j1&lt;/joint_name&gt;\n    &lt;topic&gt;force_topic&lt;/topic&gt;\n&lt;/plugin&gt;\n</code></pre> echo joint state<pre><code>gz topic -e -t /world/default/model/joint_controller_demo/joint_state\n</code></pre>","tags":["gazebo","joint","control"]},{"location":"Simulation/Gazebo/tutorials/joint_control/#demo","title":"Demo","text":"world demo <pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;sdf version=\"1.6\"&gt;\n    &lt;world name=\"default\"&gt;\n        &lt;light type=\"directional\" name=\"sun\"&gt;\n            &lt;cast_shadows&gt;true&lt;/cast_shadows&gt;\n            &lt;pose&gt;0 0 10 0 0 0&lt;/pose&gt;\n            &lt;diffuse&gt;1 1 1 1&lt;/diffuse&gt;\n            &lt;specular&gt;0.5 0.5 0.5 1&lt;/specular&gt;\n            &lt;attenuation&gt;\n                &lt;range&gt;1000&lt;/range&gt;\n                &lt;constant&gt;0.9&lt;/constant&gt;\n                &lt;linear&gt;0.01&lt;/linear&gt;\n                &lt;quadratic&gt;0.001&lt;/quadratic&gt;\n            &lt;/attenuation&gt;\n            &lt;direction&gt;-0.5 0.1 -0.9&lt;/direction&gt;\n        &lt;/light&gt;\n        &lt;model name=\"joint_controller_velocity\"&gt;\n            &lt;pose&gt;0 1 0 0 0 0&lt;/pose&gt;\n            &lt;link name=\"base_link\"&gt;\n                &lt;pose&gt;0.0 0.0 0.0 0 0 0&lt;/pose&gt;\n                &lt;inertial&gt;\n                    &lt;inertia&gt;\n                        &lt;ixx&gt;2.501&lt;/ixx&gt;\n                        &lt;ixy&gt;0&lt;/ixy&gt;\n                        &lt;ixz&gt;0&lt;/ixz&gt;\n                        &lt;iyy&gt;2.501&lt;/iyy&gt;\n                        &lt;iyz&gt;0&lt;/iyz&gt;\n                        &lt;izz&gt;5&lt;/izz&gt;\n                    &lt;/inertia&gt;\n                    &lt;mass&gt;120.0&lt;/mass&gt;\n                &lt;/inertial&gt;\n                &lt;visual name=\"base_visual\"&gt;\n                    &lt;pose&gt;0.0 0.0 0.0 0 0 0&lt;/pose&gt;\n                    &lt;geometry&gt;\n                        &lt;box&gt;\n                            &lt;size&gt;0.5 0.5 0.01&lt;/size&gt;\n                        &lt;/box&gt;\n                    &lt;/geometry&gt;\n                &lt;/visual&gt;\n                &lt;collision name=\"base_collision\"&gt;\n                    &lt;pose&gt;0.0 0.0 0.0 0 0 0&lt;/pose&gt;\n                    &lt;geometry&gt;\n                        &lt;box&gt;\n                            &lt;size&gt;0.5 0.5 0.01&lt;/size&gt;\n                        &lt;/box&gt;\n                    &lt;/geometry&gt;\n                &lt;/collision&gt;\n            &lt;/link&gt;\n            &lt;link name=\"rotor\"&gt;\n                &lt;pose&gt;0.0 0.0 0.1 0 0 0&lt;/pose&gt;\n                &lt;inertial&gt;\n                    &lt;inertia&gt;\n                        &lt;ixx&gt;0.032&lt;/ixx&gt;\n                        &lt;ixy&gt;0&lt;/ixy&gt;\n                        &lt;ixz&gt;0&lt;/ixz&gt;\n                        &lt;iyy&gt;0.032&lt;/iyy&gt;\n                        &lt;iyz&gt;0&lt;/iyz&gt;\n                        &lt;izz&gt;0.00012&lt;/izz&gt;\n                    &lt;/inertia&gt;\n                    &lt;mass&gt;0.6&lt;/mass&gt;\n                &lt;/inertial&gt;\n                &lt;visual name=\"visual\"&gt;\n                    &lt;geometry&gt;\n                        &lt;box&gt;\n                            &lt;size&gt;0.25 0.1 0.05&lt;/size&gt;\n                        &lt;/box&gt;\n                    &lt;/geometry&gt;\n                    &lt;material&gt;\n                        &lt;ambient&gt;0.2 0.8 0.2 1&lt;/ambient&gt;\n                        &lt;diffuse&gt;0.8 0 0 1&lt;/diffuse&gt;\n                    &lt;/material&gt;\n                &lt;/visual&gt;\n                &lt;collision name=\"collision\"&gt;\n                    &lt;geometry&gt;\n                        &lt;box&gt;\n                            &lt;size&gt;0.25 0.1 0.05&lt;/size&gt;\n                        &lt;/box&gt;\n                    &lt;/geometry&gt;\n                &lt;/collision&gt;\n            &lt;/link&gt;\n\n            &lt;joint name=\"world_fixed\" type=\"fixed\"&gt;\n                &lt;parent&gt;world&lt;/parent&gt;\n                &lt;child&gt;base_link&lt;/child&gt;\n            &lt;/joint&gt;\n\n            &lt;joint name=\"j1\" type=\"revolute\"&gt;\n                &lt;pose&gt;0 0 -0.5 0 0 0&lt;/pose&gt;\n                &lt;parent&gt;base_link&lt;/parent&gt;\n                &lt;child&gt;rotor&lt;/child&gt;\n                &lt;axis&gt;\n                    &lt;xyz&gt;0 0 1&lt;/xyz&gt;\n                &lt;/axis&gt;\n            &lt;/joint&gt;\n\n            &lt;plugin\n                filename=\"gz-sim-joint-controller-system\"\n                name=\"gz::sim::systems::JointController\"&gt;\n                &lt;joint_name&gt;j1&lt;/joint_name&gt;\n                &lt;initial_velocity&gt;1.0&lt;/initial_velocity&gt;\n                &lt;topic&gt;velocity_topic&lt;/topic&gt;\n            &lt;/plugin&gt;\n            &lt;plugin\n                filename=\"gz-sim-joint-state-publisher-system\"\n                name=\"gz::sim::systems::JointStatePublisher\"&gt;\n                &lt;joint_name&gt;j1&lt;/joint_name&gt;\n                &lt;topic&gt;velocity_j1_state&lt;/topic&gt;\n            &lt;/plugin&gt;\n        &lt;/model&gt;\n\n        &lt;model name=\"joint_controller_force\"&gt;\n            &lt;pose&gt;0 0 0 0 0 0&lt;/pose&gt;\n            &lt;link name=\"base_link\"&gt;\n                &lt;pose&gt;0.0 0.0 0.0 0 0 0&lt;/pose&gt;\n                &lt;inertial&gt;\n                    &lt;inertia&gt;\n                        &lt;ixx&gt;2.501&lt;/ixx&gt;\n                        &lt;ixy&gt;0&lt;/ixy&gt;\n                        &lt;ixz&gt;0&lt;/ixz&gt;\n                        &lt;iyy&gt;2.501&lt;/iyy&gt;\n                        &lt;iyz&gt;0&lt;/iyz&gt;\n                        &lt;izz&gt;5&lt;/izz&gt;\n                    &lt;/inertia&gt;\n                    &lt;mass&gt;120.0&lt;/mass&gt;\n                &lt;/inertial&gt;\n                &lt;visual name=\"base_visual\"&gt;\n                    &lt;pose&gt;0.0 0.0 0.0 0 0 0&lt;/pose&gt;\n                    &lt;geometry&gt;\n                        &lt;box&gt;\n                            &lt;size&gt;0.5 0.5 0.01&lt;/size&gt;\n                        &lt;/box&gt;\n                    &lt;/geometry&gt;\n                &lt;/visual&gt;\n                &lt;collision name=\"base_collision\"&gt;\n                    &lt;pose&gt;0.0 0.0 0.0 0 0 0&lt;/pose&gt;\n                    &lt;geometry&gt;\n                        &lt;box&gt;\n                            &lt;size&gt;0.5 0.5 0.01&lt;/size&gt;\n                        &lt;/box&gt;\n                    &lt;/geometry&gt;\n                &lt;/collision&gt;\n            &lt;/link&gt;\n            &lt;link name=\"rotor\"&gt;\n                &lt;pose&gt;0.0 0.0 0.1 0 0 0&lt;/pose&gt;\n                &lt;inertial&gt;\n                    &lt;inertia&gt;\n                        &lt;ixx&gt;0.032&lt;/ixx&gt;\n                        &lt;ixy&gt;0&lt;/ixy&gt;\n                        &lt;ixz&gt;0&lt;/ixz&gt;\n                        &lt;iyy&gt;0.032&lt;/iyy&gt;\n                        &lt;iyz&gt;0&lt;/iyz&gt;\n                        &lt;izz&gt;0.00012&lt;/izz&gt;\n                    &lt;/inertia&gt;\n                    &lt;mass&gt;0.6&lt;/mass&gt;\n                &lt;/inertial&gt;\n                &lt;visual name=\"visual\"&gt;\n                    &lt;geometry&gt;\n                        &lt;box&gt;\n                            &lt;size&gt;0.25 0.1 0.05&lt;/size&gt;\n                        &lt;/box&gt;\n                    &lt;/geometry&gt;\n                    &lt;material&gt;\n                        &lt;ambient&gt;0.2 0.8 0.2 1&lt;/ambient&gt;\n                        &lt;diffuse&gt;0.8 0 0 1&lt;/diffuse&gt;\n                    &lt;/material&gt;\n                &lt;/visual&gt;\n                &lt;collision name=\"collision\"&gt;\n                    &lt;geometry&gt;\n                        &lt;box&gt;\n                            &lt;size&gt;0.25 0.1 0.05&lt;/size&gt;\n                        &lt;/box&gt;\n                    &lt;/geometry&gt;\n                &lt;/collision&gt;\n            &lt;/link&gt;\n\n            &lt;joint name=\"world_fixed\" type=\"fixed\"&gt;\n                &lt;parent&gt;world&lt;/parent&gt;\n                &lt;child&gt;base_link&lt;/child&gt;\n            &lt;/joint&gt;\n\n            &lt;joint name=\"j1\" type=\"revolute\"&gt;\n                &lt;pose&gt;0 0 -0.5 0 0 0&lt;/pose&gt;\n                &lt;parent&gt;base_link&lt;/parent&gt;\n                &lt;child&gt;rotor&lt;/child&gt;\n                &lt;axis&gt;\n                    &lt;xyz&gt;0 0 1&lt;/xyz&gt;\n                &lt;/axis&gt;\n            &lt;/joint&gt;\n\n            &lt;plugin\n                filename=\"gz-sim-joint-controller-system\"\n                name=\"gz::sim::systems::JointController\"&gt;\n                &lt;joint_name&gt;j1&lt;/joint_name&gt;\n                &lt;use_force_commands&gt;true&lt;/use_force_commands&gt;\n                &lt;topic&gt;force_topic&lt;/topic&gt;\n                &lt;p_gain&gt;0.2&lt;/p_gain&gt;\n                &lt;i_gain&gt;0.01&lt;/i_gain&gt;\n            &lt;/plugin&gt;\n            &lt;plugin\n                filename=\"gz-sim-joint-state-publisher-system\"\n                name=\"gz::sim::systems::JointStatePublisher\"&gt;\n                &lt;joint_name&gt;j1&lt;/joint_name&gt;\n                &lt;topic&gt;force_j1_state&lt;/topic&gt;\n            &lt;/plugin&gt;\n        &lt;/model&gt;\n    &lt;/world&gt;\n&lt;/sdf&gt;\n</code></pre> command and state topics<pre><code>gz topic --list\n#\n/clock\n/force_j1_state\n/gazebo/resource_paths\n/gui/camera/pose\n/gui/currently_tracked\n/gui/track\n/stats\n/velocity_j1_state\n...\n/force_topic\n/velocity_topic\n</code></pre> publish velocity to force controller<pre><code>gz topic -t \"/force_topic\" -m gz.msgs.Double -p \"data: 10.0\"\n</code></pre>","tags":["gazebo","joint","control"]},{"location":"Simulation/Gazebo/tutorials/read_imu_data/","title":"Read IMU Data from Gazebo harmonic","text":"<p>Simulation / Gazebo</p> <p>Read imu message from gazebo simulation using cpp</p>","tags":["gazebo","gz_transport","gz_msgs","harmonic"]},{"location":"Simulation/Gazebo/tutorials/read_imu_data/#prerequisites","title":"prerequisites","text":"<pre><code>sudo apt install build-essential\nsudo apt install \\\n    libgz-transport12-dev\n    libgz-msgs10-dev\n    libgz-tools-dev\n    libgz-common5-dev\n    libgz-math7-dev\n</code></pre> world with IMU <pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;sdf version=\"1.6\"&gt;\n  &lt;world name=\"default\"&gt;\n    &lt;physics name=\"1ms\" type=\"ignored\"&gt;\n      &lt;max_step_size&gt;0.001&lt;/max_step_size&gt;\n      &lt;real_time_factor&gt;1.0&lt;/real_time_factor&gt;\n    &lt;/physics&gt;\n    &lt;plugin\n      filename=\"gz-sim-physics-system\"\n      name=\"gz::sim::systems::Physics\"&gt;\n    &lt;/plugin&gt;\n    &lt;plugin\n      filename=\"gz-sim-user-commands-system\"\n      name=\"gz::sim::systems::UserCommands\"&gt;\n    &lt;/plugin&gt;\n    &lt;plugin\n      filename=\"gz-sim-scene-broadcaster-system\"\n      name=\"gz::sim::systems::SceneBroadcaster\"&gt;\n    &lt;/plugin&gt;\n    &lt;plugin\n      filename=\"gz-sim-contact-system\"\n      name=\"gz::sim::systems::Contact\"&gt;\n    &lt;/plugin&gt;\n    &lt;plugin\n      filename=\"gz-sim-imu-system\"\n      name=\"gz::sim::systems::Imu\"&gt;\n    &lt;/plugin&gt;\n\n    &lt;light type=\"directional\" name=\"sun\"&gt;\n      &lt;cast_shadows&gt;true&lt;/cast_shadows&gt;\n      &lt;pose&gt;0 0 10 0 0 0&lt;/pose&gt;\n      &lt;diffuse&gt;1 1 1 1&lt;/diffuse&gt;\n      &lt;specular&gt;0.5 0.5 0.5 1&lt;/specular&gt;\n      &lt;attenuation&gt;\n        &lt;range&gt;1000&lt;/range&gt;\n        &lt;constant&gt;0.9&lt;/constant&gt;\n        &lt;linear&gt;0.01&lt;/linear&gt;\n        &lt;quadratic&gt;0.001&lt;/quadratic&gt;\n      &lt;/attenuation&gt;\n      &lt;direction&gt;-0.5 0.1 -0.9&lt;/direction&gt;\n    &lt;/light&gt;\n\n    &lt;model name=\"ground_plane\"&gt;\n      &lt;static&gt;true&lt;/static&gt;\n      &lt;link name=\"link\"&gt;\n        &lt;collision name=\"collision\"&gt;\n          &lt;geometry&gt;\n            &lt;plane&gt;\n              &lt;normal&gt;0 0 1&lt;/normal&gt;\n              &lt;size&gt;100 100&lt;/size&gt;\n            &lt;/plane&gt;\n          &lt;/geometry&gt;\n        &lt;/collision&gt;\n        &lt;visual name=\"visual\"&gt;\n          &lt;geometry&gt;\n            &lt;plane&gt;\n              &lt;normal&gt;0 0 1&lt;/normal&gt;\n              &lt;size&gt;100 100&lt;/size&gt;\n            &lt;/plane&gt;\n          &lt;/geometry&gt;\n          &lt;material&gt;\n            &lt;ambient&gt;0.8 0.8 0.8 1&lt;/ambient&gt;\n            &lt;diffuse&gt;0.8 0.8 0.8 1&lt;/diffuse&gt;\n            &lt;specular&gt;0.8 0.8 0.8 1&lt;/specular&gt;\n          &lt;/material&gt;\n        &lt;/visual&gt;\n      &lt;/link&gt;\n    &lt;/model&gt;\n\n    &lt;model name=\"my_box\"&gt;\n      &lt;pose&gt;1 2 0.5 0 0 0&lt;/pose&gt; &lt;!-- x y z roll pitch yaw --&gt;\n      &lt;static&gt;false&lt;/static&gt;\n\n      &lt;link name=\"box_link\"&gt;\n        &lt;collision name=\"box_collision\"&gt;\n          &lt;geometry&gt;\n            &lt;box&gt;\n              &lt;size&gt;1 1 1&lt;/size&gt; &lt;!-- x y z dimensions --&gt;\n            &lt;/box&gt;\n          &lt;/geometry&gt;\n        &lt;/collision&gt;\n\n        &lt;visual name=\"box_visual\"&gt;\n          &lt;geometry&gt;\n            &lt;box&gt;\n              &lt;size&gt;1 1 1&lt;/size&gt;\n            &lt;/box&gt;\n          &lt;/geometry&gt;\n          &lt;material&gt;\n            &lt;ambient&gt;0.1 0.3 0.8 1&lt;/ambient&gt;\n            &lt;diffuse&gt;0.1 0.3 0.8 1&lt;/diffuse&gt;\n          &lt;/material&gt;\n        &lt;/visual&gt;\n\n        &lt;sensor name=\"imu\" type=\"imu\"&gt;\n          &lt;always_on&gt;1&lt;/always_on&gt;\n          &lt;update_rate&gt;50&lt;/update_rate&gt;\n          &lt;visualize&gt;true&lt;/visualize&gt;\n          &lt;topic&gt;imu&lt;/topic&gt;\n          &lt;enable_metrics&gt;true&lt;/enable_metrics&gt;\n        &lt;/sensor&gt;\n      &lt;/link&gt;\n\n    &lt;/model&gt;\n  &lt;/world&gt;\n&lt;/sdf&gt;\n</code></pre> read_imu.cpp<pre><code>#include &lt;gz/transport.hh&gt;\n#include &lt;gz/msgs.hh&gt;\n#include &lt;iostream&gt;\n\nvoid imuCallback(const gz::msgs::IMU &amp;msg)\n{\n  std::cout &lt;&lt; \"IMU Data:\" &lt;&lt; std::endl;\n  std::cout &lt;&lt; \"  Linear Accel: \"\n            &lt;&lt; msg.linear_acceleration().x() &lt;&lt; \", \"\n            &lt;&lt; msg.linear_acceleration().y() &lt;&lt; \", \"\n            &lt;&lt; msg.linear_acceleration().z() &lt;&lt; std::endl;\n\n  // std::cout &lt;&lt; \"  Angular Vel: \"\n  //           &lt;&lt; msg.angular_velocity().x() &lt;&lt; \", \"\n  //           &lt;&lt; msg.angular_velocity().y() &lt;&lt; \", \"\n  //           &lt;&lt; msg.angular_velocity().z() &lt;&lt; std::endl;\n}\n\nint main()\n{\n  gz::transport::Node node;\n\n  std::string topic = \"/imu\";\n  if (!node.Subscribe(topic, imuCallback))\n  {\n    std::cerr &lt;&lt; \"Failed to subscribe to topic: \" &lt;&lt; topic &lt;&lt; std::endl;\n    return -1;\n  }\n\n  std::cout &lt;&lt; \"Listening to IMU data on: \" &lt;&lt; topic &lt;&lt; std::endl;\n  gz::transport::waitForShutdown();\n  return 0;\n}\n</code></pre> CMakeLists.txt<pre><code>cmake_minimum_required(VERSION 3.22)\nproject(imu_subscriber)\n\n# Find Gazebo dependencies\nfind_package(gz-transport12 REQUIRED)\nfind_package(gz-msgs10 REQUIRED)\n\n\n# Add executable\nadd_executable(read_imu read_imu.cpp)\ntarget_link_libraries(read_imu\n    gz-transport12::gz-transport12\n    ${GZ-MSGS_LIBRARIES}\n)\n</code></pre>","tags":["gazebo","gz_transport","gz_msgs","harmonic"]},{"location":"Simulation/Gazebo/vscode/","title":"Run gazebo harmonic on docker","text":"<p>Build a docker container base on cuda runtime and ubuntu 22.04 to run Gazebo harmonic simulation. The dockerfile base on Allison Thackston</p> <p>Use vscode devcontainer to run the docker image. using docker compose. vscode devcontainer</p>","tags":["gazebo","gz","harmonic","docker","vscode"]},{"location":"Simulation/Gazebo/vscode/#prerequisites","title":"Prerequisites","text":"<ul> <li>Check nvidia version using <code>nvidia-smi</code></li> <li>Pull the cuda runtime</li> <li>Install nvidia-container-toolkit more</li> </ul> pull cuda runtime<pre><code># my current cuda version is 12.4\ndocker pull nvidia/cuda:12.4.0-runtime-ubuntu22.04\ndocker run --gps all -it --rm  nvidia/cuda:12.4.0-runtime-ubuntu22.04 /bin/bash\n# from docker \nnvida-smi\n</code></pre>","tags":["gazebo","gz","harmonic","docker","vscode"]},{"location":"Simulation/Gazebo/vscode/#dockerfile","title":"Dockerfile","text":"Docker file <pre><code>FROM nvidia/cuda:12.4.0-runtime-ubuntu22.04 AS base\n\n# Avoid warnings by switching to noninteractive\nENV DEBIAN_FRONTEND=noninteractive\n\n# Install language\nRUN apt-get update &amp;&amp; apt-get install -y --no-install-recommends \\\n  locales \\\n  &amp;&amp; locale-gen en_US.UTF-8 \\\n  &amp;&amp; update-locale LC_ALL=en_US.UTF-8 LANG=en_US.UTF-8 \\\n  &amp;&amp; rm -rf /var/lib/apt/lists/*\nENV LANG=en_US.UTF-8\n\n# Install timezone\nRUN ln -fs /usr/share/zoneinfo/UTC /etc/localtime \\\n  &amp;&amp; export DEBIAN_FRONTEND=noninteractive \\\n  &amp;&amp; apt-get update \\\n  &amp;&amp; apt-get install -y --no-install-recommends tzdata \\\n  &amp;&amp; dpkg-reconfigure --frontend noninteractive tzdata \\\n  &amp;&amp; rm -rf /var/lib/apt/lists/*\n\n# install packages\nRUN apt-get update &amp;&amp; apt-get install -q -y \\\n    curl \\\n    gnupg \\\n    lsb-release \\\n    python3-argcomplete \\\n    sudo \\\n    wget \\\n  &amp;&amp; wget https://packages.osrfoundation.org/gazebo.gpg -O /usr/share/keyrings/pkgs-osrf-archive-keyring.gpg \\\n  &amp;&amp; echo \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/pkgs-osrf-archive-keyring.gpg] http://packages.osrfoundation.org/gazebo/ubuntu-stable $(lsb_release -cs) main\" | tee /etc/apt/sources.list.d/gazebo-stable.list &gt; /dev/null \\\n  &amp;&amp; apt-get update &amp;&amp; apt-get install -y -q \\\n    gz-harmonic \\\n  &amp;&amp; rm -rf /var/lib/apt/lists/*\n\n################\n# Expose the nvidia driver to allow opengl\n# Dependencies for glvnd and X11.\n################\nRUN apt-get update \\\n &amp;&amp; apt-get install -y -qq --no-install-recommends \\\n  libglvnd0 \\\n  libgl1 \\\n  libglx0 \\\n  libegl1 \\\n  libxext6 \\\n  libx11-6\n\n# Env vars for the nvidia-container-runtime.\nENV NVIDIA_VISIBLE_DEVICES=all\nENV NVIDIA_DRIVER_CAPABILITIES=graphics,utility,compute\nENV QT_X11_NO_MITSHM=1\n\nARG USERNAME=user\nARG USER_UID=1000\nARG USER_GID=$USER_UID\n\n# Check if \"ubuntu\" user exists, delete it if it does, then create the desired user\nRUN if getent passwd ubuntu &gt; /dev/null 2&gt;&amp;1; then \\\n        userdel -r ubuntu &amp;&amp; \\\n        echo \"Deleted existing ubuntu user\"; \\\n    fi &amp;&amp; \\\n    groupadd --gid $USER_GID $USERNAME &amp;&amp; \\\n    useradd -s /bin/bash --uid $USER_UID --gid $USER_GID -m $USERNAME &amp;&amp; \\\n    echo \"Created new user $USERNAME\"\n\n# Add sudo support for the non-root user\nRUN apt-get update &amp;&amp; apt-get install -y sudo \\\n  &amp;&amp; echo $USERNAME ALL=\\(root\\) NOPASSWD:ALL &gt; /etc/sudoers.d/$USERNAME\\\n  &amp;&amp; chmod 0440 /etc/sudoers.d/$USERNAME \\\n  &amp;&amp; rm -rf /var/lib/apt/lists/*\n\nCMD [\"bash\"]\n</code></pre> <p>Docker environment variables</p> <ul> <li>QT_X11_NO_MITSHM=1 is used to disable the MIT-SHM extension for X11, which can cause issues with some applications running in Docker containers.</li> <li>NVIDIA_DRIVER_CAPABILITIES=graphics,utility,compute is used to specify the capabilities of the NVIDIA driver that should be exposed to the container. This is important for GPU-accelerated applications.</li> <li>NVIDIA_VISIBLE_DEVICES=all is used to make all NVIDIA GPUs visible to the container. This is important for GPU-accelerated applications that need access to the GPU.</li> </ul>","tags":["gazebo","gz","harmonic","docker","vscode"]},{"location":"Simulation/Gazebo/vscode/#build-the-image","title":"Build the image","text":"<pre><code>docker build -t gz:harmonic .\n</code></pre>","tags":["gazebo","gz","harmonic","docker","vscode"]},{"location":"Simulation/Gazebo/vscode/#run-the-image","title":"Run the image","text":"<pre><code>xhost +local:docker\n\ndocker run --gpus all -it --rm \\\n--name gz \\\n--hostname gz \\\n--user user \\\n--network host \\\n--env=\"QT_X11_NO_MITSHM=1\"  \\\n--env=\"DISPLAY\"  \\\n-v /tmp/.X11-unix:/tmp/.X11-unix:rw \\\n-v /dev/dri:/dev/dri \\\n-v /dev/nvidia0:/dev/nvidia0 \\\n-v /dev/nvidiactl:/dev/nvidiactl \\\n-v /dev/nvidia-modeset:/dev/nvidia-modeset \\\ngz:harmonic\n</code></pre>","tags":["gazebo","gz","harmonic","docker","vscode"]},{"location":"Simulation/Gazebo/vscode/#use-vscode-and-docker","title":"Use VSCode and docker","text":"<ul> <li>Using docker-compose</li> <li>Using devcontainer to run the docker compose</li> </ul> <pre><code>\u251c\u2500\u2500 .devcontainer\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 devcontainer.json\n\u251c\u2500\u2500 docker-compose.yaml\n\u251c\u2500\u2500 .gitignore\n\u2514\u2500\u2500 gz_tutorial\n    \u2514\u2500\u2500 worlds\n        \u2514\u2500\u2500 empty.world\n</code></pre> docker-compose.yaml<pre><code>services:\n  gazebo:\n    image: gz:harmonic\n    network_mode: host\n    user: user\n    stdin_open: true\n    tty: true\n    hostname: gz\n    environment:\n      - DISPLAY=${DISPLAY}\n      - QT_X11_NO_MITSHM=1\n      - NVIDIA_VISIBLE_DEVICES=all\n      - NVIDIA_DRIVER_CAPABILITIES=all\n      - GZ_TRANSPORT_IP=gazebo\n      - GZ_DISCOVERY_SERVER=gazebo\n      - GZ_PARTITION=my_simulation\n    volumes:\n      - .:/workspace:cached\n      - ./.gz:/home/user/.gz:cached\n      - /tmp/.X11-unix:/tmp/.X11-unix:rw \n      - /dev/dri:/dev/dri \n      - /dev/nvidia0:/dev/nvidia0 \n      - /dev/nvidiactl:/dev/nvidiactl \n      - /dev/nvidia-modeset:/dev/nvidia-modeset \n    deploy:\n      resources:\n        reservations:\n          devices:\n            - capabilities: [gpu]\n</code></pre> .devcontainer/devcontainer.json<pre><code>{\n    \"name\": \"gz_tutorial\",\n    \"dockerComposeFile\": \"../docker-compose.yaml\",\n    \"service\": \"gazebo\",\n    \"shutdownAction\": \"stopCompose\",\n    \"workspaceFolder\": \"/workspace\",\n    \"remoteUser\": \"user\",\n    \"customizations\": {\n      \"vscode\": {\n        \"extensions\": [\n            \"ms-python.python\",\n            \"ms-vscode.cpptools\",\n            \"twxs.cmake\",\n            \"redhat.vscode-xml\",\n            \"redhat.vscode-yaml\",\n            \"albert.tabout\",\n            \"actboy168.tasks\",\n            \"streetsidesoftware.code-spell-checker\"\n        ],\n        \"settings\": {}\n      }\n    }\n  }\n</code></pre>","tags":["gazebo","gz","harmonic","docker","vscode"]},{"location":"Simulation/Gazebo/vscode/#run-the-simulation","title":"Run the simulation","text":"minimal world <pre><code>&lt;!-- https://github.com/gazebosim/docs/blob/master/harmonic/tutorials/sdf_worlds/world_demo.sdf --&gt;\n&lt;!-- https://gazebosim.org/docs/harmonic/sdf_worlds/ --&gt;\n&lt;?xml version=\"1.0\" ?&gt;\n&lt;sdf version=\"1.8\"&gt;\n  &lt;world name=\"world_demo\"&gt;\n    &lt;physics name=\"1ms\" type=\"ignored\"&gt;\n      &lt;max_step_size&gt;0.001&lt;/max_step_size&gt;\n      &lt;real_time_factor&gt;1.0&lt;/real_time_factor&gt;\n    &lt;/physics&gt;\n    &lt;plugin\n      filename=\"gz-sim-physics-system\"\n      name=\"gz::sim::systems::Physics\"&gt;\n    &lt;/plugin&gt;\n    &lt;plugin\n      filename=\"gz-sim-user-commands-system\"\n      name=\"gz::sim::systems::UserCommands\"&gt;\n    &lt;/plugin&gt;\n    &lt;plugin\n      filename=\"gz-sim-scene-broadcaster-system\"\n      name=\"gz::sim::systems::SceneBroadcaster\"&gt;\n    &lt;/plugin&gt;\n\n    &lt;!--light--&gt;\n    &lt;light type=\"directional\" name=\"sun\"&gt;\n      &lt;cast_shadows&gt;true&lt;/cast_shadows&gt;\n      &lt;pose&gt;0 0 10 0 0 0&lt;/pose&gt;\n      &lt;diffuse&gt;0.8 0.8 0.8 1&lt;/diffuse&gt;\n      &lt;specular&gt;0.2 0.2 0.2 1&lt;/specular&gt;\n      &lt;attenuation&gt;\n        &lt;range&gt;1000&lt;/range&gt;\n        &lt;constant&gt;0.9&lt;/constant&gt;\n        &lt;linear&gt;0.01&lt;/linear&gt;\n        &lt;quadratic&gt;0.001&lt;/quadratic&gt;\n      &lt;/attenuation&gt;\n      &lt;direction&gt;-0.5 0.1 -0.9&lt;/direction&gt;\n    &lt;/light&gt;\n    &lt;include&gt;\n        &lt;name&gt;Coke0&lt;/name&gt;\n        &lt;pose&gt;0 0 0 0 0 0&lt;/pose&gt;\n        &lt;uri&gt;https://fuel.gazebosim.org/1.0/OpenRobotics/models/Coke&lt;/uri&gt;\n    &lt;/include&gt;\n    &lt;include&gt;\n        &lt;name&gt;Coke1&lt;/name&gt;\n        &lt;pose&gt;0 0.1 0 0 0 0&lt;/pose&gt;\n        &lt;uri&gt;https://fuel.gazebosim.org/1.0/OpenRobotics/models/Coke&lt;/uri&gt;\n    &lt;/include&gt;\n  &lt;/world&gt;\n&lt;/sdf&gt;\n</code></pre> <pre><code># run the simulation\ngz sim -r v4 gz_tutorial/worlds/empty.world \n</code></pre> gz topic<pre><code>gz topic --list\ngz topic -e -t /clock\n#\n\nsim {\n  sec: 326\n  nsec: 476000000\n}\n</code></pre>","tags":["gazebo","gz","harmonic","docker","vscode"]},{"location":"Simulation/Gazebo/vscode/#gz-transport","title":"Gz Transport","text":"<p>gz_transport is Gazebo's communication middleware, used for inter-process communication (IPC) between different Gazebo components \u2014 like sensors, plugins, UI, and even ROS bridges.</p> <ul> <li>GZ_PARTITION: Isolates topic namespaces between different simulations</li> <li>GZ_DISCOVERY_SERVER:  IP address of the main discovery server (usually the Gazebo server machine)</li> <li>GZ_TRANSPORT_IP:  IP address the local process uses to advertise itself to others</li> </ul>","tags":["gazebo","gz","harmonic","docker","vscode"]},{"location":"Simulation/Gazebo/vscode/#resource","title":"Resource","text":"<ul> <li>Gazebo Simulator : 5 Ways to Speedup Simulations</li> </ul>","tags":["gazebo","gz","harmonic","docker","vscode"]},{"location":"Simulation/Gazebo_Classic/","title":"Gazebo Classic","text":"<p>Tips / Settings</p> <p>Plugin and Sensors</p> <p>Custom plugin</p> <p>Docker dev environment</p>","tags":["gazebo"]},{"location":"Simulation/Gazebo_Classic/custom_plugins/","title":"Gazebo classic custom plugin","text":"","tags":["gazebo","classic","plugin","custom"]},{"location":"Simulation/Gazebo_Classic/dev/","title":"Set gazebo classic dev environment using docker and vscode","text":"<p>Simulation / Gazebo Classic</p>","tags":["gazebo","docker","dev","classic","vscode","devcontainer"]},{"location":"Simulation/Gazebo_Classic/dev/#docker-with-nvidia-support","title":"Docker with nvidia support","text":"","tags":["gazebo","docker","dev","classic","vscode","devcontainer"]},{"location":"Simulation/Gazebo_Classic/dev/#docker-runtime-on-host","title":"Docker runtime on host","text":"<ul> <li>install nvidia-container-toolkit on host</li> <li>Config docker run time</li> </ul> <pre><code>docker info | grep -i runtime\n#\n Runtimes: runc io.containerd.runc.v2\n Default Runtime: runc\n</code></pre> <pre><code>sudo nvidia-ctk runtime configure --runtime=docker\nsudo systemctl restart docker\n</code></pre> runtime changed to nvidia<pre><code>docker info | grep -i runtime\n Runtimes: nvidia runc io.containerd.runc.v2\n</code></pre> <pre><code>cat /etc/docker/daemon.json\n#\n{\n    \"runtimes\": {\n        \"nvidia\": {\n            \"args\": [],\n            \"path\": \"nvidia-container-runtime\"\n        }\n    }\n}\n</code></pre>","tags":["gazebo","docker","dev","classic","vscode","devcontainer"]},{"location":"Simulation/Gazebo_Classic/dev/#dev-environment-using-docker","title":"Dev environment using docker","text":"<pre><code>\u251c\u2500\u2500 CMakeLists.txt\n\u251c\u2500\u2500 .devcontainer\n\u2502   \u251c\u2500\u2500 devcontainer.json\n\u2502   \u2514\u2500\u2500 Dockerfile\n\u251c\u2500\u2500 docker-compose.yaml\n\u251c\u2500\u2500 .gitignore\n\u251c\u2500\u2500 src\n\u2502   \u251c\u2500\u2500 CMakeLists.txt\n\u2502   \u2514\u2500\u2500 listener.cpp\n\u2514\u2500\u2500 .vscode\n    \u251c\u2500\u2500 c_cpp_properties.json\n    \u2514\u2500\u2500 settings.json\n</code></pre> Docker <pre><code>FROM ubuntu:22.04\n\nENV DEBIAN_FRONTEND=noninteractive\n\n# Install language\nRUN apt-get update &amp;&amp; apt-get install -y --no-install-recommends \\\n  locales \\\n  &amp;&amp; locale-gen en_US.UTF-8 \\\n  &amp;&amp; update-locale LC_ALL=en_US.UTF-8 LANG=en_US.UTF-8 \\\n  &amp;&amp; rm -rf /var/lib/apt/lists/*\nENV LANG=en_US.UTF-8\n\n# Install timezone\nRUN ln -fs /usr/share/zoneinfo/UTC /etc/localtime \\\n  &amp;&amp; export DEBIAN_FRONTEND=noninteractive \\\n  &amp;&amp; apt-get update \\\n  &amp;&amp; apt-get install -y --no-install-recommends tzdata \\\n  &amp;&amp; dpkg-reconfigure --frontend noninteractive tzdata \\\n  &amp;&amp; rm -rf /var/lib/apt/lists/*\n\nRUN apt-get update &amp;&amp; apt-get install -y --no-install-recommends \\\n    bash-completion \\\n    build-essential \\\n    cmake \\\n    gdb \\\n    git \\\n    tmux \\\n    tmuxp \\\n    pkg-config \\\n  &amp;&amp; rm -rf /var/lib/apt/lists/*\n\nCOPY .devcontainer/.tmux.conf /etc/tmux.conf\nRUN rosdep init || echo \"rosdep already initialized\"\n\nARG USERNAME=user\nARG USER_UID=1000\nARG USER_GID=$USER_UID\n\n# Create a non-root user\nRUN groupadd --gid $USER_GID $USERNAME \\\n  &amp;&amp; useradd -s /bin/bash --uid $USER_UID --gid $USER_GID -m $USERNAME \\\n  # Add sudo support for the non-root user\n  &amp;&amp; apt-get update \\\n  &amp;&amp; apt-get install -y sudo \\\n  &amp;&amp; echo $USERNAME ALL=\\(root\\) NOPASSWD:ALL &gt; /etc/sudoers.d/$USERNAME\\\n  &amp;&amp; chmod 0440 /etc/sudoers.d/$USERNAME \\\n  &amp;&amp; rm -rf /var/lib/apt/lists/*\n\nRUN apt-get update &amp;&amp; apt-get install -y --no-install-recommends \\\n    libopencv-dev \\\n    libzmq3-dev \\\n    libczmq-dev \\\n    libmsgpack-dev \\\n    wget \\\n    curl \\\n    gnupg2 \\\n    gnupg \\\n    ca-certificates \\\n    gnupg \\\n    lsb-release \\\n    curl \\\n  &amp;&amp; rm -rf /var/lib/apt/lists/*\n\n# Add the OSRF GPG key to a new keyring directory\nRUN mkdir -p /etc/apt/keyrings &amp;&amp; \\\n    wget https://packages.osrfoundation.org/gazebo.gpg -O /etc/apt/keyrings/osrf-archive-keyring.gpg\n\n# Add the Gazebo repository line, referencing the new keyring file\nRUN echo \"deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/osrf-archive-keyring.gpg] http://packages.osrfoundation.org/gazebo/ubuntu-stable $(lsb_release -cs) main\" | tee /etc/apt/sources.list.d/gazebo-stable.list &gt; /dev/null\n\n\n# Install gazebo\nRUN apt-get update &amp;&amp; apt-get install -q -y \\\n    gazebo \\\n    libgazebo-dev \\\n  &amp;&amp; rm -rf /var/lib/apt/lists/*\n\n\nRUN apt-get update &amp;&amp; apt-get install -y --no-install-recommends \\\n    mesa-utils \\\n    nvtop \\\n  &amp;&amp; rm -rf /var/lib/apt/lists/*\n\n\n  ENV DEBIAN_FRONTEND=\n</code></pre> devcontainer.json <pre><code>{\n    \"name\": \"gz11\",\n    \"dockerComposeFile\": \"../docker-compose.yaml\",\n    \"service\": \"gz\",\n    \"shutdownAction\": \"stopCompose\",\n    \"workspaceFolder\": \"/workspace\",\n    \"customizations\": {\n      \"vscode\": {\n        \"extensions\": [\n            \"ms-python.python\",\n            \"ms-vscode.cpptools\",\n            \"twxs.cmake\",\n            \"redhat.vscode-xml\",\n            \"redhat.vscode-yaml\",\n            \"albert.tabout\",\n            \"actboy168.tasks\",\n            \"streetsidesoftware.code-spell-checker\",\n            \"mhutchie.git-graph\",\n            \"dlech.chmod\",\n            \"smilerobotics.urdf\"\n        ],\n        \"settings\": {}\n      }\n    }\n  }\n</code></pre> docker-compose.yaml <pre><code>services:\n  gz:\n    build: \n      context: .\n      dockerfile: .devcontainer/Dockerfile\n    user: \"user\"\n    volumes:\n      - .:/workspace:cached\n      - /tmp/.X11-unix:/tmp/.X11-unix:rw \n      - /dev/dri:/dev/dri            # keep for OpenGL context\n    deploy:\n      resources:\n        reservations:\n          devices:\n            - driver: nvidia        # explicitly use NVIDIA runtime\n              count: all\n              capabilities: [gpu]\n    hostname: gz\n    extra_hosts:\n      - \"gz:127.0.0.1\"\n    network_mode: host\n    stdin_open: true\n    tty: true\n    environment:\n      - DISPLAY=${DISPLAY}\n      - QT_X11_NO_MITSHM=1\n      - NVIDIA_VISIBLE_DEVICES=all\n      - NVIDIA_DRIVER_CAPABILITIES=all\n      - __NV_PRIME_RENDER_OFFLOAD=1\n      - __GLX_VENDOR_LIBRARY_NAME=nvidia\n    runtime: nvidia\n</code></pre> <p>check OpenGL</p> <pre><code>glxinfo | grep \"OpenGL vendor\"\n#\nOpenGL vendor string: NVIDIA Corporation\n</code></pre>","tags":["gazebo","docker","dev","classic","vscode","devcontainer"]},{"location":"Simulation/Gazebo_Classic/dev/#run","title":"Run","text":"<pre><code>gazebo --verbose\n</code></pre> <p>fps</p> <p>The fps on my machine is about 62</p> <p>pmap</p> <p>The pmap command is a Linux utility that reports the memory map of a process. The memory map provides a detailed look at how a process uses memory, including all of the components it uses, such as libraries, executable code, and data</p> <pre><code>pmap -x $(pgrep gzclient) | grep \"nvidia\"\n</code></pre> <p>nvidia-smi</p> <p>The process gzclient and gzserver shown on the host but not from the docker image shell why?</p> <p></p> <p>TODO: simple app and config the compiler and cmake</p>","tags":["gazebo","docker","dev","classic","vscode","devcontainer"]},{"location":"Simulation/Gazebo_Classic/dev/#reference","title":"Reference","text":"<ul> <li>Download all source code</li> <li>Gazebo Simulator : 5 Ways to Speedup Simulations</li> </ul>","tags":["gazebo","docker","dev","classic","vscode","devcontainer"]},{"location":"Simulation/Gazebo_Classic/sensors/","title":"Gazebo Classic Sensors and plugin","text":"","tags":["gazebo","classic","sensors"]},{"location":"Simulation/Gazebo_Classic/tips_settings/","title":"Index","text":"","tags":["gazebo","classic","tips"]},{"location":"Simulation/Gazebo_Classic/tips_settings/#send-message-to-subscriber","title":"Send message to subscriber","text":"<pre><code># gz topic -p topic msg_type -m message_data\ngz topic -p \"/gazebo/default/iris_demo/gimbal_tilt_cmd\"  \"gazebo.msgs.GzString\" -m 'data: \"1.0\"'\n</code></pre>","tags":["gazebo","classic","tips"]},{"location":"Simulation/Gazebo_Classic/tips_settings/#reference","title":"Reference","text":"<ul> <li>5 Ways to Speedup Simulations</li> </ul>","tags":["gazebo","classic","tips"]},{"location":"Simulation/PyBullet/","title":"PyBullet Simulator","text":"<p>Simulation</p> <p>Physics simulation for games, visual effects, robotics and reinforcement learning.</p> <p>VSCode dev env</p> <p>Gymnasium</p> <p>Tip</p> <p>install pyi for intellisense pybulley.pyi download</p>","tags":["pybullet","simulation","bullet"]},{"location":"Simulation/PyBullet/#demo","title":"Demo","text":"hello.py<pre><code>import pybullet as p\nimport pybullet_data\nimport time\n\n# Connect to PyBullet with GUI\np.connect(p.GUI, options=\"--opengl2 --egl\")\n\n# Set search path to PyBullet\u2019s default data\np.setAdditionalSearchPath(pybullet_data.getDataPath())\n\n# Load a simple plane and a cube\nplane_id = p.loadURDF(\"plane.urdf\")\ncube_id = p.loadURDF(\"r2d2.urdf\", [0, 0, 1])\n\n# Add gravity\np.setGravity(0, 0, -9.8)\n\n# Run simulation loop\nwhile True:\n    p.stepSimulation()\n    time.sleep(1./240.)\n</code></pre> force opengl run on nvidia<pre><code>__NV_PRIME_RENDER_OFFLOAD=1 __GLX_VENDOR_LIBRARY_NAME=nvidia python3 hello.py\n</code></pre> <ul> <li>pybullet_data provide many URDF examples.</li> <li><code>loadURDF</code> return integer that use to refer the robot in other pybullet commands/</li> </ul>","tags":["pybullet","simulation","bullet"]},{"location":"Simulation/PyBullet/#demo-get-position-and-orientation","title":"Demo: Get Position and Orientation","text":"Position orientation and apply external force<pre><code>import pybullet as p\nimport pybullet_data\nimport time\n\n# Connect to PyBullet with GUI\np.connect(p.GUI, options=\"--opengl2 --egl\")\n\n# Set search path to PyBullet\u2019s default data\np.setAdditionalSearchPath(pybullet_data.getDataPath())\n\n# Load a simple plane and a cube\nplane_id = p.loadURDF(\"plane.urdf\")\ncarId = p.loadURDF(\u201cracecar/racecar.urdf\u201d, basePosition=[0,0,0.2])\nposition, orientation = p.getBasePositionAndOrientation(carId)\nfor _ in range(100): \n    p.stepSimulation()\n</code></pre>","tags":["pybullet","simulation","bullet"]},{"location":"Simulation/PyBullet/#demos-and","title":"Demos and ...","text":"<p>PyBullet Quickstart Guide</p> <p>loadURDF</p> <p>Links and Joints</p> <p>Camera</p> <p>VSCode dev environment</p> <p>GUI and TK inter</p> <ul> <li>online urdf</li> <li>PyBullet</li> <li>https://medium.com/@reflectrobotics/scara-robot-modeling-and-simulation-with-pybullet-7bb204958763</li> <li>ROS-PyBullet Interface</li> <li> akinami3PybulletRobotics </li> <li>PyBullet and Control Algorithms Workshop - La Robo Liga Event </li> <li>Quick start guide</li> <li> <p>PyBullet Webinar 1</p> </li> <li> <p>intor</p> </li> <li>How to Control a Robot with Python</li> <li> PyBullet workshop for NTU students : Day-1 </li> <li> PyBullet workshop for NTU students : Day-2 </li> <li> PyBullet workshop for NTU students : Day-3 </li> <li>Creating OpenAI Gym Environments with PyBullet (Part 1)</li> <li>Creating OpenAI Gym Environments with PyBullet (Part 2)</li> </ul>","tags":["pybullet","simulation","bullet"]},{"location":"Simulation/PyBullet/#projects","title":"Projects","text":"<ul> <li>balance bot RL</li> <li>Gym-Line-Follower</li> <li>pybullet cartpole</li> </ul>","tags":["pybullet","simulation","bullet"]},{"location":"Simulation/PyBullet/dev_env/","title":"PyBullet VSCode dev environment","text":"<p>Simulation / PyBullet</p> <pre><code>.\n\u251c\u2500\u2500 .devcontainer\n\u2502   \u251c\u2500\u2500 devcontainer.json\n\u2502   \u2514\u2500\u2500 Dockerfile\n\u251c\u2500\u2500 docker-compose.yml\n\u251c\u2500\u2500 README.md\n\u251c\u2500\u2500 requirements.txt\n\u2514\u2500\u2500 .vscode\n    \u2514\u2500\u2500 settings.json\n</code></pre> .devcontainer/devcontainer.json <pre><code>{\n    \"name\": \"PyBullet\",\n    \"dockerComposeFile\": \"../docker-compose.yaml\",\n    \"service\": \"dev\",\n    \"workspaceFolder\": \"/workspace\",\n    \"shutdownAction\": \"stopCompose\",\n    \"features\": {},\n    \"customizations\": {\n        \"vscode\": {\n            \"extensions\": [\n                \"ms-python.python\",\n                \"ms-python.flake8\",\n                \"ms-python.black-formatter\",\n                \"ms-toolsai.jupyter\",\n                \"ms-vscode.cmake-tools\",\n                \"ms-vscode.cpptools\",\n                \"twxs.cmake\"\n            ],\n            \"settings\": {\n                \"python.defaultInterpreterPath\": \"/usr/local/bin/python\",\n                \"python.linting.enabled\": true,\n                \"python.linting.flake8Enabled\": true,\n                \"python.formatting.provider\": \"black\",\n                \"files.watcherExclude\": {\n                    \"**/node_modules/**\": true,\n                    \"**/.git/objects/**\": true,\n                    \"**/.git/subtree-cache/**\": true,\n                    \"**/build/**\": true\n                }\n            }\n        }\n    }\n}\n</code></pre> .devcontainer/Dockerfile <pre><code>FROM ubuntu:24.04\n\n# Set environment variables\nENV DEBIAN_FRONTEND=noninteractive\nENV PYTHONUNBUFFERED=1\nENV PYTHONDONTWRITEBYTECODE=1\n\n# Install system dependencies\nRUN apt-get update &amp;&amp; apt-get install -y \\\n    build-essential \\\n    cmake \\\n    python3 \\\n    python3-pip \\\n    git \\\n    curl \\\n    wget \\\n    vim \\\n    sudo \\\n    &amp;&amp; rm -rf /var/lib/apt/lists/*\n\n# Create a non-root user\nARG USERNAME=user\nARG USER_UID=1000\nARG USER_GID=$USER_UID\n\n# Check if \"ubuntu\" user exists, delete it if it does, then create the desired user\nRUN if getent passwd ubuntu &gt; /dev/null 2&gt;&amp;1; then \\\n        userdel -r ubuntu &amp;&amp; \\\n        echo \"Deleted existing ubuntu user\"; \\\n    fi &amp;&amp; \\\n    groupadd --gid $USER_GID $USERNAME &amp;&amp; \\\n    useradd -s /bin/bash --uid $USER_UID --gid $USER_GID -m $USERNAME &amp;&amp; \\\n    echo \"Created new user $USERNAME\"\n\n# Add sudo support for the non-root user\nRUN apt-get update &amp;&amp; apt-get install -y sudo \\\n  &amp;&amp; echo $USERNAME ALL=\\(root\\) NOPASSWD:ALL &gt; /etc/sudoers.d/$USERNAME\\\n  &amp;&amp; chmod 0440 /etc/sudoers.d/$USERNAME \\\n  &amp;&amp; rm -rf /var/lib/apt/lists/*\n\n# Install Python packages commonly used with PyBullet\nRUN apt-get update &amp;&amp; apt-get install -y --no-install-recommends \\\n    python3 \\\n    python3-venv \\\n    &amp;&amp; rm -rf /var/lib/apt/lists/*\n\n# 2. Create isolated environment\n\nRUN apt-get update &amp;&amp; apt-get install -y --no-install-recommends \\\n    mesa-utils \\\n    &amp;&amp; rm -rf /var/lib/apt/lists/*\n\n\nCOPY requirements.txt /tmp/requirements.txt\nRUN pip install --break-system-packages --no-cache-dir -r /tmp/requirements.txt\n\nRUN apt-get update &amp;&amp; apt-get install -y \\\n    mesa-utils \\\n    libgl1 \\\n    libglvnd0 \\\n    libglx-mesa0 \\\n    libglu1-mesa \\\n    libx11-6 \\\n    libxext6 \\\n    &amp;&amp; rm -rf /var/lib/apt/lists/*\n</code></pre> docker-compose.yml <pre><code>services:\n  dev:\n    build:\n      context: .\n      dockerfile: .devcontainer/Dockerfile\n    user: \"user\"\n    volumes:\n      - ./:/workspace:cached\n      - /tmp/.X11-unix:/tmp/.X11-unix:rw\n    environment:\n      - DISPLAY=${DISPLAY}\n      - QT_X11_NO_MITSHM=1\n      - NVIDIA_VISIBLE_DEVICES=all\n      - NVIDIA_DRIVER_CAPABILITIES=all\n      - __NV_PRIME_RENDER_OFFLOAD=1\n      - __GLX_VENDOR_LIBRARY_NAME=nvidia\n    runtime: nvidia\n    network_mode: host\n    stdin_open: true\n    tty: true\n    hostname: dev\n    extra_hosts:\n      - \"dev:127.0.0.1\"\n    deploy:\n      resources:\n        reservations:\n          devices:\n            - driver: nvidia        # explicitly use NVIDIA runtime\n              count: all\n              capabilities: [gpu]\n</code></pre> requirements.txt <pre><code>pybullet\n</code></pre>","tags":["pybullet","vscode","dev"]},{"location":"Simulation/PyBullet/dev_env/#pyi","title":"pyi","text":"<p>pybulley.pyi download copy the <code>pyi</code> file to library location</p> <pre><code>&gt;&gt;&gt; import pybullet\npybullet build time: Dec  8 2025 19:55:19\n&gt;&gt;&gt; pybullet.__file__\n'/usr/local/lib/python3.12/dist-packages/pybullet.cpython-312-x86_64-linux-gnu.so'\n</code></pre>","tags":["pybullet","vscode","dev"]},{"location":"Simulation/PyBullet/dev_env/#check-opengl-backend","title":"Check OpenGL backend","text":"<pre><code>glxinfo | grep -i vendor\n#\nserver glx vendor string: SGI\nclient glx vendor string: NVIDIA Corporation\nOpenGL vendor string: NVIDIA Corporation\n\n\n\nglxinfo | grep -i renderer\n#\nOpenGL renderer string: NVIDIA GeForce MX450/PCIe/SSE2\n</code></pre> hello_bullet.py<pre><code>import pybullet as p\nimport time\nimport pybullet_data\n\nphysicsClient = p.connect(p.GUI)\np.setAdditionalSearchPath(pybullet_data.getDataPath())\n# Add gravity\np.setGravity(0, 0, -9.8)\nplane_id = p.loadURDF(\"plane.urdf\")\n# cube_id = p.loadURDF(\"urdf/self_balance.urdf\", [0, 0, 1])\nrobot = p.loadURDF(\"kuka_iiwa/model.urdf\", useFixedBase=True)\n\n# Run simulation loop\nwhile True:\n    p.stepSimulation()\n    time.sleep(1./240.)\n</code></pre> <pre><code>python3 hello_bullet.py\n#\npybullet build time: Nov 18 2025 13:39:23\nstartThreads creating 1 threads.\nstarting thread 0\nstarted thread 0 \nargc=2\nargv[0] = --unused\nargv[1] = --start_demo_name=Physics Server\nExampleBrowserThreadFunc started\nX11 functions dynamically loaded using dlopen/dlsym OK!\nX11 functions dynamically loaded using dlopen/dlsym OK!\nCreating context\nCreated GL 3.3 context\nDirect GLX rendering context obtained\nMaking context current\nGL_VENDOR=NVIDIA Corporation\nGL_RENDERER=NVIDIA GeForce MX450/PCIe/SSE2\nGL_VERSION=3.3.0 NVIDIA 560.35.03\nGL_SHADING_LANGUAGE_VERSION=3.30 NVIDIA via Cg compiler\npthread_getconcurrency()=0\nVersion = 3.3.0 NVIDIA 560.35.03\nVendor = NVIDIA Corporation\nRenderer = NVIDIA GeForce MX450/PCIe/SSE2\nb3Printf: Selected demo: Physics Server\nstartThreads creating 1 threads.\nstarting thread 0\nstarted thread 0 \nMotionThreadFunc thread started\nven = NVIDIA Corporation\nven = NVIDIA Corporation\n</code></pre>","tags":["pybullet","vscode","dev"]},{"location":"Simulation/PyBullet/gui_control/","title":"Index","text":"<p>Simulation / PyBullet</p> <pre><code>import tkinter as tk\nimport threading\nimport time\nimport pybullet as p\nimport pybullet_data\n\ncounter = 0\nrunning = True\n\n\ndef pybullet_thread():\n    global counter\n    p.connect(p.GUI)\n    p.setAdditionalSearchPath(pybullet_data.getDataPath())\n    p.setGravity(0, 0, -9.8)\n\n    robot = p.loadURDF(\"racecar/racecar.urdf\")\n    plane = p.loadURDF(\"plane.urdf\")\n\n    while running:\n        # update tk variable safely\n        txt.set(f\"Position: {counter}\")\n\n        counter += 1\n        p.stepSimulation()\n        time.sleep(1 / 240)\n    p.disconnect()\n\n\n# ----------------- GUI (main thread) -----------------\n\n\ndef reset_counter():\n    global counter\n    counter = 0\n\n\ndef on_close():\n    global running\n    running = False\n    time.sleep(0.5)\n    print(\"Close\")\n    root.destroy()\n\n\nroot = tk.Tk()\nroot.title(\"Robot Debugger\")\nroot.protocol(\"WM_DELETE_WINDOW\", on_close)\n\ntxt = tk.StringVar()\nlabel = tk.Label(root, textvariable=txt, font=(\"Arial\", 18))\nlabel.pack()\ntk.Button(root, text=\"Reset\", command=reset_counter).pack(pady=5)\n\n# Start pybullet in separate thread\nthreading.Thread(target=pybullet_thread, daemon=True).start()\n\n# Tkinter MUST be in the main thread\nroot.mainloop()\n</code></pre>","tags":["pybullet","tkinter"]},{"location":"Simulation/PyBullet/gym-pybullet-drones/","title":"Index","text":"<p>Simulation / PyBullet</p>","tags":["pybullet","drone","gym"]},{"location":"Simulation/PyBullet/gym-pybullet-drones/#reference","title":"Reference","text":"<ul> <li>gym-pybullet-drones</li> </ul>","tags":["pybullet","drone","gym"]},{"location":"Simulation/PyBullet/tutorials/","title":"PyBullet tutorials and learning","text":"<p>Simulation / PyBullet</p> <ul> <li>URDF</li> <li>Types of joints</li> <li>Robot Coordination</li> <li>Task Space</li> <li>Joint/Configuration space</li> <li>Base position, orientation</li> </ul>","tags":["pybullet","tutorial"]},{"location":"Simulation/PyBullet/tutorials/#urdf","title":"urdf","text":"<p>online play</p>","tags":["pybullet","tutorial"]},{"location":"Simulation/PyBullet/tutorials/#types-of-joints","title":"Types of joints","text":"<ul> <li>Fixed: rigid connection, no motion</li> <li>Revolute: support rotation in 1 dimension (along a single axis)</li> <li>Continuous: unlimited variant of revolute joints</li> <li>Prismatic: support translation in 1 dimension (along a single axis)</li> <li>Planar: translation in two dimensions</li> <li>Floating: unlimited motion (translation and rotation) in all 6 dimentions</li> </ul> PyBullet Constant Integer Meaning <code>p.JOINT_REVOLUTE</code> 0 Standard hinge joint <code>p.JOINT_PRISMATIC</code> 1 Linear slider <code>p.JOINT_SPHERICAL</code> 2 3-DOF ball joint <code>p.JOINT_PLANAR</code> 3 Planar joint <code>p.JOINT_FIXED</code> 4 Fixed (no movement) <code>p.JOINT_POINT2POINT</code> 5 P2P constraint <code>p.JOINT_GEAR</code> 6 Gear ratio constraint","tags":["pybullet","tutorial"]},{"location":"Simulation/PyBullet/tutorials/#demo-rrbot","title":"Demo: RRBot","text":"urdf <pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;robot name=\"rrbot\"&gt;\n\n  &lt;!-- ====================== --&gt;\n  &lt;!--        LINKS           --&gt;\n  &lt;!-- ====================== --&gt;\n\n  &lt;!-- Base link --&gt;\n  &lt;link name=\"base_link\"&gt;\n    &lt;inertial&gt;\n      &lt;origin xyz=\"0 0 0\" rpy=\"0 0 0\" /&gt;\n      &lt;mass value=\"1.0\"/&gt;\n      &lt;inertia\n        ixx=\"0.1\" ixy=\"0.0\" ixz=\"0.0\"\n        iyy=\"0.1\" iyz=\"0.0\"\n        izz=\"0.1\"/&gt;\n    &lt;/inertial&gt;\n    &lt;visual&gt;\n      &lt;origin xyz=\"0 0 0\" rpy=\"0 0 0\" /&gt;\n      &lt;geometry&gt;\n        &lt;box size=\"0.4 0.4 0.2\"/&gt;\n      &lt;/geometry&gt;\n      &lt;material name=\"blue\"&gt;\n        &lt;color rgba=\"0 0 1 1\"/&gt;\n      &lt;/material&gt;\n    &lt;/visual&gt;\n    &lt;collision&gt;\n      &lt;origin xyz=\"0 0 0\" rpy=\"0 0 0\" /&gt;\n      &lt;geometry&gt;\n        &lt;box size=\"0.4 0.4 0.2\"/&gt;\n      &lt;/geometry&gt;\n    &lt;/collision&gt;\n  &lt;/link&gt;\n\n  &lt;!-- Link1 --&gt;\n  &lt;link name=\"link1\"&gt;\n    &lt;inertial&gt;\n      &lt;origin xyz=\"0 0 0.5\" rpy=\"0 0 0\"/&gt;\n      &lt;mass value=\"1.0\"/&gt;\n      &lt;inertia\n        ixx=\"0.1\" ixy=\"0.0\" ixz=\"0.0\"\n        iyy=\"0.1\" iyz=\"0.0\"\n        izz=\"0.1\"/&gt;\n    &lt;/inertial&gt;\n    &lt;visual&gt;\n      &lt;origin xyz=\"0 0 0.5\" rpy=\"0 0 0\"/&gt;\n      &lt;geometry&gt;\n        &lt;cylinder radius=\"0.05\" length=\"1.0\"/&gt;\n      &lt;/geometry&gt;\n      &lt;material name=\"yellow\"&gt;\n        &lt;color rgba=\"1 1 0 1\"/&gt;\n      &lt;/material&gt;\n    &lt;/visual&gt;\n    &lt;collision&gt;\n      &lt;origin xyz=\"0 0 0.5\" rpy=\"0 0 0\"/&gt;\n      &lt;geometry&gt;\n        &lt;cylinder radius=\"0.05\" length=\"1.0\"/&gt;\n      &lt;/geometry&gt;\n    &lt;/collision&gt;\n  &lt;/link&gt;\n\n  &lt;!-- Link2 --&gt;\n  &lt;link name=\"link2\"&gt;\n    &lt;inertial&gt;\n      &lt;origin xyz=\"0 0 0.5\" rpy=\"0 0 0\"/&gt;\n      &lt;mass value=\"1.0\"/&gt;\n      &lt;inertia\n        ixx=\"0.1\" ixy=\"0.0\" ixz=\"0.0\"\n        iyy=\"0.1\" iyz=\"0.0\"\n        izz=\"0.1\"/&gt;\n    &lt;/inertial&gt;\n    &lt;visual&gt;\n      &lt;origin xyz=\"0 0 0.5\" rpy=\"0 0 0\"/&gt;\n      &lt;geometry&gt;\n        &lt;cylinder radius=\"0.05\" length=\"1.0\"/&gt;\n      &lt;/geometry&gt;\n      &lt;material name=\"red\"&gt;\n        &lt;color rgba=\"1 0 0 1\"/&gt;\n      &lt;/material&gt;\n    &lt;/visual&gt;\n    &lt;collision&gt;\n      &lt;origin xyz=\"0 0 0.5\" rpy=\"0 0 0\"/&gt;\n      &lt;geometry&gt;\n        &lt;cylinder radius=\"0.05\" length=\"1.0\"/&gt;\n      &lt;/geometry&gt;\n    &lt;/collision&gt;\n  &lt;/link&gt;\n\n\n  &lt;!-- ====================== --&gt;\n  &lt;!--        JOINTS          --&gt;\n  &lt;!-- ====================== --&gt;\n\n  &lt;!-- Joint1: base_link \u2192 link1 --&gt;\n  &lt;joint name=\"joint_1\" type=\"revolute\"&gt;\n    &lt;origin xyz=\"0 0 0.1\" rpy=\"0 0 0\"/&gt;\n    &lt;parent link=\"base_link\"/&gt;\n    &lt;child link=\"link1\"/&gt;\n    &lt;axis xyz=\"0 0 1\"/&gt; &lt;!-- rotates around Z --&gt;\n    &lt;limit lower=\"-3.14\" upper=\"3.14\" effort=\"10\" velocity=\"1.0\"/&gt;\n  &lt;/joint&gt;\n\n  &lt;!-- Joint2: link1 \u2192 link2 --&gt;\n  &lt;joint name=\"joint_2\" type=\"revolute\"&gt;\n    &lt;origin xyz=\"0 0 1.0\" rpy=\"0 0 0\"/&gt;\n    &lt;parent link=\"link1\"/&gt;\n    &lt;child link=\"link2\"/&gt;\n    &lt;axis xyz=\"0 1 0\"/&gt; &lt;!-- rotates around Y --&gt;\n    &lt;limit lower=\"-3.14\" upper=\"3.14\" effort=\"10\" velocity=\"1.0\"/&gt;\n  &lt;/joint&gt;\n\n\n\n&lt;/robot&gt;\n</code></pre>","tags":["pybullet","tutorial"]},{"location":"Simulation/PyBullet/tutorials/#joint-name-and-types","title":"Joint name and types","text":"<pre><code>import pybullet as p\nimport time\nimport pybullet_data\n\n\np.connect(p.GUI)\np.setGravity(0, 0, -9.8)\n\n# Default PyBullet assets\np.setAdditionalSearchPath(pybullet_data.getDataPath())\nplane_id = p.loadURDF(\"plane.urdf\")\n\np.setAdditionalSearchPath(\"/workspace/demos/urdf\")\nrobot_id = p.loadURDF(\"rrbot.urdf\", useFixedBase=True)\n# Print joint information\nnum_joints = p.getNumJoints(robot_id)\nprint(\"Total joints:\", num_joints)\nfor i in range(num_joints):\n    info = p.getJointInfo(robot_id, i)\n    print(i, info[1].decode(\"utf-8\"), \"| type =\", info[2])\n\nwhile p.isConnected():\n    p.stepSimulation()\n    time.sleep(1./240.)\n</code></pre> output<pre><code>---\nTotal joints: 2\n0 joint_1 | type = 0\n1 joint_2 | type = 0\n---\n</code></pre>","tags":["pybullet","tutorial"]},{"location":"Simulation/PyBullet/tutorials/#joint-command","title":"Joint command","text":"","tags":["pybullet","tutorial"]},{"location":"Simulation/PyBullet/tutorials/#reference","title":"Reference","text":"<ul> <li>PyBullet workshop</li> </ul>","tags":["pybullet","tutorial"]},{"location":"Simulation/PyBullet/tutorials/keyboard/","title":"Pybullet keyboard and mouse","text":"<p>Simulation / PyBullet</p> <pre><code>import pybullet as p\nimport pybullet_data\n\nphysicsClient = p.connect(p.GUI)\np.setAdditionalSearchPath(pybullet_data.getDataPath())\np.setGravity(0, 0, -10)\nplaneId = p.loadURDF(\"plane.urdf\")\nboxId = p.loadURDF(\"cube.urdf\", [0, 0, 1])\n\nwhile p.isConnected():\n    keys = p.getKeyboardEvents()\n\n    if p.B3G_SPACE in keys and keys[p.B3G_SPACE] &amp; p.KEY_WAS_TRIGGERED:\n        print(\"Spacebar was pressed!\")\n        # Trigger an event, e.g., toggle a variable\n\n    p.stepSimulation()\n</code></pre>","tags":["pybullet","keyboard","mouse"]},{"location":"Simulation/PyBullet/tutorials/pose_and_orienation/","title":"Position and Orientation","text":"<p>Simulation / PyBullet</p> <pre><code>---\ntitle: Position and Orientation\ntags:\n    - pybullet\n    - position\n    - orientation\n---\n\n\n{{ page_folder_links() }}\n\n\n```python\n</code></pre> <p>Download box.urdf</p> getBasePositionAndOrientation getQuaternionFromEuler loadURDF <p>```</p> <p>Download box.urdf</p> getBasePositionAndOrientation getQuaternionFromEuler loadURDF","tags":["pybullet","position","orientation"]},{"location":"Simulation/PyBullet/tutorials/camera/","title":"Pybullet camera","text":"<p>Simulation / PyBullet / tutorials</p> camera <pre><code>import pybullet as p\nimport pybullet_data\nimport time\n\n# Initialize PyBullet\nphysicsClient = p.connect(p.GUI)\np.setAdditionalSearchPath(pybullet_data.getDataPath())\n\n# Create ground plane\nplaneId = p.loadURDF(\"plane.urdf\")\n\n# Add texture to the ground\ntextureId = p.loadTexture(\"tarmac.png\")\np.changeVisualShape(planeId, -1, textureUniqueId=textureId)\n\n# Set gravity and run simulation\np.setGravity(0, 0, -9.81)\n\ncamera_pos = [0, 0, 10]  # Start at x=0, y=0, z=10m\nvelocity = 5.0  # 5 m/s in x-direction\nwidth, height = 640, 480\nfov, aspect, near, far = 60, width/height, 0.1, 100.0\nprojection_matrix = p.computeProjectionMatrixFOV(fov, aspect, near, far)\ntarget_pos = [camera_pos[0], camera_pos[1], 0]  # Look downward\n\nwhile True:\n    p.stepSimulation()\n    view_matrix = p.computeViewMatrix(camera_pos, target_pos, [0, 1, 0])  # Up vector: y-axis\n    _, _, rgb, _, _ = p.getCameraImage(width, height, view_matrix, projection_matrix,\n                                    renderer=p.ER_BULLET_HARDWARE_OPENGL)\n    time.sleep(1./30.)\n</code></pre>","tags":["pybullet","camera"]},{"location":"Simulation/PyBullet/tutorials/camera/#computeprojectionmatrixfov","title":"computeProjectionMatrixFOV","text":"<pre><code>projection_matrix = p.computeProjectionMatrixFOV(fov, aspect, near, far)\n</code></pre> <p>Creates a projection matrix for a virtual camera using a perspective (field-of-view) projection. Parameters:</p> <ul> <li>fov: Field of view in degrees (vertical angle).</li> <li>aspect: Aspect ratio (width/height).</li> <li>near: Near clipping plane distance.</li> <li>far: Far clipping plane distance.</li> </ul> <p>Result: Returns a 4x4 matrix that transforms 3D points into 2D camera space, simulating a real camera lens. </p>","tags":["pybullet","camera"]},{"location":"Simulation/PyBullet/tutorials/camera/#getcameraimage","title":"getCameraImage","text":"<pre><code>_, _, rgb, _, _ = p.getCameraImage(width, height, view_matrix, projection_matrix, renderer=p.ER_BULLET_HARDWARE_OPENGL)\n</code></pre> <p>Renders an image from the simulation as seen by the virtual camera. Parameters:</p> <ul> <li>width, height: Output image size.</li> <li>view_matrix: Defines the camera\u2019s position and orientation (where it looks from and to).</li> <li>projection_matrix: Defines how the 3D scene is projected onto the 2D image (from computeProjectionMatrixFOV).</li> <li>renderer: Rendering backend (here, OpenGL).</li> </ul> <p>Returns: A tuple containing image data, including the RGB image (rgb), depth, and segmentation masks.</p> <p></p> opencv view <pre><code>import cv2\nimport numpy as np\nimport pybullet as p\nimport pybullet_data\nimport time\n\n# Initialize PyBullet\nphysicsClient = p.connect(p.GUI)\np.setAdditionalSearchPath(pybullet_data.getDataPath())\n\n# Create ground plane\nplaneId = p.loadURDF(\"plane.urdf\")\n\n# Add texture to the ground\ntextureId = p.loadTexture(\"tarmac.png\")\np.changeVisualShape(planeId, -1, textureUniqueId=textureId)\n\n# Set gravity and run simulation\np.setGravity(0, 0, -9.81)\n\ncamera_pos = [0, 0, 10]  # Start at x=0, y=0, z=10m\nvelocity = 5.0  # 5 m/s in x-direction\nwidth, height = 640, 480\nfov, aspect, near, far = 60, width/height, 0.1, 100.0\nprojection_matrix = p.computeProjectionMatrixFOV(fov, aspect, near, far)\ntarget_pos = [camera_pos[0], camera_pos[1], 0]  # Look downward\n\nwhile True:\n    p.stepSimulation()\n    view_matrix = p.computeViewMatrix(camera_pos, target_pos, [0, 1, 0])  # Up vector: y-axis\n    _, _, rgb, _, _ = p.getCameraImage(width, height, view_matrix, projection_matrix,\n                                    renderer=p.ER_BULLET_HARDWARE_OPENGL)\n\n    rgb = np.reshape(rgb, (height, width, 4))[:, :, :3]  # Remove alpha channel\n    rgb = cv2.cvtColor(rgb, cv2.COLOR_RGBA2BGR)\n\n    # Write to video\n    cv2.imshow('Camera Feed', rgb)\n    key = cv2.waitKey(1)\n\n    if key == ord('q'):\n        break\n\n    time.sleep(1./30.)\ncv2.destroyAllWindows()\np.disconnect()\n</code></pre>","tags":["pybullet","camera"]},{"location":"Simulation/PyBullet/tutorials/links_and_joints/","title":"Index","text":"<p>title: PyBullet tutorials: Links and joints tags:     - pybullet     - getNumJoints     - getJointInfo     - getDynamicsInfo     - getLinkState</p>"},{"location":"Simulation/PyBullet/tutorials/links_and_joints/#joint-and-link-info","title":"Joint and Link info","text":"<pre><code>import pybullet as p\nimport pybullet_data\n\n# setup\np.connect(p.DIRECT)\np.resetSimulation()\np.setGravity(gravX=0, gravY=0, gravZ=-9.8)\np.setAdditionalSearchPath(path=pybullet_data.getDataPath())\n\n# load URDF\nrobo = p.loadURDF(\n    \"franka_panda/panda.urdf\", basePosition=[1, 0, 0.1], useFixedBase=True\n)\n\n# joints\ndic_info = {\n    0: \"joint Index\",  # starts at 0\n    1: \"joint Name\",\n    2: \"joint Type\",  # 0=revolute (rotational), 1=prismatic (sliding), 4=fixed\n    3: \"state vectorIndex\",\n    4: \"velocity vectorIndex\",\n    5: \"flags\",  # nvm always 0\n    6: \"joint Damping\",\n    7: \"joint Friction\",  # coefficient\n    8: \"joint lowerLimit\",  # min angle\n    9: \"joint upperLimit\",  # max angle\n    10: \"joint maxForce\",  # max force allowed\n    11: \"joint maxVelocity\",  # max speed\n    12: \"link Name\",  # child link connected to this joint\n    13: \"joint Axis\",\n    14: \"parent FramePos\",  # position\n    15: \"parent FrameOrn\",  # orientation\n    16: \"parent Index\",  # \u22121 = base\n}\nfor i in range(p.getNumJoints(bodyUniqueId=robo)):\n    joint_info = p.getJointInfo(bodyUniqueId=robo, jointIndex=i)\n    print(f\"--- JOINT {i} ---\")\n    print({dic_info[k]: joint_info[k] for k in dic_info.keys()})\n\n# links\nfor i in range(p.getNumJoints(robo)):\n    link_name = p.getJointInfo(robo, i)[12].decode(\"utf-8\")  # field 12=\"link Name\"\n    dyn = p.getDynamicsInfo(robo, i)\n    pos, orn, *_ = p.getLinkState(robo, i)\n    dic_info = {\"Mass\": dyn[0], \"Friction\": dyn[1], \"Position\": pos, \"Orientation\": orn}\n    print(f\"--- LINK {i}: {link_name} ---\")\n    print(dic_info)\n</code></pre> <ul> <li>getNumJoints: getNumJoints returns an integer value representing the number of joints. (page 23)</li> <li>getJointInfo: query joint information (page 23)</li> <li>getDynamicsInfo: get information about the mass, center of mass, friction and other properties of the base and links. (page 37-38)</li> <li>getLinkState: query the Cartesian world position and orientation for the link center of mass (page 31)</li> </ul>"},{"location":"Simulation/PyBullet/tutorials/links_and_joints/#movement-control","title":"Movement Control","text":"<ul> <li>Force / Torque</li> <li>Velocity</li> <li>Position</li> </ul> <p> robot urdf</p>"},{"location":"Simulation/PyBullet/tutorials/links_and_joints/#position-control","title":"Position control","text":"position control<pre><code>import pybullet as p\nimport time\nimport pybullet_data\n\n\np.connect(p.GUI)\np.setGravity(0, 0, -9.8)\n\n# Default PyBullet assets\np.setAdditionalSearchPath(pybullet_data.getDataPath())\nplane_id = p.loadURDF(\"plane.urdf\")\n\n# Additional URDFs location\np.setAdditionalSearchPath(\"/workspaces/pybullet_tutorial/demos/urdf\")\n# fix base to world\nrobot_id = p.loadURDF(\"rrbot.urdf\", useFixedBase=True)\n\n# add slider for each joint\njoint_sliders = {}\nnum_joints = p.getNumJoints(robot_id)\nfor i in range(num_joints):\n    info = p.getJointInfo(robot_id, i)\n    j_name = info[1].decode(\"utf-8\")\n    j_type = info[2]\n\n    slider_id = p.addUserDebugParameter(j_name, -3.14, 3.14, 0.0)\n    joint_sliders[i] = slider_id\n\n\nwhile p.isConnected():\n    for j, slider_id in joint_sliders.items():\n        target = p.readUserDebugParameter(slider_id)\n        # set joint position\n        p.setJointMotorControl2(\n            robot_id,\n            j,\n            controlMode=p.POSITION_CONTROL,\n            targetPosition=target,\n            force=5.0\n        )\n    p.stepSimulation()\n    time.sleep(1./240.)\n</code></pre>"},{"location":"Simulation/PyBullet/tutorials/links_and_joints/#setjointmotorcontrol2","title":"setJointMotorControl2","text":"<p>We can control a robot by setting a desired control mode for one or more joint motors. During the stepSimulation the physics engine will simulate the motors to reach the given target value that can be reached within the maximum motor forces and other constraints. (page 25)</p>"},{"location":"Simulation/PyBullet/tutorials/links_and_joints/#control-velocity","title":"Control Velocity","text":"<pre><code>import pybullet as p\nimport time\nimport pybullet_data\n\n\np.connect(p.GUI)\np.setGravity(0, 0, -9.8)\n\n# Default PyBullet assets\np.setAdditionalSearchPath(pybullet_data.getDataPath())\nplane_id = p.loadURDF(\"plane.urdf\")\n\n# Additional URDFs location\np.setAdditionalSearchPath(\"/workspaces/pybullet_tutorial/demos/urdf\")\n# fix base to world\nrobot_id = p.loadURDF(\"rrbot.urdf\", useFixedBase=True)\n\n# add slider for each joint\njoint_sliders = {}\nnum_joints = p.getNumJoints(robot_id)\nfor i in range(num_joints):\n    info = p.getJointInfo(robot_id, i)\n    j_name = info[1].decode(\"utf-8\")\n    j_type = info[2]\n\n    slider_id = p.addUserDebugParameter(j_name, -2, 2, 0.0)\n    joint_sliders[i] = slider_id\n\n\nwhile p.isConnected():\n    for j, slider_id in joint_sliders.items():\n        target = p.readUserDebugParameter(slider_id)\n        # set joint position\n        p.setJointMotorControl2(\n            robot_id,\n            j,\n            controlMode=p.VELOCITY_CONTROL,\n            targetVelocity=target,\n            force=5.0\n        )\n    p.stepSimulation()\n    time.sleep(1./240.)\n</code></pre>"},{"location":"Simulation/PyBullet/tutorials/links_and_joints/#control-with-force-torque","title":"control with force / torque","text":"<p>Tip</p> <pre><code># Disable default motors\nfor j in range(num_joints):\n    p.setJointMotorControl2(robot_id, j, p.VELOCITY_CONTROL, force=0)\n</code></pre> <p>Tip</p> <p>Start slightly away from upright so gravity is non-zero</p> <pre><code># \np.resetJointState(robot_id, 0, 0.2)\n</code></pre> <pre><code>import pybullet as p\nimport time\nimport pybullet_data\n\np.connect(p.GUI)\np.setGravity(0, 0, -9.8)\n\n# Default assets\np.setAdditionalSearchPath(pybullet_data.getDataPath())\nplane_id = p.loadURDF(\"plane.urdf\")\n\n# Your URDFs\np.setAdditionalSearchPath(\"/workspaces/pybullet_tutorial/demos/urdf\")\nrobot_id = p.loadURDF(\"rrbot.urdf\", useFixedBase=True)\n\nnum_joints = p.getNumJoints(robot_id)\n\n# Disable default motors\nfor j in range(num_joints):\n    p.setJointMotorControl2(robot_id, j, p.VELOCITY_CONTROL, force=0)\n\n# Optional: reduce damping so it moves easier\nfor j in range(num_joints):\n    p.changeDynamics(robot_id, j, linearDamping=0, angularDamping=0)\n\n# Start slightly away from upright so gravity is non-zero\np.resetJointState(robot_id, 0, 0.2)\n\n# Torque slider ONLY for joint 1 (revolute)\nMAX_TORQUE = 20.0\nslider_id = p.addUserDebugParameter(\"joint1_torque\", -MAX_TORQUE, MAX_TORQUE, 0.0)\n\nwhile p.isConnected():\n    torque = p.readUserDebugParameter(slider_id)\n\n    p.setJointMotorControl2(\n        robot_id,\n        0,  # control joint1 only\n        controlMode=p.TORQUE_CONTROL,\n        force=torque\n    )\n\n    p.stepSimulation()\n    time.sleep(1./240.)\n</code></pre> <p></p> <p>TODO: show joint angel TODO: calc the torque need to apply for this angel</p> \\[\\tau = m g r \\sin(\\theta)\\] \\[\\tau_\\text{max,gravity} = m g r \u2248 1 \\cdot 9.81 \\cdot 0.45 \u2248  4.4 \\text{Nm}\\] <p>If the joint comes to rest at some angle \u03b8 because of damping, static equilibrium is roughly:</p> \\[\\tau_\\text{applied} + \\tau_\\text{gravity}(\\theta) = 0\\] \\[4.0 - (m g r \\sin\\theta) = 0 \\Rightarrow \\sin\\theta = \\frac{4.0}{1 \\cdot 9.81 \\cdot 0.45} \u2248 0.906\\] \\[ \\sin\\theta = 0.906 ; \\theta=65deg\\]"},{"location":"Simulation/PyBullet/tutorials/loadurdf/","title":"PyBullet tutorials and learning","text":"<pre><code>import pybullet as p\nimport pybullet_data\nimport time\n\n# setup\np.connect(p.GUI)\np.resetSimulation()\np.setGravity(gravX=0, gravY=0, gravZ=-9.8)\np.setAdditionalSearchPath(path=pybullet_data.getDataPath())\n\n# load URDF\nplane = p.loadURDF(\"plane.urdf\")\n\ncube = p.loadURDF(\n    \"cube.urdf\", basePosition=[0, 0, 1], globalScaling=0.5, useFixedBase=True\n)\n\nobj = p.loadURDF(\"cube_small.urdf\", basePosition=[1, 1, 0.1], globalScaling=1.5)\np.changeVisualShape(objectUniqueId=obj, linkIndex=-1, rgbaColor=[1, 0, 0, 1])  # red\n\np.setRealTimeSimulation(True)\nwhile p.isConnected():\n    time.sleep(0.01)\n</code></pre> <ul> <li>useFixedBase: force the base of the loaded object to be static</li> <li>basePosition: create the base of the object at the specified position in world space coordinates [X,Y,Z].</li> <li>globalScaling: globalScaling will apply a scale factor to the URDF model</li> </ul>","tags":["pybullet","loadurdf","changeVisualShape"]},{"location":"Simulation/PyBullet/tutorials/loadurdf/#changevisualshape","title":"changeVisualShape","text":"<p>check page 53 in pybullet guid</p> <p>You can use changeVisualShape to change the texture of a shape, the RGBA color and other properties.</p>","tags":["pybullet","loadurdf","changeVisualShape"]},{"location":"Simulation/PyBullet/tutorials/loadurdf/#change-ground-texture","title":"Change ground Texture","text":"<p>tarmac.png</p> <pre><code>import pybullet as p\nimport pybullet_data\nimport time\nimport pathlib\n\n# Initialize PyBullet\nphysicsClient = p.connect(p.GUI)\np.setAdditionalSearchPath(pybullet_data.getDataPath())\n\n# Create ground plane\nplaneId = p.loadURDF(\"plane.urdf\")\n\n# Add texture to the ground\nimage_path = pathlib.Path(__file__).parent.joinpath(\"tarmac.png\").as_posix()\ntextureId = p.loadTexture(image_path)\np.changeVisualShape(planeId, -1, textureUniqueId=textureId)\n\n# Set gravity and run simulation\np.setGravity(0, 0, -9.81)\n\nwhile True:\n    p.stepSimulation()\n    time.sleep(1./240.)\n</code></pre>","tags":["pybullet","loadurdf","changeVisualShape"]},{"location":"Simulation/airsim/","title":"Project AirSim","text":"<p>AirSim is a simulator for drones, cars and more, built on Unreal Engine Microsoft AirSim was officially archived by Microsoft in 2022. it continue and fork by other i clone ProjectAirSim by IAMAISIM</p> <p>Project AirSim consists of three main layers:</p> <ul> <li>Project AirSim Sim Libs - Base infrastructure for defining a generic robot structure and simulation scene tick loop</li> <li>Project AirSim Plugin - Host package (currently an Unreal Plugin) that builds on the sim libs to connect external components (controller, physics, rendering) at runtime that are specific to each configured robot-type scenario (ex. quadrotor drones)</li> <li>Project AirSim Client Library - End-user library to enable API calls to interact with the robot and simulation over a network connection</li> </ul>","tags":["airsim","simulator"]},{"location":"Simulation/airsim/#usage","title":"Usage","text":"","tags":["airsim","simulator"]},{"location":"Simulation/airsim/#pre-build-environment","title":"Pre-build environment","text":"<p>I just want to download and run a Project AirSim environment and drive it with some Python code.</p> <p>The python project airsim client locate at <code>client/python/projectairsim/</code></p>","tags":["airsim","simulator"]},{"location":"Simulation/airsim/#dev","title":"Dev","text":"<ul> <li>Dockerfile to install python dependencies </li> <li>Install prebuild binary</li> </ul> <pre><code># syntax=docker/dockerfile:1\nFROM nvidia/cuda:12.4.1-runtime-ubuntu22.04\n\nENV DEBIAN_FRONTEND=noninteractive\n\n# --- OS deps (Python + GL runtime) ---\nRUN apt-get update &amp;&amp; apt-get install -y --no-install-recommends \\\n    ca-certificates \\\n    git \\\n    python3 \\\n    python3-pip \\\n    python3-venv \\\n    # Fix for: libGL.so.1 not found\n    libgl1 \\\n    # Common runtime libs often needed by OpenCV / GUI-ish deps\n    libglib2.0-0 \\\n    libsm6 \\\n    libxext6 \\\n    &amp;&amp; rm -rf /var/lib/apt/lists/*\n\n# --- Virtualenv ---\nENV VENV_PATH=/opt/venv\nRUN python3 -m venv ${VENV_PATH}\nENV PATH=\"${VENV_PATH}/bin:${PATH}\"\n\nRUN pip install --no-cache-dir -U pip setuptools wheel\n\n# --- Clone ProjectAirSim ---\nARG PROJECTAIRSIM_REF=main\nWORKDIR /opt\nRUN git clone --depth 1 --branch ${PROJECTAIRSIM_REF} https://github.com/iamaisim/ProjectAirSim.git\n\n# --- Install the Python client ---\nWORKDIR /opt/ProjectAirSim/client/python/projectairsim\nRUN pip install --no-cache-dir -e .\n\n# Sanity check\nRUN python -c \"import projectairsim; print('projectairsim import OK')\"\n\nWORKDIR /workspace\nCMD [\"bash\"]\n</code></pre> docker usage<pre><code>docker run --rm -it --gpus all --net host \\\n  -e DISPLAY=$DISPLAY \\\n  -v /tmp/.X11-unix:/tmp/.X11-unix:rw \\\nairsim:22.04 /bin/bash\n</code></pre> <pre><code>/opt/ProjectAirSim/client/python/example_user_scripts# python3 hello_drone.py\n</code></pre>","tags":["airsim","simulator"]},{"location":"Simulation/airsim/#reference","title":"Reference","text":"<ul> <li>iamai site</li> <li>Project AirSim simulator</li> <li>Project AirSim</li> </ul>","tags":["airsim","simulator"]},{"location":"Simulation/gazebo_jetty/","title":"Gazebo JETTY","text":"<p>VSCode dev</p> <p>gz transport</p> <p>Custom plugins</p>","tags":["gazebo","gz","jetty"]},{"location":"Simulation/gazebo_jetty/custom_plugins/","title":"Gazebo custom plugin","text":"","tags":["gazebo","gz","jetty","plugin","custom"]},{"location":"Simulation/gazebo_jetty/custom_plugins/#simple-model-plugin","title":"Simple model plugin","text":"simple.cpp<pre><code>#include &lt;gz/sim/System.hh&gt;\n#include &lt;gz/plugin/Register.hh&gt;\n#include &lt;iostream&gt;\n\nusing namespace gz;\nusing namespace sim;\n\n/////////////////////////////////////////////////\nclass SimpleParamReader\n  : public System,\n    public ISystemConfigure\n{\npublic:\n  void Configure(const Entity &amp;,\n                 const std::shared_ptr&lt;const sdf::Element&gt; &amp;_sdf,\n                 EntityComponentManager &amp;,\n                 EventManager &amp;) override\n  {\n    if (_sdf-&gt;HasElement(\"test_value\"))\n    {\n      auto value = _sdf-&gt;Get&lt;std::string&gt;(\"test_value\");\n      std::cout &lt;&lt; \"[SimpleParamReader] test_value: \" &lt;&lt; value &lt;&lt; \"\\n\";\n    }\n    else\n    {\n      std::cout &lt;&lt; \"[SimpleParamReader] No &lt;test_value&gt; found in SDF\\n\";\n    }\n  }\n};\n\nGZ_ADD_PLUGIN(SimpleParamReader,\n              System,\n              SimpleParamReader::ISystemConfigure)\n\nGZ_ADD_PLUGIN_ALIAS(SimpleParamReader,\n                    \"gz::sim::systems::SimpleParamReader\")\n</code></pre> CMakeLists.txt<pre><code>cmake_minimum_required(VERSION 3.10)\nproject(SimpleParamReader)\n\nfind_package(gz-sim REQUIRED)\nfind_package(gz-plugin REQUIRED)\n\nadd_library(SimpleParamReader SHARED simple.cpp)\n\ntarget_link_libraries(SimpleParamReader\n  gz-sim::gz-sim\n  gz-plugin::gz-plugin\n)\n\ninstall(TARGETS SimpleParamReader\n  LIBRARY DESTINATION ${CMAKE_SOURCE_DIR}/bin)\n</code></pre> <p>Note</p> <p>The <code>name</code> in the <code>plugin</code> section is register by - GZ_ADD_PLUGIN - GZ_ADD_PLUGIN_ALIAS </p> model plugin section<pre><code> &lt;plugin\n    name=\"gz::sim::systems::SimpleParamReader\"\n    filename=\"libSimpleParamReader.so\"&gt;\n    &lt;test_value&gt;HelloWorld&lt;/test_value&gt;\n&lt;/plugin&gt;\n</code></pre> <p>Tip</p> <p>Don't forget to set <code>GZ_SIM_SYSTEM_PLUGIN_PATH</code> </p>","tags":["gazebo","gz","jetty","plugin","custom"]},{"location":"Simulation/gazebo_jetty/gz_transport/","title":"GZ Transport","text":"<p>gz_transport is Gazebo's communication middleware, used for inter-process communication (IPC) between different Gazebo components \u2014 like sensors, plugins, UI, and even ROS bridges. for ionic the gz_transport is version 14</p>","tags":["gazebo","ionic","gz_transport"]},{"location":"Simulation/gazebo_jetty/gz_transport/#gz_transport-python-bindings","title":"gz_transport python bindings","text":"<p>Python bindings for gz_transport read more Python support</p> <pre><code>sudo apt install python3-gz-transport15\n# gazebo messages\nsudo apt install python3-gz-msgs12\n</code></pre>","tags":["gazebo","ionic","gz_transport"]},{"location":"Simulation/gazebo_jetty/gz_transport/#references","title":"References","text":"<ul> <li>Gazebo Release Features (gz-* versions)</li> </ul>","tags":["gazebo","ionic","gz_transport"]},{"location":"Simulation/gazebo_jetty/vscode/","title":"Run gazebo ionic on docker","text":"","tags":["gazebo","gz","jetty","docker","vscode"]},{"location":"Simulation/gazebo_jetty/vscode/#dockerfile","title":"Dockerfile","text":"Docker file","tags":["gazebo","gz","jetty","docker","vscode"]},{"location":"Simulation/gazebo_jetty/vscode/#run-the-image","title":"Run the image","text":"<pre><code>xhost +local:docker\n\ndocker run --gpus all -it --rm \\\n--name ionic \\\n--hostname gz \\\n--user user \\\n--network host \\\n--env=\"QT_X11_NO_MITSHM=1\"  \\\n--env=\"DISPLAY\"  \\\n-v /tmp/.X11-unix:/tmp/.X11-unix:rw \\\n-v /dev/dri:/dev/dri \\\n-v /dev/nvidia0:/dev/nvidia0 \\\n-v /dev/nvidiactl:/dev/nvidiactl \\\n-v /dev/nvidia-modeset:/dev/nvidia-modeset \\\ngz:ionic\n</code></pre>","tags":["gazebo","gz","jetty","docker","vscode"]},{"location":"Simulation/gazebo_jetty/vscode/#use-vscode-and-docker","title":"Use VSCode and docker","text":"<ul> <li>Using docker-compose</li> <li>Using devcontainer to run the docker compose</li> </ul> <pre><code>\u251c\u2500\u2500 .devcontainer\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 devcontainer.json\n\u251c\u2500\u2500 docker-compose.yaml\n\u251c\u2500\u2500 .gitignore\n\u2514\u2500\u2500 gz_tutorial\n    \u2514\u2500\u2500 worlds\n        \u2514\u2500\u2500 empty.world\n</code></pre> docker-compose.yaml<pre><code>services:\n  gazebo:\n    image: gz:harmonic\n    network_mode: host\n    user: user\n    stdin_open: true\n    tty: true\n    hostname: gz\n    environment:\n      - DISPLAY=${DISPLAY}\n      - QT_X11_NO_MITSHM=1\n      - NVIDIA_VISIBLE_DEVICES=all\n      - NVIDIA_DRIVER_CAPABILITIES=all\n      - GZ_TRANSPORT_IP=gazebo\n      - GZ_DISCOVERY_SERVER=gazebo\n      - GZ_PARTITION=my_simulation\n    volumes:\n      - .:/workspace:cached\n      - ./.gz:/home/user/.gz:cached\n      - /tmp/.X11-unix:/tmp/.X11-unix:rw \n      - /dev/dri:/dev/dri \n      - /dev/nvidia0:/dev/nvidia0 \n      - /dev/nvidiactl:/dev/nvidiactl \n      - /dev/nvidia-modeset:/dev/nvidia-modeset \n    deploy:\n      resources:\n        reservations:\n          devices:\n            - capabilities: [gpu]\n</code></pre> .devcontainer/devcontainer.json<pre><code>{\n    \"name\": \"gz_tutorial\",\n    \"dockerComposeFile\": \"../docker-compose.yaml\",\n    \"service\": \"gazebo\",\n    \"shutdownAction\": \"stopCompose\",\n    \"workspaceFolder\": \"/workspace\",\n    \"remoteUser\": \"user\",\n    \"customizations\": {\n      \"vscode\": {\n        \"extensions\": [\n            \"ms-python.python\",\n            \"ms-vscode.cpptools\",\n            \"twxs.cmake\",\n            \"redhat.vscode-xml\",\n            \"redhat.vscode-yaml\",\n            \"albert.tabout\",\n            \"actboy168.tasks\",\n            \"streetsidesoftware.code-spell-checker\"\n        ],\n        \"settings\": {}\n      }\n    }\n  }\n</code></pre>","tags":["gazebo","gz","jetty","docker","vscode"]},{"location":"Simulation/godot/","title":"Godot game engine","text":"<p>Simulation</p>","tags":["godot","simulation"]},{"location":"Simulation/godot/#run","title":"Run","text":"<pre><code># Run with NVIDIA GPU\n__NV_PRIME_RENDER_OFFLOAD=1 __GLX_VENDOR_LIBRARY_NAME=nvidia ./Godot_v4.5.1-stable_linux.x86_64 \n</code></pre>","tags":["godot","simulation"]},{"location":"Simulation/godot/#ros2","title":"ROS2","text":"build automation tool<pre><code>pip install scons\n</code></pre>","tags":["godot","simulation"]},{"location":"Simulation/godot/#reference","title":"Reference","text":"<ul> <li>Introducing 3D Tiles for Godot by Battle Road</li> <li>Godot ros2 integration</li> <li>godot_ros</li> </ul>","tags":["godot","simulation"]},{"location":"Simulation/isaac_lab/","title":"Index","text":"<p>title: Isaac LAB tags:     - isaac     - isaacSim</p>"},{"location":"Simulation/isaac_lab/#install","title":"Install","text":""},{"location":"Simulation/isaac_lab/#reference","title":"Reference","text":"<ul> <li>Isaac LAB documentation (local install)</li> <li>isaac lab basic</li> </ul>"},{"location":"Simulation/osg/","title":"Open scene graph","text":"<p>Simulation</p> <p>OpenSceneGraph (OSG) is an open-source 3D graphics toolkit written in C++, built on top of OpenGL. It provides a high-level scene graph abstraction for building, rendering, and managing complex 3D scenes efficiently.</p>","tags":["osg","open scene graph","osgEarth"]},{"location":"Simulation/osg/#common-use-case","title":"Common use case","text":"Area Description Simulation &amp; Training Flight simulators, military simulators, driving trainers Scientific Visualization Displaying large 3D datasets or terrains Geospatial Systems Used by osgEarth to render real-world maps and terrain Virtual Reality (VR) Basis for immersive 3D visualization Game Engines / Tools Lightweight base for building visualization or engine tools <p>OSG Earth</p>","tags":["osg","open scene graph","osgEarth"]},{"location":"Simulation/osg/#install","title":"Install","text":"<pre><code>git clone https://github.com/openscenegraph/OpenSceneGraph.git\ncd OpenSceneGraph\nmkdir build\ncd build\ncmake ..\nmake\nsudo make install\nsuod ldconfig\n</code></pre>","tags":["osg","open scene graph","osgEarth"]},{"location":"Simulation/osg/#demo","title":"Demo","text":"<pre><code>#include &lt;osgViewer/Viewer&gt;\n#include &lt;osg/ShapeDrawable&gt;\n\nint main() {\n    osg::ref_ptr&lt;osg::Group&gt; root = new osg::Group();\n    root-&gt;addChild(new osg::ShapeDrawable(new osg::Sphere(osg::Vec3(0,0,0), 1.0)));\n\n    osgViewer::Viewer viewer;\n    viewer.setSceneData(root);\n    return viewer.run();\n}\n</code></pre> <pre><code>cmake_minimum_required(VERSION 3.10)\nproject(SimpleOSGApp)\n\nset(CMAKE_CXX_STANDARD 17)\n\nfind_package(OpenSceneGraph REQUIRED COMPONENTS osg osgDB osgUtil osgViewer)\n\n# Create executable\nadd_executable(osg_example hello.cpp)\n\n# Link OSG libraries\ntarget_link_libraries(osg_example\n    PRIVATE\n        osg\n        osgDB\n        osgUtil\n        osgViewer\n)\n</code></pre>","tags":["osg","open scene graph","osgEarth"]},{"location":"Simulation/osg/#learn-path-create-by-chatgpt","title":"Learn path create by chatGPT","text":"<p>Each week builds on the previous one. For each topic, I\u2019ve included:</p> <ul> <li>\ud83c\udf93 Concepts \u2014 what you\u2019ll learn</li> <li>\ud83d\udcbb Practice Goals \u2014 what you\u2019ll implement</li> <li>\ud83d\udcda Resources \u2014 where to learn more</li> </ul> <p>\ud83d\uddd3\ufe0f Week 1 \u2013 Setup &amp; Core Concepts</p> <p>Goal: Understand what OSG is, how it organizes scenes, and render your first object.</p> <p>\ud83c\udf93 Concepts - Scene graph structure (Nodes, Groups, Geodes) - Viewer and event loop (osgViewer::Viewer) - Geometry, Drawables, and simple shapes - Installing OSG and using CMake with VSCode</p> <p>\ud83d\udcbb Practice</p> <ul> <li>\u2705 Install OSG (sudo apt install libopenscenegraph-dev)</li> <li>\u2705 Build your first program (sphere example)</li> <li>\u2705 Add multiple shapes (cube + sphere + cone)</li> <li>\u2705 Use osg::Group to attach nodes</li> <li>\u2705 Experiment with osgViewer::Viewer::run()</li> </ul> <p>\ud83d\udcda Resources</p> <p>OSG Wiki \u2013 Getting Started</p> <p>\ud83d\uddd3\ufe0f Week 2 \u2013 Transforms &amp; Cameras</p> <p>Goal: Learn to position objects and control the camera.</p> <p>\ud83c\udf93 Concepts</p> <ul> <li>Transform nodes (osg::MatrixTransform)</li> <li>Local vs global coordinates</li> <li>Orbit manipulator (osgGA::OrbitManipulator)</li> <li>Camera node (osg::Camera)</li> </ul> <p>\ud83d\udcbb Practice</p> <ul> <li>\u2705 Move an object using MatrixTransform</li> <li>\u2705 Animate a rotation using osg::AnimationPathCallback</li> <li>\u2705 Add a camera and control with mouse (OrbitManipulator)</li> <li>\u2705 Play with setHomeViewpoint() to set default view</li> </ul> <p>\ud83d\udcda Resources</p> <p>Example: examples/osganimationpath</p> <p>Camera Manipulators Doc</p> <p>\ud83d\uddd3\ufe0f Week 3 \u2013 Models, Materials &amp; Lighting</p> <p>Goal: Load real 3D models and make your scene look realistic.</p> <p>\ud83c\udf93 Concepts</p> <ul> <li>Loading models (osgDB::readNodeFile)</li> <li>Materials, textures, and lights</li> <li>StateSets (managing OpenGL state)</li> <li>Shaders overview</li> </ul> <p>\ud83d\udcbb Practice</p> <ul> <li>\u2705 Load a .obj or .osgb model</li> <li>\u2705 Add texture using osg::Texture2D</li> <li>\u2705 Add a light source (osg::LightSource)</li> <li>\u2705 Adjust materials via osg::Material</li> </ul> <p>\ud83d\udcda Resources</p> <ul> <li>Example: examples/osglight</li> <li>Example: examples/osgshadercomp</li> <li>Book: Beginner\u2019s Guide Ch. 4\u20136</li> </ul> <p>\ud83d\uddd3\ufe0f Week 4 \u2013 Interaction &amp; Events</p> <p>Goal: Make the scene respond to input.</p> <p>\ud83c\udf93 Concepts</p> <ul> <li>Event handlers (osgGA::GUIEventHandler)</li> <li>Keyboard and mouse input</li> <li>Picking (selecting objects with mouse)</li> <li>Callbacks (update, cull, draw)</li> </ul> <p>\ud83d\udcbb Practice</p> <ul> <li>\u2705 Create a custom event handler for key presses</li> <li>\u2705 Implement simple object movement (e.g., arrow keys to move)</li> <li>\u2705 Add text overlay using osgText::Text</li> <li>\u2705 Implement a basic \u201cobject picker\u201d</li> </ul> <p>\ud83d\udcda Resources</p> <ul> <li>Example: examples/osgevent</li> <li>osgGA::GUIEventHandler API</li> <li>OSG Callback System</li> </ul> <p>\ud83d\uddd3\ufe0f Week 5 \u2013 Performance &amp; Advanced Features</p> <p>Goal: Understand optimization and advanced scene graph concepts.</p> <p>\ud83c\udf93 Concepts</p> <ul> <li>Level of Detail (osg::LOD)</li> <li>Culling and bounding volumes</li> <li>Paging (loading large datasets dynamically)</li> <li>Multithreaded rendering overview</li> <li>Using shaders (GLSL in OSG)</li> </ul> <p>\ud83d\udcbb Practice</p> <ul> <li>\u2705 Create LOD nodes for distant objects</li> <li>\u2705 Visualize bounding boxes (osg::BoundingBox)</li> <li>\u2705 Try replacing default shader with custom GLSL</li> <li>\u2705 Explore example: osgmultitexture</li> </ul> <p>\ud83d\udcda Resources</p> <ul> <li>Example: examples/osglod</li> <li>OSG Rendering Optimization</li> </ul> <p>\ud83d\uddd3\ufe0f Week 6 \u2013 Integration &amp; osgEarth</p> <p>Goal: Combine what you learned and build a mini-project.</p> <p>\ud83c\udf93 Concepts</p> <ul> <li>osgEarth basics (MapNode, ImageLayer, ElevationLayer)</li> <li>Adding UI (Qt or ImGui optional)</li> <li>Combining 3D models + terrain</li> <li>Exporting and saving scenes</li> </ul> <p>\ud83d\udcbb Practice</p> <ul> <li>\u2705 Install osgEarth (sudo apt install osgEarth)</li> <li>\u2705 Load OpenStreetMap base layer</li> <li>\u2705 Add a model (e.g., aircraft or robot) at specific lat/lon</li> <li>\u2705 Use OrbitManipulator to explore the map</li> <li>\u2705 Export scene with osgDB::writeNodeFile()</li> </ul> <p>\ud83d\udcda Resources</p> <ul> <li>osgEarth GitHub: https://github.com/gwaldron/osgearth</li> </ul> <p>\ud83e\udde9 Optional Weeks (7+)</p> <ul> <li>Week 7 \u2192 integrate with Qt GUI (using osgQt::GLWidget)</li> <li>Week 8 \u2192 build plugin or viewer utility</li> <li>Week 9 \u2192 add VR support (OpenVR / Oculus)</li> <li>Week 10 \u2192 integrate with ROS 2 or simulation data (e.g., real sensor visualization)</li> </ul>","tags":["osg","open scene graph","osgEarth"]},{"location":"Simulation/osg/#reference","title":"Reference","text":"<ul> <li>OpenSceneGraph Tutorial for Algorithms Development</li> </ul>","tags":["osg","open scene graph","osgEarth"]},{"location":"Simulation/osg/learn_path/week1/","title":"OSG Group","text":"<p>Simulation / osg / learn path</p> <ul> <li>osg::Group is a container node \u2014 it can have one or more child nodes.</li> <li>It is used to organize your scene in a tree-like hierarchy called a scene graph.</li> <li>Each child can be a 3D object (osg::Geode), another Group, or even a transformation node.</li> </ul> <p>You can think of it like a folder that holds multiple objects inside the 3D scene.</p> <pre><code>osg::Group (root)\n \u251c\u2500\u2500 osg::Geode (sphere)\n \u2502     \u2514\u2500\u2500 osg::ShapeDrawable (Sphere)\n \u251c\u2500\u2500 osg::Geode (box)\n \u2502     \u2514\u2500\u2500 osg::ShapeDrawable (Box)\n \u2514\u2500\u2500 osg::Geode (cone)\n       \u2514\u2500\u2500 osg::ShapeDrawable (Cone)\n</code></pre> Demo <pre><code>#include &lt;osg/ShapeDrawable&gt;\n#include &lt;osg/Geode&gt;\n#include &lt;osg/Group&gt;\n#include &lt;osgViewer/Viewer&gt;\n\nint main() {\n    // Create drawables (actual shapes)\n    osg::ref_ptr&lt;osg::ShapeDrawable&gt; sphere =\n        new osg::ShapeDrawable(new osg::Sphere(osg::Vec3(0, 0, 0), 1.0));\n    osg::ref_ptr&lt;osg::ShapeDrawable&gt; box =\n        new osg::ShapeDrawable(new osg::Box(osg::Vec3(3, 0, 0), 1.5));\n    osg::ref_ptr&lt;osg::ShapeDrawable&gt; cone =\n        new osg::ShapeDrawable(new osg::Cone(osg::Vec3(-3, 0, 0), 1.0, 2.0));\n\n    // Create geodes to hold each drawable\n    osg::ref_ptr&lt;osg::Geode&gt; geodeSphere = new osg::Geode();\n    osg::ref_ptr&lt;osg::Geode&gt; geodeBox = new osg::Geode();\n    osg::ref_ptr&lt;osg::Geode&gt; geodeCone = new osg::Geode();\n\n    geodeSphere-&gt;addDrawable(sphere);\n    geodeBox-&gt;addDrawable(box);\n    geodeCone-&gt;addDrawable(cone);\n\n    // Create a group node and attach all geodes\n    osg::ref_ptr&lt;osg::Group&gt; root = new osg::Group();\n    root-&gt;addChild(geodeSphere);\n    root-&gt;addChild(geodeBox);\n    root-&gt;addChild(geodeCone);\n\n    // Viewer setup\n    osgViewer::Viewer viewer;\n    viewer.setSceneData(root);\n    return viewer.run();\n}\n</code></pre>","tags":["osg","group"]},{"location":"Simulation/osg/learn_path/week1/run_loop/","title":"OSG viewer loop","text":"<p>Simulation / osg / learn path</p> <p>understand what happens inside OSG\u2019s main rendering loop and how you can customize or control it.</p> <pre><code>return viewer.run();\n</code></pre> <p>It starts OSG\u2019s main loop, which: - Opens a rendering window - Initializes the camera and graphics context - Continuously:     - Polls user input (keyboard/mouse)     - Updates scene nodes (via callbacks)     - Traverses the scene graph     - Draws the current frame     - Exits when the window closes or viewer.done() returns true.</p>","tags":["osg","viewer","run"]},{"location":"Simulation/osg/learn_path/week1/run_loop/#manual","title":"Manual","text":"run_loop.cpp<pre><code>#include &lt;osg/ShapeDrawable&gt;\n#include &lt;osg/Geode&gt;\n#include &lt;osgViewer/Viewer&gt;\n#include &lt;osgGA/OrbitManipulator&gt;\n\nint main()\n{\n    // --- Create a shape (a simple box) ---\n    osg::ref_ptr&lt;osg::ShapeDrawable&gt; box =\n        new osg::ShapeDrawable(new osg::Box(osg::Vec3(0, 0, 0), 1.0));\n    // Ensures visible color even if lighting is off.\n    box-&gt;setColor(osg::Vec4(0.2f, 0.8f, 0.2f, 1.0f)); // green color\n\n    // --- Create a geode (geometry node) and add the shape ---\n    osg::ref_ptr&lt;osg::Geode&gt; geode = new osg::Geode();\n    geode-&gt;addDrawable(box);\n\n    // --- Create the viewer ---\n    osgViewer::Viewer viewer;\n\n    // Set up a visible window (x, y, width, height)\n    // Ensures a proper rendering window is created (some systems need it).\n    viewer.setUpViewInWindow(100, 100, 800, 600);\n\n    // Add a manipulator so you can move the camera with the mouse\n    viewer.setCameraManipulator(new osgGA::OrbitManipulator());\n\n    // Set the scene data\n    viewer.setSceneData(geode.get());\n\n    // --- Main loop ---\n    while (!viewer.done())\n    {\n         // Here you can:\n        // 1. update object positions\n        // 2. run physics or sensor code\n        // 3. handle custom input\n        viewer.frame(); // Render one frame\n    }\n\n    return 0;\n}\n</code></pre> <pre><code>find_package(OpenSceneGraph REQUIRED COMPONENTS osg osgDB osgUtil osgViewer osgGA)\nset(OSG_LIBRARIES\n    osg\n    osgDB\n    osgUtil\n    osgViewer\n    osgGA\n)\n\nadd_executable(run_loop run_loop.cpp)\ntarget_link_libraries(run_loop PRIVATE ${OSG_LIBRARIES})\n</code></pre>","tags":["osg","viewer","run"]},{"location":"Simulation/osg/osg_earth/","title":"Index","text":"<p>Simulation / osg</p>","tags":["osg","open scene graph","osgEarth"]},{"location":"Simulation/osg/osg_earth/#osg-earth","title":"osg earth","text":"<p>osg earth</p> <pre><code># OSG\ngit clone https://github.com/openscenegraph/OpenSceneGraph.git\ncd OpenSceneGraph &amp;&amp; mkdir build &amp;&amp; cd build\ncmake .. -DCMAKE_CXX_STANDARD=17 -DCMAKE_BUILD_TYPE=Release\nmake -j$(nproc)\nsudo make install\n\n# osgEarth\ngit clone https://github.com/gwaldron/osgearth.git\ncd osgearth &amp;&amp; mkdir build &amp;&amp; cd build\ncmake .. -DCMAKE_CXX_STANDARD=17 -DCMAKE_BUILD_TYPE=Release\nmake -j$(nproc)\nsudo make install\n</code></pre>","tags":["osg","open scene graph","osgEarth"]},{"location":"Simulation/other/","title":"Other simulators","text":"<p>Simulation</p> <p>ROS2 Autonomous UAV Simulation</p>","tags":["simulator","ros"]},{"location":"Simulation/vsg/","title":"VulkanSceneGraph","text":"<p>Simulation</p>","tags":["vulkan","vsg"]},{"location":"Simulation/vsg/#install","title":"Install","text":"<ul> <li>Install on ubuntu 22.04</li> <li>Install with glslang optional (ver 14.0.0)</li> </ul> <p>glslang-dev glslang-tools</p> <p>Only if ubuntu 24.04  for ubuntu 22.04 install from source</p> <pre><code>sudo apt-get install cmake-curses-gui g++ git libvulkan-dev \\\nglslang-dev glslang-tools\n</code></pre> <pre><code>cmake -B build -DCMAKE_BUILD_TYPE=Release\ncmake --build build -j$(nproc)\nsudo cmake --install build\nsudo ldconfig\n</code></pre>","tags":["vulkan","vsg"]},{"location":"Simulation/vsg/#glslang","title":"glslang","text":"","tags":["vulkan","vsg"]},{"location":"Simulation/vsg/#-install-version-150-vsg-complain-on-version-160","title":"- Install version 15.0 (vsg complain on version 16.0)","text":"<pre><code>git checkout tags/15.0.0\ncmake -B build -DCMAKE_BUILD_TYPE=Release -DENABLE_OPT=off\ncmake --build build -j$(nproc)\nsudo cmake --install build\nsudo ldconfig\n</code></pre>","tags":["vulkan","vsg"]},{"location":"Simulation/webots/","title":"Index","text":"<p>Simulation</p>","tags":["webots"]},{"location":"Simulation/webots/#python-settings","title":"Python settings","text":"pythonpath<pre><code>export PYTHONPATH=$PYTHONPATH:/usr/local/webots/lib/controller/python\n</code></pre>","tags":["webots"]},{"location":"projects/","title":"Projects","text":"","tags":["projects"]},{"location":"projects/#parameters_utils","title":"parameters_utils","text":"<p>Helper python module that manage external parameter The module expose service that save parameter changes back to original file</p>","tags":["projects"]}]}